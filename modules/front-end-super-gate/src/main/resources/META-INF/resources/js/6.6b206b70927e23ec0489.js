webpackJsonp([6,8,9,11,16,20,22,23,25,26,27,28],{

/***/ 212:
/***/ (function(module, exports, __webpack_require__) {

var Component = __webpack_require__(137)(
  /* script */
  __webpack_require__(647),
  /* template */
  __webpack_require__(649),
  /* scopeId */
  null,
  /* cssModules */
  null
)
Component.options.__file = "d:\\FDS_OPENCPS\\front-end-v2.1\\frontend-opencps-v2.1\\onegate_21_fe\\src\\components\\TiepNhan\\TiepNhanHoSo_ThanhPhanHoSo.vue"
if (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== "default" && key !== "__esModule"})) {console.error("named exports are not supported in *.vue files.")}
if (Component.options.functional) {console.error("[vue-loader] TiepNhanHoSo_ThanhPhanHoSo.vue: functional components are not supported with templates, they should use render functions.")}

/* hot reload */
if (false) {(function () {
  var hotAPI = require("vue-hot-reload-api")
  hotAPI.install(require("vue"), false)
  if (!hotAPI.compatible) return
  module.hot.accept()
  if (!module.hot.data) {
    hotAPI.createRecord("data-v-687ee6a0", Component.options)
  } else {
    hotAPI.reload("data-v-687ee6a0", Component.options)
  }
})()}

module.exports = Component.exports


/***/ }),

/***/ 216:
/***/ (function(module, exports, __webpack_require__) {

var Component = __webpack_require__(137)(
  /* script */
  __webpack_require__(650),
  /* template */
  __webpack_require__(671),
  /* scopeId */
  null,
  /* cssModules */
  null
)
Component.options.__file = "d:\\FDS_OPENCPS\\front-end-v2.1\\frontend-opencps-v2.1\\onegate_21_fe\\src\\components\\form_xu_ly\\FeeDetail.vue"
if (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== "default" && key !== "__esModule"})) {console.error("named exports are not supported in *.vue files.")}
if (Component.options.functional) {console.error("[vue-loader] FeeDetail.vue: functional components are not supported with templates, they should use render functions.")}

/* hot reload */
if (false) {(function () {
  var hotAPI = require("vue-hot-reload-api")
  hotAPI.install(require("vue"), false)
  if (!hotAPI.compatible) return
  module.hot.accept()
  if (!module.hot.data) {
    hotAPI.createRecord("data-v-6830f0e4", Component.options)
  } else {
    hotAPI.reload("data-v-6830f0e4", Component.options)
  }
})()}

module.exports = Component.exports


/***/ }),

/***/ 217:
/***/ (function(module, exports, __webpack_require__) {

var Component = __webpack_require__(137)(
  /* script */
  __webpack_require__(651),
  /* template */
  __webpack_require__(672),
  /* scopeId */
  null,
  /* cssModules */
  null
)
Component.options.__file = "d:\\FDS_OPENCPS\\front-end-v2.1\\frontend-opencps-v2.1\\onegate_21_fe\\src\\components\\toggleButton.vue"
if (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== "default" && key !== "__esModule"})) {console.error("named exports are not supported in *.vue files.")}
if (Component.options.functional) {console.error("[vue-loader] toggleButton.vue: functional components are not supported with templates, they should use render functions.")}

/* hot reload */
if (false) {(function () {
  var hotAPI = require("vue-hot-reload-api")
  hotAPI.install(require("vue"), false)
  if (!hotAPI.compatible) return
  module.hot.accept()
  if (!module.hot.data) {
    hotAPI.createRecord("data-v-7cc31a58", Component.options)
  } else {
    hotAPI.reload("data-v-7cc31a58", Component.options)
  }
})()}

module.exports = Component.exports


/***/ }),

/***/ 219:
/***/ (function(module, exports, __webpack_require__) {

var Component = __webpack_require__(137)(
  /* script */
  __webpack_require__(674),
  /* template */
  __webpack_require__(680),
  /* scopeId */
  null,
  /* cssModules */
  null
)
Component.options.__file = "d:\\FDS_OPENCPS\\front-end-v2.1\\frontend-opencps-v2.1\\onegate_21_fe\\src\\components\\form_xu_ly\\PhanCongNguoiThucHien.vue"
if (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== "default" && key !== "__esModule"})) {console.error("named exports are not supported in *.vue files.")}
if (Component.options.functional) {console.error("[vue-loader] PhanCongNguoiThucHien.vue: functional components are not supported with templates, they should use render functions.")}

/* hot reload */
if (false) {(function () {
  var hotAPI = require("vue-hot-reload-api")
  hotAPI.install(require("vue"), false)
  if (!hotAPI.compatible) return
  module.hot.accept()
  if (!module.hot.data) {
    hotAPI.createRecord("data-v-7cac08a2", Component.options)
  } else {
    hotAPI.reload("data-v-7cac08a2", Component.options)
  }
})()}

module.exports = Component.exports


/***/ }),

/***/ 220:
/***/ (function(module, exports, __webpack_require__) {

var Component = __webpack_require__(137)(
  /* script */
  __webpack_require__(675),
  /* template */
  __webpack_require__(678),
  /* scopeId */
  null,
  /* cssModules */
  null
)
Component.options.__file = "d:\\FDS_OPENCPS\\front-end-v2.1\\frontend-opencps-v2.1\\onegate_21_fe\\src\\components\\form_xu_ly\\ThongTinCoBanHoSo.vue"
if (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== "default" && key !== "__esModule"})) {console.error("named exports are not supported in *.vue files.")}
if (Component.options.functional) {console.error("[vue-loader] ThongTinCoBanHoSo.vue: functional components are not supported with templates, they should use render functions.")}

/* hot reload */
if (false) {(function () {
  var hotAPI = require("vue-hot-reload-api")
  hotAPI.install(require("vue"), false)
  if (!hotAPI.compatible) return
  module.hot.accept()
  if (!module.hot.data) {
    hotAPI.createRecord("data-v-02494d10", Component.options)
  } else {
    hotAPI.reload("data-v-02494d10", Component.options)
  }
})()}

module.exports = Component.exports


/***/ }),

/***/ 221:
/***/ (function(module, exports, __webpack_require__) {

var Component = __webpack_require__(137)(
  /* script */
  __webpack_require__(676),
  /* template */
  __webpack_require__(679),
  /* scopeId */
  null,
  /* cssModules */
  null
)
Component.options.__file = "d:\\FDS_OPENCPS\\front-end-v2.1\\frontend-opencps-v2.1\\onegate_21_fe\\src\\components\\form_xu_ly\\TraKetQua.vue"
if (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== "default" && key !== "__esModule"})) {console.error("named exports are not supported in *.vue files.")}
if (Component.options.functional) {console.error("[vue-loader] TraKetQua.vue: functional components are not supported with templates, they should use render functions.")}

/* hot reload */
if (false) {(function () {
  var hotAPI = require("vue-hot-reload-api")
  hotAPI.install(require("vue"), false)
  if (!hotAPI.compatible) return
  module.hot.accept()
  if (!module.hot.data) {
    hotAPI.createRecord("data-v-5b02061d", Component.options)
  } else {
    hotAPI.reload("data-v-5b02061d", Component.options)
  }
})()}

module.exports = Component.exports


/***/ }),

/***/ 222:
/***/ (function(module, exports, __webpack_require__) {

var Component = __webpack_require__(137)(
  /* script */
  __webpack_require__(677),
  /* template */
  __webpack_require__(681),
  /* scopeId */
  null,
  /* cssModules */
  null
)
Component.options.__file = "d:\\FDS_OPENCPS\\front-end-v2.1\\frontend-opencps-v2.1\\onegate_21_fe\\src\\components\\form_xu_ly\\YkienCanBoThucHien.vue"
if (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== "default" && key !== "__esModule"})) {console.error("named exports are not supported in *.vue files.")}
if (Component.options.functional) {console.error("[vue-loader] YkienCanBoThucHien.vue: functional components are not supported with templates, they should use render functions.")}

/* hot reload */
if (false) {(function () {
  var hotAPI = require("vue-hot-reload-api")
  hotAPI.install(require("vue"), false)
  if (!hotAPI.compatible) return
  module.hot.accept()
  if (!module.hot.data) {
    hotAPI.createRecord("data-v-ad80357c", Component.options)
  } else {
    hotAPI.reload("data-v-ad80357c", Component.options)
  }
})()}

module.exports = Component.exports


/***/ }),

/***/ 224:
/***/ (function(module, exports, __webpack_require__) {

var Component = __webpack_require__(137)(
  /* script */
  __webpack_require__(682),
  /* template */
  __webpack_require__(699),
  /* scopeId */
  null,
  /* cssModules */
  null
)
Component.options.__file = "d:\\FDS_OPENCPS\\front-end-v2.1\\frontend-opencps-v2.1\\onegate_21_fe\\src\\components\\Comment.vue"
if (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== "default" && key !== "__esModule"})) {console.error("named exports are not supported in *.vue files.")}
if (Component.options.functional) {console.error("[vue-loader] Comment.vue: functional components are not supported with templates, they should use render functions.")}

/* hot reload */
if (false) {(function () {
  var hotAPI = require("vue-hot-reload-api")
  hotAPI.install(require("vue"), false)
  if (!hotAPI.compatible) return
  module.hot.accept()
  if (!module.hot.data) {
    hotAPI.createRecord("data-v-c8f36406", Component.options)
  } else {
    hotAPI.reload("data-v-c8f36406", Component.options)
  }
})()}

module.exports = Component.exports


/***/ }),

/***/ 225:
/***/ (function(module, exports, __webpack_require__) {

var Component = __webpack_require__(137)(
  /* script */
  __webpack_require__(683),
  /* template */
  __webpack_require__(696),
  /* scopeId */
  null,
  /* cssModules */
  null
)
Component.options.__file = "d:\\FDS_OPENCPS\\front-end-v2.1\\frontend-opencps-v2.1\\onegate_21_fe\\src\\components\\form_xu_ly\\FormBoSungThongTinNgan.vue"
if (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== "default" && key !== "__esModule"})) {console.error("named exports are not supported in *.vue files.")}
if (Component.options.functional) {console.error("[vue-loader] FormBoSungThongTinNgan.vue: functional components are not supported with templates, they should use render functions.")}

/* hot reload */
if (false) {(function () {
  var hotAPI = require("vue-hot-reload-api")
  hotAPI.install(require("vue"), false)
  if (!hotAPI.compatible) return
  module.hot.accept()
  if (!module.hot.data) {
    hotAPI.createRecord("data-v-2df4b7d0", Component.options)
  } else {
    hotAPI.reload("data-v-2df4b7d0", Component.options)
  }
})()}

module.exports = Component.exports


/***/ }),

/***/ 226:
/***/ (function(module, exports, __webpack_require__) {

var Component = __webpack_require__(137)(
  /* script */
  __webpack_require__(684),
  /* template */
  __webpack_require__(700),
  /* scopeId */
  null,
  /* cssModules */
  null
)
Component.options.__file = "d:\\FDS_OPENCPS\\front-end-v2.1\\frontend-opencps-v2.1\\onegate_21_fe\\src\\components\\form_xu_ly\\KyPheDuyetTaiLieu.vue"
if (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== "default" && key !== "__esModule"})) {console.error("named exports are not supported in *.vue files.")}
if (Component.options.functional) {console.error("[vue-loader] KyPheDuyetTaiLieu.vue: functional components are not supported with templates, they should use render functions.")}

/* hot reload */
if (false) {(function () {
  var hotAPI = require("vue-hot-reload-api")
  hotAPI.install(require("vue"), false)
  if (!hotAPI.compatible) return
  module.hot.accept()
  if (!module.hot.data) {
    hotAPI.createRecord("data-v-f7571a70", Component.options)
  } else {
    hotAPI.reload("data-v-f7571a70", Component.options)
  }
})()}

module.exports = Component.exports


/***/ }),

/***/ 227:
/***/ (function(module, exports, __webpack_require__) {

var Component = __webpack_require__(137)(
  /* script */
  __webpack_require__(685),
  /* template */
  __webpack_require__(697),
  /* scopeId */
  null,
  /* cssModules */
  null
)
Component.options.__file = "d:\\FDS_OPENCPS\\front-end-v2.1\\frontend-opencps-v2.1\\onegate_21_fe\\src\\components\\form_xu_ly\\TaoTaiLieuKetQua.vue"
if (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== "default" && key !== "__esModule"})) {console.error("named exports are not supported in *.vue files.")}
if (Component.options.functional) {console.error("[vue-loader] TaoTaiLieuKetQua.vue: functional components are not supported with templates, they should use render functions.")}

/* hot reload */
if (false) {(function () {
  var hotAPI = require("vue-hot-reload-api")
  hotAPI.install(require("vue"), false)
  if (!hotAPI.compatible) return
  module.hot.accept()
  if (!module.hot.data) {
    hotAPI.createRecord("data-v-5b77eb43", Component.options)
  } else {
    hotAPI.reload("data-v-5b77eb43", Component.options)
  }
})()}

module.exports = Component.exports


/***/ }),

/***/ 255:
/***/ (function(module, exports, __webpack_require__) {

var Component = __webpack_require__(137)(
  /* script */
  __webpack_require__(742),
  /* template */
  __webpack_require__(751),
  /* scopeId */
  null,
  /* cssModules */
  null
)
Component.options.__file = "d:\\FDS_OPENCPS\\front-end-v2.1\\frontend-opencps-v2.1\\onegate_21_fe\\src\\components\\XuLyHoSo.vue"
if (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== "default" && key !== "__esModule"})) {console.error("named exports are not supported in *.vue files.")}
if (Component.options.functional) {console.error("[vue-loader] XuLyHoSo.vue: functional components are not supported with templates, they should use render functions.")}

/* hot reload */
if (false) {(function () {
  var hotAPI = require("vue-hot-reload-api")
  hotAPI.install(require("vue"), false)
  if (!hotAPI.compatible) return
  module.hot.accept()
  if (!module.hot.data) {
    hotAPI.createRecord("data-v-b51162c2", Component.options)
  } else {
    hotAPI.reload("data-v-b51162c2", Component.options)
  }
})()}

module.exports = Component.exports


/***/ }),

/***/ 515:
/***/ (function(module, exports, __webpack_require__) {

var global = __webpack_require__(20);
var core = __webpack_require__(30);
var LIBRARY = __webpack_require__(142);
var wksExt = __webpack_require__(516);
var defineProperty = __webpack_require__(57).f;
module.exports = function (name) {
  var $Symbol = core.Symbol || (core.Symbol = LIBRARY ? {} : global.Symbol || {});
  if (name.charAt(0) != '_' && !(name in $Symbol)) defineProperty($Symbol, name, { value: wksExt.f(name) });
};


/***/ }),

/***/ 516:
/***/ (function(module, exports, __webpack_require__) {

exports.f = __webpack_require__(19);


/***/ }),

/***/ 517:
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(642), __esModule: true };

/***/ }),

/***/ 518:
/***/ (function(module, exports, __webpack_require__) {

// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)
var $keys = __webpack_require__(229);
var hiddenKeys = __webpack_require__(146).concat('length', 'prototype');

exports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {
  return $keys(O, hiddenKeys);
};


/***/ }),

/***/ 642:
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(644);
module.exports = __webpack_require__(30).Object.keys;


/***/ }),

/***/ 643:
/***/ (function(module, exports, __webpack_require__) {

// most Object methods by ES6 should accept primitives
var $export = __webpack_require__(51);
var core = __webpack_require__(30);
var fails = __webpack_require__(94);
module.exports = function (KEY, exec) {
  var fn = (core.Object || {})[KEY] || Object[KEY];
  var exp = {};
  exp[KEY] = exec(fn);
  $export($export.S + $export.F * fails(function () { fn(1); }), 'Object', exp);
};


/***/ }),

/***/ 644:
/***/ (function(module, exports, __webpack_require__) {

// 19.1.2.14 Object.keys(O)
var toObject = __webpack_require__(97);
var $keys = __webpack_require__(138);

__webpack_require__(643)('keys', function () {
  return function keys(it) {
    return $keys(toObject(it));
  };
});


/***/ }),

/***/ 645:
/***/ (function(module, exports, __webpack_require__) {

"use strict";


exports.__esModule = true;

var _iterator = __webpack_require__(654);

var _iterator2 = _interopRequireDefault(_iterator);

var _symbol = __webpack_require__(653);

var _symbol2 = _interopRequireDefault(_symbol);

var _typeof = typeof _symbol2.default === "function" && typeof _iterator2.default === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof _symbol2.default === "function" && obj.constructor === _symbol2.default && obj !== _symbol2.default.prototype ? "symbol" : typeof obj; };

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

exports.default = typeof _symbol2.default === "function" && _typeof(_iterator2.default) === "symbol" ? function (obj) {
  return typeof obj === "undefined" ? "undefined" : _typeof(obj);
} : function (obj) {
  return obj && typeof _symbol2.default === "function" && obj.constructor === _symbol2.default && obj !== _symbol2.default.prototype ? "symbol" : typeof obj === "undefined" ? "undefined" : _typeof(obj);
};

/***/ }),

/***/ 647:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise__ = __webpack_require__(139);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_jquery__ = __webpack_require__(36);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_jquery__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_toastr__ = __webpack_require__(141);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_toastr___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_toastr__);






/* harmony default export */ __webpack_exports__["default"] = ({
  props: {
    onlyView: {
      type: Boolean,
      default: function _default() {
        return false;
      }
    },
    id: {
      type: String,
      default: function _default() {
        return 'nm';
      }
    },
    partTypes: {
      type: Array,
      default: function _default() {
        return [1, 3];
      }
    },
    checkInput: {
      type: Number,
      default: function _default() {
        return 0;
      }
    }
  },
  data: function data() {
    return {
      dossierTemplateItems: [],
      dossierMarksItems: [],
      dossierFilesItems: [],
      thongTinHoSo: {},
      valid: true,
      stateView: false,
      dialogAddOtherTemp: false,
      loadingAddOther: false,
      otherDossierTemplate: '',
      sheet: false,
      partView: '',
      dossierFileIdView: '',
      stateEdit: false,
      progressUploadPart: '',
      dialogPDF: false,
      dialogPDFLoading: true,
      stateAddFileOther: false,
      dossierTemplatesItemSelect: {},
      fileViews: [],
      sampleCount: 0,
      serviceInfoId: 0,
      fileMarkItems: [{
        text: 'Không có',
        value: 0
      }, {
        text: 'Bản chụp',
        value: 1
      }, {
        text: 'Bản sao',
        value: 2
      }, {
        text: 'Bản gốc',
        value: 3
      }],
      fileCheckItems: [{
        text: 'Chưa kiểm tra',
        value: 0
      }, {
        text: 'Đạt',
        value: 1
      }, {
        text: 'Không đạt',
        value: 2
      }],
      fileTemplateItems: [],
      stateViewResult: true
    };
  },
  computed: {
    loading: function loading() {
      return this.$store.getters.loading;
    },
    originality: function originality() {
      var vm = this;
      return vm.getOriginality();
    },
    initDataResource: function initDataResource() {
      return this.$store.getters.loadingInitData;
    }
  },
  mounted: function mounted() {
    var vm = this;
    vm.page = 1;
    vm.$nextTick(function () {});
  },

  methods: {
    resetCounterTemplate: function resetCounterTemplate(_ref, data) {
      var commit = _ref.commit,
          state = _ref.state;

      var vm = this;
      vm.dossierTemplateItems.forEach(function (val) {
        if (val.partNo === data.partNo) {
          if (val.hasForm) {
            val.count = 1;
          } else {
            val.count = 0;
          }
        }
      });
    },
    recountFileTemplates: function recountFileTemplates() {
      var vm = this;
      vm.dossierTemplateItems.forEach(function (itemTemplate) {
        itemTemplate.count = 0;
        vm.dossierFilesItems.forEach(function (itemFile) {
          if (itemTemplate.partNo === itemFile.dossierPartNo && !itemFile.eForm) {
            itemTemplate.count++;
          }
        });
      });
    },
    initData: function initData(data) {
      var vm = this;
      var arrTemp = [];

      if (data['sampleCount'] !== null && data['sampleCount'] !== undefined && data['sampleCount'] !== 'undefined') {
        vm.sampleCount = data['sampleCount'];
      }
      arrTemp.push(vm.$store.dispatch('loadDossierTemplates', data));
      arrTemp.push(vm.$store.dispatch('loadDossierMark', data));
      arrTemp.push(vm.$store.dispatch('loadDossierFiles', data.dossierId));
      arrTemp.push(vm.$store.dispatch('getServiceInfo', {
        serviceInfoId: data.serviceCode
      }));
      vm.thongTinHoSo = data;
      __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise___default.a.all(arrTemp).then(function (values) {
        var dossierTemplates = values[0];
        var dossierMarks = values[1];
        var dossierFiles = values[2];
        var fileTemplates = [];
        if (values[3].hasOwnProperty('serviceInfoId')) {
          vm.serviceInfoId = values[3].serviceInfoId;
        }
        if (values[3].fileTemplates) {
          if (Array.isArray(values[3].fileTemplates)) {
            fileTemplates = values[3].fileTemplates;
          } else {
            fileTemplates.push(values[3].fileTemplates);
          }
        }

        var dossierTemplateItems = vm.mergeDossierTemplateVsDossierFiles(dossierTemplates, dossierFiles);

        dossierTemplateItems = vm.mergeDossierTemplateVsDossierMark(dossierTemplateItems, dossierMarks);
        dossierTemplateItems = vm.mergeDossierTemplateVsFileTemplates(dossierTemplateItems, fileTemplates);

        vm.dossierFilesItems = dossierFiles;
        vm.dossierMarksItems = dossierMarks;
        vm.fileTemplateItems = fileTemplates;
        vm.dossierTemplateItems = dossierTemplateItems;
        vm.changeStateViewResult();
        setTimeout(function (argument) {
          vm.genAllAlpacaForm(dossierFiles, dossierTemplateItems);
          vm.recountFileTemplates();
        }, 500);
      }).catch(function (reject) {});
    },
    genAllAlpacaForm: function genAllAlpacaForm(dossierFiles, dossierTemplateItems) {
      var vm = this;
      if (dossierFiles.length > 0) {
        var dossierFilesEform = dossierFiles.filter(function (file) {
          return file.eForm;
        });
        var dossierTemplatesHasForm = dossierTemplateItems.filter(function (template) {
          return template.hasForm && vm.partTypes.includes(template.partType);
        });
        if (dossierFilesEform.length > 0) {
          dossierFilesEform.forEach(function (itemFiles) {
            if (itemFiles.eForm) {
              vm.$store.dispatch('loadAlpcaForm', itemFiles);
            }
          });
        } else {
          dossierTemplateItems.forEach(function (val) {
            if (val.hasForm && vm.partTypes.includes(val.partType)) {
              val['templateFileNo'] = vm.thongTinHoSo.dossierTemplateNo;
              vm.showAlpacaJSFORM(val);
            }
          });
        }
        if (dossierTemplatesHasForm.length !== dossierFilesEform.length) {
          dossierTemplatesHasForm.forEach(function (template) {
            var indexFromFile = dossierFilesEform.findIndex(function (item) {
              return template.partNo === item.dossierPartNo;
            });
            if (indexFromFile === -1) {
              template['templateFileNo'] = vm.thongTinHoSo.dossierTemplateNo;
              vm.showAlpacaJSFORM(template);
            }
          });
        }
      } else {
        dossierTemplateItems.forEach(function (val) {
          if (val.hasForm && vm.partTypes.includes(val.partType)) {
            val['templateFileNo'] = vm.thongTinHoSo.dossierTemplateNo;
            vm.showAlpacaJSFORM(val);
          }
        });
      }
    },
    postDossierMark: function postDossierMark(item, index) {
      var vm = this;
      item['dossierId'] = vm.thongTinHoSo.dossierId;
      vm.$store.dispatch('postDossierMark', item).then(function (resultMark) {}).catch(function (reject) {});
    },
    mergeDossierTemplateVsDossierFiles: function mergeDossierTemplateVsDossierFiles(dossierTemplates, dossierFiles) {
      var vm = this;
      if (dossierFiles.length !== 0) {
        dossierTemplates.forEach(function (template) {
          template['daKhai'] = false;
          var itemFind = dossierFiles.find(function (file) {
            return template.partNo === file.dossierPartNo && vm.partTypes.includes(template.partType) && file.eForm;
          });
          if (itemFind) {
            template['daKhai'] = true;
          } else if (!itemFind && template.hasForm) {
            template['daKhai'] = false;
          }
          dossierFiles.forEach(function (dossierFile) {
            if (template.partNo === dossierFile.dossierPartNo && !dossierFile.eForm && !template.hasForm) {
              template['daKhai'] = true;
            }
          });
        });
      } else {
        dossierTemplates.forEach(function (template) {
          if (template.hasForm) {
            template['daKhai'] = false;
          }
        });
      }
      return dossierTemplates;
    },
    mergeDossierTemplateVsDossierMark: function mergeDossierTemplateVsDossierMark(dossierTemplates, dossierMarks) {
      if (dossierMarks.length !== 0) {
        dossierTemplates.map(function (itemTemplate) {
          itemTemplate['count'] = 0;
          itemTemplate['stateEditFileCheck'] = false;
          var fileMarkFind = dossierMarks.find(function (fileMark) {
            return fileMark.dossierPartNo === itemTemplate.partNo;
          });
          if (fileMarkFind !== null && fileMarkFind !== undefined) {
            itemTemplate['fileMark'] = fileMarkFind.fileMark;
            itemTemplate['fileComment'] = fileMarkFind.fileComment;
            itemTemplate['fileCheck'] = fileMarkFind.fileCheck;
          } else {
            itemTemplate['fileMark'] = 0;
            itemTemplate['fileComment'] = '';
            itemTemplate['fileCheck'] = 0;
          }
          return itemTemplate;
        });
      } else {
        if (dossierTemplates) {
          dossierTemplates.forEach(function (itemTemplate) {
            itemTemplate['stateEditFileCheck'] = false;
            itemTemplate['count'] = 0;
            itemTemplate['fileMark'] = 0;
            itemTemplate['fileComment'] = '';
            itemTemplate['fileCheck'] = 0;
            itemTemplate['stateEditFileCheck'] = false;
          });
        }
      }
      return dossierTemplates;
    },
    mergeDossierTemplateVsFileTemplates: function mergeDossierTemplateVsFileTemplates(dossierTemplates, fileTemplates) {
      if (fileTemplates.length !== 0) {
        dossierTemplates.map(function (itemTemplate) {
          var fileTemp = fileTemplates.find(function (fileTemplate) {
            return fileTemplate.fileTemplateNo === itemTemplate.fileTemplateNo;
          });
          if (fileTemp !== null && fileTemp !== undefined) {
            itemTemplate['hasFileTemp'] = fileTemp.fileTemplateNo;
          } else {
            itemTemplate['hasFileTemp'] = '';
          }
          return itemTemplate;
        });
      } else {
        if (dossierTemplates) {
          dossierTemplates.forEach(function (itemTemplate) {
            itemTemplate['hasFileTemp'] = '';
          });
        }
      }
      return dossierTemplates;
    },
    showAlpacaJSFORM: function showAlpacaJSFORM(item) {
      var vm = this;
      item['dossierId'] = vm.thongTinHoSo.dossierId;
      vm.$store.dispatch('loadFormScript', item).then(function (resScript) {
        vm.$store.dispatch('loadFormData', item).then(function (resData) {
          __WEBPACK_IMPORTED_MODULE_1_jquery___default()('#formAlpaca' + item.partNo + vm.id).empty();
          var formScript, formData;

          if (resScript) {
            formScript = eval('(' + resScript + ')');
          } else {
            formScript = {};
          }
          if (resData) {
            formData = eval('(' + resData + ')');
          } else {
            formData = {};
          }

          formScript.data = formData;
          __WEBPACK_IMPORTED_MODULE_1_jquery___default()('#formAlpaca' + item.partNo + vm.id).alpaca(formScript);
        });
      });
    },
    saveAlpacaForm: function saveAlpacaForm(item, index) {
      var vm = this;
      var fileFind = vm.dossierFilesItems.find(function (itemFile) {
        return itemFile.dossierPartNo === item.partNo && itemFile.eForm;
      });
      if (fileFind) {
        fileFind['dossierId'] = vm.thongTinHoSo.dossierId;
        fileFind['id'] = vm.id;
        vm.$store.dispatch('putAlpacaForm', fileFind).then(function (resData) {}).catch(function (reject) {
          __WEBPACK_IMPORTED_MODULE_2_toastr___default.a.error('Yêu cầu của bạn được thực hiện thất bại.');
        });
      } else {
        item['dossierId'] = vm.thongTinHoSo.dossierId;
        item['id'] = vm.id;
        vm.$store.dispatch('postEform', item).then(function (resPostEform) {
          vm.dossierTemplateItems[index].daKhai = true;
          vm.$store.dispatch('loadDossierFiles', vm.thongTinHoSo.dossierId).then(function (resFiles) {
            vm.dossierFilesItems = resFiles;
          }).catch(function (reject) {
            __WEBPACK_IMPORTED_MODULE_2_toastr___default.a.error('Yêu cầu của bạn được thực hiện thất bại.');
          });
        }).catch(function (reject) {
          __WEBPACK_IMPORTED_MODULE_2_toastr___default.a.error('Yêu cầu của bạn được thực hiện thất bại.');
        });
      }
    },
    onDeleteAttackFiles: function onDeleteAttackFiles(item) {
      var vm = this;

      var x = confirm('Bạn có muốn xóa toàn bộ file trong thành phần hồ sơ này?');
      if (x) {
        vm.dossierFilesItems.forEach(function (val) {
          if (val.dossierPartNo === item.partNo) {
            val['dossierId'] = vm.thongTinHoSo.dossierId;
            vm.$store.dispatch('deleteAttackFiles', val).then(function (result) {
              vm.resetCounterTemplate(item);
              vm.$store.dispatch('loadDossierFiles', vm.thongTinHoSo.dossierId);
            }).catch(function (xhr) {});
          }
        });
      }
    },
    pickFile: function pickFile(item) {
      var vm = this;
      vm.stateAddFileOther = false;
      document.getElementById('file' + item.partNo).click();
    },
    onUploadSingleFile: function onUploadSingleFile(e, data, index) {
      var vm = this;
      vm.dossierTemplatesItemSelect = data;
      vm.progressUploadPart = data.partNo;
      data['dossierId'] = vm.thongTinHoSo.dossierId;
      data['dossierTemplateNo'] = vm.thongTinHoSo.dossierTemplateNo;
      vm.dossierTemplateItems[index]['daKhai'] = true;
      if (data.partType !== 3) {
        vm.$store.dispatch('uploadSingleFile', data).then(function (result) {
          vm.progressUploadPart = '';
          vm.$store.dispatch('loadDossierFiles', vm.thongTinHoSo.dossierId).then(function (result) {
            vm.dossierFilesItems = result;
            vm.recountFileTemplates();
          });
        }).catch(function (xhr) {
          vm.progressUploadPart = '';
        });
      } else {
        if (__WEBPACK_IMPORTED_MODULE_1_jquery___default()('#file' + data.partNo)[0].files.length === 0) {
          vm.progressUploadPart = '';
          return;
        }
        vm.partView = data.partNo;
        vm.stateView = true;
        vm.dialogAddOtherTemp = true;
      }
    },
    loadAlpcaForm: function loadAlpcaForm(data) {
      var vm = this;
      var fileFind = vm.dossierFilesItems.find(function (itemFile) {
        return itemFile.dossierPartNo === data.partNo && itemFile.eForm;
      });
      if (fileFind) {
        fileFind['id'] = vm.id;
        vm.$store.dispatch('loadAlpcaForm', fileFind);
      } else {
        vm.dossierTemplateItems.forEach(function (val) {
          if (val.hasForm && data.partNo === val.partNo) {
            val['templateFileNo'] = vm.thongTinHoSo.dossierTemplateNo;
            vm.showAlpacaJSFORM(val);
          }
        });
      }
    },
    deleteSingleFileEform: function deleteSingleFileEform(item, index) {
      var vm = this;
      var x = confirm('Bạn có muốn xóa?');
      if (x) {
        vm.dossierFilesItems.forEach(function (file) {
          if (file.dossierPartNo === item.partNo && file.eForm) {
            file['dossierId'] = vm.thongTinHoSo.dossierId;
            vm.$store.dispatch('deleteDossierFile', file).then(function (resFile) {
              vm.$store.dispatch('loadDossierFiles', vm.thongTinHoSo.dossierId).then(function (result) {
                vm.dossierFilesItems = result;
                vm.recountFileTemplates();
                var fileViewsTemp = vm.dossierFilesItems.filter(function (file) {
                  return file.dossierPartNo === item.partNo && !file.eForm;
                });
                if (fileViewsTemp) {
                  vm.fileViews = fileViewsTemp;
                }
              });
            });
          }
        });
        vm.dossierTemplateItems[index].daKhai = false;
      }
    },
    previewFileEfom: function previewFileEfom(item, index) {
      var vm = this;
      vm.dossierFilesItems.forEach(function (file) {
        if (file.dossierPartNo === item.partNo && file.eForm) {
          file['dossierId'] = vm.thongTinHoSo.dossierId;
          vm.dialogPDFLoading = true;
          vm.dialogPDF = true;
          if (!vm.onlyView) {
            file['id'] = vm.id;
            vm.$store.dispatch('putAlpacaForm', file).then(function (resData) {
              setTimeout(function () {
                vm.$store.dispatch('viewFile', file).then(function (result) {
                  vm.dialogPDFLoading = false;
                  document.getElementById('dialogPDFPreview' + vm.id).src = result;
                });
              }, 1000);
            }).catch(function (reject) {
              __WEBPACK_IMPORTED_MODULE_2_toastr___default.a.error('Yêu cầu của bạn được thực hiện thất bại.');
            });
          } else {
            vm.$store.dispatch('viewFile', file).then(function (result) {
              vm.dialogPDFLoading = false;
              document.getElementById('dialogPDFPreview' + vm.id).src = result;
            });
          }
        }
      });
    },
    deleteSingleFile: function deleteSingleFile(item, index) {
      var vm = this;
      var x = confirm('Bạn có muốn xóa?');
      if (x) {
        item['dossierId'] = vm.thongTinHoSo.dossierId;
        vm.$store.dispatch('deleteDossierFile', item).then(function (resFile) {
          vm.fileViews.splice(index, 1);
          vm.stateView = true;
          vm.partView = item.dossierPartNo;
          vm.$store.dispatch('loadDossierFiles', vm.thongTinHoSo.dossierId).then(function (result) {
            vm.dossierFilesItems = result;

            vm.setDaKhai(vm.dossierFilesItems);
          });
        }).catch(function (reject) {
          __WEBPACK_IMPORTED_MODULE_2_toastr___default.a.error('Yêu cầu của bạn được thực hiện thất bại.');
        });
      }
    },
    viewFile: function viewFile(data) {
      var _this = this;

      var vm = this;
      vm.dossierFilesItems.forEach(function (val) {
        val['dossierId'] = vm.thongTinHoSo.dossierId;
        if (val.dossierPartNo === data.partNo) {
          _this.$store.dispatch('viewFile', val);
        }
      });
    },
    setDaKhai: function setDaKhai(itemFile) {
      var vm = this;
      var indexFile = vm.dossierFilesItems.findIndex(function (file) {
        return file.dossierPartNo === itemFile.dossierPartNo;
      });
      if (indexFile === -1) {
        for (var i = 0; i < vm.dossierTemplateItems.length; i++) {
          if (vm.dossierTemplateItems[i].partNo === itemFile.dossierPartNo && !vm.dossierTemplateItems[i].hasForm) {
            vm.dossierTemplateItems[i]['daKhai'] = false;
            break;
          }
        }
      }
    },
    checkPartType3: function checkPartType3() {
      var vm = this;
      if (vm.dossierTemplateItems.length !== 0) {
        for (var i = 0; i < vm.dossierTemplateItems.length; i++) {
          if (vm.dossierTemplateItems[i].partType === 3) {
            return true;
          }
        }
      }
      return false;
    },
    viewFile2: function viewFile2(data) {
      var vm = this;
      if (data.fileSize === 0) {
        return;
      }
      if (data.fileType === 'doc' || data.fileType === 'docx' || data.fileType === 'xlsx' || data.fileType === 'xls' || data.fileType === 'zip' || data.fileType === 'rar') {
        var url = vm.initDataResource.dossierApi + '/' + vm.thongTinHoSo.dossierId + '/files/' + data.referenceUid;
        window.open(url);
      } else {
        vm.dialogPDFLoading = true;
        vm.dialogPDF = true;
        data['dossierId'] = vm.thongTinHoSo.dossierId;
        vm.$store.dispatch('viewFile', data).then(function (result) {
          vm.dialogPDFLoading = false;
          document.getElementById('dialogPDFPreview' + vm.id).src = result;
        });
      }
    },
    viewFileWithPartNo: function viewFileWithPartNo(item) {
      var vm = this;
      if (vm.dossierFilesItems) {
        var fileViewsTemp = vm.dossierFilesItems.filter(function (file) {
          return file.dossierPartNo === item.partNo && !file.eForm;
        });
        if (fileViewsTemp) {
          vm.fileViews = fileViewsTemp;

          if (vm.partView !== item.partNo) {
            vm.stateView = true;
            vm.partView = item.partNo;
          } else {
            vm.stateView = !vm.stateView;
            vm.partView = item.partNo;
          }
        } else {
          return;
        }
      }
      return;
    },
    saveMark: function saveMark() {
      var vm = this;
      if (vm.dossierTemplateItems) {
        vm.dossierTemplateItems.forEach(function (value, index) {
          if (value.partType === 1) {
            value['dossierId'] = vm.thongTinHoSo.dossierId;
            vm.$store.dispatch('postDossierMark', value);
          }
        });
      }
    },
    changeFileMark: function changeFileMark(event, index) {
      var vm = this;

      var item = vm.dossierTemplateItems[index];
      item['dossierId'] = vm.thongTinHoSo.dossierId;
      item['fileMark'] = event;
      item['checkInput'] = vm.checkInput;

      vm.$store.dispatch('postDossierMark', item);
      vm.dossierTemplateItems[index].fileMark = event;
    },
    changeFileCheck: function changeFileCheck(event, index) {
      var vm = this;

      var item = vm.dossierTemplateItems[index];
      item['dossierId'] = vm.thongTinHoSo.dossierId;
      item['fileCheck'] = event;
      item['checkInput'] = vm.checkInput;
      if (event === 2) {
        item['stateEditFileCheck'] = true;
        return;
      } else {
        item['fileComment'] = '';
      }

      vm.$store.dispatch('postDossierMark', item);
      vm.dossierTemplateItems[index].fileCheck = event;
    },
    changeFileComment: function changeFileComment(item, index) {
      var vm = this;

      if (item.fileComment === null || item.fileComment === undefined || item.fileComment === '') {
        return;
      }
      item['dossierId'] = vm.thongTinHoSo.dossierId;
      item['fileComment'] = item.fileComment;
      item['checkInput'] = vm.checkInput;
      item['stateEditFileCheck'] = !item['stateEditFileCheck'];

      vm.$store.dispatch('postDossierMark', item);
      vm.dossierTemplateItems[index].fileComment = item.fileComment;
    },
    checkStyle: function checkStyle(item) {
      var vm = this;
      if (vm.checkInput === 1) {
        return 'calc(100% - 140px)';
      } else {
        var divPx = 0;
        if (vm.originality !== 1 && item.partType === 1 && !vm.thongTinHoSo.online && vm.checkInput !== 1) {
          divPx += 140;
        }
        if (item.fileCheck > 0 && !vm.thongTinHoSo.online) {
          divPx += 20;
        }
        if (item.fileCheck > 0 && vm.thongTinHoSo.online) {
          divPx += 40;
        }
        if (!vm.onlyView) {
          divPx += 90;
        }
        return 'calc(100% - ' + divPx + 'px)';
      }
    },
    checkVisibleTemp: function checkVisibleTemp(item, index) {
      var vm = this;
      if (!vm.onlyView) {
        return true;
      }
      if (item.partType === 3) {
        if (vm.dossierFilesItems.length > 0) {
          var indexFile = vm.dossierFilesItems.findIndex(function (file) {
            return file.dossierPartNo === item.partNo;
          });
          if (indexFile === -1) {
            return false;
          } else {
            return true;
          }
        } else {
          return false;
        }
      } else {
        return true;
      }
    },
    changeStateViewResult: function changeStateViewResult() {
      var vm = this;
      if (vm.dossierFilesItems.length > 0) {
        var index = vm.dossierFilesItems.findIndex(function (file) {
          return file.dossierPartType === 2;
        });
        if (index !== -1) {
          vm.$emit('tp:change-state-view-result', true);
        } else {
          vm.$emit('tp:change-state-view-result', false);
        }
      }
    },
    changeOtherDossierTemp: function changeOtherDossierTemp(data) {
      var vm = this;
      if (vm.originality === 3 && vm.stateAddFileOther) {
        vm.loadingAddOther = true;
        vm.$store.dispatch('uploadSingleOtherFile', {
          dossierId: vm.thongTinHoSo.dossierId,
          displayName: data,
          partNo: vm.dossierTemplatesItemSelect.partNo
        }).then(function (resFile) {
          vm.loadingAddOther = false;
          vm.dialogAddOtherTemp = false;
          vm.$store.dispatch('loadDossierFiles', vm.thongTinHoSo.dossierId).then(function (result2) {
            vm.dossierFilesItems = result2;
          });
        }).catch(function (reject) {
          vm.loadingAddOther = false;
        });
      } else {
        var params = vm.dossierTemplatesItemSelect;
        params['dossierId'] = vm.thongTinHoSo.dossierId;
        params['displayName'] = data;
        params['dossierTemplateNo'] = vm.thongTinHoSo.dossierTemplateNo;
        vm.$store.dispatch('uploadSingleFile', params).then(function (result1) {
          vm.progressUploadPart = '';
          vm.dialogAddOtherTemp = false;

          vm.$store.dispatch('loadDossierFiles', vm.thongTinHoSo.dossierId).then(function (result2) {
            vm.dossierFilesItems = result2;
            vm.recountFileTemplates();
            if (vm.stateView && vm.dossierFilesItems) {
              var fileViewsTemp = vm.dossierFilesItems.filter(function (file) {
                return file.dossierPartNo === vm.dossierTemplatesItemSelect.partNo && !file.eForm;
              });
              if (fileViewsTemp) {
                vm.fileViews = fileViewsTemp;
              }
            }
          });
        }).catch(function (xhr) {
          vm.progressUploadPart = '';
        });
      }
    },
    downloadFileTemplate: function downloadFileTemplate(item, index) {
      var vm = this;
      if (vm.fileTemplateItems.length > 0) {
        var fileFind = vm.fileTemplateItems.find(function (file) {
          return item.fileTemplateNo === file.fileTemplateNo;
        });
        if (fileFind) {
          var url = vm.initDataResource.serviceInfoApi + '/' + vm.serviceInfoId + '/filetemplates/' + fileFind.fileTemplateNo;
          window.open(url);
        } else {}
      }
    },
    addOtherTemplate: function addOtherTemplate() {
      var vm = this;
      if (vm.$refs.form.validate()) {
        vm.changeOtherDossierTemp(vm.otherDossierTemplate);
      }
    },
    editDisplayName: function editDisplayName(item, index) {
      var vm = this;
      if (vm.dossierFileIdView !== item.dossierFileId) {
        vm.dossierFileIdView = item.dossierFileId;
        vm.stateEdit = true;
      } else {
        vm.dossierFileIdView = item.dossierFileId;
        vm.stateEdit = !vm.stateEdit;
      }
    },
    cancelDialog: function cancelDialog() {
      var vm = this;
      vm.dialogAddOtherTemp = false;
      vm.progressUploadPart = '';
    },
    addFileOther: function addFileOther(item) {
      var vm = this;
      vm.dialogAddOtherTemp = true;
      vm.stateAddFileOther = true;
      vm.dossierTemplatesItemSelect = item;
    },
    validDossierTemplate: function validDossierTemplate() {
      var vm = this;
      if (vm.dossierTemplateItems.length > 0) {
        for (var i = 0; i < vm.dossierTemplateItems.length; i++) {
          if (vm.dossierTemplateItems[i]['required'] && !vm.dossierTemplateItems[i]['daKhai'] && vm.partTypes.includes(vm.dossierTemplateItems[i].partType)) {
            var message = 'Chú ý :' + vm.dossierTemplateItems[i].partName + ' là thành phần bắt buộc!';
            __WEBPACK_IMPORTED_MODULE_2_toastr___default.a.error(message);
            return false;
          }
        }
        return true;
      } else {
        return true;
      }
    },
    changeDisplayName: function changeDisplayName(item, index) {
      var vm = this;
      var params = {
        dossierId: vm.thongTinHoSo.dossierId,
        value: value
      };
      vm.$store.dispatch('changeDisplayNameFile', params).then(function (result) {
        vm.fileViews[index].displayName = result.displayName;
        vm.stateEdit = false;
      }).catch(function (reject) {});
    }
  }
});

/***/ }),

/***/ 648:
/***/ (function(module, exports, __webpack_require__) {

(function(e,t){ true?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.VMoney=t():e.VMoney=t()})(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=".",t(t.s=9)}([function(e,t,n){"use strict";t.a={prefix:"",suffix:"",thousands:",",decimal:".",precision:2}},function(e,t,n){"use strict";var r=n(2),i=n(5),u=n(0);t.a=function(e,t){if(t.value){var o=n.i(i.a)(u.a,t.value);if("INPUT"!==e.tagName.toLocaleUpperCase()){var a=e.getElementsByTagName("input");1!==a.length||(e=a[0])}e.oninput=function(){var t=e.value.length-e.selectionEnd;e.value=n.i(r.a)(e.value,o),t=Math.max(t,o.suffix.length),t=e.value.length-t,t=Math.max(t,o.prefix.length+1),n.i(r.b)(e,t),e.dispatchEvent(n.i(r.c)("change"))},e.onfocus=function(){n.i(r.b)(e,e.value.length-o.suffix.length)},e.oninput(),e.dispatchEvent(n.i(r.c)("input"))}}},function(e,t,n){"use strict";function r(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:m.a;"number"==typeof e&&(e=e.toFixed(o(t.precision)));var n=e.indexOf("-")>=0?"-":"",r=u(e),i=c(r,t.precision),a=d(i).split("."),p=a[0],l=a[1];return p=f(p,t.thousands),t.prefix+n+s(p,l,t.decimal)+t.suffix}function i(e,t){var n=e.indexOf("-")>=0?-1:1,r=u(e),i=c(r,t);return parseFloat(i)*n}function u(e){return d(e).replace(/\D+/g,"")||"0"}function o(e){return a(0,e,20)}function a(e,t,n){return Math.max(e,Math.min(t,n))}function c(e,t){var n=Math.pow(10,t);return(parseFloat(e)/n).toFixed(o(t))}function f(e,t){return e.replace(/(\d)(?=(?:\d{3})+\b)/gm,"$1"+t)}function s(e,t,n){return t?e+n+t:e}function d(e){return e?e.toString():""}function p(e,t){var n=function(){e.setSelectionRange(t,t)};e===document.activeElement&&(n(),setTimeout(n,1))}function l(e){var t=document.createEvent("Event");return t.initEvent(e,!0,!0),t}var m=n(0);n.d(t,"a",function(){return r}),n.d(t,"d",function(){return i}),n.d(t,"b",function(){return p}),n.d(t,"c",function(){return l})},function(e,t,n){"use strict";function r(e,t){t&&Object.keys(t).map(function(e){a.a[e]=t[e]}),e.directive("money",o.a),e.component("money",u.a)}Object.defineProperty(t,"__esModule",{value:!0});var i=n(6),u=n.n(i),o=n(1),a=n(0);n.d(t,"Money",function(){return u.a}),n.d(t,"VMoney",function(){return o.a}),n.d(t,"options",function(){return a.a}),n.d(t,"VERSION",function(){return c});var c="0.8.1";t.default=r,"undefined"!=typeof window&&window.Vue&&window.Vue.use(r)},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(1),i=n(0),u=n(2);t.default={name:"Money",props:{value:{required:!0,type:[Number,String],default:0},masked:{type:Boolean,default:!1},precision:{type:Number,default:function(){return i.a.precision}},decimal:{type:String,default:function(){return i.a.decimal}},thousands:{type:String,default:function(){return i.a.thousands}},prefix:{type:String,default:function(){return i.a.prefix}},suffix:{type:String,default:function(){return i.a.suffix}}},directives:{money:r.a},data:function(){return{formattedValue:""}},watch:{value:{immediate:!0,handler:function(e,t){var r=n.i(u.a)(e,this.$props);r!==this.formattedValue&&(this.formattedValue=r)}}},methods:{change:function(e){this.$emit("input",this.masked?e.target.value:n.i(u.d)(e.target.value,this.precision))}}}},function(e,t,n){"use strict";t.a=function(e,t){return e=e||{},t=t||{},Object.keys(e).concat(Object.keys(t)).reduce(function(n,r){return n[r]=void 0===t[r]?e[r]:t[r],n},{})}},function(e,t,n){var r=n(7)(n(4),n(8),null,null);e.exports=r.exports},function(e,t){e.exports=function(e,t,n,r){var i,u=e=e||{},o=typeof e.default;"object"!==o&&"function"!==o||(i=e,u=e.default);var a="function"==typeof u?u.options:u;if(t&&(a.render=t.render,a.staticRenderFns=t.staticRenderFns),n&&(a._scopeId=n),r){var c=a.computed||(a.computed={});Object.keys(r).forEach(function(e){var t=r[e];c[e]=function(){return t}})}return{esModule:i,exports:u,options:a}}},function(e,t){e.exports={render:function(){var e=this,t=e.$createElement;return(e._self._c||t)("input",{directives:[{name:"money",rawName:"v-money",value:{precision:e.precision,decimal:e.decimal,thousands:e.thousands,prefix:e.prefix,suffix:e.suffix},expression:"{precision, decimal, thousands, prefix, suffix}"}],staticClass:"v-money",attrs:{type:"tel"},domProps:{value:e.formattedValue},on:{change:e.change}})},staticRenderFns:[]}},function(e,t,n){e.exports=n(3)}])});

/***/ }),

/***/ 649:
/***/ (function(module, exports, __webpack_require__) {

module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('div', [_c('v-card', [_vm._l((_vm.dossierTemplateItems), function(item, index) {
    return (_vm.partTypes.includes(item.partType) && _vm.checkVisibleTemp(item, index)) ? _c('div', {
      key: item.partNo,
      staticClass: "form_alpaca",
      staticStyle: {
        "position": "relative"
      }
    }, [_c('v-expansion-panel', {
      staticClass: "expaned__list__data"
    }, [_c('v-expansion-panel-content', {
      attrs: {
        "hide-actions": "",
        "value": false
      }
    }, [_c('div', {
      staticStyle: {
        "background-color": "#fff"
      },
      attrs: {
        "slot": "header"
      },
      on: {
        "click": function($event) {
          _vm.stateView = false
        }
      },
      slot: "header"
    }, [_c('div', {
      staticStyle: {
        "align-items": "center",
        "min-height": "38px",
        "background": "#fff",
        "padding-left": "15px"
      },
      style: ({
        width: _vm.checkStyle(item)
      })
    }, [_c('div', {
      staticClass: "mr-2",
      staticStyle: {
        "min-width": "18px",
        "display": "flex",
        "min-height": "38px"
      },
      on: {
        "click": function($event) {
          _vm.loadAlpcaForm(item)
        }
      }
    }, [_c('div', {
      staticClass: "header__tphs"
    }, [_c('span', {
      staticClass: "text-bold"
    }, [_vm._v(_vm._s(index + 1) + ".")]), _vm._v("  ")]), _vm._v(" "), _c('div', {
      staticClass: "header__tphs"
    }, [_vm._v("\n                  " + _vm._s(item.partName) + "  "), (item.required) ? _c('span', {
      staticStyle: {
        "color": "red"
      }
    }, [_vm._v(" (*) ")]) : _vm._e(), _vm._v("\n                    \n                  "), (item.hasForm && item.daKhai) ? _c('v-tooltip', {
      attrs: {
        "top": ""
      }
    }, [_c('i', {
      staticClass: "fa fa-file-text-o",
      staticStyle: {
        "color": "#0d71bb",
        "font-size": "13px"
      },
      attrs: {
        "slot": "activator",
        "aria-hidden": "true"
      },
      slot: "activator"
    }), _vm._v(" "), _c('span', [_vm._v("Biểu mẫu trực tuyến (Đã khai)")])]) : _vm._e(), _vm._v(" "), (item.hasForm && !item.daKhai) ? _c('v-tooltip', {
      attrs: {
        "top": ""
      }
    }, [_c('i', {
      staticClass: "fa fa-file-o",
      staticStyle: {
        "color": "#0d71bb",
        "font-size": "13px"
      },
      attrs: {
        "slot": "activator"
      },
      slot: "activator"
    }), _vm._v(" "), _c('span', [_vm._v("Biểu mẫu trực tuyến (Chưa khai)")])]) : _vm._e(), _vm._v("\n                    \n                  "), (!item.hasForm && item.hasFileTemp) ? _c('v-tooltip', {
      attrs: {
        "top": ""
      }
    }, [_c('v-icon', {
      staticStyle: {
        "color": "#0d71bb"
      },
      attrs: {
        "slot": "activator",
        "size": "16",
        "color": "primary"
      },
      on: {
        "click": function($event) {
          $event.stopPropagation();
          _vm.downloadFileTemplate(item, index)
        }
      },
      slot: "activator"
    }, [_vm._v("save_alt")]), _vm._v(" "), _c('span', [_vm._v("Biểu mẫu điền thủ công")])], 1) : _vm._e()], 1)]), _vm._v(" "), _c('div', {
      staticStyle: {
        "display": "flex"
      }
    }, [(_vm.checkInput === 1 && item.fileCheck === 2 && item.stateEditFileCheck) ? _c('v-text-field', {
      attrs: {
        "placeholder": "Nhập lý do",
        "rules": [function (v) { return !!v || 'Bạn phải nhập lý do trước khi gửi'; }],
        "required": ""
      },
      on: {
        "click": function($event) {
          $event.stopPropagation();
        },
        "keyup": function($event) {
          if (!('button' in $event) && _vm._k($event.keyCode, "enter", 13, $event.key, "Enter")) { return null; }
          _vm.changeFileComment(item, index)
        }
      },
      model: {
        value: (item.fileComment),
        callback: function($$v) {
          _vm.$set(item, "fileComment", $$v)
        },
        expression: "item.fileComment"
      }
    }) : _vm._e(), _vm._v(" "), (_vm.checkInput === 1 && item.fileCheck === 2 && item.stateEditFileCheck) ? _c('v-tooltip', {
      attrs: {
        "top": ""
      }
    }, [_c('v-btn', {
      staticClass: "mx-0 my-0",
      attrs: {
        "slot": "activator",
        "icon": ""
      },
      on: {
        "click": function($event) {
          $event.stopPropagation();
          _vm.changeFileComment(item, index)
        }
      },
      slot: "activator"
    }, [_c('v-icon', {
      staticClass: "mx-0",
      attrs: {
        "size": "16",
        "color": "primary"
      }
    }, [_vm._v("send")])], 1), _vm._v(" "), _c('span', [_vm._v("Gửi")])], 1) : _vm._e()], 1), _vm._v(" "), (item.fileComment && !item.stateEditFileCheck) ? _c('i', {
      staticStyle: {
        "font-size": "12px",
        "color": "#0d71bb",
        "margin-left": "10px"
      }
    }, [_vm._v(_vm._s(item.fileComment))]) : _vm._e(), _vm._v(" "), (item.fileComment && !item.stateEditFileCheck && _vm.checkInput === 1) ? _c('v-tooltip', {
      attrs: {
        "top": ""
      }
    }, [_c('v-icon', {
      staticStyle: {
        "font-size": "13px",
        "color": "#0d71bb",
        "margin-left": "10px",
        "cursor": "pointer"
      },
      attrs: {
        "slot": "activator"
      },
      on: {
        "click": function($event) {
          $event.stopPropagation();
          item.stateEditFileCheck = !item.stateEditFileCheck
        }
      },
      slot: "activator"
    }, [_vm._v("edit")]), _vm._v(" "), _c('span', [_vm._v("Chỉnh sửa ý kiến")])], 1) : _vm._e(), _vm._v(" "), _vm._l((_vm.dossierFilesItems), function(itemFileView, index) {
      return (item.partNo === itemFileView.dossierPartNo && !itemFileView.eForm) ? _c('div', {
        key: index
      }, [_c('div', {
        staticStyle: {
          "width": "calc(100% - 370px)",
          "display": "flex",
          "align-items": "center",
          "min-height": "38px",
          "background": "#fff",
          "padding-left": "15px",
          "font-size": "12px"
        }
      }, [_c('span', {
        staticClass: "ml-3",
        staticStyle: {
          "cursor": "pointer"
        },
        on: {
          "click": function($event) {
            $event.stopPropagation();
            _vm.viewFile2(itemFileView)
          }
        }
      }, [(itemFileView.fileSize !== 0) ? _c('v-icon', [_vm._v("attach_file")]) : _vm._e(), _vm._v("\n                    " + _vm._s(itemFileView.displayName) + " - \n                    "), _c('i', [_vm._v(_vm._s(itemFileView.modifiedDate))])], 1), _vm._v(" "), (!_vm.onlyView && _vm.checkInput !== 1) ? _c('v-btn', {
        staticClass: "mx-0 my-0",
        attrs: {
          "icon": "",
          "ripple": ""
        },
        on: {
          "click": function($event) {
            $event.stopPropagation();
            _vm.deleteSingleFile(itemFileView, index)
          }
        }
      }, [_c('v-icon', {
        staticStyle: {
          "color": "red"
        }
      }, [_vm._v("delete_outline")])], 1) : _vm._e()], 1)]) : _vm._e()
    })], 2)]), _vm._v(" "), (item.hasForm) ? _c('v-card', [_c('v-card-text', {
      staticStyle: {
        "background-color": "rgba(244, 247, 213, 0.19)"
      }
    }, [_c('v-layout', {
      attrs: {
        "wrap": ""
      }
    }, [(!_vm.stateView) ? _c('v-flex', {
      staticClass: "text-xs-right",
      attrs: {
        "xs12": ""
      }
    }, [(item.hasForm && !_vm.onlyView && _vm.checkInput !== 1) ? _c('v-btn', {
      attrs: {
        "color": "primary"
      },
      on: {
        "click": function($event) {
          _vm.saveAlpacaForm(item, index)
        }
      }
    }, [_vm._v("Lưu lại")]) : _vm._e(), _vm._v(" "), (item.daKhai && item.hasForm && !_vm.onlyView && _vm.checkInput !== 1) ? _c('v-btn', {
      attrs: {
        "color": "primary"
      },
      on: {
        "click": function($event) {
          _vm.deleteSingleFileEform(item, index)
        }
      }
    }, [_vm._v("Xóa")]) : _vm._e(), _vm._v(" "), (item.daKhai && item.hasForm) ? _c('v-btn', {
      attrs: {
        "color": "primary"
      },
      on: {
        "click": function($event) {
          _vm.previewFileEfom(item, index)
        }
      }
    }, [_vm._v("In")]) : _vm._e(), _vm._v(" "), (!_vm.onlyView || item.daKhai) ? _c('div', {
      class: {
        "no_acction__event": _vm.onlyView
      },
      attrs: {
        "id": 'formAlpaca' + item.partNo + _vm.id
      }
    }) : _vm._e()], 1) : _vm._e()], 1)], 1)], 1) : _vm._e()], 1)], 1), _vm._v(" "), _c('div', {
      staticClass: "absolute__btn group__thanh_phan pr-3 mr-1"
    }, [(_vm.loading) ? _c('content-placeholders', {
      staticClass: "mt-1"
    }, [_c('content-placeholders-text', {
      attrs: {
        "lines": 1
      }
    })], 1) : _c('v-layout', {
      attrs: {
        "row": "",
        "wrap": ""
      }
    }, [(_vm.originality !== 1 && item.partType === 1 && !_vm.thongTinHoSo.online && _vm.checkInput !== 1) ? _c('v-flex', {
      staticClass: "layout wrap",
      staticStyle: {
        "width": "110px"
      }
    }, [_c('v-select', {
      attrs: {
        "items": _vm.fileMarkItems,
        "disabled": _vm.onlyView
      },
      on: {
        "change": function($event) {
          _vm.changeFileMark($event, index)
        }
      },
      model: {
        value: (_vm.dossierTemplateItems[index].fileMark),
        callback: function($$v) {
          _vm.$set(_vm.dossierTemplateItems[index], "fileMark", $$v)
        },
        expression: "dossierTemplateItems[index].fileMark"
      }
    })], 1) : _vm._e(), _vm._v(" "), (_vm.checkInput === 1) ? _c('v-flex', {
      staticClass: "layout wrap",
      staticStyle: {
        "width": "120px"
      }
    }, [_c('v-select', {
      attrs: {
        "items": _vm.fileCheckItems,
        "item-text": "text",
        "item-value": "value"
      },
      on: {
        "change": function($event) {
          _vm.changeFileCheck($event, index)
        }
      },
      model: {
        value: (_vm.dossierTemplateItems[index].fileCheck),
        callback: function($$v) {
          _vm.$set(_vm.dossierTemplateItems[index], "fileCheck", $$v)
        },
        expression: "dossierTemplateItems[index].fileCheck"
      }
    })], 1) : (item.fileCheck > 0) ? _c('v-flex', {
      staticClass: "layout wrap",
      style: ({
        width: '20px',
        'align-items': 'center',
        'margin-left': '10px',
        'margin-top': _vm.thongTinHoSo.online ? '10px' : '0px'
      })
    }, [(item.fileCheck === 1) ? _c('v-tooltip', {
      attrs: {
        "top": ""
      }
    }, [_c('v-icon', {
      staticClass: "mx-0",
      attrs: {
        "slot": "activator",
        "size": "16",
        "color": "primary"
      },
      slot: "activator"
    }, [_vm._v("done")]), _vm._v(" "), _c('span', [_vm._v("Đạt")])], 1) : (item.fileCheck === 2) ? _c('v-tooltip', {
      attrs: {
        "top": ""
      }
    }, [_c('v-icon', {
      staticClass: "mx-0",
      attrs: {
        "slot": "activator",
        "size": "16",
        "color": "primary"
      },
      slot: "activator"
    }, [_vm._v("close")]), _vm._v(" "), _c('span', [_vm._v("Không đạt")])], 1) : _vm._e()], 1) : _vm._e(), _vm._v(" "), (_vm.checkInput !== 1) ? _c('v-flex', {
      class: {
        'text-xs-center': !_vm.onlyView, 'text-xs-right': _vm.onlyView
      },
      style: ({
        width: !_vm.onlyView ? '90px' : 'auto'
      })
    }, [_c('input', {
      staticStyle: {
        "display": "none"
      },
      attrs: {
        "type": "file",
        "id": 'file' + item.partNo
      },
      on: {
        "change": function($event) {
          _vm.onUploadSingleFile($event, item, index)
        }
      }
    }), _vm._v(" "), (item.partType === 3 && _vm.originality === 3 && !_vm.onlyView) ? _c('v-tooltip', {
      attrs: {
        "top": ""
      }
    }, [_c('v-btn', {
      staticClass: "mx-0 my-0",
      attrs: {
        "slot": "activator",
        "icon": ""
      },
      on: {
        "click": function($event) {
          _vm.addFileOther(item)
        }
      },
      slot: "activator"
    }, [_c('v-icon', {
      staticClass: "mx-0",
      attrs: {
        "size": "16",
        "color": "primary"
      }
    }, [_vm._v("add")])], 1), _vm._v(" "), _c('span', [_vm._v("Thêm giấy tờ khác")])], 1) : _vm._e(), _vm._v(" "), (_vm.progressUploadPart === item.partNo) ? _c('v-progress-circular', {
      attrs: {
        "width": 2,
        "size": 25,
        "color": "green",
        "indeterminate": ""
      }
    }) : (_vm.progressUploadPart !== item.partNo && !_vm.onlyView) ? _c('v-tooltip', {
      attrs: {
        "top": ""
      }
    }, [_c('v-btn', {
      staticClass: "mx-0 my-0",
      attrs: {
        "slot": "activator",
        "icon": ""
      },
      on: {
        "click": function($event) {
          _vm.pickFile(item)
        }
      },
      slot: "activator"
    }, [_c('v-badge', [_c('v-icon', {
      attrs: {
        "size": "16",
        "color": "primary"
      }
    }, [_vm._v("cloud_upload")])], 1)], 1), _vm._v(" "), _c('span', [_vm._v("Tải file lên")])], 1) : _vm._e()], 1) : _vm._e()], 1)], 1)], 1) : _vm._e()
  }), _vm._v(" "), _c('v-dialog', {
    attrs: {
      "max-width": "400",
      "transition": "fade-transition",
      "persistent": ""
    },
    model: {
      value: (_vm.dialogAddOtherTemp),
      callback: function($$v) {
        _vm.dialogAddOtherTemp = $$v
      },
      expression: "dialogAddOtherTemp"
    }
  }, [_c('v-card', [_c('v-form', {
    ref: "form",
    attrs: {
      "lazy-validation": ""
    },
    model: {
      value: (_vm.valid),
      callback: function($$v) {
        _vm.valid = $$v
      },
      expression: "valid"
    }
  }, [_c('v-card-title', {
    staticClass: "headline"
  }, [_vm._v("Tên giấy tờ")]), _vm._v(" "), _c('v-btn', {
    staticClass: "mx-0 my-0 absolute__btn_panel mr-2",
    attrs: {
      "icon": "",
      "dark": ""
    },
    nativeOn: {
      "click": function($event) {
        return _vm.cancelDialog($event)
      }
    }
  }, [_c('v-icon', [_vm._v("clear")])], 1), _vm._v(" "), (_vm.loadingAddOther) ? _c('v-progress-linear', {
    staticClass: "my-0",
    attrs: {
      "indeterminate": true
    }
  }) : _vm._e(), _vm._v(" "), _c('v-card-text', {
    staticClass: "pb-0 pt-4"
  }, [_c('v-layout', {
    attrs: {
      "wrap": ""
    }
  }, [_c('v-flex', {
    staticClass: "px-2 pb-3",
    attrs: {
      "xs12": ""
    }
  }, [_c('v-text-field', {
    attrs: {
      "label": "Tên giấy tờ:",
      "rules": [function (v) { return !!v || 'Bạn phải điền tên giấy tờ.'; }],
      "required": ""
    },
    model: {
      value: (_vm.otherDossierTemplate),
      callback: function($$v) {
        _vm.otherDossierTemplate = $$v
      },
      expression: "otherDossierTemplate"
    }
  })], 1)], 1)], 1), _vm._v(" "), _c('v-card-actions', [_c('v-spacer'), _vm._v(" "), _c('v-btn', {
    attrs: {
      "color": "red darken-3",
      "flat": "flat"
    },
    nativeOn: {
      "click": function($event) {
        return _vm.cancelDialog($event)
      }
    }
  }, [_vm._v("\n              Quay lại\n            ")]), _vm._v(" "), _c('v-btn', {
    attrs: {
      "color": "primary",
      "flat": "flat",
      "loading": _vm.loadingAddOther
    },
    nativeOn: {
      "click": function($event) {
        return _vm.addOtherTemplate($event)
      }
    }
  }, [_vm._v("\n            Đồng ý\n            "), _c('span', {
    attrs: {
      "slot": "loader"
    },
    slot: "loader"
  }, [_vm._v("Loading...")])])], 1)], 1)], 1)], 1)], 2), _vm._v(" "), _c('v-dialog', {
    staticStyle: {
      "overflow": "hidden"
    },
    attrs: {
      "max-width": "900",
      "transition": "fade-transition"
    },
    model: {
      value: (_vm.dialogPDF),
      callback: function($$v) {
        _vm.dialogPDF = $$v
      },
      expression: "dialogPDF"
    }
  }, [_c('v-card', [_c('v-card-title', {
    staticClass: "headline"
  }, [_vm._v("File đính kèm")]), _vm._v(" "), _c('v-btn', {
    staticClass: "mx-0 my-0 absolute__btn_panel mr-2",
    attrs: {
      "icon": "",
      "dark": ""
    },
    nativeOn: {
      "click": function($event) {
        _vm.dialogPDF = false
      }
    }
  }, [_c('v-icon', [_vm._v("clear")])], 1), _vm._v(" "), (_vm.dialogPDFLoading) ? _c('div', {
    staticStyle: {
      "min-height": "600px",
      "text-align": "center",
      "margin": "auto",
      "padding": "25%"
    }
  }, [_c('v-progress-circular', {
    attrs: {
      "size": 100,
      "width": 1,
      "color": "primary",
      "indeterminate": ""
    }
  })], 1) : _vm._e(), _vm._v(" "), _c('iframe', {
    directives: [{
      name: "show",
      rawName: "v-show",
      value: (!_vm.dialogPDFLoading),
      expression: "!dialogPDFLoading"
    }],
    staticStyle: {
      "overflow": "auto",
      "min-height": "600px"
    },
    attrs: {
      "id": 'dialogPDFPreview' + _vm.id,
      "src": "",
      "type": "application/pdf",
      "width": "100%",
      "height": "100%",
      "frameborder": "0"
    }
  })], 1)], 1)], 1)
},staticRenderFns: []}
module.exports.render._withStripped = true
if (false) {
  module.hot.accept()
  if (module.hot.data) {
     require("vue-hot-reload-api").rerender("data-v-687ee6a0", module.exports)
  }
}

/***/ }),

/***/ 650:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_v_money__ = __webpack_require__(648);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_v_money___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_v_money__);



/* harmony default export */ __webpack_exports__["default"] = ({
  props: {
    payments: {
      type: Object,
      default: function _default() {}
    },
    viaPortal: {
      type: Number,
      default: function _default() {
        return 0;
      }
    }
  },
  model: {
    prop: 'payments'
  },
  data: function data() {
    return {
      data_payment: {},
      money: {
        decimal: '',
        thousands: '.',
        prefix: '',
        suffix: '',
        precision: 0,
        masked: false
      },
      totalFee: 0,
      feeTamThu: 0,
      feeTong: 0,
      checkPaid: true,
      activeEdit: true
    };
  },
  directives: { money: __WEBPACK_IMPORTED_MODULE_0_v_money__["VMoney"] },
  created: function created() {
    var vm = this;
    vm.data_payment = vm.payments;
    if (vm.payments) {
      setTimeout(function () {
        var feeAmount = vm.payments.feeAmount ? Number(vm.payments.feeAmount.toString().replace(/\./g, '')) : 0;

        if (vm.payments.requestPayment === 1) {
          var advanceAmount = vm.payments.advanceAmount ? Number(vm.payments.advanceAmount.toString().replace(/\./g, '')) : 0;
          vm.totalFee = advanceAmount;
        } else if (vm.payments.requestPayment === 2) {
          var serviceAmount = vm.payments.serviceAmount ? Number(vm.payments.serviceAmount.toString().replace(/\./g, '')) : 0;
          vm.totalFee = feeAmount + serviceAmount;
        } else {
          var _advanceAmount = vm.payments.advanceAmount ? Number(vm.payments.advanceAmount.toString().replace(/\./g, '')) : 0;
          var _serviceAmount = vm.payments.serviceAmount ? Number(vm.payments.serviceAmount.toString().replace(/\./g, '')) : 0;
          vm.feeTong = feeAmount + _serviceAmount;
          vm.totalFee = feeAmount + _serviceAmount - _advanceAmount;
        }
        if (vm.totalFee < 0) {
          vm.totalFee = 0;
        }
      }, 200);
    }
  },

  methods: {
    changeFee: function changeFee() {
      var vm = this;
      var val = vm.data_payment;
      var feeAmount = val.feeAmount ? Number(val.feeAmount.toString().replace(/\./g, '')) : 0;
      if (val.requestPayment === 1) {
        var advanceAmount = Number(val.advanceAmount.toString().replace(/\./g, ''));
        vm.totalFee = advanceAmount;
      } else if (val.requestPayment === 2) {
        var serviceAmount = Number(val.serviceAmount.toString().replace(/\./g, ''));
        vm.totalFee = feeAmount + serviceAmount;
      } else {
        var _advanceAmount2 = Number(val.advanceAmount.toString().replace(/\./g, ''));
        var _serviceAmount2 = Number(val.serviceAmount.toString().replace(/\./g, ''));
        vm.feeTong = feeAmount + _serviceAmount2;
        vm.totalFee = feeAmount + _serviceAmount2 - _advanceAmount2;
      }
      if (vm.totalFee < 0) {
        vm.totalFee = 0;
      }
    },
    currency: function currency(value) {
      if (value) {
        var moneyCur = (value / 1).toFixed(0).replace('.', ',');
        return moneyCur.toString().replace(/\B(?=(\d{3})+(?!\d))/g, '.');
      }
      return '';
    },
    goBack: function goBack() {
      window.history.back();
    }
  },
  filters: {}
});

/***/ }),

/***/ 651:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_typeof__ = __webpack_require__(645);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_typeof___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_typeof__);



var constants = {
  colorChecked: '#75C791',
  colorUnchecked: '#bfcbd9',
  cssColors: false,
  labelChecked: 'on',
  labelUnchecked: 'off',
  width: 50,
  height: 22,
  margin: 3
};

var contains = function contains(object, title) {
  return (typeof object === 'undefined' ? 'undefined' : __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_typeof___default()(object)) === 'object' && object.hasOwnProperty(title);
};

var px = function px(v) {
  return v + 'px';
};

/* harmony default export */ __webpack_exports__["default"] = ({
  name: 'toggle-button',
  props: {
    title_checked: '',
    title_unchecked: '',
    value: {
      type: Boolean,
      default: false
    },
    disabled: {
      type: Boolean,
      default: false
    },
    sync: {
      type: Boolean,
      default: false
    },
    speed: {
      type: Number,
      default: 300
    },
    color: {
      type: [String, Object],
      validator: function validator(value) {
        return (typeof value === 'undefined' ? 'undefined' : __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_typeof___default()(value)) === 'object' ? value.checked || value.unchecked : typeof value === 'string';
      }
    },
    cssColors: {
      type: Boolean,
      default: false
    },
    labels: {
      type: [Boolean, Object],
      default: false,
      validator: function validator(value) {
        return (typeof value === 'undefined' ? 'undefined' : __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_typeof___default()(value)) === 'object' ? value.checked || value.unchecked : typeof value === 'boolean';
      }
    },
    height: {
      type: Number,
      default: constants.height
    },
    width: {
      type: Number,
      default: constants.width
    }
  },
  computed: {
    className: function className() {
      var toggled = this.toggled,
          disabled = this.disabled;

      return ['vue-js-switch', { toggled: toggled, disabled: disabled }];
    },
    ariaChecked: function ariaChecked() {
      return this.toggled.toString();
    },
    coreStyle: function coreStyle() {
      return {
        width: px(this.width),
        height: px(this.height),
        backgroundColor: this.cssColors ? null : this.colorCurrent,
        borderRadius: px(Math.round(this.height / 2))
      };
    },
    maxWidth: function maxWidth() {
      return {
        width: px(this.width) + '!important'
      };
    },
    buttonRadius: function buttonRadius() {
      return this.height - constants.margin * 2;
    },
    distance: function distance() {
      return px(this.width - this.height + constants.margin);
    },
    buttonStyle: function buttonStyle() {
      return {
        width: px(this.buttonRadius),
        height: px(this.buttonRadius),
        transition: 'transform ' + this.speed + 'ms',
        transform: this.toggled ? 'translate3d(' + this.distance + ', 3px, 0px)' : null
      };
    },
    labelStyle: function labelStyle() {
      return {
        lineHeight: px(this.height)
      };
    },
    colorChecked: function colorChecked() {
      var color = this.color;

      if ((typeof color === 'undefined' ? 'undefined' : __WEBPACK_IMPORTED_MODULE_0_babel_runtime_helpers_typeof___default()(color)) !== 'object') {
        return color || constants.colorChecked;
      }
      return contains(color, 'checked') ? color.checked : constants.colorChecked;
    },
    colorUnchecked: function colorUnchecked() {
      var color = this.color;

      return contains(color, 'unchecked') ? color.unchecked : constants.colorUnchecked;
    },
    colorCurrent: function colorCurrent() {
      return this.toggled ? this.colorChecked : this.colorUnchecked;
    },
    labelChecked: function labelChecked() {
      return contains(this.labels, 'checked') ? this.labels.checked : constants.labelChecked;
    },
    labelUnchecked: function labelUnchecked() {
      return contains(this.labels, 'unchecked') ? this.labels.unchecked : constants.labelUnchecked;
    }
  },
  watch: {
    value: function value(_value) {
      if (this.sync) {
        this.toggled = !!_value;
      }
    }
  },
  data: function data() {
    return {
      toggled: !!this.value
    };
  },

  methods: {
    toggle: function toggle(event) {
      this.toggled = !this.toggled;
      this.$emit('input', this.toggled);
      this.$emit('change', {
        value: this.toggled,
        srcEvent: event
      });
    }
  }
});

/***/ }),

/***/ 653:
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(658), __esModule: true };

/***/ }),

/***/ 654:
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(659), __esModule: true };

/***/ }),

/***/ 658:
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(666);
__webpack_require__(231);
__webpack_require__(667);
__webpack_require__(668);
module.exports = __webpack_require__(30).Symbol;


/***/ }),

/***/ 659:
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(140);
__webpack_require__(213);
module.exports = __webpack_require__(516).f('iterator');


/***/ }),

/***/ 660:
/***/ (function(module, exports, __webpack_require__) {

// all enumerable object keys, includes symbols
var getKeys = __webpack_require__(138);
var gOPS = __webpack_require__(214);
var pIE = __webpack_require__(211);
module.exports = function (it) {
  var result = getKeys(it);
  var getSymbols = gOPS.f;
  if (getSymbols) {
    var symbols = getSymbols(it);
    var isEnum = pIE.f;
    var i = 0;
    var key;
    while (symbols.length > i) if (isEnum.call(it, key = symbols[i++])) result.push(key);
  } return result;
};


/***/ }),

/***/ 661:
/***/ (function(module, exports, __webpack_require__) {

// 7.2.2 IsArray(argument)
var cof = __webpack_require__(74);
module.exports = Array.isArray || function isArray(arg) {
  return cof(arg) == 'Array';
};


/***/ }),

/***/ 662:
/***/ (function(module, exports, __webpack_require__) {

var META = __webpack_require__(143)('meta');
var isObject = __webpack_require__(59);
var has = __webpack_require__(73);
var setDesc = __webpack_require__(57).f;
var id = 0;
var isExtensible = Object.isExtensible || function () {
  return true;
};
var FREEZE = !__webpack_require__(94)(function () {
  return isExtensible(Object.preventExtensions({}));
});
var setMeta = function (it) {
  setDesc(it, META, { value: {
    i: 'O' + ++id, // object ID
    w: {}          // weak collections IDs
  } });
};
var fastKey = function (it, create) {
  // return primitive with prefix
  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;
  if (!has(it, META)) {
    // can't set metadata to uncaught frozen object
    if (!isExtensible(it)) return 'F';
    // not necessary to add metadata
    if (!create) return 'E';
    // add missing metadata
    setMeta(it);
  // return object ID
  } return it[META].i;
};
var getWeak = function (it, create) {
  if (!has(it, META)) {
    // can't set metadata to uncaught frozen object
    if (!isExtensible(it)) return true;
    // not necessary to add metadata
    if (!create) return false;
    // add missing metadata
    setMeta(it);
  // return hash weak collections IDs
  } return it[META].w;
};
// add metadata on freeze-family methods calling
var onFreeze = function (it) {
  if (FREEZE && meta.NEED && isExtensible(it) && !has(it, META)) setMeta(it);
  return it;
};
var meta = module.exports = {
  KEY: META,
  NEED: false,
  fastKey: fastKey,
  getWeak: getWeak,
  onFreeze: onFreeze
};


/***/ }),

/***/ 663:
/***/ (function(module, exports, __webpack_require__) {

var pIE = __webpack_require__(211);
var createDesc = __webpack_require__(96);
var toIObject = __webpack_require__(95);
var toPrimitive = __webpack_require__(215);
var has = __webpack_require__(73);
var IE8_DOM_DEFINE = __webpack_require__(228);
var gOPD = Object.getOwnPropertyDescriptor;

exports.f = __webpack_require__(58) ? gOPD : function getOwnPropertyDescriptor(O, P) {
  O = toIObject(O);
  P = toPrimitive(P, true);
  if (IE8_DOM_DEFINE) try {
    return gOPD(O, P);
  } catch (e) { /* empty */ }
  if (has(O, P)) return createDesc(!pIE.f.call(O, P), O[P]);
};


/***/ }),

/***/ 664:
/***/ (function(module, exports, __webpack_require__) {

// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window
var toIObject = __webpack_require__(95);
var gOPN = __webpack_require__(518).f;
var toString = {}.toString;

var windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames
  ? Object.getOwnPropertyNames(window) : [];

var getWindowNames = function (it) {
  try {
    return gOPN(it);
  } catch (e) {
    return windowNames.slice();
  }
};

module.exports.f = function getOwnPropertyNames(it) {
  return windowNames && toString.call(it) == '[object Window]' ? getWindowNames(it) : gOPN(toIObject(it));
};


/***/ }),

/***/ 666:
/***/ (function(module, exports, __webpack_require__) {

"use strict";

// ECMAScript 6 symbols shim
var global = __webpack_require__(20);
var has = __webpack_require__(73);
var DESCRIPTORS = __webpack_require__(58);
var $export = __webpack_require__(51);
var redefine = __webpack_require__(230);
var META = __webpack_require__(662).KEY;
var $fails = __webpack_require__(94);
var shared = __webpack_require__(147);
var setToStringTag = __webpack_require__(98);
var uid = __webpack_require__(143);
var wks = __webpack_require__(19);
var wksExt = __webpack_require__(516);
var wksDefine = __webpack_require__(515);
var enumKeys = __webpack_require__(660);
var isArray = __webpack_require__(661);
var anObject = __webpack_require__(38);
var isObject = __webpack_require__(59);
var toIObject = __webpack_require__(95);
var toPrimitive = __webpack_require__(215);
var createDesc = __webpack_require__(96);
var _create = __webpack_require__(218);
var gOPNExt = __webpack_require__(664);
var $GOPD = __webpack_require__(663);
var $DP = __webpack_require__(57);
var $keys = __webpack_require__(138);
var gOPD = $GOPD.f;
var dP = $DP.f;
var gOPN = gOPNExt.f;
var $Symbol = global.Symbol;
var $JSON = global.JSON;
var _stringify = $JSON && $JSON.stringify;
var PROTOTYPE = 'prototype';
var HIDDEN = wks('_hidden');
var TO_PRIMITIVE = wks('toPrimitive');
var isEnum = {}.propertyIsEnumerable;
var SymbolRegistry = shared('symbol-registry');
var AllSymbols = shared('symbols');
var OPSymbols = shared('op-symbols');
var ObjectProto = Object[PROTOTYPE];
var USE_NATIVE = typeof $Symbol == 'function';
var QObject = global.QObject;
// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173
var setter = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;

// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687
var setSymbolDesc = DESCRIPTORS && $fails(function () {
  return _create(dP({}, 'a', {
    get: function () { return dP(this, 'a', { value: 7 }).a; }
  })).a != 7;
}) ? function (it, key, D) {
  var protoDesc = gOPD(ObjectProto, key);
  if (protoDesc) delete ObjectProto[key];
  dP(it, key, D);
  if (protoDesc && it !== ObjectProto) dP(ObjectProto, key, protoDesc);
} : dP;

var wrap = function (tag) {
  var sym = AllSymbols[tag] = _create($Symbol[PROTOTYPE]);
  sym._k = tag;
  return sym;
};

var isSymbol = USE_NATIVE && typeof $Symbol.iterator == 'symbol' ? function (it) {
  return typeof it == 'symbol';
} : function (it) {
  return it instanceof $Symbol;
};

var $defineProperty = function defineProperty(it, key, D) {
  if (it === ObjectProto) $defineProperty(OPSymbols, key, D);
  anObject(it);
  key = toPrimitive(key, true);
  anObject(D);
  if (has(AllSymbols, key)) {
    if (!D.enumerable) {
      if (!has(it, HIDDEN)) dP(it, HIDDEN, createDesc(1, {}));
      it[HIDDEN][key] = true;
    } else {
      if (has(it, HIDDEN) && it[HIDDEN][key]) it[HIDDEN][key] = false;
      D = _create(D, { enumerable: createDesc(0, false) });
    } return setSymbolDesc(it, key, D);
  } return dP(it, key, D);
};
var $defineProperties = function defineProperties(it, P) {
  anObject(it);
  var keys = enumKeys(P = toIObject(P));
  var i = 0;
  var l = keys.length;
  var key;
  while (l > i) $defineProperty(it, key = keys[i++], P[key]);
  return it;
};
var $create = function create(it, P) {
  return P === undefined ? _create(it) : $defineProperties(_create(it), P);
};
var $propertyIsEnumerable = function propertyIsEnumerable(key) {
  var E = isEnum.call(this, key = toPrimitive(key, true));
  if (this === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return false;
  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key] ? E : true;
};
var $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key) {
  it = toIObject(it);
  key = toPrimitive(key, true);
  if (it === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return;
  var D = gOPD(it, key);
  if (D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key])) D.enumerable = true;
  return D;
};
var $getOwnPropertyNames = function getOwnPropertyNames(it) {
  var names = gOPN(toIObject(it));
  var result = [];
  var i = 0;
  var key;
  while (names.length > i) {
    if (!has(AllSymbols, key = names[i++]) && key != HIDDEN && key != META) result.push(key);
  } return result;
};
var $getOwnPropertySymbols = function getOwnPropertySymbols(it) {
  var IS_OP = it === ObjectProto;
  var names = gOPN(IS_OP ? OPSymbols : toIObject(it));
  var result = [];
  var i = 0;
  var key;
  while (names.length > i) {
    if (has(AllSymbols, key = names[i++]) && (IS_OP ? has(ObjectProto, key) : true)) result.push(AllSymbols[key]);
  } return result;
};

// 19.4.1.1 Symbol([description])
if (!USE_NATIVE) {
  $Symbol = function Symbol() {
    if (this instanceof $Symbol) throw TypeError('Symbol is not a constructor!');
    var tag = uid(arguments.length > 0 ? arguments[0] : undefined);
    var $set = function (value) {
      if (this === ObjectProto) $set.call(OPSymbols, value);
      if (has(this, HIDDEN) && has(this[HIDDEN], tag)) this[HIDDEN][tag] = false;
      setSymbolDesc(this, tag, createDesc(1, value));
    };
    if (DESCRIPTORS && setter) setSymbolDesc(ObjectProto, tag, { configurable: true, set: $set });
    return wrap(tag);
  };
  redefine($Symbol[PROTOTYPE], 'toString', function toString() {
    return this._k;
  });

  $GOPD.f = $getOwnPropertyDescriptor;
  $DP.f = $defineProperty;
  __webpack_require__(518).f = gOPNExt.f = $getOwnPropertyNames;
  __webpack_require__(211).f = $propertyIsEnumerable;
  __webpack_require__(214).f = $getOwnPropertySymbols;

  if (DESCRIPTORS && !__webpack_require__(142)) {
    redefine(ObjectProto, 'propertyIsEnumerable', $propertyIsEnumerable, true);
  }

  wksExt.f = function (name) {
    return wrap(wks(name));
  };
}

$export($export.G + $export.W + $export.F * !USE_NATIVE, { Symbol: $Symbol });

for (var es6Symbols = (
  // 19.4.2.2, 19.4.2.3, 19.4.2.4, 19.4.2.6, 19.4.2.8, 19.4.2.9, 19.4.2.10, 19.4.2.11, 19.4.2.12, 19.4.2.13, 19.4.2.14
  'hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'
).split(','), j = 0; es6Symbols.length > j;)wks(es6Symbols[j++]);

for (var wellKnownSymbols = $keys(wks.store), k = 0; wellKnownSymbols.length > k;) wksDefine(wellKnownSymbols[k++]);

$export($export.S + $export.F * !USE_NATIVE, 'Symbol', {
  // 19.4.2.1 Symbol.for(key)
  'for': function (key) {
    return has(SymbolRegistry, key += '')
      ? SymbolRegistry[key]
      : SymbolRegistry[key] = $Symbol(key);
  },
  // 19.4.2.5 Symbol.keyFor(sym)
  keyFor: function keyFor(sym) {
    if (!isSymbol(sym)) throw TypeError(sym + ' is not a symbol!');
    for (var key in SymbolRegistry) if (SymbolRegistry[key] === sym) return key;
  },
  useSetter: function () { setter = true; },
  useSimple: function () { setter = false; }
});

$export($export.S + $export.F * !USE_NATIVE, 'Object', {
  // 19.1.2.2 Object.create(O [, Properties])
  create: $create,
  // 19.1.2.4 Object.defineProperty(O, P, Attributes)
  defineProperty: $defineProperty,
  // 19.1.2.3 Object.defineProperties(O, Properties)
  defineProperties: $defineProperties,
  // 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)
  getOwnPropertyDescriptor: $getOwnPropertyDescriptor,
  // 19.1.2.7 Object.getOwnPropertyNames(O)
  getOwnPropertyNames: $getOwnPropertyNames,
  // 19.1.2.8 Object.getOwnPropertySymbols(O)
  getOwnPropertySymbols: $getOwnPropertySymbols
});

// 24.3.2 JSON.stringify(value [, replacer [, space]])
$JSON && $export($export.S + $export.F * (!USE_NATIVE || $fails(function () {
  var S = $Symbol();
  // MS Edge converts symbol values to JSON as {}
  // WebKit converts symbol values to JSON as null
  // V8 throws on boxed symbols
  return _stringify([S]) != '[null]' || _stringify({ a: S }) != '{}' || _stringify(Object(S)) != '{}';
})), 'JSON', {
  stringify: function stringify(it) {
    var args = [it];
    var i = 1;
    var replacer, $replacer;
    while (arguments.length > i) args.push(arguments[i++]);
    $replacer = replacer = args[1];
    if (!isObject(replacer) && it === undefined || isSymbol(it)) return; // IE8 returns string on undefined
    if (!isArray(replacer)) replacer = function (key, value) {
      if (typeof $replacer == 'function') value = $replacer.call(this, key, value);
      if (!isSymbol(value)) return value;
    };
    args[1] = replacer;
    return _stringify.apply($JSON, args);
  }
});

// 19.4.3.4 Symbol.prototype[@@toPrimitive](hint)
$Symbol[PROTOTYPE][TO_PRIMITIVE] || __webpack_require__(52)($Symbol[PROTOTYPE], TO_PRIMITIVE, $Symbol[PROTOTYPE].valueOf);
// 19.4.3.5 Symbol.prototype[@@toStringTag]
setToStringTag($Symbol, 'Symbol');
// 20.2.1.9 Math[@@toStringTag]
setToStringTag(Math, 'Math', true);
// 24.3.3 JSON[@@toStringTag]
setToStringTag(global.JSON, 'JSON', true);


/***/ }),

/***/ 667:
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(515)('asyncIterator');


/***/ }),

/***/ 668:
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(515)('observable');


/***/ }),

/***/ 671:
/***/ (function(module, exports, __webpack_require__) {

module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('div', {
    staticClass: "payment-info",
    staticStyle: {
      "width": "100%"
    }
  }, [_c('v-expansion-panel', {
    staticClass: "expansion-pl"
  }, [_c('v-expansion-panel-content', {
    attrs: {
      "hide-actions": "",
      "value": "1"
    }
  }, [_c('div', {
    attrs: {
      "slot": "header"
    },
    slot: "header"
  }, [_c('div', {
    staticClass: "background-triangle-small"
  }, [_c('v-icon', {
    attrs: {
      "size": "18",
      "color": "white"
    }
  }, [_vm._v("star_rate")])], 1), _vm._v(" "), (_vm.data_payment.requestPayment === 1 || _vm.data_payment.requestPayment === 5) ? _c('span', [_vm._v(_vm._s(_vm.data_payment.paymentFee))]) : _vm._e(), _vm._v(" "), (_vm.data_payment.requestPayment === 2) ? _c('span', [_vm._v("Lập phiếu thanh toán")]) : _vm._e()]), _vm._v(" "), _c('v-card', [_c('v-card-text', {
    staticClass: "pb-1"
  }, [_c('v-layout', {
    attrs: {
      "wrap": ""
    }
  }, [_c('v-flex', {
    attrs: {
      "xs12": "",
      "sm2": ""
    }
  }, [_c('v-subheader', {
    staticClass: "pl-0 text-right"
  }, [_vm._v("Lệ phí: ")])], 1), _vm._v(" "), _c('v-flex', {
    attrs: {
      "xs12": "",
      "sm3": ""
    }
  }, [(_vm.data_payment.editable === 1 || _vm.data_payment.editable === 3) ? _c('v-text-field', {
    directives: [{
      name: "money",
      rawName: "v-money",
      value: (_vm.money),
      expression: "money"
    }],
    attrs: {
      "suffix": "vnđ"
    },
    on: {
      "keyup": _vm.changeFee
    },
    model: {
      value: (_vm.data_payment.feeAmount),
      callback: function($$v) {
        _vm.$set(_vm.data_payment, "feeAmount", $$v)
      },
      expression: "data_payment.feeAmount"
    }
  }) : _c('p', {
    staticClass: "mt-1 mb-0"
  }, [_vm._v(_vm._s(_vm.currency(_vm.data_payment.feeAmount.toString().replace(/\./g, ''))) + "    vnđ")])], 1), _vm._v(" "), _c('v-flex', {
    attrs: {
      "xs12": "",
      "sm2": ""
    }
  }, [_c('v-subheader', {
    staticClass: "pl-0 text-right"
  }, [_vm._v("Phí: ")])], 1), _vm._v(" "), _c('v-flex', {
    attrs: {
      "xs12": "",
      "sm3": ""
    }
  }, [(_vm.data_payment.editable === 2 || _vm.data_payment.editable === 3) ? _c('v-text-field', {
    directives: [{
      name: "money",
      rawName: "v-money",
      value: (_vm.money),
      expression: "money"
    }],
    attrs: {
      "suffix": "vnđ"
    },
    on: {
      "keyup": _vm.changeFee
    },
    model: {
      value: (_vm.data_payment.serviceAmount),
      callback: function($$v) {
        _vm.$set(_vm.data_payment, "serviceAmount", $$v)
      },
      expression: "data_payment.serviceAmount"
    }
  }) : _c('p', {
    staticClass: "mt-1 mb-0"
  }, [_vm._v(_vm._s(_vm.currency(_vm.data_payment.serviceAmount.toString().replace(/\./g, ''))) + "    vnđ")])], 1), _vm._v(" "), _c('v-flex', {
    attrs: {
      "xs12": "",
      "sm2": ""
    }
  })], 1)], 1), _vm._v(" "), _c('v-card-text', {
    staticClass: "pt-0"
  }, [_c('v-layout', {
    attrs: {
      "wrap": ""
    }
  }, [(_vm.data_payment.requestPayment === 1) ? _c('v-flex', {
    attrs: {
      "xs12": "",
      "sm2": ""
    }
  }, [_c('v-subheader', {
    staticClass: "pl-0 text-right"
  }, [_vm._v("Tổng: ")])], 1) : _vm._e(), _vm._v(" "), (_vm.data_payment.requestPayment === 1) ? _c('v-flex', {
    staticClass: "pt-1",
    attrs: {
      "xs12": "",
      "sm3": ""
    }
  }, [_c('span', [_vm._v(_vm._s(_vm.currency(_vm.feeTong.toString().replace(/\./g, ''))) + "    vnđ")])]) : _vm._e(), _vm._v(" "), (_vm.data_payment.requestPayment === 1) ? _c('v-flex', {
    attrs: {
      "xs12": "",
      "sm1": ""
    }
  }) : _vm._e(), _vm._v(" "), (_vm.data_payment.requestPayment === 2) ? _c('v-flex', {
    attrs: {
      "xs12": "",
      "sm2": ""
    }
  }, [_c('v-subheader', {
    staticClass: "pl-0 text-right"
  }, [_vm._v("Tổng: ")])], 1) : _vm._e(), _vm._v(" "), (_vm.data_payment.requestPayment === 2) ? _c('v-flex', {
    staticClass: "pt-1",
    attrs: {
      "xs12": "",
      "sm3": ""
    }
  }, [_c('span', [_vm._v(_vm._s(_vm.currency(_vm.totalFee.toString().replace(/\./g, ''))) + "    vnđ")])]) : _vm._e(), _vm._v(" "), (_vm.data_payment.requestPayment === 2) ? _c('v-flex', {
    attrs: {
      "xs12": "",
      "sm1": ""
    }
  }) : _vm._e(), _vm._v(" "), (_vm.data_payment.requestPayment === 5) ? _c('v-flex', {
    attrs: {
      "xs12": "",
      "sm2": ""
    }
  }, [_c('v-subheader', {
    staticClass: "pl-0 text-right"
  }, [_vm._v("Tổng: ")])], 1) : _vm._e(), _vm._v(" "), (_vm.data_payment.requestPayment === 5) ? _c('v-flex', {
    staticClass: "pt-1",
    attrs: {
      "xs12": "",
      "sm3": ""
    }
  }, [_c('span', [_vm._v(_vm._s(_vm.currency(_vm.feeTong.toString().replace(/\./g, ''))) + "    vnđ")])]) : _vm._e(), _vm._v(" "), (_vm.data_payment.requestPayment === 5) ? _c('v-flex', {
    attrs: {
      "xs12": "",
      "sm2": ""
    }
  }, [_c('v-subheader', {
    staticClass: "pl-0 text-right"
  }, [_vm._v("Đã tạm nộp: ")])], 1) : _vm._e(), _vm._v(" "), (_vm.data_payment.requestPayment === 5) ? _c('v-flex', {
    staticClass: "pt-2",
    attrs: {
      "xs12": "",
      "sm3": ""
    }
  }, [_c('span', [_vm._v(_vm._s(_vm.currency((Number(_vm.data_payment.advanceAmount.toString().replace(/\./g, ''))).toString().replace(/\./g, ''))) + "    vnđ")])]) : _vm._e(), _vm._v(" "), (_vm.data_payment.requestPayment === 5) ? _c('v-flex', {
    attrs: {
      "xs12": "",
      "sm1": ""
    }
  }) : _vm._e(), _vm._v(" "), (_vm.data_payment.requestPayment === 5) ? _c('v-flex', {
    attrs: {
      "xs12": "",
      "sm2": ""
    }
  }, [_c('v-subheader', {
    staticClass: "pl-0 text-right"
  }, [_vm._v("Còn phải nộp: ")])], 1) : _vm._e(), _vm._v(" "), (_vm.data_payment.requestPayment === 5) ? _c('v-flex', {
    staticClass: "pt-2",
    attrs: {
      "xs12": "",
      "sm3": ""
    }
  }, [_c('span', [_vm._v(_vm._s(_vm.currency(_vm.totalFee.toString().replace(/\./g, ''))) + "    vnđ")])]) : _vm._e(), _vm._v(" "), (_vm.data_payment.requestPayment === 5) ? _c('v-flex', {
    attrs: {
      "xs12": "",
      "sm1": ""
    }
  }) : _vm._e()], 1), _vm._v(" "), _c('v-layout', {
    staticStyle: {
      "position": "relative"
    },
    attrs: {
      "wrap": ""
    }
  }, [_c('v-flex', {
    staticClass: "my-0 py-1",
    staticStyle: {
      "width": "70px"
    }
  }, [_c('span', {
    staticClass: "red--text"
  }, [_vm._v("* ")]), _vm._v(" Ghi chú:")]), _vm._v(" "), _c('v-flex', {
    staticStyle: {
      "width": "calc(100% - 80px)"
    }
  }, [(_vm.activeEdit == false) ? _c('div', {
    staticClass: "pl-2"
  }, [_c('v-text-field', {
    staticClass: "py-0",
    attrs: {
      "multi-line": "",
      "readonly": _vm.activeEdit,
      "required": ""
    },
    model: {
      value: (_vm.data_payment.paymentNote),
      callback: function($$v) {
        _vm.$set(_vm.data_payment, "paymentNote", $$v)
      },
      expression: "data_payment.paymentNote"
    }
  })], 1) : _vm._e(), _vm._v(" "), (_vm.activeEdit || _vm.data_payment.paymentNote === '') ? _c('p', {
    staticClass: "px-2 my-0 py-1"
  }, [_vm._v("\n                " + _vm._s(_vm.data_payment.paymentNote) + "   \n                "), (_vm.activeEdit == true) ? _c('v-icon', {
    staticClass: "hover-pointer btn-add mx-0 my-0",
    attrs: {
      "color": "blue",
      "size": "20",
      "title": "Sửa",
      "grey": "",
      "darken-4": ""
    },
    on: {
      "click": function($event) {
        $event.stopPropagation();
        _vm.activeEdit = false
      }
    }
  }, [_vm._v("\n                  create\n                ")]) : _vm._e()], 1) : _vm._e(), _vm._v(" "), _c('span', {
    staticStyle: {
      "position": "absolute",
      "top": "15px",
      "right": "10px"
    }
  }, [(_vm.activeEdit == false) ? _c('v-icon', {
    staticClass: "hover-pointer btn-add mx-0 my-0",
    attrs: {
      "color": "green",
      "size": "25",
      "grey": "",
      "darken-4": ""
    },
    on: {
      "click": function($event) {
        $event.stopPropagation();
        _vm.activeEdit = true
      }
    }
  }, [_vm._v("\n                  check\n                ")]) : _vm._e()], 1)])], 1)], 1)], 1)], 1)], 1)], 1)
},staticRenderFns: []}
module.exports.render._withStripped = true
if (false) {
  module.hot.accept()
  if (module.hot.data) {
     require("vue-hot-reload-api").rerender("data-v-6830f0e4", module.exports)
  }
}

/***/ }),

/***/ 672:
/***/ (function(module, exports, __webpack_require__) {

module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('label', {
    class: _vm.className,
    style: (_vm.maxWidth),
    attrs: {
      "role": "checkbox",
      "title": _vm.toggled ? _vm.title_checked : _vm.title_unchecked,
      "aria-checked": _vm.ariaChecked
    }
  }, [_c('input', {
    staticClass: "v-switch-input",
    attrs: {
      "type": "checkbox"
    },
    on: {
      "change": function($event) {
        $event.stopPropagation();
        return _vm.toggle($event)
      }
    }
  }), _vm._v(" "), _c('div', {
    staticClass: "v-switch-core",
    style: (_vm.coreStyle)
  }, [_c('div', {
    staticClass: "v-switch-button",
    style: (_vm.buttonStyle)
  })]), _vm._v(" "), (_vm.labels) ? [(_vm.toggled) ? _c('span', {
    staticClass: "v-switch-label v-left",
    style: (_vm.labelStyle),
    domProps: {
      "innerHTML": _vm._s(_vm.labelChecked)
    }
  }) : _c('span', {
    staticClass: "v-switch-label v-right",
    style: (_vm.labelStyle),
    domProps: {
      "innerHTML": _vm._s(_vm.labelUnchecked)
    }
  })] : _vm._e()], 2)
},staticRenderFns: []}
module.exports.render._withStripped = true
if (false) {
  module.hot.accept()
  if (module.hot.data) {
     require("vue-hot-reload-api").rerender("data-v-7cc31a58", module.exports)
  }
}

/***/ }),

/***/ 674:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery__ = __webpack_require__(36);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_jquery__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__toggleButton_vue__ = __webpack_require__(217);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1__toggleButton_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1__toggleButton_vue__);




/* harmony default export */ __webpack_exports__["default"] = ({
  components: {
    'toggle-button': __WEBPACK_IMPORTED_MODULE_1__toggleButton_vue___default.a
  },
  props: {
    assign_items: {
      type: Array,
      default: function _default() {
        return [];
      }
    },
    type: {
      type: Number,
      default: function _default() {
        return 1;
      }
    },
    configNote: {
      type: Object,
      default: function _default() {}
    }
  },
  model: {
    prop: 'assign_items'
  },
  data: function data() {
    return {
      data_phancong: [],
      assignedtype_items: {
        '2': [{ text: 'Không có phân công', value: 0 }, { text: 'Thực hiện chính', value: 1 }, { text: 'Thực hiện phối hợp', value: 2 }],
        '3': [{ text: 'Không có phân công', value: 0 }, { text: 'Thực hiện chính', value: 1 }, { text: 'Thực hiện phối hợp', value: 2 }, { text: 'Theo dõi', value: 3 }]
      },
      title_asign: {
        '1': 'PHÂN CÔNG NGƯỜI THỰC HIỆN',
        '2': 'PHÂN CÔNG THỰC HIỆN, PHỐI HỢP',
        '3': 'PHÂN CÔNG THỰC HIỆN, PHỐI HỢP VÀ THEO DÕI'
      },
      presenterAddGroup: true,
      assignValidate: true
    };
  },
  created: function created() {
    var vm = this;
    setTimeout(function () {
      __WEBPACK_IMPORTED_MODULE_0_jquery___default()('.btn-tgl').addClass('btn-hidden');
    }, 200);
  },
  mounted: function mounted() {
    this.data_phancong = this.assign_items;
  },

  methods: {
    changeAssigned: function changeAssigned(event, index) {
      var vm = this;
      if (vm.type === 1) {
        if (event === true) {
          vm.assign_items[index].assigned = 1;
        } else {
          vm.assign_items[index].assigned = 0;
        }
      }
    },
    checkAsign: function checkAsign(event, index) {
      var vm = this;
      if (event) {
        vm.assign_items[index].assigned = 1;
        __WEBPACK_IMPORTED_MODULE_0_jquery___default()('#btn-' + index).removeClass('btn-hidden');
      } else {
        vm.assign_items[index].assigned = 0;
        __WEBPACK_IMPORTED_MODULE_0_jquery___default()('#btn-' + index).addClass('btn-hidden');
      }
    },
    changeTypeAssign: function changeTypeAssign(event, index) {
      var vm = this;
      if (event.value) {
        vm.assign_items[index].assigned = 1;
        __WEBPACK_IMPORTED_MODULE_0_jquery___default()('#btn-' + index).removeClass('btn-hidden');
      } else {
        vm.assign_items[index].assigned = 2;
        __WEBPACK_IMPORTED_MODULE_0_jquery___default()('#btn-' + index).addClass('btn-hidden');
      }
    },
    doExport: function doExport() {
      var vm = this;
      var assign = vm.assign_items.filter(function (item) {
        return Number(item.assigned) > 0;
      });
      if (assign.length === 0) {
        vm.assignValidate = false;
        return vm.assignValidate;
      } else {
        vm.assignValidate = true;
        return vm.assignValidate;
      }
    }
  }
});

/***/ }),

/***/ 675:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });


/* harmony default export */ __webpack_exports__["default"] = ({
  props: {
    detailDossier: {
      type: Object,
      default: function _default() {}
    }
  },
  watch: {
    detailDossier: function detailDossier(val) {
      var vm = this;
      vm.thongTinChiTietHoSo = val;
    }
  },
  components: {},
  data: function data() {
    return {
      thongTinChiTietHoSo: {},
      showContactDetail: false
    };
  },
  computed: {
    loading: function loading() {
      return this.$store.getters.loading;
    },
    originality: function originality() {
      var vm = this;
      return vm.getOriginality();
    }
  },
  created: function created() {
    var vm = this;
    vm.thongTinChiTietHoSo = vm.detailDossier;
  },
  mounted: function mounted() {
    var vm = this;
    vm.thongTinChiTietHoSo = vm.detailDossier;
  },

  methods: {
    initData: function initData(data) {
      var vm = this;
      vm.$store.dispatch('getDetailDossier', data).then(function (resultDossier) {
        vm.thongTinChiTietHoSo = resultDossier;
      });
    },
    goBack: function goBack() {
      window.history.back();
    },
    durationText: function durationText(durationUnit, durationCount) {
      var durationText;
      if (durationUnit === 1 && durationCount > 8) {
        var day = Math.floor(durationCount / 8) + ' ngày';
        var hours = void 0;
        if (durationCount % 8 !== 0) {
          hours = (durationCount / 8 - Math.floor(durationCount / 8)) * 8 + ' giờ';
        } else {
          hours = '';
        }
        durationText = day + ' ' + hours;
      } else if (durationUnit === 0) {
        durationText = durationCount + ' ngày';
      } else if (durationUnit === 1 && durationCount <= 8) {
        durationText = durationCount + ' giờ';
      }
      return durationText;
    }
  },
  filters: {
    dateTimeView: function dateTimeView(arg) {
      if (arg) {
        var value = new Date(arg);
        return value.getDate().toString().padStart(2, '0') + '/' + (value.getMonth() + 1).toString().padStart(2, '0') + '/' + value.getFullYear() + ' | ' + value.getHours().toString().padStart(2, '0') + ':' + value.getMinutes().toString().padStart(2, '0');
      } else {
        return '';
      }
    }
  }
});

/***/ }),

/***/ 676:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });


/* harmony default export */ __webpack_exports__["default"] = ({
  props: {
    resultFiles: {
      type: Array,
      default: function _default() {
        return [];
      }
    }
  },
  data: function data() {
    return {
      dossierId: '',
      loadingAction: false,
      headers: [{
        text: 'STT',
        align: 'center',
        sortable: false
      }, {
        text: 'Số giấy',
        align: 'center',
        sortable: false
      }, {
        text: 'Ngày cấp',
        align: 'center',
        sortable: false
      }, {
        text: 'Tên giấy tờ',
        align: 'center',
        sortable: false
      }]
    };
  },
  computed: {
    loading: function loading() {
      return this.$store.getters.loading;
    }
  },
  created: function created() {
    var vm = this;
    vm.$nextTick(function () {});
  },

  methods: {},
  filters: {
    dateTimeView: function dateTimeView(arg) {
      if (arg) {
        var value = new Date(arg);
        return value.getDate().toString().padStart(2, '0') + '/' + (value.getMonth() + 1).toString().padStart(2, '0') + '/' + value.getFullYear();
      } else {
        return '';
      }
    },
    filterFileResult: function filterFileResult(arg) {
      if (arg.length > 0) {
        var resultFilter = [];
        resultFilter = arg.filter(function (val, index) {
          return val.dossierPartType === 2 && val.eForm === false;
        });
        return resultFilter;
      }
    }
  }
});

/***/ }),

/***/ 677:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });


/* harmony default export */ __webpack_exports__["default"] = ({
  props: {
    user_note: {
      type: Number,
      required: true
    },
    configNote: {
      type: Object,
      required: false
    }
  },
  data: function data() {
    return {
      noteYkien: '',
      valid: false
    };
  },
  methods: {
    initData: function initData(data) {
      var vm = this;
      vm.$store.dispatch('getDetailDossier', data).then(function (resultDossier) {
        vm.thongTinChiTietHoSo = resultDossier;
      });
    },
    doExport: function doExport() {
      var vm = this;
      var exportData = {
        text: vm.noteYkien,
        valid: vm.$refs.userNoteForm.validate()
      };
      return exportData;
    }
  }
});

/***/ }),

/***/ 678:
/***/ (function(module, exports, __webpack_require__) {

module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('v-expansion-panel', {
    staticClass: "expansion-pl ext__form"
  }, [_c('v-expansion-panel-content', {
    attrs: {
      "hide-actions": "",
      "value": "1"
    }
  }, [_c('div', {
    attrs: {
      "slot": "header"
    },
    slot: "header"
  }, [_c('div', {
    staticClass: "background-triangle-small"
  }, [_c('v-icon', {
    attrs: {
      "size": "18",
      "color": "white"
    }
  }, [_vm._v("star_rate")])], 1), _vm._v("Thông tin chung hồ sơ")]), _vm._v(" "), _c('v-card', [_c('v-card-text', {
    staticClass: "py-0"
  }, [_c('v-layout', {
    staticClass: "px-2 py-2",
    attrs: {
      "wrap": ""
    }
  }, [(_vm.originality !== 1) ? _c('v-flex', {
    staticClass: "pr-3",
    attrs: {
      "xs12": "",
      "sm4": ""
    }
  }, [_c('div', {
    staticClass: "xs12 sm12 pb-1"
  }, [_c('span', {
    staticClass: "pr-2"
  }, [_vm._v("Chủ hồ sơ: ")]), _vm._v(" "), _c('span', {
    staticClass: "pl-0 text-bold"
  }, [_vm._v(" " + _vm._s(_vm.thongTinChiTietHoSo.applicantName))])]), _vm._v(" "), _c('div', {
    staticClass: "xs12 sm12 pb-1 overHidden"
  }, [_c('span', {
    staticClass: "pr-2"
  }, [_vm._v("Địa chỉ: ")]), _vm._v(" "), _c('v-tooltip', {
    attrs: {
      "top": ""
    }
  }, [_c('span', {
    staticClass: "text-bold ",
    attrs: {
      "slot": "activator"
    },
    slot: "activator"
  }, [_vm._v(_vm._s(_vm.thongTinChiTietHoSo.address) + " " + _vm._s(_vm.thongTinChiTietHoSo.wardName) + ", " + _vm._s(_vm.thongTinChiTietHoSo.districtName) + ", " + _vm._s(_vm.thongTinChiTietHoSo.cityName))]), _vm._v(" "), _c('span', {
    staticClass: "pl-0"
  }, [_vm._v(" " + _vm._s(_vm.thongTinChiTietHoSo.address) + " " + _vm._s(_vm.thongTinChiTietHoSo.wardName) + ", " + _vm._s(_vm.thongTinChiTietHoSo.districtName) + ", " + _vm._s(_vm.thongTinChiTietHoSo.cityName))])])], 1), _vm._v(" "), _c('div', {
    staticClass: "xs12 sm12 pb-1"
  }, [_c('span', {
    staticClass: "pl-0"
  }, [_vm._v("Thư điện tử: ")]), _vm._v(" "), _c('span', {
    staticClass: "pl-0 text-bold "
  }, [_vm._v(" " + _vm._s(_vm.thongTinChiTietHoSo.contactEmail) + " ")])]), _vm._v(" "), _c('div', {
    staticClass: "xs12 sm12 pb-1"
  }, [_c('span', {
    staticClass: "pr-2"
  }, [_vm._v("Điện thoại: ")]), _vm._v(" "), _c('span', {
    staticClass: "pl-0 text-bold "
  }, [_vm._v(" " + _vm._s(_vm.thongTinChiTietHoSo.contactTelNo) + " ")])])]) : _vm._e(), _vm._v(" "), (_vm.originality === 1) ? _c('v-flex', {
    staticClass: "pr-3",
    attrs: {
      "xs12": "",
      "sm4": ""
    }
  }, [_c('div', {
    staticClass: "xs12 sm12 pb-1"
  }, [_c('span', {
    staticClass: "pr-2"
  }, [_vm._v("Mã hồ sơ: ")]), _vm._v(" "), _c('span', {
    staticClass: "pl-0 text-bold "
  }, [_vm._v("  " + _vm._s(_vm.thongTinChiTietHoSo.dossierNo) + " ")])]), _vm._v(" "), _c('div', {
    staticClass: "xs12 sm12 pb-1"
  }, [_c('span', {
    staticClass: "pr-2"
  }, [_vm._v("Cơ quan: ")]), _vm._v(" "), _c('span', {
    staticClass: "pl-0 text-bold "
  }, [_vm._v("  " + _vm._s(_vm.thongTinChiTietHoSo.govAgencyName) + " ")])]), _vm._v(" "), _c('div', {
    staticClass: "xs12 sm12 pb-1"
  }, [_c('span', {
    staticClass: "pr-2"
  }, [_vm._v("Trạng thái: ")]), _vm._v(" "), _c('span', {
    staticClass: "pl-0 text-bold "
  }, [_vm._v(" " + _vm._s(_vm.thongTinChiTietHoSo.dossierStatusText) + " ")])])]) : _vm._e(), _vm._v(" "), (_vm.originality !== 1) ? _c('v-flex', {
    attrs: {
      "xs12": "",
      "sm4": ""
    }
  }, [_c('div', {
    staticClass: "xs12 sm12 pb-1"
  }, [_c('span', {
    staticClass: "pr-2"
  }, [_vm._v("Ngày gửi trực tuyến: ")]), _vm._v(" "), (_vm.thongTinChiTietHoSo.online) ? _c('span', {
    staticClass: "pl-0 text-bold"
  }, [_vm._v(" " + _vm._s(_vm.thongTinChiTietHoSo.submitDate) + " ")]) : _c('span', {
    staticClass: "pl-0 text-bold"
  }, [_vm._v(" Một cửa ")])]), _vm._v(" "), _c('div', {
    staticClass: "xs12 sm12 pb-1"
  }, [_c('span', {
    staticClass: "pr-2"
  }, [_vm._v("Ngày tiếp nhận: ")]), _vm._v(" "), _c('span', {
    staticClass: "pl-0 text-bold "
  }, [_vm._v(" " + _vm._s(_vm.thongTinChiTietHoSo.receiveDate))])]), _vm._v(" "), _c('div', {
    staticClass: "xs12 sm12 pb-1"
  }, [_c('span', {
    staticClass: "pr-2"
  }, [_vm._v("Thời hạn giải quyết: ")]), _vm._v(" "), (_vm.thongTinChiTietHoSo.durationCount > 0) ? _c('span', {
    staticClass: "pl-0 text-bold "
  }, [_vm._v(" \n                " + _vm._s(_vm.durationText(_vm.thongTinChiTietHoSo.durationUnit, _vm.thongTinChiTietHoSo.durationCount)) + " làm việc \n              ")]) : _c('span', {
    staticClass: "pl-0 text-bold "
  }, [_vm._v("\n                Không quy định\n              ")])]), _vm._v(" "), _c('div', {
    staticClass: "xs12 sm12 pb-1"
  }, [_c('span', {
    staticClass: "pr-2"
  }, [_vm._v("Ngày hẹn trả: ")]), _vm._v(" "), _c('span', {
    staticClass: "pl-0 text-bold "
  }, [_vm._v(" " + _vm._s(_vm.thongTinChiTietHoSo.dueDate))])])]) : _c('v-flex', {
    attrs: {
      "xs12": "",
      "sm4": ""
    }
  }, [_c('div', {
    staticClass: "xs12 sm12 pb-1"
  }, [_c('span', {
    staticClass: "pr-2"
  }, [_vm._v("Ngày gửi: ")]), _vm._v(" "), (_vm.thongTinChiTietHoSo.online) ? _c('span', {
    staticClass: "pl-0 text-bold"
  }, [_vm._v(" " + _vm._s(_vm.thongTinChiTietHoSo.submitDate) + " ")]) : _c('span', {
    staticClass: "pl-0 text-bold"
  }, [_vm._v(" Một cửa ")])]), _vm._v(" "), _c('div', {
    staticClass: "xs12 sm12 pb-1"
  }, [_c('span', {
    staticClass: "pr-2"
  }, [_vm._v("Ngày tiếp nhận: ")]), _vm._v(" "), _c('span', {
    staticClass: "pl-0 text-bold "
  }, [_vm._v(" " + _vm._s(_vm.thongTinChiTietHoSo.receiveDate))])]), _vm._v(" "), _c('div', {
    staticClass: "xs12 sm12 pb-1"
  }, [_c('span', {
    staticClass: "pr-2"
  }, [_vm._v("Ngày hẹn trả: ")]), _vm._v(" "), _c('span', {
    staticClass: "pl-0 text-bold "
  }, [_vm._v(" " + _vm._s(_vm.thongTinChiTietHoSo.dueDate))])])]), _vm._v(" "), (_vm.originality !== 1) ? _c('v-flex', {
    attrs: {
      "xs12": "",
      "sm4": ""
    }
  }, [_c('div', {
    staticClass: "xs12 sm12 pb-1"
  }, [_c('span', {
    staticClass: "pr-2"
  }, [_vm._v("Mã hồ sơ: ")]), _vm._v(" "), _c('span', {
    staticClass: "pl-0 text-bold "
  }, [_vm._v("  " + _vm._s(_vm.thongTinChiTietHoSo.dossierNo) + " ")])]), _vm._v(" "), _c('div', {
    staticClass: "xs12 sm12 pb-1"
  }, [_c('span', {
    staticClass: "pr-2"
  }, [_vm._v("Trạng thái: ")]), _vm._v(" "), _c('span', {
    staticClass: "pl-0 text-bold "
  }, [_vm._v(" " + _vm._s(_vm.thongTinChiTietHoSo.dossierStatusText) + " ")])]), _vm._v(" "), _c('div', {
    staticClass: "xs12 sm12 pb-1 overHidden"
  }, [_c('span', {
    staticClass: "pr-2"
  }, [_vm._v("Nội dung: ")]), _vm._v(" "), (_vm.thongTinChiTietHoSo.briefNote) ? _c('v-tooltip', {
    attrs: {
      "top": ""
    }
  }, [_c('span', {
    staticClass: "text-bold ",
    attrs: {
      "slot": "activator"
    },
    slot: "activator"
  }, [_vm._v(_vm._s(_vm.thongTinChiTietHoSo.briefNote))]), _vm._v(" "), _c('span', {
    staticClass: "pl-0"
  }, [_vm._v(_vm._s(_vm.thongTinChiTietHoSo.briefNote) + " ")])]) : _vm._e()], 1)]) : _c('v-flex', {
    attrs: {
      "xs12": "",
      "sm4": ""
    }
  }, [_c('div', {
    staticClass: "xs12 sm12 pb-1",
    staticStyle: {
      "color": "#0b72ba"
    }
  }, [_vm._v("Ghi chú:")]), _vm._v(" "), (_vm.thongTinChiTietHoSo.dossierNote && _vm.thongTinChiTietHoSo.dossierNote !== 'null') ? _c('div', {
    staticClass: "xs12 sm12 pb-1 overHidden"
  }, [_c('v-tooltip', {
    attrs: {
      "top": ""
    }
  }, [_c('span', {
    staticClass: "text-bold ",
    attrs: {
      "slot": "activator"
    },
    slot: "activator"
  }, [_vm._v(_vm._s(_vm.thongTinChiTietHoSo.dossierNote) + " ")]), _vm._v(" "), _c('span', {
    staticClass: "pl-0"
  }, [_vm._v(" " + _vm._s(_vm.thongTinChiTietHoSo.dossierNote) + " ")])])], 1) : _vm._e(), _vm._v(" "), (_vm.thongTinChiTietHoSo.extendDate) ? _c('div', {
    staticClass: "xs12 sm12 pb-1"
  }, [_c('span', {
    staticClass: "pl-0 text-bold"
  }, [_vm._v("Hẹn lại: " + _vm._s(_vm.thongTinChiTietHoSo.extendDate))])]) : _vm._e()])], 1)], 1)], 1)], 1)], 1)
},staticRenderFns: []}
module.exports.render._withStripped = true
if (false) {
  module.hot.accept()
  if (module.hot.data) {
     require("vue-hot-reload-api").rerender("data-v-02494d10", module.exports)
  }
}

/***/ }),

/***/ 679:
/***/ (function(module, exports, __webpack_require__) {

module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('div', {
    staticClass: "traketqua"
  }, [_c('v-expansion-panel', {
    staticClass: "expansion-pl"
  }, [_c('v-expansion-panel-content', {
    attrs: {
      "hide-actions": "",
      "value": "1"
    }
  }, [_c('div', {
    attrs: {
      "slot": "header"
    },
    slot: "header"
  }, [_c('div', {
    staticClass: "background-triangle-small"
  }, [_c('v-icon', {
    attrs: {
      "size": "18",
      "color": "white"
    }
  }, [_vm._v("star_rate")])], 1), _vm._v("Giấy tờ kết quả\n      ")]), _vm._v(" "), _c('v-card', [_c('v-card-text', [_c('v-data-table', {
    staticClass: "table-bordered",
    attrs: {
      "headers": _vm.headers,
      "items": _vm._f("filterFileResult")(_vm.resultFiles),
      "item-key": "no",
      "hide-actions": "",
      "no-data-text": 'Không có giấy tờ kết quả'
    },
    scopedSlots: _vm._u([{
      key: "headerCell",
      fn: function(props) {
        return [_c('v-tooltip', {
          attrs: {
            "bottom": ""
          }
        }, [_c('span', {
          attrs: {
            "slot": "activator"
          },
          slot: "activator"
        }, [_vm._v("\n                  " + _vm._s(props.header.text) + "\n                ")]), _vm._v(" "), _c('span', [_vm._v("\n                  " + _vm._s(props.header.text) + "\n                ")])])]
      }
    }, {
      key: "items",
      fn: function(props) {
        return [_c('td', {
          staticClass: "text-xs-center",
          staticStyle: {
            "width": "5%"
          }
        }, [_vm._v(" " + _vm._s(props.index + 1) + " ")]), _vm._v(" "), _c('td', {
          staticClass: "text-xs-left",
          staticStyle: {
            "width": "10%"
          }
        }, [_vm._v(" " + _vm._s(props.item.deliverableCode) + " ")]), _vm._v(" "), _c('td', {
          staticClass: "text-xs-left",
          staticStyle: {
            "width": "10%"
          }
        }, [_vm._v(" " + _vm._s(_vm._f("dateTimeView")(props.item.createDate)) + " ")]), _vm._v(" "), _c('td', {
          staticClass: "text-xs-left",
          staticStyle: {
            "width": "75%"
          }
        }, [_vm._v(" " + _vm._s(props.item.displayName) + " ")])]
      }
    }])
  })], 1)], 1)], 1)], 1)], 1)
},staticRenderFns: []}
module.exports.render._withStripped = true
if (false) {
  module.hot.accept()
  if (module.hot.data) {
     require("vue-hot-reload-api").rerender("data-v-5b02061d", module.exports)
  }
}

/***/ }),

/***/ 680:
/***/ (function(module, exports, __webpack_require__) {

module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('div', {
    staticClass: "phancong",
    staticStyle: {
      "background-color": "white",
      "width": "100%"
    }
  }, [_c('v-expansion-panel', {
    staticClass: "expansion-pl"
  }, [_c('v-expansion-panel-content', {
    attrs: {
      "hide-actions": "",
      "value": "1"
    }
  }, [_c('div', {
    attrs: {
      "slot": "header"
    },
    slot: "header"
  }, [_c('div', {
    staticClass: "background-triangle-small"
  }, [_c('v-icon', {
    attrs: {
      "size": "18",
      "color": "white"
    }
  }, [_vm._v("star_rate")])], 1), _vm._v("Chọn người thực hiện\n      ")]), _vm._v(" "), _c('v-card', [(_vm.type === 1) ? _c('v-card-text', {
    staticClass: "py-1"
  }, [_c('v-layout', {
    attrs: {
      "wrap": ""
    }
  }, _vm._l((_vm.data_phancong), function(item, index) {
    return _c('v-checkbox', {
      key: item.userId,
      staticStyle: {
        "display": "inline-block"
      },
      attrs: {
        "slot": "activator",
        "label": item.userName,
        "title": item.userName
      },
      on: {
        "change": function($event) {
          _vm.changeAssigned($event, index)
        }
      },
      slot: "activator",
      model: {
        value: (item.assigned),
        callback: function($$v) {
          _vm.$set(item, "assigned", $$v)
        },
        expression: "item.assigned"
      }
    })
  })), _vm._v(" "), (!_vm.assignValidate) ? _c('span', {
    staticClass: "ml-3",
    staticStyle: {
      "color": "#f44336"
    }
  }, [_vm._v("* Yêu cầu chọn người để thực hiện")]) : _vm._e()], 1) : _c('v-card-text', {
    staticClass: "px-2 py-1"
  }, [_c('v-layout', {
    staticClass: "my-1",
    attrs: {
      "wrap": ""
    }
  }, _vm._l((_vm.data_phancong), function(item, index) {
    return _c('div', {
      key: item.userId,
      staticClass: "ml-3"
    }, [_c('v-layout', {
      attrs: {
        "wrap": ""
      }
    }, [_c('v-tooltip', {
      attrs: {
        "top": ""
      }
    }, [_c('v-checkbox', {
      staticStyle: {
        "min-width": "150px"
      },
      attrs: {
        "slot": "activator",
        "label": item.userName
      },
      on: {
        "change": function($event) {
          _vm.checkAsign($event, index)
        }
      },
      slot: "activator",
      model: {
        value: (item.assigned),
        callback: function($$v) {
          _vm.$set(item, "assigned", $$v)
        },
        expression: "item.assigned"
      }
    }), _vm._v(" "), _c('span', {
      staticClass: "pl-0"
    }, [_vm._v(" " + _vm._s(item.userName) + " ")])], 1), _vm._v(" "), _c('toggle-button', {
      staticClass: "mx-1 btn-tgl",
      attrs: {
        "id": ("btn-" + index),
        "title_checked": "Thực hiện",
        "title_unchecked": "Phối hợp",
        "labels": {
          checked: 'TH',
          unchecked: 'PH'
        },
        "color": {
          checked: '#7DCE94',
          unchecked: '#82C7EB'
        },
        "width": 50
      },
      on: {
        "change": function($event) {
          _vm.changeTypeAssign($event, index)
        }
      },
      model: {
        value: (_vm.presenterAddGroup),
        callback: function($$v) {
          _vm.presenterAddGroup = $$v
        },
        expression: "presenterAddGroup"
      }
    })], 1)], 1)
  })), _vm._v(" "), (!_vm.assignValidate) ? _c('span', {
    staticClass: "ml-3",
    staticStyle: {
      "color": "#f44336"
    }
  }, [_vm._v("* Yêu cầu chọn người để thực hiện")]) : _vm._e()], 1)], 1)], 1)], 1)], 1)
},staticRenderFns: []}
module.exports.render._withStripped = true
if (false) {
  module.hot.accept()
  if (module.hot.data) {
     require("vue-hot-reload-api").rerender("data-v-7cac08a2", module.exports)
  }
}

/***/ }),

/***/ 681:
/***/ (function(module, exports, __webpack_require__) {

module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('v-expansion-panel', {
    staticClass: "expansion-pl ext__form"
  }, [_c('v-expansion-panel-content', {
    attrs: {
      "hide-actions": "",
      "value": "1"
    }
  }, [_c('div', {
    attrs: {
      "slot": "header"
    },
    slot: "header"
  }, [_c('div', {
    staticClass: "background-triangle-small"
  }, [_c('v-icon', {
    attrs: {
      "size": "18",
      "color": "white"
    }
  }, [_vm._v("star_rate")])], 1), _vm._v(" "), _c('span', [_vm._v("Ý kiến cán bộ")]), _vm._v(" "), (_vm.user_note === 2) ? _c('span', {
    staticClass: "red--text text--darken-3"
  }, [_vm._v("*")]) : _vm._e()]), _vm._v(" "), _c('v-card', [_c('v-card-text', {
    staticClass: "py-2 px-2"
  }, [_c('v-layout', {
    attrs: {
      "wrap": ""
    }
  }, [_c('v-flex', {
    attrs: {
      "xs12": ""
    }
  }, [_c('v-form', {
    ref: "userNoteForm",
    model: {
      value: (_vm.valid),
      callback: function($$v) {
        _vm.valid = $$v
      },
      expression: "valid"
    }
  }, [_c('v-text-field', {
    attrs: {
      "multi-line": "",
      "rows": 4,
      "rules": _vm.user_note === 2 ? [function () { return _vm.noteYkien !== '' || 'Trường dữ liệu bắt buộc'; }] : []
    },
    model: {
      value: (_vm.noteYkien),
      callback: function($$v) {
        _vm.noteYkien = $$v
      },
      expression: "noteYkien"
    }
  })], 1)], 1)], 1)], 1)], 1)], 1)], 1)
},staticRenderFns: []}
module.exports.render._withStripped = true
if (false) {
  module.hot.accept()
  if (module.hot.data) {
     require("vue-hot-reload-api").rerender("data-v-ad80357c", module.exports)
  }
}

/***/ }),

/***/ 682:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__ = __webpack_require__(517);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_jquery__ = __webpack_require__(36);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_jquery__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_jquery_textcomplete__ = __webpack_require__(695);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_jquery_textcomplete___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_jquery_textcomplete__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_jquery_comments__ = __webpack_require__(694);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_jquery_comments___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_jquery_comments__);







/* harmony default export */ __webpack_exports__["default"] = ({
  props: ['classPK', 'className'],
  data: function data() {
    return {
      usersComment: [],
      comment: [],
      argShowMore: true,

      checkOpinion: true
    };
  },
  computed: {
    loading: function loading() {
      return this.$store.getters.loading;
    },
    initData: function initData() {
      return this.$store.getters.loadingInitData;
    }
  },
  watch: {
    classPK: function classPK(val) {
      var vm = this;
      vm.$store.dispatch('loadUsersComment', val).then(function (result) {
        vm.usersComment = result;
        vm.initComment();
      }).catch(function (reject) {
        vm.initComment();
      });
    }
  },
  created: function created() {},
  mounted: function mounted() {},

  methods: {
    runComment: function runComment() {
      var vm = this;
      if (vm.classPK) {
        vm.initComment();
      }
    },

    initComment: function initComment() {
      var vm = this;
      __WEBPACK_IMPORTED_MODULE_1_jquery___default()('#comments-container-el').comments({
        profilePictureURL: 'https://png.icons8.com/material/50/000000/guest-male.png',
        textareaRows: 2,
        enableAttachments: true,
        enableHashtags: true,
        enablePinging: true,
        postCommentOnEnter: false,
        forceResponsive: false,
        readOnly: false,
        textareaPlaceholderText: 'Thêm bình luận mới',
        newestText: 'Mới nhất',
        oldestText: 'Cũ nhất',
        popularText: 'Phổ biến',
        attachmentsText: 'Đính kèm',
        sendText: 'Gửi',
        replyText: 'Trả lời',
        editText: 'Sửa',
        editedText: 'Đã sửa',
        youText: 'Bạn',
        saveText: 'Ghi lại',
        deleteText: 'Xóa',

        hideRepliesText: 'Ẩn câu trả lời',
        noCommentsText: 'Không có bình luận nào',
        noAttachmentsText: 'Không có tệp đính kèm',
        attachmentDropText: 'Kéo thả tệp đính kèm',
        fieldMappings: {
          id: 'commentId',
          parent: 'parent',
          userId: 'userId',
          created: 'createdDate',
          modified: 'modifiedDate',
          content: 'content',
          fileURL: 'fileUrl',
          fileMimeType: 'fileType',
          fileName: 'fileName',
          pings: 'pings',
          creator: 'userId',
          fullname: 'fullname',
          profileURL: 'profileUrl',
          profilePictureURL: 'pictureUrl',
          isNew: 'isNew',
          createdByAdmin: 'isAdmin',
          createdByCurrentUser: 'createdByCurrentUser',
          upvoteCount: 'upvoteCount',
          userHasUpvoted: 'userHasUpvoted',
          email: 'email',
          opinion: 'opinion',
          className: 'className',
          classPK: 'classPK'
        },
        timeFormatter: function timeFormatter(time) {
          if (time) {
            var value = new Date(time);
            value.setHours(value.getHours() - 7);
            return value.getDate().toString().padStart(2, '0') + '/' + (value.getMonth() + 1).toString().padStart(2, '0') + '/' + value.getFullYear() + ' ' + value.getHours().toString().padStart(2, '0') + ':' + value.getMinutes().toString().padStart(2, '0');
          } else {
            return '';
          }
        },
        getUsers: function getUsers(onSuccess, onError) {
          onSuccess(vm.usersComment);
        },
        getComments: function getComments(onSuccess, onError) {
          var dataGet = {
            'classPK': vm.classPK,
            'className': vm.className
          };
          var promise = vm.$store.dispatch('loadCommentItems', dataGet);
          promise.then(function (result) {
            var data = [];
            __WEBPACK_IMPORTED_MODULE_1_jquery___default.a.each(result, function (index, item) {
              vm.comment = item;
              vm.formatComment(vm.comment);
              data.push(vm.comment);
            });
            onSuccess(data);
          }).catch(function (reject) {
            onSuccess([]);
            onError();
          });
        },
        postComment: function postComment(data, onSuccess, onError) {
          data.classPK = vm.classPK;
          data.className = vm.className;
          data.opinion = document.getElementById('opinion').checked;
          vm.$store.dispatch('postComment', data).then(function (result) {
            if (result.opinion) {
              __WEBPACK_IMPORTED_MODULE_1_jquery___default()('.opinion').hide();
            }
            document.getElementById('opinion').checked = false;
            vm.comment = result;
            vm.formatComment(vm.comment);
            onSuccess(vm.comment);
          });
        },
        putComment: function putComment(data, onSuccess, onError) {
          data.classPK = vm.classPK;
          data.className = vm.className;
          vm.$store.dispatch('putComment', data).then(function (result) {
            vm.comment = result;
            vm.formatComment(vm.comment);
            onSuccess(vm.comment);
          });
        },
        deleteComment: function deleteComment(data, onSuccess, onError) {
          data.classPK = vm.classPK;
          data.className = vm.className;
          vm.$store.dispatch('deleteComment', data).then(function (result) {
            onSuccess();
          }).catch(function (reject) {
            onError();
          });
        },
        upvoteComment: function upvoteComment(data, onSuccess, onError) {
          data.classPK = vm.classPK;
          data.className = vm.className;
          vm.$store.dispatch('upvoteComment', data).then(function (result) {
            vm.comment = result;
            vm.formatComment(vm.comment);
            onSuccess(vm.comment);
          }).catch(function (reject) {});
        },
        uploadAttachments: function uploadAttachments(comments, onSuccess, onError) {
          var responses = 0;
          var successfulUploads = [];
          var serverResponded = function serverResponded() {
            responses++;
            if (responses === comments.length) {
              if (successfulUploads.length === 0) {
                onError();
              } else {
                onSuccess(successfulUploads);
              }
            }
          };
          __WEBPACK_IMPORTED_MODULE_1_jquery___default()(comments).each(function (index, comment) {
            var formData = new FormData();
            __WEBPACK_IMPORTED_MODULE_1_jquery___default()(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(comment)).each(function (index, key) {
              var value = comment[key];
              if (value) {
                formData.append(key, value);
              }
            });
            formData.append('file', comment.file);
            formData.append('className', vm.className);
            formData.append('classPK', vm.classPK);
            formData.append('parent', comment.parent != null ? comment.parent : 0);
            formData.append('fileName', comment.file.name);
            formData.append('fileType', comment.file.type);
            formData.append('fileSize', comment.file.size);
            formData.append('pings', comment.pings.join());
            formData.append('opinion', document.getElementById('opinion').checked);

            formData.append('email', vm.initData.user.userEmail);
            formData.append('fullname', vm.initData.user.userName);
            formData.append('opinion', document.getElementById('opinion').checked);
            __WEBPACK_IMPORTED_MODULE_1_jquery___default.a.ajax({
              url: vm.initData.commentApi + '/uploads',
              dataType: 'json',
              type: 'POST',
              headers: {
                'groupId': vm.initData.groupId
              },
              data: formData,
              cache: false,
              contentType: false,
              processData: false,
              success: function success(comment) {
                if (comment.opinion) {
                  __WEBPACK_IMPORTED_MODULE_1_jquery___default()('.opinion').hide();
                }
                document.getElementById('opinion').checked = false;
                vm.formatComment(comment);
                successfulUploads.push(vm.comment);
                serverResponded();
                if (comment.opinion) {
                  __WEBPACK_IMPORTED_MODULE_1_jquery___default()('.opinion').hide();
                }
                document.getElementById('opinion').checked = false;
              },
              error: function error(xhr, data) {
                serverResponded();
              }
            });
          });
        }
      });
    },
    formatComment: function formatComment(comment) {
      var vm = this;
      vm.comment = comment;
      if (comment.parent === 0) {
        vm.comment.parent = null;
      }
      if (comment.fileName === '') {
        vm.comment.fileName = null;
      }
      if (comment.fileType === '') {
        vm.comment.fileType = null;
      }
      if (comment.fileUrl === '') {
        vm.comment.fileUrl = null;
      }
      if (comment.pictureUrl === '') {
        vm.comment.pictureUrl = 'https://png.icons8.com/material/50/000000/guest-male.png';
      }
      vm.comment.fullname = comment.fullname;
      vm.comment.opinion = comment.opinion;
      vm.comment.pings = comment.pings.toString().split(',');
      vm.comment.createdDate = vm.comment.createDate;
      vm.comment.modifiedDate = vm.comment.modifiedDate;
    },
    dateTimeView: function dateTimeView(arg) {
      if (arg) {
        var value = new Date(arg);
        return value.getDate().toString().padStart(2, '0') + '/' + (value.getMonth() + 1).toString().padStart(2, '0') + '/' + value.getFullYear() + ' ' + value.getHours().toString().padStart(2, '0') + ':' + value.getMinutes().toString().padStart(2, '0');
      } else {
        return '';
      }
    }
  },
  filters: {
    dateTimeView: function dateTimeView(arg) {
      if (arg) {
        var value = new Date(arg);
        return value.getDate().toString().padStart(2, '0') + '/' + (value.getMonth() + 1).toString().padStart(2, '0') + '/' + value.getFullYear() + '  ' + value.getHours().toString().padStart(2, '0') + ':' + value.getMinutes().toString().padStart(2, '0');
      } else {
        return '';
      }
    }
  }
});

/***/ }),

/***/ 683:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });


/* harmony default export */ __webpack_exports__["default"] = ({
  props: {
    dossier_id: {
      type: Number
    },
    action_id: {
      type: Number
    }
  },
  data: function data() {
    return {
      itemId: null,
      fieldNameID: '',
      date: null,
      dialog: false,
      formBuilder: [],
      rulesValid: {
        number: function number(value) {
          var pattern = /^\d+$/;
          return pattern.test(value) || 'Kiểu dữ liệu sai định dạng.';
        }
      }
    };
  },
  created: function created() {
    var vm = this;
    vm.$nextTick(function () {
      var filter = {
        dossierId: vm.dossier_id,
        actionId: vm.action_id
      };
      vm.$store.dispatch('getExtraForm', filter).then(function (result) {
        vm.formBuilder = result;
      });
    });
  },

  methods: {
    openDialogCustom: function openDialogCustom(item, fieldName) {
      var vm = this;
      vm.dialog = true;
      vm.fieldNameID = fieldName;
      vm.itemId = item;
    },
    pickDateCustom: function pickDateCustom() {
      var vm = this;

      vm.itemId.value = vm.dateTimeView(vm.date);
      vm.dialog = false;
    },
    inputChangeValue: function inputChangeValue(item) {
      var vm = this;
      item.value = document.getElementById(item.fieldName).value;
    },
    dateTimeView: function dateTimeView(arg) {
      if (arg) {
        var value = new Date(arg);
        return value.getDate().toString().padStart(2, '0') + '/' + (value.getMonth() + 1).toString().padStart(2, '0') + '/' + value.getFullYear();
      } else {
        return '';
      }
    },
    formSubmitData: function formSubmitData() {
      var vm = this;
      var objectReturn = {};
      for (var key in vm.formBuilder) {
        objectReturn[vm.formBuilder[key].fieldName] = vm.formBuilder[key].value;
      }
      return objectReturn;
    }
  }
});

/***/ }),

/***/ 684:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery__ = __webpack_require__(36);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_jquery__);



/* harmony default export */ __webpack_exports__["default"] = ({
  props: {
    detailDossier: {}
  },
  data: function data() {
    return {
      tabActive: 'tabs-1',
      activeKS: true,
      noteReason: '',
      thongTinHoSo: {}
    };
  },
  created: function created() {},
  mounted: function mounted() {},

  methods: {
    changeActive: function changeActive() {
      var vm = this;
    },
    doExport: function doExport() {
      var vm = this;
      var exportData = {
        textValue: vm.noteReason,
        useKS: vm.activeKS
      };
      return exportData;
    }
  }
});

/***/ }),

/***/ 685:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery__ = __webpack_require__(36);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_jquery__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_toastr__ = __webpack_require__(141);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_toastr___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_toastr__);




/* harmony default export */ __webpack_exports__["default"] = ({
  props: {
    id: {
      type: String,
      default: function _default() {
        return 'nm';
      }
    },
    detailDossier: {
      type: Object,
      default: function _default() {}
    },
    createFiles: {
      type: Array,
      default: function _default() {
        return [];
      }
    }
  },
  data: function data() {
    return {
      dossierTemplateItems: [],
      dossierMarksItems: [],
      dossierFilesItems: [],
      thongTinHoSo: {},
      valid: true,
      stateView: false,
      dialogAddOtherTemp: false,
      loadingAddOther: false,
      otherDossierTemplate: '',
      sheet: false,
      partView: '',
      dossierFileIdView: '',
      stateEdit: false,
      progressUploadPart: '',
      dialogPDF: false,
      dialogPDFLoading: true,
      stateAddFileOther: false,
      dossierTemplatesItemSelect: {},
      fileViews: [],
      sampleCount: 0,
      fileTemplateItems: []
    };
  },
  computed: {
    loading: function loading() {
      return this.$store.getters.loading;
    },
    originality: function originality() {
      var vm = this;
      return vm.getOriginality();
    },
    initDataResource: function initDataResource() {
      return this.$store.getters.loadingInitData;
    }
  },
  created: function created() {
    var vm = this;
    vm.page = 1;
    vm.$nextTick(function () {
      if (vm.detailDossier['dossierId']) {
        vm.$store.dispatch('loadDossierFiles', vm.detailDossier.dossierId).then(function (resFiles) {
          vm.dossierFilesItems = resFiles;
          vm.createFiles = vm.mergeDossierTemplateVsDossierFiles(vm.createFiles, resFiles);
        }).catch(function (reject) {});
      }
    });
  },
  mounted: function mounted() {
    var vm = this;
    vm.$nextTick(function () {
      if (vm.createFiles.length > 0) {
        setTimeout(function () {
          vm.genAllAlpacaForm(vm.dossierFilesItems, vm.createFiles);
        }, 300);
      }
    });
  },

  methods: {
    genAllAlpacaForm: function genAllAlpacaForm(dossierFiles, createFiles) {
      var vm = this;
      if (dossierFiles.length > 0) {
        var dossierFilesEform = dossierFiles.filter(function (file) {
          return file.eForm;
        });
        var dossierTemplatesHasForm = createFiles.filter(function (template) {
          return template.eForm;
        });
        if (dossierFilesEform.length > 0) {
          dossierFilesEform.forEach(function (itemFiles) {
            if (itemFiles.eForm) {
              vm.$store.dispatch('loadAlpcaForm', itemFiles);
            }
          });
        } else {
          createFiles.forEach(function (val) {
            if (val.eForm) {
              val['templateFileNo'] = vm.detailDossier.dossierTemplateNo;
              vm.showAlpacaJSFORM(val);
            }
          });
        }
        if (dossierTemplatesHasForm.length !== dossierFilesEform.length) {
          dossierTemplatesHasForm.forEach(function (template) {
            var indexFromFile = dossierFilesEform.findIndex(function (item) {
              return template.partNo === item.dossierPartNo;
            });
            if (indexFromFile === -1) {
              template['templateFileNo'] = vm.detailDossier.dossierTemplateNo;
              vm.showAlpacaJSFORM(template);
            }
          });
        }
      } else {
        createFiles.forEach(function (val) {
          if (val.eForm) {
            val['templateFileNo'] = vm.detailDossier.dossierTemplateNo;
            vm.showAlpacaJSFORM(val);
          }
        });
      }
    },
    mergeDossierTemplateVsDossierFiles: function mergeDossierTemplateVsDossierFiles(createFiles, dossierFiles) {
      var vm = this;
      if (dossierFiles.length !== 0) {
        createFiles.forEach(function (template) {
          var itemFind = dossierFiles.find(function (file) {
            return template.partNo === file.dossierPartNo && file.eForm;
          });
          if (itemFind) {
            template['daKhai'] = true;
          } else if (!itemFind && template.eForm) {
            template['daKhai'] = false;
          }
        });
      } else {
        createFiles.forEach(function (template) {
          if (template.eForm) {
            template['daKhai'] = false;
          }
        });
      }
      return createFiles;
    },
    showAlpacaJSFORM: function showAlpacaJSFORM(item) {
      var vm = this;
      item['dossierId'] = vm.detailDossier.dossierId;
      vm.$store.dispatch('loadFormScript', item).then(function (resScript) {
        vm.$store.dispatch('loadFormData', item).then(function (resData) {
          __WEBPACK_IMPORTED_MODULE_0_jquery___default()('#formAlpaca' + item.partNo + vm.id).empty();
          var formScript, formData;

          if (resScript) {
            formScript = eval('(' + resScript + ')');
          } else {
            formScript = {};
          }
          if (resData) {
            formData = eval('(' + resData + ')');
          } else {
            formData = {};
          }

          formScript.data = formData;
          __WEBPACK_IMPORTED_MODULE_0_jquery___default()('#formAlpaca' + item.partNo + vm.id).alpaca(formScript);
        });
      });
    },
    saveAlpacaForm: function saveAlpacaForm(item, index) {
      var vm = this;
      var fileFind = vm.dossierFilesItems.find(function (itemFile) {
        return itemFile.dossierPartNo === item.partNo && itemFile.eForm;
      });
      if (fileFind) {
        fileFind['dossierId'] = vm.detailDossier.dossierId;
        fileFind['id'] = vm.id;
        vm.$store.dispatch('putAlpacaForm', fileFind).then(function (resData) {}).catch(function (reject) {
          __WEBPACK_IMPORTED_MODULE_1_toastr___default.a.error('Yêu cầu của bạn được thực hiện thất bại.');
        });
      } else {
        item['dossierId'] = vm.detailDossier.dossierId;
        item['id'] = vm.id;
        vm.$store.dispatch('postEform', item).then(function (resPostEform) {
          vm.createFiles[index].daKhai = true;
          vm.$store.dispatch('loadDossierFiles', vm.detailDossier.dossierId).then(function (resFiles) {
            vm.dossierFilesItems = resFiles;
          }).catch(function (reject) {
            __WEBPACK_IMPORTED_MODULE_1_toastr___default.a.error('Yêu cầu của bạn được thực hiện thất bại.');
          });
        }).catch(function (reject) {
          __WEBPACK_IMPORTED_MODULE_1_toastr___default.a.error('Yêu cầu của bạn được thực hiện thất bại.');
        });
      }
    },
    onDeleteAttackFiles: function onDeleteAttackFiles(item) {
      var vm = this;

      var x = confirm('Bạn có muốn xóa toàn bộ file trong thành phần hồ sơ này?');
      if (x) {
        vm.dossierFilesItems.forEach(function (val) {
          if (val.dossierPartNo === item.partNo) {
            val['dossierId'] = vm.detailDossier.dossierId;
            vm.$store.dispatch('deleteAttackFiles', val).then(function (result) {
              vm.$store.dispatch('loadDossierFiles', vm.detailDossier.dossierId);
            }).catch(function (xhr) {});
          }
        });
      }
    },
    pickFile: function pickFile(item) {
      var vm = this;
      vm.stateAddFileOther = false;
      document.getElementById('file' + item.partNo).click();
    },
    onUploadSingleFile: function onUploadSingleFile(e, data) {
      var vm = this;
      vm.dossierTemplatesItemSelect = data;
      vm.progressUploadPart = data.partNo;
      data['dossierId'] = vm.detailDossier.dossierId;
      data['dossierTemplateNo'] = vm.detailDossier.dossierTemplateNo;
      vm.$store.dispatch('uploadSingleFile', data).then(function (result) {
        vm.progressUploadPart = '';
        vm.$store.dispatch('loadDossierFiles', vm.detailDossier.dossierId).then(function (result) {
          vm.dossierFilesItems = result;
        });
      }).catch(function (xhr) {
        vm.progressUploadPart = '';
      });
    },
    loadAlpcaForm: function loadAlpcaForm(data) {
      var vm = this;
      var fileFind = vm.dossierFilesItems.find(function (itemFile) {
        return itemFile.dossierPartNo === data.partNo && itemFile.eForm;
      });
      if (fileFind) {
        fileFind['id'] = vm.id;
        vm.$store.dispatch('loadAlpcaForm', fileFind);
      } else {
        vm.createFiles.forEach(function (val) {
          if (val.eForm && data.partNo === val.partNo) {
            val['templateFileNo'] = vm.detailDossier.dossierTemplateNo;
            vm.showAlpacaJSFORM(val);
          }
        });
      }
    },
    deleteSingleFileEform: function deleteSingleFileEform(item, index) {
      var vm = this;
      var x = confirm('Bạn có muốn xóa?');
      if (x) {
        vm.dossierFilesItems.forEach(function (file) {
          if (file.dossierPartNo === item.partNo && file.eForm) {
            file['dossierId'] = vm.detailDossier.dossierId;
            vm.$store.dispatch('deleteDossierFile', file).then(function (resFile) {
              vm.$store.dispatch('loadDossierFiles', vm.detailDossier.dossierId).then(function (result) {
                vm.dossierFilesItems = result;
                var fileViewsTemp = vm.dossierFilesItems.filter(function (file) {
                  return file.dossierPartNo === item.partNo && !file.eForm;
                });
                if (fileViewsTemp) {
                  vm.fileViews = fileViewsTemp;
                }
              });
            });
          }
        });
        vm.createFiles[index].daKhai = false;
      }
    },
    previewFileEfom: function previewFileEfom(item, index) {
      var vm = this;
      vm.dossierFilesItems.forEach(function (file) {
        if (file.dossierPartNo === item.partNo && file.eForm) {
          file['dossierId'] = vm.detailDossier.dossierId;
          vm.dialogPDFLoading = true;
          vm.dialogPDF = true;
          file['id'] = vm.id;
          vm.$store.dispatch('putAlpacaForm', file).then(function (resData) {
            setTimeout(function () {
              vm.$store.dispatch('viewFile', file).then(function (result) {
                vm.dialogPDFLoading = false;
                document.getElementById('dialogPDFPreview' + vm.id).src = result;
              });
            }, 1000);
          }).catch(function (reject) {
            __WEBPACK_IMPORTED_MODULE_1_toastr___default.a.error('Yêu cầu của bạn được thực hiện thất bại.');
          });
        }
      });
    },
    deleteSingleFile: function deleteSingleFile(item, index) {
      var vm = this;
      var x = confirm('Bạn có muốn xóa?');
      if (x) {
        item['dossierId'] = vm.detailDossier.dossierId;
        vm.$store.dispatch('deleteDossierFile', item).then(function (resFile) {
          vm.fileViews.splice(index, 1);
          vm.partView = item.dossierPartNo;
          vm.$store.dispatch('loadDossierFiles', vm.detailDossier.dossierId).then(function (result) {
            vm.dossierFilesItems = result;
          });
        }).catch(function (reject) {
          __WEBPACK_IMPORTED_MODULE_1_toastr___default.a.error('Yêu cầu của bạn được thực hiện thất bại.');
        });
      }
    },
    viewFile: function viewFile(data) {
      var _this = this;

      var vm = this;
      vm.dossierFilesItems.forEach(function (val) {
        val['dossierId'] = vm.detailDossier.dossierId;
        if (val.dossierPartNo === data.partNo) {
          _this.$store.dispatch('viewFile', val);
        }
      });
    },
    viewFile2: function viewFile2(data) {
      var vm = this;
      if (data.fileType === 'doc' || data.fileType === 'docx' || data.fileType === 'xlsx' || data.fileType === 'xls' || data.fileType === 'zip' || data.fileType === 'rar') {
        var url = vm.initDataResource.dossierApi + '/' + vm.detailDossier.dossierId + '/files/' + data.referenceUid;
        window.open(url);
      } else {
        vm.dialogPDFLoading = true;
        vm.dialogPDF = true;
        data['dossierId'] = vm.detailDossier.dossierId;
        vm.$store.dispatch('viewFile', data).then(function (result) {
          vm.dialogPDFLoading = false;
          document.getElementById('dialogPDFPreview' + vm.id).src = result;
        });
      }
    },
    viewFileWithPartNo: function viewFileWithPartNo(item) {
      var vm = this;
      if (vm.dossierFilesItems) {
        var fileViewsTemp = vm.dossierFilesItems.filter(function (file) {
          return file.dossierPartNo === item.partNo && !file.eForm;
        });
        if (fileViewsTemp) {
          vm.fileViews = fileViewsTemp;
          if (vm.partView !== item.partNo) {
            vm.stateView = true;
            vm.partView = item.partNo;
          } else {
            vm.stateView = !vm.stateView;
            vm.partView = item.partNo;
          }
        } else {
          return;
        }
      }
      return;
    },
    checkStyle: function checkStyle(item) {
      return 'calc(100% - ' + 50 + 'px)';
    },
    downloadFileTemplate: function downloadFileTemplate(item, index) {
      var vm = this;
      if (vm.fileTemplateItems.length > 0) {
        var fileFind = vm.fileTemplateItems.find(function (file) {
          return item.fileTemplateNo === file.fileTemplateNo;
        });
        if (fileFind) {
          var url = vm.initDataResource.serviceInfoApi + '/' + fileFind.serviceCode + '/filetemplates/' + fileFind.fileTemplateNo;
          window.open(url);
        } else {}
      }
    },
    cancelDialog: function cancelDialog() {
      var vm = this;
      vm.dialogAddOtherTemp = false;
      vm.progressUploadPart = '';
    },
    addFileOther: function addFileOther(item) {
      var vm = this;
      vm.dialogAddOtherTemp = true;
      vm.stateAddFileOther = true;
      vm.dossierTemplatesItemSelect = item;
    },
    changeDisplayName: function changeDisplayName(item, index) {
      var vm = this;
      var params = {
        dossierId: vm.detailDossier.dossierId,
        value: value
      };
      vm.$store.dispatch('changeDisplayNameFile', params).then(function (result) {
        vm.fileViews[index].displayName = result.displayName;
        vm.stateEdit = false;
      }).catch(function (reject) {});
    }
  }
});

/***/ }),

/***/ 694:
/***/ (function(module, exports, __webpack_require__) {

/* WEBPACK VAR INJECTION */(function(jQuery) {var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;/* eslint-disable */

(function (factory) {
	if (true) {
		// AMD. Register as an anonymous module.
		!(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(36)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),
				__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
				(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
	} else if (typeof module === 'object' && module.exports) {
		// Node/CommonJS
		module.exports = function(root, jQuery) {
			if (jQuery === undefined) {
				// require('jQuery') returns a factory that requires window to
				// build a jQuery instance, we normalize how we use modules
				// that require this pattern but the window provided is a noop
				// if it's defined (how jquery works)
				if (typeof window !== 'undefined') {
					jQuery = require('jquery');
				}
				else {
					jQuery = require('jquery')(root);
				}
			}
			factory(jQuery);
			return jQuery;
		};
	} else {
		// Browser globals
		factory(jQuery);
	}
}(function($) {

	var Comments = {
		// Instance variables
		$el: null,
		commentsById: {},
		usersById: {},
		dataFetched: false,
		currentSortKey: '',
		options: {},
		events: {
			// Close dropdowns
			'click': 'closeDropdowns',
			// Save comment on keydown
			'keydown [contenteditable]' : 'saveOnKeydown',
			// Listening changes in contenteditable fields (due to input event not working with IE)
			'focus [contenteditable]' : 'saveEditableContent',
			'keyup [contenteditable]' : 'checkEditableContentForChange',
			'paste [contenteditable]' : 'checkEditableContentForChange',
			'input [contenteditable]' : 'checkEditableContentForChange',
			'blur [contenteditable]' : 'checkEditableContentForChange',
			// Navigation
			'click .navigation li[data-sort-key]' : 'navigationElementClicked',
			'click .navigation li.title' : 'toggleNavigationDropdown',
			// Main comenting field
			'click .commenting-field.main .textarea': 'showMainCommentingField',
			'click .commenting-field.main .close' : 'hideMainCommentingField',
			// All commenting fields
			'click .commenting-field .textarea' : 'increaseTextareaHeight',
			'change .commenting-field .textarea' : 'increaseTextareaHeight textareaContentChanged',
			'click .commenting-field:not(.main) .close' : 'removeCommentingField',
			// Edit mode actions
			'click .commenting-field .send.enabled' : 'postComment',
			'click .commenting-field .update.enabled' : 'putComment',
			'click .commenting-field .delete.enabled' : 'deleteComment',
			'change .commenting-field .upload.enabled input[type="file"]' : 'fileInputChanged',
			// Other actions
			'click li.comment button.upvote' : 'upvoteComment',
			'click li.comment button.delete.enabled' : 'deleteComment',
			'click li.comment .hashtag' : 'hashtagClicked',
			'click li.comment .ping' : 'pingClicked',
			// Other
			'click li.comment ul.child-comments .toggle-all': 'toggleReplies',
			'click li.comment button.reply': 'replyButtonClicked',
			'click li.comment button.edit': 'editButtonClicked',
			// Drag & dropping attachments
			'dragenter' : 'showDroppableOverlay',
			'dragenter .droppable-overlay' : 'handleDragEnter',
			'dragleave .droppable-overlay' : 'handleDragLeaveForOverlay',
			'dragenter .droppable-overlay .droppable' : 'handleDragEnter',
			'dragleave .droppable-overlay .droppable' : 'handleDragLeaveForDroppable',
			'dragover .droppable-overlay' : 'handleDragOverForOverlay',
			'drop .droppable-overlay' : 'handleDrop',
			// Prevent propagating the click event into buttons under the autocomplete dropdown
			'click .dropdown.autocomplete': 'stopPropagation',
			'mousedown .dropdown.autocomplete': 'stopPropagation',
			'touchstart .dropdown.autocomplete': 'stopPropagation',
		},
		// Default options

		getDefaultOptions: function() {
			return {
				// User        
				profilePictureURL: '',
				currentUserIsAdmin: false,
				currentUserId: null,
				// Font awesome icon overrides        
				spinnerIconURL: '',
				upvoteIconURL: '',
				replyIconURL: '',
				uploadIconURL: '',
				attachmentIconURL: '',
				fileIconURL: '',
				noCommentsIconURL: '',
				noCommentsImptIconURL: '',
				// Strings to be formatted (for example localization)     
				textareaPlaceholderText: 'Thêm bình luận mới',
				newestText: 'Mới nhất',
				oldestText: 'Cũ nhất',
				importantCmtText: 'Ý kiến chính thức',
				popularText: 'Phổ biến',
				attachmentsText: 'Tệp đính kèm',
				sendText: 'Gửi',
				replyText: 'Trả lời',
				editText: 'Sửa',
				editedText: 'Đã sửa',
				youText: 'You',
				saveText: 'Ghi lại',
				deleteText: 'Xoá',
				newText: 'Mới',
				viewAllRepliesText: 'Xem tất cả __replyCount__ trả lời',
				hideRepliesText: 'Hide replies',
				noCommentsText: 'Không có bình luận',
				noCommentsImportantText: 'Không có ý kiến chính thức',
				noAttachmentsText: 'Không có tệp đính kèm',
				attachmentDropText: 'Kéo thả tệp để tải lên',
				textFormatter: function(text) {return text},
				
				// Functionalities        
				enableReplying: true,
				enableEditing: true,
				enableUpvoting: true,
				enableDeleting: true,
				enableAttachments: false,
				enableHashtags: false,
				enablePinging: false,
				enableDeletingCommentWithReplies: false,
				enableNavigation: true,
				postCommentOnEnter: false,
				forceResponsive: false,
				readOnly: false,
				defaultNavigationSortKey: 'newest',
				// Colors     
				highlightColor: '#2793e6',
				deleteButtonColor: '#C9302C',
				scrollContainer: this.$el,
				roundProfilePictures: false,
				textareaRows: 2,
				textareaRowsOnFocus: 2,
				textareaMaxRows: 5,
				maxRepliesVisible: 2,
				
				fieldMappings: {
					id: 'id',
					parent: 'parent',
					created: 'createdDate',
					modified: 'modifiedDate',
					content: 'content',
					file: 'file',
					fileURL: 'file_url',
					fileMimeType: 'file_mime_type',
					pings: 'pings',
					creator: 'creator',
					fullname: 'fullname',
					profileURL: 'profile_url',
					profilePictureURL: 'profile_picture_url',
					isNew: 'is_new',
					createdByAdmin: 'created_by_admin',
					createdByCurrentUser: 'created_by_current_user',
					upvoteCount: 'upvote_count',
					userHasUpvoted: 'user_has_upvoted'
				},
				
				getUsers: function(success, error) {success([])},
				getComments: function(success, error) {success([])},
				postComment: function(commentJSON, success, error) {success(commentJSON)},
				putComment: function(commentJSON, success, error) {success(commentJSON)},
				deleteComment: function(commentJSON, success, error) {success()},
				upvoteComment: function(commentJSON, success, error) {success(commentJSON)},
				hashtagClicked: function(hashtag) {},
				pingClicked: function(userId) {},
				uploadAttachments: function(commentArray, success, error) {success(commentArray)},
				refresh: function() {},
				timeFormatter: function(time) {return new Date(time).toLocaleDateString()},
				appendNewComments: function(commentJSONs, success, error) {success([])}
			}
		},

		// Initialization
		init: function(options, el) {
			this.$el = $(el);
			this.$el.addClass('jquery-comments');
			this.undelegateEvents();
			this.delegateEvents();
			// Detect mobile devices
			(function(a){(jQuery.browser=jQuery.browser||{}).mobile=/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4))})(navigator.userAgent||navigator.vendor||window.opera);
			if($.browser.mobile) this.$el.addClass('mobile');
			// Init options
			this.options = $.extend(true, {}, this.getDefaultOptions(), options);;
			// Read-only mode
			if(this.options.readOnly) this.$el.addClass('read-only');
			// Set initial sort key
			this.currentSortKey = this.options.defaultNavigationSortKey;
			// Create CSS declarations for highlight color
			this.createCssDeclarations();
			// Fetching data and rendering
			this.fetchDataAndRender();
		},

		delegateEvents: function() {
			this.bindEvents(false);
		},

		undelegateEvents: function() {
			this.bindEvents(true);
		},

		bindEvents: function(unbind) {
				var bindFunction = unbind ? 'off' : 'on';
				for (var key in this.events) {
						var eventName = key.split(' ')[0];
						var selector = key.split(' ').slice(1).join(' ');
						var methodNames = this.events[key].split(' ');

						for(var index in methodNames) {
								if(methodNames.hasOwnProperty(index)) {
										var method = this[methodNames[index]];

										// Keep the context
										method = $.proxy(method, this);

										if (selector == '') {
												this.$el[bindFunction](eventName, method);
										} else {
												this.$el[bindFunction](eventName, selector, method);
										}
								}
						}
				}
		},

		// Basic functionalities
		fetchDataAndRender: function () {
			var self = this;
			setTimeout(function(){self.appendNewComments()},30000);
			this.commentsById = {};
			this.usersById = {};
			this.$el.empty();
			this.createHTML();
			// Render after data has been fetched
			var dataFetched = this.after(this.options.enablePinging ? 2 : 1, function() {
				self.dataFetched = true;
				self.render();
			});

			// Comments
			var commentsFetched = function(commentsArray) {
				// Convert comments to custom data model
				var commentModels = commentsArray.map(function(commentsJSON){
					return self.createCommentModel(commentsJSON)
				});
				// Sort comments by date (oldest first so that they can be appended to the data model
				// without caring dependencies)
				self.sortComments(commentModels, 'oldest');
				$(commentModels).each(function(index, commentModel) {
						self.addCommentToDataModel(commentModel);
				});
				dataFetched();
			};
			this.options.getComments(commentsFetched, dataFetched);

			// Users
			if(this.options.enablePinging) {
				var usersFetched = function(userArray) {
					$(userArray).each(function(index, user) {
						self.usersById[user.id] = user;
					});
					dataFetched();
				}
				this.options.getUsers(usersFetched, dataFetched);
			};
		},

		fetchNext: function() {
			var self = this;
			// Loading indicator
			var spinner = this.createSpinner();
			this.$el.find('ul#comment-list').append(spinner);
			var success = function (commentModels) {
				$(commentModels).each(function(index, commentModel) {
					self.createComment(commentModel);
				});
				spinner.remove();
			}

			var error = function() {
				spinner.remove();
			}
			this.options.getComments(success, error);
		},

		createCommentModel: function(commentJSON) {
			var commentModel = this.applyInternalMappings(commentJSON);
			commentModel.childs = [];
			this.commentsById[commentModel.id] = commentModel;
			return commentModel;
		},

		addCommentToDataModel: function(commentModel) {
			if(!(commentModel.id in this.commentsById)) {
				this.commentsById[commentModel.id] = commentModel;

				// Update child array of the parent (append childs to the array of outer most parent)
				if(commentModel.parent) {
					var outermostParent = this.getOutermostParent(commentModel.parent);
					outermostParent.childs.push(commentModel.id);
				}
			}
		},

		updateCommentModel: function(commentModel) {
			$.extend(this.commentsById[commentModel.id], commentModel);
		},

		render: function() {
			var self = this;
			// Prevent re-rendering if data hasn't been fetched
			if(!this.dataFetched) return;
			// Show active container
			this.showActiveContainer();
			// Create comments
			this.createComments();
			// Create attachments if enabled
			if(this.options.enableAttachments) this.createAttachments(); 
			// Create important comment
			this.createImportantComments();
			// Remove spinner
			this.$el.find('> .spinner').remove();
			this.options.refresh();
		},

		showActiveContainer: function() {
			var activeNavigationEl = this.$el.find('.navigation li[data-container-name].active');
			var containerName = activeNavigationEl.data('container-name');
			var containerEl = this.$el.find('[data-container="' + containerName + '"]');
			containerEl.siblings('[data-container]').hide();
			containerEl.show();
		},

		createComments: function() {
			var self = this;
			// Create the list element before appending to DOM in order to reach better performance
			this.$el.find('#comment-list').remove();
			var commentList = $('<ul/>', {
				id: 'comment-list',
				'class': 'main'
			});

			// Divide commments into main level comments and replies
			var mainLevelComments = [];
			var replies = [];

			$(this.getComments()).each(function(index, commentModel) {
				if(commentModel.parent == null) {
					mainLevelComments.push(commentModel);
				} else {
					replies.push(commentModel);
				}
			});

			// Append main level comments
			this.sortComments(mainLevelComments, this.currentSortKey);
			mainLevelComments.reverse();    // Reverse the order as they are prepended to DOM
			$(mainLevelComments).each(function(index, commentModel) {
				self.addComment(commentModel, commentList);
			});

			// Append replies in chronological order
			this.sortComments(replies, 'oldest');
			$(replies).each(function(index, commentModel) {
				self.addComment(commentModel, commentList);
			});

			// Appned list to DOM
			this.$el.find('[data-container="comments"]').prepend(commentList);
		},

		createAttachments: function() {
			var self = this;
			// Create the list element before appending to DOM in order to reach better performance
			this.$el.find('#attachment-list').remove();
			var attachmentList = $('<ul/>', {
				id: 'attachment-list',
				'class': 'main'
			});

			var attachments = this.getAttachments();
			this.sortComments(attachments, 'newest');
			attachments.reverse();    // Reverse the order as they are prepended to DOM
			$(attachments).each(function(index, commentModel) {
				self.addAttachment(commentModel, attachmentList);
			});

			// Appned list to DOM
			this.$el.find('[data-container="attachments"]').prepend(attachmentList);
		},
		createImportantComments: function() {
			var self = this;
			// Create the list element before appending to DOM in order to reach better performance
			this.$el.find('#importantCmt-list').remove();
			var importantCmtList = $('<ul/>', {
					id: 'importantCmt-list',
					'class': 'main'
			});

			var importantCmt = this.getImportantCmt();

			this.sortComments(importantCmt, 'newest');
			importantCmt.reverse();    // Reverse the order as they are prepended to DOM
			$(importantCmt).each(function(index, commentModel) {
					self.addImportantCmt(commentModel, importantCmtList);
			});

			// Appned list to DOM
			this.$el.find('[data-container="importantCmt"]').prepend(importantCmtList);
		},
		addComment: function(commentModel, commentList) {
			commentList = commentList || this.$el.find('#comment-list');
			var commentEl = this.createCommentElement(commentModel);

			// Case: reply
			if(commentModel.parent) {
				var directParentEl = commentList.find('.comment[data-id="'+commentModel.parent+'"]');

				// Re-render action bar of direct parent element
				this.reRenderCommentActionBar(commentModel.parent);

				// Force replies into one level only
				var outerMostParent = directParentEl.parents('.comment').last();
				if(outerMostParent.length == 0) outerMostParent = directParentEl;

				// Append element to DOM
				var childCommentsEl = outerMostParent.find('.child-comments');
				var commentingField = childCommentsEl.find('.commenting-field');
				if(commentingField.length) {
					commentingField.before(commentEl)
				} else {
					childCommentsEl.append(commentEl);
				}

				// Update toggle all -button
				this.updateToggleAllButton(outerMostParent);

			// Case: main level comment
			} else {
				commentList.prepend(commentEl);
			}
		},
		addAttachment: function(commentModel, commentList) {
			commentList = commentList || this.$el.find('#attachment-list');
			var commentEl = this.createCommentElement(commentModel);
			commentList.prepend(commentEl);
		},
		addImportantCmt: function(commentModel, commentList) {
			commentList = commentList || this.$el.find('#importantCmt-list');
			var commentEl = this.createCommentElement(commentModel);
			commentList.prepend(commentEl);
		},
		removeComment: function(commentId) {
			var self = this;
			var commentModel = this.commentsById[commentId];

			// Remove child comments recursively
			var childComments = this.getChildComments(commentModel.id);
			$(childComments).each(function(index, childComment) {
				self.removeComment(childComment.id);
			});

			// Update the child array of outermost parent
			if(commentModel.parent) {
				var outermostParent = this.getOutermostParent(commentModel.parent);
				var indexToRemove = outermostParent.childs.indexOf(commentModel.id);
				outermostParent.childs.splice(indexToRemove, 1);
			}

			// Remove the comment from data model
			delete this.commentsById[commentId];
			var commentElements = this.$el.find('li.comment[data-id="'+commentId+'"]');
			var parentEl = commentElements.parents('li.comment').last();

			// Remove the element
			commentElements.remove();

			// Update the toggle all button
			this.updateToggleAllButton(parentEl);
		},

		uploadAttachments: function(files, commentingField) {
			var self = this;
			if(!commentingField) commentingField = this.$el.find('.commenting-field.main');
			var isReply = !commentingField.hasClass('main');
			var fileCount = files.length;

			if(fileCount) {
				var uploadButton = commentingField.find('.upload');
				var textarea = commentingField.find('.textarea');

				// Disable upload button and append spinners while request is pending
				uploadButton.removeClass('enabled');
				var attachmentListSpinner = this.createSpinner();
				var commentListSpinner = this.createSpinner();
				this.$el.find('ul#attachment-list').prepend(attachmentListSpinner);
				if(isReply) {
					commentingField.before(commentListSpinner);
				} else {
					this.$el.find('ul#comment-list').prepend(commentListSpinner);
				}

				var success = function(commentArray) {
					$(commentArray).each(function(index, commentJSON) {
						var commentModel = self.createCommentModel(commentJSON);
						self.addCommentToDataModel(commentModel);
						self.addComment(commentModel);
						self.addAttachment(commentModel);
					});

					// Close the commenting field if all the uploads were successfull
					// and there's no content besides the attachment
					if(commentArray.length == fileCount && self.getTextareaContent(textarea).length == 0) {
						commentingField.find('.close').trigger('click');
					}

					// Enable upload button and remove spinners
					uploadButton.addClass('enabled');
					commentListSpinner.remove();
					attachmentListSpinner.remove();
				};

				var error = function() {
					// Enable upload button and remove spinners
					uploadButton.addClass('enabled');
					commentListSpinner.remove();
					attachmentListSpinner.remove();
				};

				var commentArray = [];
				$(files).each(function(index, file) {
					// Create comment JSON
					var commentJSON = self.createCommentJSON(textarea);
					commentJSON.id += '-' + index;
					commentJSON.content = '';
					commentJSON.file = file;
					commentJSON.fileURL = 'C:/fakepath/' + file.name;
					commentJSON.fileMimeType = file.type;
					// Reverse mapping
					commentJSON = self.applyExternalMappings(commentJSON);
					commentArray.push(commentJSON);
				});

				self.options.uploadAttachments(commentArray, success, error);
			}

			// Clear the input field
			uploadButton.find('input').val('');
		},

		updateToggleAllButton: function(parentEl) {
			// Don't hide replies if maxRepliesVisible is null or undefined
			if (this.options.maxRepliesVisible == null) return;

			var childCommentsEl = parentEl.find('.child-comments');
			var childComments = childCommentsEl.find('.comment');
			var toggleAllButton = childCommentsEl.find('li.toggle-all');
			childComments.removeClass('hidden-reply');

			// Select replies to be hidden
			if (this.options.maxRepliesVisible === 0) {
				var hiddenReplies = childComments;
			} else {
				var hiddenReplies = childComments.slice(0, -this.options.maxRepliesVisible);
			}

			// Add identifying class for hidden replies so they can be toggled
			hiddenReplies.addClass('hidden-reply');

			// Show all replies if replies are expanded
			if(toggleAllButton.find('span.text').text() == this.options.textFormatter(this.options.hideRepliesText)) {
				hiddenReplies.addClass('visible');
			}

			// Make sure that toggle all button is present
			if(childComments.length > this.options.maxRepliesVisible) {

				// Append button to toggle all replies if necessary
				if(!toggleAllButton.length) {

					toggleAllButton = $('<li/>', {
						'class': 'toggle-all highlight-font-bold'
					});
					var toggleAllButtonText = $('<span/>', {
						'class': 'text'
					});
					var caret = $('<span/>', {
						'class': 'caret'
					});

					// Append toggle button to DOM
					toggleAllButton.append(toggleAllButtonText).append(caret);
					childCommentsEl.prepend(toggleAllButton);
				}

				// Update the text of toggle all -button
				this.setToggleAllButtonText(toggleAllButton, false);
			// Make sure that toggle all button is not present
			} else {
				toggleAllButton.remove();
			}
		},

		sortComments: function (comments, sortKey) {
			var self = this;
			// Sort by popularity
			if(sortKey == 'popularity') {
				comments.sort(function(commentA, commentB) {
					var pointsOfA = commentA.childs.length;
					var pointsOfB = commentB.childs.length;

					if(self.options.enableUpvoting) {
						pointsOfA += commentA.upvoteCount;
						pointsOfB += commentB.upvoteCount;
					}

					if(pointsOfB != pointsOfA) {
						return pointsOfB - pointsOfA;

					} else {
						// Return newer if popularity is the same
						var createdA = new Date(commentA.created).getTime();
						var createdB = new Date(commentB.created).getTime();
						return createdB - createdA;
					}
				});
			// Sort by date
			} else {
				comments.sort(function(commentA, commentB) {
					var createdA = (new Date(commentA.created)).getTime();
					var createdB = (new Date(commentB.created)).getTime();
					if(sortKey == 'oldest') {
						return createdA - createdB;
					} else {
						return createdB - createdA;
					}
				});
			}
		},

		sortUsers: function(users) {
			users.sort(function(a,b) {
				var nameA = a.fullname.toLowerCase().trim();
				var nameB = b.fullname.toLowerCase().trim();
				if(nameA < nameB) return -1;
				if(nameA > nameB) return 1;
				return 0;
			});
		},

		sortAndReArrangeComments: function(sortKey) {
			var commentList = this.$el.find('#comment-list');

			// Get main level comments
			var mainLevelComments = this.getComments().filter(function(commentModel){return !commentModel.parent});
			this.sortComments(mainLevelComments, sortKey);

			// Rearrange the main level comments
			$(mainLevelComments).each(function(index, commentModel) {
					var commentEl = commentList.find('> li.comment[data-id='+commentModel.id+']');
					commentList.append(commentEl);
			});
		},

		showActiveSort: function() {
			var activeElements = this.$el.find('.navigation li[data-sort-key="' + this.currentSortKey + '"]');

			// Indicate active sort
			this.$el.find('.navigation li').removeClass('active');
			activeElements.addClass('active');

			// Update title for dropdown
			var titleEl = this.$el.find('.navigation .title');
			if(this.currentSortKey != 'attachments') {
				titleEl.addClass('active');
				titleEl.find('header').html(activeElements.first().html());
			} else {
				var defaultDropdownEl = this.$el.find('.navigation ul.dropdown').children().first();
				titleEl.find('header').html(defaultDropdownEl.html());
			} 

			// Show active container
			this.showActiveContainer();
		},

		forceResponsive: function() {
			this.$el.addClass('responsive');
		},

		// Event handlers

		closeDropdowns: function() {
			this.$el.find('.dropdown').hide();
		},

		saveOnKeydown: function(ev) {
			// Save comment on cmd/ctrl + enter
			if(ev.keyCode == 13) {
				var metaKey = ev.metaKey || ev.ctrlKey;
				if(this.options.postCommentOnEnter || metaKey) {                
					var el = $(ev.currentTarget);
					el.siblings('.control-row').find('.save').trigger('click');
					ev.stopPropagation();
					ev.preventDefault();
				}
			}
		},

		saveEditableContent: function(ev) {
			var el = $(ev.currentTarget);
			el.data('before', el.html());
		},

		checkEditableContentForChange: function(ev) {
			var el = $(ev.currentTarget);
			if (el.data('before') != el.html()) {
				el.data('before', el.html());
				el.trigger('change');
			}
		},

		navigationElementClicked: function(ev) {
			var navigationEl = $(ev.currentTarget);
			var sortKey = navigationEl.data().sortKey;

			// Sort the comments if necessary
			if(sortKey != 'attachments') {
					this.sortAndReArrangeComments(sortKey);
			}
			// Save the current sort key
			this.currentSortKey = sortKey;
			this.showActiveSort();
		},

		toggleNavigationDropdown: function(ev) {
			// Prevent closing immediately
			ev.stopPropagation();

			var dropdown = $(ev.currentTarget).find('~ .dropdown');
			dropdown.toggle();
		},

		showMainCommentingField: function(ev) {
			var mainTextarea = $(ev.currentTarget);
			mainTextarea.siblings('.control-row').show();
			mainTextarea.parent().find('.close').show();
			mainTextarea.focus();
		},

		hideMainCommentingField: function(ev) {
			var closeButton = $(ev.currentTarget);
			var mainTextarea = this.$el.find('.commenting-field.main .textarea');
			var mainControlRow = this.$el.find('.commenting-field.main .control-row');

			this.clearTextarea(mainTextarea);
			this.adjustTextareaHeight(mainTextarea, false);

			mainControlRow.hide();
			closeButton.hide();
			mainTextarea.blur();
		},

		increaseTextareaHeight: function(ev) {
			var textarea = $(ev.currentTarget);
			this.adjustTextareaHeight(textarea, true);
		},

		textareaContentChanged: function(ev) {
			var textarea = $(ev.currentTarget);
			var saveButton = textarea.siblings('.control-row').find('.save');

			// Update parent id if reply-to tag was removed
			if(!textarea.find('.reply-to.tag').length) {
				var commentId = textarea.attr('data-comment');

				// Case: editing comment
				if(commentId) {
					var parentComments = textarea.parents('li.comment');
					if(parentComments.length > 1) {
						var parentId = parentComments.last().data('id');
						textarea.attr('data-parent', parentId);
					}

				// Case: new comment
				} else {
					var parentId = textarea.parents('li.comment').last().data('id');
					textarea.attr('data-parent', parentId);
				}
			}

			// Move close button if scrollbar is visible
			var commentingField = textarea.parents('.commenting-field').first();
			if(textarea[0].scrollHeight > textarea.outerHeight()) {
				commentingField.addClass('scrollable');
			} else {
				commentingField.removeClass('scrollable');
			}

			// Check if content or parent has changed if editing
			var contentOrParentChangedIfEditing = true;
			var content = this.getTextareaContent(textarea, true);
			if(commentId = textarea.attr('data-comment')) {
				var contentChanged = content != this.commentsById[commentId].content;
				var parentFromModel;
				if(this.commentsById[commentId].parent) {
					parentFromModel = this.commentsById[commentId].parent.toString();
				}
				var parentChanged = textarea.attr('data-parent') != parentFromModel;
				contentOrParentChangedIfEditing = contentChanged || parentChanged;
			}

			// Check whether save button needs to be enabled
			if(content.length && contentOrParentChangedIfEditing) {
				saveButton.addClass('enabled');
			} else {
				saveButton.removeClass('enabled');
			}
		},

		removeCommentingField: function(ev) {
			var closeButton = $(ev.currentTarget);

			// Remove edit class from comment if user was editing the comment
			var textarea = closeButton.siblings('.textarea');
			if(textarea.attr('data-comment')) {
				closeButton.parents('li.comment').first().removeClass('edit');
			}

			// Remove the field
			var commentingField = closeButton.parents('.commenting-field').first();
			commentingField.remove();
		},

		appendNewComments: function() {
			var self = this;
			console.log($(self.$el.context), $(self.$el.context).length);
			if ($(self.$el.context).length == 0) {
				clearTimeout(myVar);
				return;
			}
			var commentJSONs = this.getComments();

			var success = function(commentsNew, commentsEdit) {
				for (var c in commentsNew) {
					self.createComment(commentsNew[c]);
				}
				
				for (var cmt in commentsEdit) {
					var commentModel = self.createCommentModel(commentsEdit[cmt]);
					self.updateCommentModel(commentModel);
					self.reRenderComment(commentModel.id);
				}
			};

			var error = function() {
				console.log('jquery comment append new error');
			};
			var myVar = setTimeout(function(){self.appendNewComments()},30000);
			this.options.appendNewComments(commentJSONs, success, error);
		},
			
		postComment: function(ev) {
			var self = this;
			var sendButton = $(ev.currentTarget);
			var commentingField = sendButton.parents('.commenting-field').first();
			var textarea = commentingField.find('.textarea');

			// Disable send button while request is pending
			sendButton.removeClass('enabled');

			// Create comment JSON
			var commentJSON = this.createCommentJSON(textarea);

			// Reverse mapping
			commentJSON = this.applyExternalMappings(commentJSON);

			var success = function(commentJSON) {
				self.currentSortKey = 'newest'
				self.showActiveSort()
				self.createComment(commentJSON);
				commentingField.find('.close').trigger('click');
			};

			var error = function() {
				sendButton.addClass('enabled');
			};

			this.options.postComment(commentJSON, success, error);
		},

		createComment: function(commentJSON) {
			var commentModel = this.createCommentModel(commentJSON);
			this.addCommentToDataModel(commentModel);
			this.addComment(commentModel);
			if (commentModel.opinion == true) {
				this.addImportantCmt(commentModel);
			}
		},

		putComment: function(ev) {
			var self = this;
			var saveButton = $(ev.currentTarget);
			var commentingField = saveButton.parents('.commenting-field').first();
			var textarea = commentingField.find('.textarea');

			// Disable send button while request is pending
			saveButton.removeClass('enabled');

			// Use a clone of the existing model and update the model after succesfull update
			var commentJSON =  $.extend({}, this.commentsById[textarea.attr('data-comment')]);
			$.extend(commentJSON, {
				parent: textarea.attr('data-parent') || null,
				content: this.getTextareaContent(textarea),
				pings: this.getPings(textarea),
				modified: new Date().getTime()
			});

			// Reverse mapping
			commentJSON = this.applyExternalMappings(commentJSON);
			
			var success = function(commentJSON) {
				// The outermost parent can not be changed by editing the comment so the childs array
				// of parent does not require an update

				var commentModel = self.createCommentModel(commentJSON);
			
				// Delete childs array from new comment model since it doesn't need an update
				delete commentModel['childs'];
				self.updateCommentModel(commentModel);
				// Close the editing field
				commentingField.find('.close').trigger('click');

				// Re-render the comment
				self.reRenderComment(commentModel.id);
			};

			var error = function() {
				saveButton.addClass('enabled');
			};

			this.options.putComment(commentJSON, success, error);
		},

		deleteComment: function(ev) {
			var self = this;
			var deleteButton = $(ev.currentTarget);
			var commentEl = deleteButton.parents('.comment').first();
			var commentJSON =  $.extend({}, this.commentsById[commentEl.attr('data-id')]);
			var commentId = commentJSON.id;
			var parentId = commentJSON.parent;

			// Disable send button while request is pending
			deleteButton.removeClass('enabled');

			// Reverse mapping
			commentJSON = this.applyExternalMappings(commentJSON);

			var success = function() {
				self.removeComment(commentId);
				if(parentId) self.reRenderCommentActionBar(parentId);
				// 
				if (commentJSON.opinion==true) {
					$(`[data-sort-key=${self.currentSortKey}]`).trigger('click')
				}
				// 
			};

			var error = function() {
				deleteButton.addClass('enabled');
			};

			this.options.deleteComment(commentJSON, success, error);
		},

		hashtagClicked: function(ev) {
			var el = $(ev.currentTarget);
			var value = el.attr('data-value');
			this.options.hashtagClicked(value);
		},

		pingClicked: function(ev) {
			var el = $(ev.currentTarget);
			var value = el.attr('data-value');
			this.options.pingClicked(value);
		},

		fileInputChanged: function(ev, files) {
			var files = ev.currentTarget.files;
			var commentingField = $(ev.currentTarget).parents('.commenting-field').first();
			this.uploadAttachments(files, commentingField);
		},

		upvoteComment: function(ev) {
			var self = this;
			var commentEl = $(ev.currentTarget).parents('li.comment').first();
			var commentModel = commentEl.data().model;

			// Check whether user upvoted the comment or revoked the upvote
			var previousUpvoteCount = commentModel.upvoteCount;
			var newUpvoteCount;
			if(commentModel.userHasUpvoted) {
				newUpvoteCount = previousUpvoteCount - 1;
			} else {
				newUpvoteCount = previousUpvoteCount + 1;
			}

			// Show changes immediatelly
			commentModel.userHasUpvoted = !commentModel.userHasUpvoted;
			commentModel.upvoteCount = newUpvoteCount;
			this.reRenderUpvotes(commentModel.id);

			// Reverse mapping
			var commentJSON = $.extend({}, commentModel);
			commentJSON = this.applyExternalMappings(commentJSON);

			var success = function(commentJSON) {
				var commentModel = self.createCommentModel(commentJSON);
				self.updateCommentModel(commentModel);
				self.reRenderUpvotes(commentModel.id);
			};

			var error = function() {
				// Revert changes
				commentModel.userHasUpvoted = !commentModel.userHasUpvoted;
				commentModel.upvoteCount = previousUpvoteCount;
				self.reRenderUpvotes(commentModel.id);
			};

			this.options.upvoteComment(commentJSON, success, error);
		},

		toggleReplies: function(ev) {
			var el = $(ev.currentTarget);
			el.siblings('.hidden-reply').toggleClass('visible');
			this.setToggleAllButtonText(el, true);
		},

		replyButtonClicked: function(ev) {
			var replyButton = $(ev.currentTarget);
			var outermostParent = replyButton.parents('li.comment').last();
			var parentId = replyButton.parents('.comment').first().data().id;

			// Remove existing field
			var replyField = outermostParent.find('.child-comments > .commenting-field');
			if(replyField.length) replyField.remove();
			var previousParentId = replyField.find('.textarea').attr('data-parent');

			// Create the reply field (do not re-create)
			if(previousParentId != parentId) {
				replyField = this.createCommentingFieldElement(parentId, null, false);
				outermostParent.find('.child-comments').append(replyField);

				// Move cursor to end
				var textarea = replyField.find('.textarea');
				this.moveCursorToEnd(textarea)

				// Make sure the reply field will be displayed
				var scrollTop = this.options.scrollContainer.scrollTop();
				var endOfReply = scrollTop + replyField.position().top + replyField.outerHeight();
				var endOfScrollable = scrollTop + this.options.scrollContainer.outerHeight();
				if(endOfReply > endOfScrollable) {
					var newScrollTop = scrollTop + (endOfReply - endOfScrollable);
					this.options.scrollContainer.scrollTop(newScrollTop);
				}
			}
		},

		editButtonClicked: function(ev) {
			var editButton = $(ev.currentTarget);
			var commentEl = editButton.parents('li.comment').first();
			var commentModel = commentEl.data().model;
			
			commentModel = this.commentsById[commentModel.id];
			commentEl.addClass('edit');

			// Create the editing field
			var editField = this.createCommentingFieldElement(commentModel.parent, commentModel.id, false);
			commentEl.find('.comment-wrapper').first().append(editField);

			// Append original content
			var textarea = editField.find('.textarea');
			textarea.attr('data-comment', commentModel.id);

			// Escaping HTML
			textarea.append(this.getFormattedCommentContent(commentModel, true));

			// Move cursor to end
			this.moveCursorToEnd(textarea);
		},

		showDroppableOverlay: function(ev) {
			if(this.options.enableAttachments) {
				this.$el.find('.droppable-overlay').css('top', this.$el[0].scrollTop);
				this.$el.find('.droppable-overlay').show();
				this.$el.addClass('drag-ongoing');
			}
		},

		handleDragEnter: function(ev) {
			var count = $(ev.currentTarget).data('dnd-count') || 0;
			count++;
			$(ev.currentTarget).data('dnd-count', count);
			$(ev.currentTarget).addClass('drag-over');
		},

		handleDragLeave: function(ev, callback) {
			var count = $(ev.currentTarget).data('dnd-count');
			count--;
			$(ev.currentTarget).data('dnd-count', count);

			if(count == 0) {            
				$(ev.currentTarget).removeClass('drag-over');
				if(callback) callback();
			}
		},

		handleDragLeaveForOverlay: function(ev) {
			var self = this;
			this.handleDragLeave(ev, function() {
				self.hideDroppableOverlay();
			});
		},

		handleDragLeaveForDroppable: function(ev) {
			this.handleDragLeave(ev);
		},

		handleDragOverForOverlay: function(ev) {
			ev.stopPropagation();
			ev.preventDefault();
			ev.originalEvent.dataTransfer.dropEffect = 'copy';
		},

		hideDroppableOverlay: function() {
			this.$el.find('.droppable-overlay').hide();
			this.$el.removeClass('drag-ongoing');
		},

		handleDrop: function(ev) {
			ev.preventDefault();

			// Reset DND counts
			$(ev.target).trigger('dragleave');

			// Hide the overlay and upload the files
			this.hideDroppableOverlay();
			this.uploadAttachments(ev.originalEvent.dataTransfer.files);
		},

		stopPropagation: function(ev) {
			ev.stopPropagation();
		},


		// HTML elements

		createHTML: function() {
			var self = this;
			// Commenting field
			var mainCommentingField = this.createCommentingFieldElement(null, null, true);
			mainCommentingField.addClass('main');
			this.$el.append(mainCommentingField);

			// Hide control row and close button
			var mainControlRow = mainCommentingField.find('.control-row');
			mainControlRow.hide();
			mainCommentingField.find('.close').hide();

			// Navigation bar
			if (this.options.enableNavigation) {
				this.$el.append(this.createNavigationElement());
				this.showActiveSort();
			}

			// Loading spinner
			var spinner = this.createSpinner();
			this.$el.append(spinner);

			// Comments container
			var commentsContainer = $('<div/>', {
				'class': 'data-container overflowComment',
				'data-container': 'comments'
			});
			this.$el.append(commentsContainer);
				
			// "No comments" placeholder
			var noComments = $('<div/>', {
				'class': 'no-comments no-data',
				text: this.options.textFormatter(this.options.noCommentsText)
			});
			var noCommentsIcon = $('<i/>', {
				'class': 'fa fa-comments fa-2x'
			});
			if(this.options.noCommentsIconURL.length) {
				noCommentsIcon.css('background-image', 'url("'+this.options.noCommentsIconURL+'")');
				noCommentsIcon.addClass('image');
			}
			noComments.prepend($('<br/>')).prepend(noCommentsIcon);            
			commentsContainer.append(noComments);

			// important Comment Container
			var importantCmtContainer = $('<div/>', {
				'class': 'data-container overflowComment',
				'data-container': 'importantCmt'
			});
			this.$el.append(importantCmtContainer);
				// "No comments Important" placeholder
			var noCommentsImpt = $('<div/>', {
				'class': 'no-comments no-data',
				text: this.options.textFormatter(this.options.noCommentsImportantText)
			});
			var noCommentsImptIcon = $('<i/>', {
				'class': 'fa fa-comments fa-2x'
			});
			if(this.options.noCommentsImptIconURL.length) {
				noCommentsImptIcon.css('background-image', 'url("'+this.options.noCommentsImptIconURL+'")');
				noCommentsImptIcon.addClass('image');
			}
			noCommentsImpt.prepend($('<br/>')).prepend(noCommentsImptIcon);            
			importantCmtContainer.append(noCommentsImpt);

			// Attachments
			if(this.options.enableAttachments) {
				// Attachments container
				var attachmentsContainer = $('<div/>', {
					'class': 'data-container overflowComment',
					'data-container': 'attachments'
				});
				this.$el.append(attachmentsContainer);
				
				// "No attachments" placeholder
				var noAttachments = $('<div/>', {
					'class': 'no-attachments no-data',
					text: this.options.textFormatter(this.options.noAttachmentsText)
				});
				var noAttachmentsIcon = $('<i/>', {
					'class': 'fa fa-paperclip fa-2x'
				});
				if(this.options.attachmentIconURL.length) {
					noAttachmentsIcon.css('background-image', 'url("'+this.options.attachmentIconURL+'")');
					noAttachmentsIcon.addClass('image');
				}
				noAttachments.prepend($('<br/>')).prepend(noAttachmentsIcon);
				attachmentsContainer.append(noAttachments);


				// Drag & dropping attachments
				var droppableOverlay = $('<div/>', {
					'class': 'droppable-overlay'
				});

				var droppableContainer = $('<div/>', {
					'class': 'droppable-container'
				});

				var droppable = $('<div/>', {
					'class': 'droppable'
				});

				var uploadIcon = $('<i/>', {
					'class': 'fa fa-upload fa-4x'
				});
				if(this.options.uploadIconURL.length) {
					uploadIcon.css('background-image', 'url("'+this.options.uploadIconURL+'")');
					uploadIcon.addClass('image');
				}

				var dropAttachmentText = $('<div/>', {
					text: this.options.textFormatter(this.options.attachmentDropText)
				});
				droppable.append(uploadIcon);
				droppable.append(dropAttachmentText);

				droppableOverlay.html(droppableContainer.html(droppable)).hide();
				this.$el.append(droppableOverlay);
			}
		},

		createProfilePictureElement: function(src) {
			if(src) {
				var profilePicture = $('<img/>', {
					src: src
				});
			} else {
				var profilePicture = $('<i/>', {
					'class': 'fa fa-user'
				});
			}
			profilePicture.addClass('profile-picture');
			if(this.options.roundProfilePictures) profilePicture.addClass('round');
			return profilePicture;
		},

		createCommentingFieldElement: function(parentId, existingCommentId, enableOpinion) {
			var self = this;
			// Commenting field
			var commentingField = $('<div/>', {
				'class': 'commenting-field'
			});

			// Profile picture
			if(existingCommentId) {
				var profilePictureURL = this.commentsById[existingCommentId].profilePictureURL;
			} else {
				var profilePictureURL = this.options.profilePictureURL;
			}
			var profilePicture = this.createProfilePictureElement(profilePictureURL);

			// New comment
			var textareaWrapper = $('<div/>', {
				'class': 'textarea-wrapper'
			});

			// Control row
			var controlRow = $('<div/>', {
				'class': 'control-row'
			});

			// Textarea
			var textarea = $('<div/>', {
				'class': 'textarea',
				'data-placeholder': this.options.textFormatter(this.options.textareaPlaceholderText),
				contenteditable: true
			});

			// Setting the initial height for the textarea
			this.adjustTextareaHeight(textarea, false);

			// Close button
			var closeButton = $('<span/>', {
				'class': 'close'
			}).append($('<span class="left"/>')).append($('<span class="right"/>'));

			// Save button text
			if(existingCommentId) {
				var saveButtonText = this.options.textFormatter(this.options.saveText);
				var opinionCmtId = existingCommentId
				// Delete button Edit Comment
				// var deleteButton = $('<span/>', {
				// 		'class': 'delete',
				// 		text: this.options.textFormatter(this.options.deleteText)
				// }).css('background-color', this.options.deleteButtonColor);
				// controlRow.append(deleteButton);

				// // Enable the delete button only if the user is allowed to delete
				// if(this.isAllowedToDelete(existingCommentId)) deleteButton.addClass('enabled')

			} else {
				var saveButtonText = this.options.textFormatter(this.options.sendText);
				var opinionCmtId =''
				// Add upload button if attachments are enabled
				if(this.options.enableAttachments) {
					var uploadButton = $('<span/>', {
						'class': 'enabled upload'
					});
					var uploadIcon = $('<i/>', {
						'class': 'md-icon',
						text: 'Tải lên'
					});
					var fileInput = $('<input/>', {
						type: 'file',
						'data-role': 'none' // Prevent jquery-mobile for adding classes
					});
					// Multi file upload might not work with backend as the the file names
					// may be the same causing duplicates
					if(!$.browser.mobile) fileInput.attr('multiple', 'multiple');

					if(this.options.uploadIconURL.length) {
						uploadIcon.css('background-image', 'url("'+this.options.uploadIconURL+'")');
						uploadIcon.addClass('image');
					}
					uploadButton.append(uploadIcon).append(fileInput);
					controlRow.append(uploadButton);
				}
			}

			// Save button
			var saveButtonClass = existingCommentId ? 'update' : 'send';
			var saveButton = $('<span/>', {
				'class': saveButtonClass + ' save highlight-background',
				text: saveButtonText
			});
			// Check opinion

			if (enableOpinion) {
				var checkOpinion = $('<input/>', {
					'class': 'opinion checkOpinion mt-1 mr-1',
					'id': 'opinion' + opinionCmtId,
					'name': 'opinion' + opinionCmtId,
					'type': 'checkbox'
				});
				var labelCheckOpinion = $('<label/>', {
					'class': 'opinion label-opinion',
					'for': 'opinion'+opinionCmtId,
					text: 'Ý kiến chính thức'
				});
				controlRow.append(checkOpinion).append(labelCheckOpinion);
			}
			
			// Populate the element
			controlRow.prepend(saveButton);
			textareaWrapper.append(closeButton).append(textarea).append(controlRow);
			commentingField.append(profilePicture).append(textareaWrapper);


			if(parentId) {

					// Set the parent id to the field if necessary
				textarea.attr('data-parent', parentId);

				// Append reply-to tag if necessary
				var parentModel = this.commentsById[parentId];
				if(parentModel.parent) {
					textarea.html('&nbsp;');    // Needed to set the cursor to correct place

					// Creating the reply-to tag
					var replyToName = '@' + parentModel.fullname;
					var replyToTag = this.createTagElement(replyToName, 'reply-to', parentModel.creator);
					textarea.prepend(replyToTag);
				}
			}

			// Pinging users
			if(this.options.enablePinging) {
					textarea.textcomplete([{
							/**match: /(^|\s)@(([a-zäöüß]|\s)*)$/im,*/
						match: /(^|\s)@(([0-9]|[^\u0000-\u007F]|[a-zäöüß]|\s)*)$/im,
							search: function (term, callback) {
								// console.log(term);
									term = self.normalizeSpaces(term);

									// Users excluding self and already pinged users
									var pings = self.getPings(textarea);
									var users = self.getUsers().filter(function(user) {
											var isSelf = user.id == self.options.currentUserId;
											var alreadyPinged = pings.indexOf(user.id) != -1;
											return !isSelf && !alreadyPinged;
									});

									// Sort users
									self.sortUsers(users);

									callback($.map(users, function (user) {
											var lowercaseTerm = term.toLowerCase();
											var nameMatch = user.fullname.toLowerCase().indexOf(lowercaseTerm) != -1;
											var emailMatch = user.email.toLowerCase().indexOf(lowercaseTerm) != -1;
											return nameMatch || emailMatch ? user : null;
									}));
							},
							template: function(user) {
									var wrapper = $('<div/>');

									var profilePictureEl = $('<img/>', {
											src: user.pictureUrl,
											'class': 'profile-picture round'
									});
									var detailsEl = $('<div/>', {
											'class': 'details',
									});
									var nameEl = $('<div/>', {
											'class': 'name',
									}).html(user.fullname);

									var emailEl = $('<div/>', {
											'class': 'email',
									}).html(user.email);
											
									if (user.email) {
											detailsEl.append(nameEl).append(emailEl);
									} else {
											detailsEl.addClass('no-email')
											detailsEl.append(nameEl)
									}

									wrapper.append(profilePictureEl).append(detailsEl);
									return wrapper.html();
							},
							replace: function (user) {
									var tag = self.createTagElement('@' + user.fullname, 'ping', user.id);
									return ' ' + tag[0].outerHTML + ' ';
							},
					}], {
							appendTo: '.jquery-comments',
							dropdownClassName: 'dropdown autocomplete',
							maxCount: 5,
							rightEdgeOffset: 0,
					});


					// OVERIDE TEXTCOMPLETE DROPDOWN POSITIONING

					$.fn.textcomplete.Dropdown.prototype.render = function(zippedData) {
						var contentsHtml = this._buildContents(zippedData);
						var unzippedData = $.map(zippedData, function (d) { return d.value; });
						if (zippedData.length) {
							var strategy = zippedData[0].strategy;
							if (strategy.id) {
								this.$el.attr('data-strategy', strategy.id);
							} else {
								this.$el.removeAttr('data-strategy');
							}
							this._renderHeader(unzippedData);
							this._renderFooter(unzippedData);
							if (contentsHtml) {
								this._renderContents(contentsHtml);
								this._fitToBottom();
								this._fitToRight();
								this._activateIndexedItem();
							}
							this._setScroll();
						} else if (this.noResultsMessage) {
							this._renderNoResultsMessage(unzippedData);
						} else if (this.shown) {
							this.deactivate();
						}

						// CUSTOM CODE
						// ===========

						// Adjust vertical position
						var top = parseInt(this.$el.css('top')) + self.options.scrollContainer.scrollTop();
						this.$el.css('top', top);

						// Adjust horizontal position
						var originalLeft = this.$el.css('left');
						this.$el.css('left', 0);    // Left must be set to 0 in order to get the real width of the el
						var maxLeft = self.$el.width() - this.$el.outerWidth();
						var left = Math.min(maxLeft, parseInt(originalLeft));
						this.$el.css('left', left);

						// ===========
					}
			}

			return commentingField;
	},

	createNavigationElement: function() {
		var navigationEl = $('<ul/>', {
			'class': 'navigation'
		});
		var navigationWrapper = $('<div/>', {
			'class': 'navigation-wrapper'
		});
		navigationEl.append(navigationWrapper);

		// Newest
		var newest = $('<li/>', {
			text: this.options.textFormatter(this.options.newestText),
			'data-sort-key': 'newest',
			'data-container-name': 'comments'
		});

		// Oldest
		var oldest = $('<li/>', {
			text: this.options.textFormatter(this.options.oldestText),
			'data-sort-key': 'oldest',
			'data-container-name': 'comments'
		});
		// Important
		var important = $('<li/>', {
			text: this.options.textFormatter(this.options.importantCmtText),
			'data-sort-key': 'important',
			'data-container-name': 'importantCmt'
		});
		// Popular
		var popular = $('<li/>', {
			text: this.options.textFormatter(this.options.popularText),
			'data-sort-key': 'popularity',
			'data-container-name': 'comments'
		});

		// Attachments
		var attachments = $('<li/>', {
			text: this.options.textFormatter(this.options.attachmentsText),
			'data-sort-key': 'attachments',
			'data-container-name': 'attachments'
		});

		// Attachments icon
		var attachmentsIcon = $('<i/>', {
			'class': 'fa fa-paperclip'
		});
		if(this.options.attachmentIconURL.length) {
			attachmentsIcon.css('background-image', 'url("'+this.options.attachmentIconURL+'")');
			attachmentsIcon.addClass('image');
		}
		attachments.prepend(attachmentsIcon);

		// Responsive navigation
		var dropdownNavigationWrapper = $('<div/>', {
			'class': 'navigation-wrapper responsive'
		});
		var dropdownNavigation = $('<ul/>', {
			'class': 'dropdown'
		});
		var dropdownTitle = $('<li/>', {
			'class': 'title'
		});
		var dropdownTitleHeader = $('<header/>');

		dropdownTitle.append(dropdownTitleHeader);
		dropdownNavigationWrapper.append(dropdownTitle);
		dropdownNavigationWrapper.append(dropdownNavigation);
		navigationEl.append(dropdownNavigationWrapper);

		// Populate elements
		navigationWrapper.append(newest).append(oldest).append(important);
		dropdownNavigation.append(newest.clone()).append(oldest.clone()).append(important.clone());

		if(this.options.enableReplying || this.options.enableUpvoting) {
			navigationWrapper.append(popular);
			dropdownNavigation.append(popular.clone());
		}
		if(this.options.enableAttachments) {
			navigationWrapper.append(attachments);
			dropdownNavigationWrapper.append(attachments.clone());
		}

		if(this.options.forceResponsive) this.forceResponsive();
		return navigationEl;
	},

	createSpinner: function() {
		var spinner = $('<div/>', {
			'class': 'spinner'
		});
		var spinnerIcon = $('<i/>', {
			'class': 'fa fa-spinner fa-spin'
		});
		if(this.options.spinnerIconURL.length) {
			spinnerIcon.css('background-image', 'url("'+this.options.spinnerIconURL+'")');
			spinnerIcon.addClass('image');
		}
		spinner.html(spinnerIcon);
		return spinner;
	},

	createCommentElement: function(commentModel) {

		// Comment container element
		var commentEl = $('<li/>', {
			'data-id': commentModel.id,
			'class': 'comment'
		}).data('model', commentModel);

		if(commentModel.createdByCurrentUser) commentEl.addClass('by-current-user');
		if(commentModel.createdByAdmin) commentEl.addClass('by-admin');

		// Child comments
		var childComments = $('<ul/>', {
			'class': 'child-comments'
		});

		// Comment wrapper
		var commentWrapper = this.createCommentWrapperElement(commentModel);

		commentEl.append(commentWrapper);
		if(commentModel.parent == null) commentEl.append(childComments);
		return commentEl;
	},

	createCommentWrapperElement: function(commentModel) {
		var commentWrapper = $('<div/>', {
			'class': 'comment-wrapper'
		});

		// Profile picture
		var profilePicture = this.createProfilePictureElement(commentModel.profilePictureURL);

		// Time
		var time = $('<time/>', {
			text: this.options.timeFormatter(commentModel.created),
			'data-original': commentModel.created
		});

		// Name
		var nameText = commentModel.createdByCurrentUser ? this.options.textFormatter(this.options.youText) : commentModel.fullname;
		var name = $('<div/>', {
			'class': 'name'
		});
		if(commentModel.profileURL) {
			var link = $('<a/>', {
				href: commentModel.profileURL,
				text: nameText
			});
			name.html(link);
		} else {
			name.text(nameText);
		}

		// Highlight name for own comments and admin
		if(commentModel.createdByCurrentUser || commentModel.createdByAdmin) name.addClass('highlight-font-bold');

		// Show reply-to name if parent of parent exists
		if(commentModel.parent) {
			var parent = this.commentsById[commentModel.parent];
			if(parent.parent) {
				var replyTo = $('<span/>', {
					'class': 'reply-to',
					text: parent.fullname
				});

				// reply icon
				var replyIcon = $('<i/>', {
					'class': 'fa fa-share'
				});
				if(this.options.replyIconURL.length) {
					replyIcon.css('background-image', 'url("'+this.options.replyIconURL+'")');
					replyIcon.addClass('image');
				}

				replyTo.prepend(replyIcon);
				name.append(replyTo);
			}
		}

		// New tag
		if(commentModel.isNew) {
			var newTag = $('<span/>', {
				'class': 'new highlight-background',
				text: this.options.newText
			});
			name.append(newTag);
		}

		// Wrapper
		var wrapper = $('<div/>', {
			'class': 'wrapper'
		});
		// Note Ý kiến chính thức
		var noteOpinion = $('<div/>', {
			'class': 'note-opinion',
			text: '(Ý kiến chính thức)'
		});
		// Content
		var content = $('<div/>', {
			'class': 'content'
		});

		// Case: attachment
		var isAttachment = commentModel.fileURL != undefined;
		if(isAttachment) {
			var format = null;
			var type = null;

			// Type and format
			if(commentModel.fileMimeType) {
				var mimeTypeParts = commentModel.fileMimeType.split('/');
				if(mimeTypeParts.length == 2) {
					format = mimeTypeParts[1];
					type = mimeTypeParts[0];
				}
			}

			// Attachment link
			var link = $('<a/>', {
				'class': 'attachment',
				href: commentModel.fileURL,
				target: '_blank'
			});
			
			// var link = $('<a/>', {
			// 		'class': 'attachment',
			// 		href: 'javascript:viewCommentFileAttach("' + commentModel.fileURL + '","' + commentModel.fileMimeType + '");'
			// });
			
			// Case: image preview
			if(type == 'image') {
				var image = $('<img/>', {
					src: commentModel.fileURL
				});
				link.html(image);
			// Case: video preview
			} else if(type == 'video') {
				var video = $('<video/>', {
					src: commentModel.fileURL,
					type: commentModel.fileMimeType,
					controls: 'controls'
				});
				link.html(video);

			// Case: icon and text
			} else {

				// Icon
				var availableIcons = ['archive', 'audio', 'code', 'excel', 'image', 'movie', 'pdf', 'photo',
					'picture', 'powerpoint', 'sound', 'video', 'word', 'zip'];
				
				var iconClass = 'fa fa-file-o';
				if(availableIcons.indexOf(format) > 0) {
					iconClass = 'fa fa-file-' + format + '-o';
				} else if(availableIcons.indexOf(type) > 0) {
					iconClass = 'fa fa-file-' + type + '-o';
				}

				var fileIcon = $('<i/>', {
					'class': iconClass
				});
				if(this.options.fileIconURL.length) {
					fileIcon.css('background-image', 'url("'+this.options.fileIconURL+'")');
					fileIcon.addClass('image');
				}
				// File name
				/**
				var parts = commentModel.fileURL.split('/');
				var fileName = parts[parts.length - 1];
				fileName = fileName.split('?')[0];
				fileName = decodeURIComponent(fileName);
				*/
				var fileName = commentModel.fileName;
				link.text(fileName);
				link.prepend(fileIcon);
			}
			content.html(link);
		// Case: regular comment
		} else {
			content.html(this.getFormattedCommentContent(commentModel));
		}

		// Edited timestamp
		if(commentModel.modified && commentModel.modified != commentModel.created) {
			var editedTime = this.options.timeFormatter(commentModel.modified);
			var edited = $('<time/>', {
				'class': 'edited',
				text: this.options.textFormatter(this.options.editedText) + ' ' + editedTime,
				'data-original': commentModel.modified
			});
			content.append(edited);
		}

		// Actions
		var actions = $('<span/>', {
			'class': 'actions'
		});

		// Reply
		var reply = $('<button/>', {
			'class': 'action reply',
			'type': 'button',
			text: this.options.textFormatter(this.options.replyText)
		});

		// Upvote icon
		var upvoteIcon = $('<i/>', {
			'class': 'fa fa-thumbs-up'
		});
		if(this.options.upvoteIconURL.length) {
			upvoteIcon.css('background-image', 'url("'+this.options.upvoteIconURL+'")');
			upvoteIcon.addClass('image');
		}

		// Upvotes
		var upvotes = this.createUpvoteElement(commentModel);

		// Append buttons for actions that are enabled
		if(this.options.enableReplying) actions.append(reply);
		if(this.options.enableUpvoting) actions.append(upvotes);

		if(commentModel.createdByCurrentUser || this.options.currentUserIsAdmin) {
			// Case: delete button for attachment and currentUser
			if(isAttachment && this.isAllowedToDelete(commentModel.id)) {
				var deleteButton = $('<button/>', {
					'class': 'action delete enabled',
					text: this.options.textFormatter(this.options.deleteText)
				});
				actions.append(deleteButton);

			// Case: edit button for regular comment
			} else if(!isAttachment && this.options.enableEditing) {
				var editButton = $('<button/>', {
					'class': 'action edit',
					text: this.options.textFormatter(this.options.editText)
				});
				actions.append(editButton);
				var deleteButton = $('<button/>', {
					'class': 'action delete enabled',
					text: this.options.textFormatter(this.options.deleteText)
				});
				actions.append(deleteButton);
			}
		}

		wrapper.append(content);
		if(commentModel.opinion == true) {
			wrapper.append(noteOpinion);
		}
		wrapper.append(actions);
		commentWrapper.append(profilePicture).append(time).append(name).append(wrapper);
		return commentWrapper;
	},

	createUpvoteElement: function(commentModel) {
		// Upvote icon
		var upvoteIcon = $('<i/>', {
			'class': 'fa fa-thumbs-up'
		});
		if(this.options.upvoteIconURL.length) {
			upvoteIcon.css('background-image', 'url("'+this.options.upvoteIconURL+'")');
			upvoteIcon.addClass('image');
		}

		// Upvotes
		var upvoteEl = $('<button/>', {
			'class': 'action upvote' + (commentModel.userHasUpvoted ? ' highlight-font' : '')
		}).append($('<span/>', {
			text: commentModel.upvoteCount,
			'class': 'upvote-count'
		})).append(upvoteIcon);

		return upvoteEl;
	},

	createTagElement: function(text, extraClasses, value) {
		var tagEl = $('<input/>', {
			'class': 'tag',
			'type': 'button',
			'data-role': 'none',
		});
		if(extraClasses) tagEl.addClass(extraClasses);
		tagEl.val(text);
		tagEl.attr('data-value', value);
		return tagEl;
	},

	reRenderComment: function(id) {
		var commentModel = this.commentsById[id];
		var commentElements = this.$el.find('li.comment[data-id="'+commentModel.id+'"]');

		var self = this;
		commentElements.each(function(index, commentEl) {
			var commentWrapper = self.createCommentWrapperElement(commentModel);
			$(commentEl).find('.comment-wrapper').first().replaceWith(commentWrapper);
		});
	},

	reRenderCommentActionBar: function(id) {
		var commentModel = this.commentsById[id];
		var commentElements = this.$el.find('li.comment[data-id="'+commentModel.id+'"]');

		var self = this;
		commentElements.each(function(index, commentEl) {
			var commentWrapper = self.createCommentWrapperElement(commentModel);
			$(commentEl).find('.actions').first().replaceWith(commentWrapper.find('.actions'));
		});
	},

	reRenderUpvotes: function(id) {
		var commentModel = this.commentsById[id];
		var commentElements = this.$el.find('li.comment[data-id="'+commentModel.id+'"]');

		var self = this;
		commentElements.each(function(index, commentEl) {
			var upvotes = self.createUpvoteElement(commentModel);
			$(commentEl).find('.upvote').first().replaceWith(upvotes);
		});
	},


	// Styling
	createCssDeclarations: function() {

		// Remove previous css-declarations
		$('head style.jquery-comments-css').remove();

		// Navigation underline
		this.createCss('.jquery-comments ul.navigation li.active:after {background: '
			+ this.options.highlightColor  + ' !important;',
			+'}');

		// Dropdown active element
		this.createCss('.jquery-comments ul.navigation ul.dropdown li.active {background: '
			+ this.options.highlightColor  + ' !important;',
			+'}');

		// Background highlight
		this.createCss('.jquery-comments .highlight-background {background: '
			+ this.options.highlightColor  + ' !important;',
			+'}');

		// Font highlight
		this.createCss('.jquery-comments .highlight-font {color: '
			+ this.options.highlightColor + ' !important;'
			+'}');
		this.createCss('.jquery-comments .highlight-font-bold {color: '
			+ this.options.highlightColor + ' !important;'
			+ 'font-weight: bold;'
			+'}');
	},

	createCss: function(css) {
		var styleEl = $('<style/>', {
			type: 'text/css',
			'class': 'jquery-comments-css',
			text: css
		});
		$('head').append(styleEl);
	},

	//
	getComments: function() {
		var self = this;
		let commentArr = Object.keys(this.commentsById).map(function(id){return self.commentsById[id]})
		let importantCmtArr = commentArr.filter(function(comment){return comment.opinion})
		let importantCmtUser = commentArr.filter(function(comment){return comment.opinion&&comment.createdByCurrentUser})
		let attachCmtArr = commentArr.filter(function(comment){return comment.fileURL != undefined})
		if (commentArr.length > 3) {
			$('.data-container[data-container=comments]').addClass('lessEl')
		} else {
			$('.data-container[data-container=comments]').addClass('fullEl')
		}
		// 
		if (importantCmtArr.length > 3) {
			$('.data-container[data-container=importantCmt]').addClass('lessEl')
		} else {
			$('.data-container[data-container=importantCmt]').addClass('fullEl')
		}
		if (importantCmtUser.length > 0) {
			$('.opinion').hide()
		} else {
			$('.opinion').show()
		}
		// 
		if (attachCmtArr.length > 3) {
			$('.data-container[data-container=attachments]').addClass('lessEl')
		} else {
			$('.data-container[data-container=attachments]').addClass('fullEl')
		}

		return Object.keys(this.commentsById).map(function(id){return self.commentsById[id]});
	},

	getUsers: function() {
		var self = this;
		return Object.keys(this.usersById).map(function(id){return self.usersById[id]});
	},

	getChildComments: function(parentId) {
		return this.getComments().filter(function(comment){return comment.parent == parentId});
	},

	getAttachments: function() {
		var self = this;
		return this.getComments().filter(function(comment){return comment.fileURL != undefined});
	},
	getImportantCmt: function() {
		var self = this;
		return this.getComments().filter(function(comment){return comment.opinion == true});
	},
	getOutermostParent: function(directParentId) {
		var parentId = directParentId;
		do {
			var parentComment = this.commentsById[parentId];
			parentId = parentComment.parent;
		} while(parentComment.parent != null);
		return parentComment;
	},

	createCommentJSON: function(textarea) {
		var time = new Date().toISOString();
		var commentJSON = {
			id: 'c' +  (this.getComments().length + 1),   // Temporary id
			parent: textarea.attr('data-parent') || null,
			created: time,
			modified: time,
			content: this.getTextareaContent(textarea),
			pings: this.getPings(textarea),
			fullname: this.options.textFormatter(this.options.youText),
			profilePictureURL: this.options.profilePictureURL,
			createdByCurrentUser: true,
			upvoteCount: 0,
			userHasUpvoted: false
		};
		return commentJSON;
	},

	isAllowedToDelete: function(commentId) {
		if(this.options.enableDeleting) {
			var isAllowedToDelete = true;
			if(!this.options.enableDeletingCommentWithReplies) {
				$(this.getComments()).each(function(index, comment) {
					if(comment.parent == commentId) isAllowedToDelete = false;
				});
			}
			return isAllowedToDelete;
		}
		return false;
	},

	setToggleAllButtonText: function(toggleAllButton, toggle) {
		var self = this;
		var textContainer = toggleAllButton.find('span.text');
		var caret = toggleAllButton.find('.caret');

		var showExpandingText = function() {
				var text = self.options.textFormatter(self.options.viewAllRepliesText);
				var replyCount = toggleAllButton.siblings('.comment').length;
				text = text.replace('__replyCount__', replyCount);
				textContainer.text(text);
		};

		var hideRepliesText = this.options.textFormatter(this.options.hideRepliesText);

		if(toggle) {
			// Toggle text
			if(textContainer.text() == hideRepliesText) {
				showExpandingText();
			} else {
				textContainer.text(hideRepliesText);
			}
			// Toggle direction of the caret
			caret.toggleClass('up');
		} else {
			// Update text if necessary
			if(textContainer.text() != hideRepliesText) {
				showExpandingText();
			}
		}
	},

	adjustTextareaHeight: function(textarea, focus) {
		var textareaBaseHeight = 2.2;
		var lineHeight = 1.45;

		var setRows = function(rows) {
			var height = textareaBaseHeight + (rows - 1) * lineHeight;
			textarea.css('height', height + 'em');
		};

		textarea = $(textarea);
		var rowCount = focus == true ? this.options.textareaRowsOnFocus : this.options.textareaRows;
		do {
			setRows(rowCount);
			rowCount++;
			var isAreaScrollable = textarea[0].scrollHeight > textarea.outerHeight();
			var maxRowsUsed = this.options.textareaMaxRows == false ?
				false : rowCount > this.options.textareaMaxRows;
		} while(isAreaScrollable && !maxRowsUsed);
	},

	clearTextarea: function(textarea) {
		textarea.empty().trigger('input');
	},

	getTextareaContent: function(textarea, humanReadable) {
		var textareaClone = textarea.clone();

		// Remove reply-to tag
		textareaClone.find('.reply-to.tag').remove();

		// Replace tags with text values
		textareaClone.find('.tag.hashtag').replaceWith(function(){
			return humanReadable ? $(this).val() : '#' + $(this).attr('data-value');
		});
		textareaClone.find('.tag.ping').replaceWith(function(){
			return humanReadable ? $(this).val() : '@' + $(this).attr('data-value');
		});

		var ce = $('<pre/>').html(textareaClone.html());
		ce.find('div, p, br').replaceWith(function() { return '\n' + this.innerHTML; });

		// Trim leading spaces
		var text = ce.text().replace(/^\s+/g, '');

		// Normalize spaces
		var text = this.normalizeSpaces(text);
		return text;
	},

	getFormattedCommentContent: function(commentModel, replaceNewLines) {
		var html = this.escape(commentModel.content);
		html = this.linkify(html);
		html = this.highlightTags(commentModel, html);
		if(replaceNewLines) html = html.replace(/(?:\n)/g, '<br>');
		return html;
	},

	getPings: function(textarea) {
		return $.map(textarea.find('.ping'), function(el){return parseInt($(el).attr('data-value'))});
	},

	moveCursorToEnd: function(el) {
		el = $(el)[0];

		// Trigger input to adjust size
		$(el).trigger('input');

		// Scroll to bottom
		$(el).scrollTop(el.scrollHeight);

		// Move cursor to end
		if (typeof window.getSelection != 'undefined' && typeof document.createRange != 'undefined') {
			var range = document.createRange();
			range.selectNodeContents(el);
			range.collapse(false);
			var sel = window.getSelection();
			sel.removeAllRanges();
			sel.addRange(range);
		} else if (typeof document.body.createTextRange != 'undefined') {
			var textRange = document.body.createTextRange();
			textRange.moveToElementText(el);
			textRange.collapse(false);
			textRange.select();
		}

		// Focus
		el.focus();
	},

	escape: function(inputText) {
		return $('<pre/>').text(this.normalizeSpaces(inputText)).html();
	},

	normalizeSpaces: function(inputText) {
		return inputText.replace(new RegExp('\u00a0', 'g'), ' ');   // Convert non-breaking spaces to reguar spaces
	},

	after: function(times, func) {
		var self = this;
		return function() {
			times--;
			if (times == 0) {
				return func.apply(self, arguments);
			}
		}
	},

	highlightTags: function(commentModel, html) {
		if(this.options.enableHashtags) html = this.highlightHashtags(commentModel, html);
		if(this.options.enablePinging) html = this.highlightPings(commentModel, html);
		return html;
	},

	highlightHashtags: function(commentModel, html) {
		var self = this;

		if(html.indexOf('#') != -1) {
			var __createTag = function(tag) {
				var tag = self.createTagElement('#' + tag, 'hashtag', tag);
				return tag[0].outerHTML;
			}

			var regex = /(^|\s)#([a-zäöüß\d-_]+)/gim;
			html = html.replace(regex, function($0, $1, $2){
				return $1 + __createTag($2);
			});
		}
		return html;
	},

	highlightPings: function(commentModel, html) {
		var self = this;

		if(html.indexOf('@') != -1) {

			var __createTag = function(user) {
				var tag = self.createTagElement('@' + user.fullname, 'ping', user.id);
				return tag[0].outerHTML;
			}

			var highlightedHtml = '';
			$(commentModel.pings).each(function(index, id) {
				if(id in self.usersById) {
					var user = self.usersById[id];
					var pingText = '@' + user.id;

					var endIndex = html.indexOf(pingText) + pingText.length;
					var current = html.slice(0, endIndex);
					highlightedHtml += current.replace(pingText, __createTag(user));

					html = html.slice(endIndex);
				}
			});
			highlightedHtml += html;
			return highlightedHtml;
		}
		return html;
	},

	linkify: function(inputText) {
		var replacedText, replacePattern1, replacePattern2, replacePattern3;

		// URLs starting with http://, https://, file:// or ftp://
		replacePattern1 = /(^|\s)((https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim;
		replacedText = inputText.replace(replacePattern1, '$1<a href="$2" target="_blank">$2</a>');

		// URLs starting with "www." (without // before it, or it'd re-link the ones done above).
		replacePattern2 = /(^|\s)(www\.[\S]+(\b|$))/gim;
		replacedText = replacedText.replace(replacePattern2, '$1<a href="http://$2" target="_blank">$2</a>');

		// Change email addresses to mailto:: links.
		replacePattern3 = /(^|\s)(([a-zA-Z0-9\-\_\.]+)@[a-zA-Z\_]+?(\.[a-zA-Z]{2,6})+)/gim;
		replacedText = replacedText.replace(replacePattern3, '$1<a href="mailto:$2">$2</a>');

		// If there are hrefs in the original text, let's split
		// the text up and only work on the parts that don't have urls yet.
		var count = inputText.match(/<a href/g) || [];

		if(count.length > 0){
			// Keep delimiter when splitting
			var splitInput = inputText.split(/(<\/a>)/g);
			for (var i = 0 ; i < splitInput.length ; i++){
				if(splitInput[i].match(/<a href/g) == null){
					splitInput[i] = splitInput[i].replace(replacePattern1, '<a href="$1" target="_blank">$1</a>').replace(replacePattern2, '$1<a href="http://$2" target="_blank">$2</a>').replace(replacePattern3, '<a href="mailto:$1">$1</a>');
				}
			}
			var combinedReplacedText = splitInput.join('');
			return combinedReplacedText;
		} else {
			return replacedText;
		}
	},

	waitUntil: function(condition, callback) {
		var self = this;

		if(condition()) {
			callback();
		} else {
			setTimeout(function() {
				self.waitUntil(condition, callback);
			}, 100);
		}
	},

	applyInternalMappings: function(commentJSON) {
		// Inverting field mappings
		var invertedMappings = {};
		var mappings = this.options.fieldMappings;
		for (var prop in mappings) {
			if(mappings.hasOwnProperty(prop)) {
				invertedMappings[mappings[prop]] = prop;
			}
		}

		return this.applyMappings(invertedMappings, commentJSON);
	},

	applyExternalMappings: function(commentJSON) {
		var mappings = this.options.fieldMappings;
		return this.applyMappings(mappings, commentJSON);
	},

	applyMappings: function(mappings, commentJSON) {
		var result = {};

		for(var key1 in commentJSON) {
			if(key1 in mappings) {
				var key2 = mappings[key1];
				result[key2] = commentJSON[key1];
			}
		}
		return result;
	}

	};

	$.fn.comments = function(options) {
		return this.each(function() {
			var comments = Object.create(Comments);
			$.data(this, 'comments', comments);
			comments.init(options || {}, this);
		});
	};
}));


/* eslint-disable */
/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(36)))

/***/ }),

/***/ 695:
/***/ (function(module, exports, __webpack_require__) {

var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (factory) {
  if (true) {
    // AMD. Register as an anonymous module.
    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(36)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),
				__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?
				(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),
				__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));
  } else if (typeof module === "object" && module.exports) {
    var $ = require('jquery');
    module.exports = factory($);
  } else {
    // Browser globals
    factory(jQuery);
  }
}(function (jQuery) {

/*!
 * jQuery.textcomplete
 *
 * Repository: https://github.com/yuku-t/jquery-textcomplete
 * License:    MIT (https://github.com/yuku-t/jquery-textcomplete/blob/master/LICENSE)
 * Author:     Yuku Takahashi
 */

if (typeof jQuery === 'undefined') {
  throw new Error('jQuery.textcomplete requires jQuery');
}

+function ($) {
  'use strict';

  var warn = function (message) {
    if (console.warn) { console.warn(message); }
  };

  var id = 1;

  $.fn.textcomplete = function (strategies, option) {
    var args = Array.prototype.slice.call(arguments);
    return this.each(function () {
      var self = this;
      var $this = $(this);
      var completer = $this.data('textComplete');
      if (!completer) {
        option || (option = {});
        option._oid = id++;  // unique object id
        completer = new $.fn.textcomplete.Completer(this, option);
        $this.data('textComplete', completer);
      }
      if (typeof strategies === 'string') {
        if (!completer) return;
        args.shift()
        completer[strategies].apply(completer, args);
        if (strategies === 'destroy') {
          $this.removeData('textComplete');
        }
      } else {
        // For backward compatibility.
        // TODO: Remove at v0.4
        $.each(strategies, function (obj) {
          $.each(['header', 'footer', 'placement', 'maxCount'], function (name) {
            if (obj[name]) {
              completer.option[name] = obj[name];
              warn(name + 'as a strategy param is deprecated. Use option.');
              delete obj[name];
            }
          });
        });
        completer.register($.fn.textcomplete.Strategy.parse(strategies, {
          el: self,
          $el: $this
        }));
      }
    });
  };

}(jQuery);

+function ($) {
  'use strict';

  // Exclusive execution control utility.
  //
  // func - The function to be locked. It is executed with a function named
  //        `free` as the first argument. Once it is called, additional
  //        execution are ignored until the free is invoked. Then the last
  //        ignored execution will be replayed immediately.
  //
  // Examples
  //
  //   var lockedFunc = lock(function (free) {
  //     setTimeout(function { free(); }, 1000); // It will be free in 1 sec.
  //     console.log('Hello, world');
  //   });
  //   lockedFunc();  // => 'Hello, world'
  //   lockedFunc();  // none
  //   lockedFunc();  // none
  //   // 1 sec past then
  //   // => 'Hello, world'
  //   lockedFunc();  // => 'Hello, world'
  //   lockedFunc();  // none
  //
  // Returns a wrapped function.
  var lock = function (func) {
    var locked, queuedArgsToReplay;

    return function () {
      // Convert arguments into a real array.
      var args = Array.prototype.slice.call(arguments);
      if (locked) {
        // Keep a copy of this argument list to replay later.
        // OK to overwrite a previous value because we only replay
        // the last one.
        queuedArgsToReplay = args;
        return;
      }
      locked = true;
      var self = this;
      args.unshift(function replayOrFree() {
        if (queuedArgsToReplay) {
          // Other request(s) arrived while we were locked.
          // Now that the lock is becoming available, replay
          // the latest such request, then call back here to
          // unlock (or replay another request that arrived
          // while this one was in flight).
          var replayArgs = queuedArgsToReplay;
          queuedArgsToReplay = undefined;
          replayArgs.unshift(replayOrFree);
          func.apply(self, replayArgs);
        } else {
          locked = false;
        }
      });
      func.apply(this, args);
    };
  };

  var isString = function (obj) {
    return Object.prototype.toString.call(obj) === '[object String]';
  };

  var uniqueId = 0;
  var initializedEditors = [];

  function Completer(element, option) {
    this.$el        = $(element);
    this.id         = 'textcomplete' + uniqueId++;
    this.strategies = [];
    this.views      = [];
    this.option     = $.extend({}, Completer.defaults, option);

    if (!this.$el.is('input[type=text]') && !this.$el.is('input[type=search]') && !this.$el.is('textarea') && !element.isContentEditable && element.contentEditable != 'true') {
      throw new Error('textcomplete must be called on a Textarea or a ContentEditable.');
    }

    // use ownerDocument to fix iframe / IE issues
    if (element === element.ownerDocument.activeElement) {
      // element has already been focused. Initialize view objects immediately.
      this.initialize()
    } else {
      // Initialize view objects lazily.
      var self = this;
      this.$el.one('focus.' + this.id, function () { self.initialize(); });

      // Special handling for CKEditor: lazy init on instance load
      if ((!this.option.adapter || this.option.adapter == 'CKEditor') && typeof CKEDITOR != 'undefined' && (this.$el.is('textarea'))) {
        CKEDITOR.on("instanceReady", function(event) { //For multiple ckeditors on one page: this needs to be executed each time a ckeditor-instance is ready.

          if($.inArray(event.editor.id, initializedEditors) == -1) { //For multiple ckeditors on one page: focus-eventhandler should only be added once for every editor.
            initializedEditors.push(event.editor.id);
			
            event.editor.on("focus", function(event2) {
				//replace the element with the Iframe element and flag it as CKEditor
				self.$el = $(event.editor.editable().$);
				if (!self.option.adapter) {
					self.option.adapter = $.fn.textcomplete['CKEditor'];
				}
				self.option.ckeditor_instance = event.editor; //For multiple ckeditors on one page: in the old code this was not executed when adapter was alread set. So we were ALWAYS working with the FIRST instance.
              	self.initialize();
            });
          }
        });
      }
    }
  }

  Completer.defaults = {
    appendTo: 'body',
    className: '',  // deprecated option
    dropdownClassName: 'dropdown-menu textcomplete-dropdown',
    maxCount: 10,
    zIndex: '100',
    rightEdgeOffset: 30
  };

  $.extend(Completer.prototype, {
    // Public properties
    // -----------------

    id:         null,
    option:     null,
    strategies: null,
    adapter:    null,
    dropdown:   null,
    $el:        null,
    $iframe:    null,

    // Public methods
    // --------------

    initialize: function () {
      var element = this.$el.get(0);
      
      // check if we are in an iframe
      // we need to alter positioning logic if using an iframe
      if (this.$el.prop('ownerDocument') !== document && window.frames.length) {
        for (var iframeIndex = 0; iframeIndex < window.frames.length; iframeIndex++) {
          if (this.$el.prop('ownerDocument') === window.frames[iframeIndex].document) {
            this.$iframe = $(window.frames[iframeIndex].frameElement);
            break;
          }
        }
      }
      
      
      // Initialize view objects.
      this.dropdown = new $.fn.textcomplete.Dropdown(element, this, this.option);
      var Adapter, viewName;
      if (this.option.adapter) {
        Adapter = this.option.adapter;
      } else {
        if (this.$el.is('textarea') || this.$el.is('input[type=text]') || this.$el.is('input[type=search]')) {
          viewName = typeof element.selectionEnd === 'number' ? 'Textarea' : 'IETextarea';
        } else {
          viewName = 'ContentEditable';
        }
        Adapter = $.fn.textcomplete[viewName];
      }
      this.adapter = new Adapter(element, this, this.option);
    },

    destroy: function () {
      this.$el.off('.' + this.id);
      if (this.adapter) {
        this.adapter.destroy();
      }
      if (this.dropdown) {
        this.dropdown.destroy();
      }
      this.$el = this.adapter = this.dropdown = null;
    },

    deactivate: function () {
      if (this.dropdown) {
        this.dropdown.deactivate();
      }
    },

    // Invoke textcomplete.
    trigger: function (text, skipUnchangedTerm) {
      if (!this.dropdown) { this.initialize(); }
      text != null || (text = this.adapter.getTextFromHeadToCaret());
      var searchQuery = this._extractSearchQuery(text);
      if (searchQuery.length) {
        var term = searchQuery[1];
        // Ignore shift-key, ctrl-key and so on.
        if (skipUnchangedTerm && this._term === term && term !== "") { return; }
        this._term = term;
        this._search.apply(this, searchQuery);
      } else {
        this._term = null;
        this.dropdown.deactivate();
      }
    },

    fire: function (eventName) {
      var args = Array.prototype.slice.call(arguments, 1);
      this.$el.trigger(eventName, args);
      return this;
    },

    register: function (strategies) {
      Array.prototype.push.apply(this.strategies, strategies);
    },

    // Insert the value into adapter view. It is called when the dropdown is clicked
    // or selected.
    //
    // value    - The selected element of the array callbacked from search func.
    // strategy - The Strategy object.
    // e        - Click or keydown event object.
    select: function (value, strategy, e) {
      this._term = null;
      this.adapter.select(value, strategy, e);
      this.fire('change').fire('textComplete:select', value, strategy);
      this.adapter.focus();
    },

    // Private properties
    // ------------------

    _clearAtNext: true,
    _term:        null,

    // Private methods
    // ---------------

    // Parse the given text and extract the first matching strategy.
    //
    // Returns an array including the strategy, the query term and the match
    // object if the text matches an strategy; otherwise returns an empty array.
    _extractSearchQuery: function (text) {
      for (var i = 0; i < this.strategies.length; i++) {
        var strategy = this.strategies[i];
        var context = strategy.context(text);
        if (context || context === '') {
          var matchRegexp = $.isFunction(strategy.match) ? strategy.match(text) : strategy.match;
          if (isString(context)) { text = context; }
          var match = text.match(matchRegexp);
          if (match) { return [strategy, match[strategy.index], match]; }
        }
      }
      return []
    },

    // Call the search method of selected strategy..
    _search: lock(function (free, strategy, term, match) {
      var self = this;
      strategy.search(term, function (data, stillSearching) {
        if (!self.dropdown.shown) {
          self.dropdown.activate();
        }
        if (self._clearAtNext) {
          // The first callback in the current lock.
          self.dropdown.clear();
          self._clearAtNext = false;
        }
        self.dropdown.setPosition(self.adapter.getCaretPosition());
        self.dropdown.render(self._zip(data, strategy, term));
        if (!stillSearching) {
          // The last callback in the current lock.
          free();
          self._clearAtNext = true; // Call dropdown.clear at the next time.
        }
      }, match);
    }),

    // Build a parameter for Dropdown#render.
    //
    // Examples
    //
    //  this._zip(['a', 'b'], 's');
    //  //=> [{ value: 'a', strategy: 's' }, { value: 'b', strategy: 's' }]
    _zip: function (data, strategy, term) {
      return $.map(data, function (value) {
        return { value: value, strategy: strategy, term: term };
      });
    }
  });

  $.fn.textcomplete.Completer = Completer;
}(jQuery);

+function ($) {
  'use strict';

  var $window = $(window);

  var include = function (zippedData, datum) {
    var i, elem;
    var idProperty = datum.strategy.idProperty
    for (i = 0; i < zippedData.length; i++) {
      elem = zippedData[i];
      if (elem.strategy !== datum.strategy) continue;
      if (idProperty) {
        if (elem.value[idProperty] === datum.value[idProperty]) return true;
      } else {
        if (elem.value === datum.value) return true;
      }
    }
    return false;
  };

  var dropdownViews = {};
  $(document).on('click', function (e) {
    var id = e.originalEvent && e.originalEvent.keepTextCompleteDropdown;
    $.each(dropdownViews, function (key, view) {
      if (key !== id) { view.deactivate(); }
    });
  });

  var commands = {
    SKIP_DEFAULT: 0,
    KEY_UP: 1,
    KEY_DOWN: 2,
    KEY_ENTER: 3,
    KEY_PAGEUP: 4,
    KEY_PAGEDOWN: 5,
    KEY_ESCAPE: 6
  };

  // Dropdown view
  // =============

  // Construct Dropdown object.
  //
  // element - Textarea or contenteditable element.
  function Dropdown(element, completer, option) {
    this.$el       = Dropdown.createElement(option);
    this.completer = completer;
    this.id        = completer.id + 'dropdown';
    this._data     = []; // zipped data.
    this.$inputEl  = $(element);
    this.option    = option;

    // Override setPosition method.
    if (option.listPosition) { this.setPosition = option.listPosition; }
    if (option.height) { this.$el.height(option.height); }
    var self = this;
    $.each(['maxCount', 'placement', 'footer', 'header', 'noResultsMessage', 'className'], function (_i, name) {
      if (option[name] != null) { self[name] = option[name]; }
    });
    this._bindEvents(element);
    dropdownViews[this.id] = this;
  }

  $.extend(Dropdown, {
    // Class methods
    // -------------

    createElement: function (option) {
      var $parent = option.appendTo;
      if (!($parent instanceof $)) { $parent = $($parent); }
      var $el = $('<ul></ul>')
        .addClass(option.dropdownClassName)
        .attr('id', 'textcomplete-dropdown-' + option._oid)
        .css({
          display: 'none',
          left: 0,
          position: 'absolute',
          zIndex: option.zIndex
        })
        .appendTo($parent);
      return $el;
    }
  });

  $.extend(Dropdown.prototype, {
    // Public properties
    // -----------------

    $el:       null,  // jQuery object of ul.dropdown-menu element.
    $inputEl:  null,  // jQuery object of target textarea.
    completer: null,
    footer:    null,
    header:    null,
    id:        null,
    maxCount:  null,
    placement: '',
    shown:     false,
    data:      [],     // Shown zipped data.
    className: '',

    // Public methods
    // --------------

    destroy: function () {
      // Don't remove $el because it may be shared by several textcompletes.
      this.deactivate();

      this.$el.off('.' + this.id);
      this.$inputEl.off('.' + this.id);
      this.clear();
      this.$el.remove();
      this.$el = this.$inputEl = this.completer = null;
      delete dropdownViews[this.id]
    },

    render: function (zippedData) {
      var contentsHtml = this._buildContents(zippedData);
      var unzippedData = $.map(zippedData, function (d) { return d.value; });
      if (zippedData.length) {
        var strategy = zippedData[0].strategy;
        if (strategy.id) {
          this.$el.attr('data-strategy', strategy.id);
        } else {
          this.$el.removeAttr('data-strategy');
        }
        this._renderHeader(unzippedData);
        this._renderFooter(unzippedData);
        if (contentsHtml) {
          this._renderContents(contentsHtml);
          this._fitToBottom();
          this._fitToRight();
          this._activateIndexedItem();
        }
        this._setScroll();
      } else if (this.noResultsMessage) {
        this._renderNoResultsMessage(unzippedData);
      } else if (this.shown) {
        this.deactivate();
      }
    },

    setPosition: function (pos) {
      // Make the dropdown fixed if the input is also fixed
      // This can't be done during init, as textcomplete may be used on multiple elements on the same page
      // Because the same dropdown is reused behind the scenes, we need to recheck every time the dropdown is showed
      var position = 'absolute';
      // Check if input or one of its parents has positioning we need to care about
      this.$inputEl.add(this.$inputEl.parents()).each(function() {
        if($(this).css('position') === 'absolute') // The element has absolute positioning, so it's all OK
          return false;
        if($(this).css('position') === 'fixed') {
          pos.top -= $window.scrollTop();
          pos.left -= $window.scrollLeft();
          position = 'fixed';
          return false;
        }
      });
      this.$el.css(this._applyPlacement(pos));
      this.$el.css({ position: position }); // Update positioning

      return this;
    },

    clear: function () {
      this.$el.html('');
      this.data = [];
      this._index = 0;
      this._$header = this._$footer = this._$noResultsMessage = null;
    },

    activate: function () {
      if (!this.shown) {
        this.clear();
        this.$el.show();
        if (this.className) { this.$el.addClass(this.className); }
        this.completer.fire('textComplete:show');
        this.shown = true;
      }
      return this;
    },

    deactivate: function () {
      if (this.shown) {
        this.$el.hide();
        if (this.className) { this.$el.removeClass(this.className); }
        this.completer.fire('textComplete:hide');
        this.shown = false;
      }
      return this;
    },

    isUp: function (e) {
      return e.keyCode === 38 || (e.ctrlKey && e.keyCode === 80);  // UP, Ctrl-P
    },

    isDown: function (e) {
      return e.keyCode === 40 || (e.ctrlKey && e.keyCode === 78);  // DOWN, Ctrl-N
    },

    isEnter: function (e) {
      var modifiers = e.ctrlKey || e.altKey || e.metaKey || e.shiftKey;
      return !modifiers && (e.keyCode === 13 || e.keyCode === 9 || (this.option.completeOnSpace === true && e.keyCode === 32))  // ENTER, TAB
    },

    isPageup: function (e) {
      return e.keyCode === 33;  // PAGEUP
    },

    isPagedown: function (e) {
      return e.keyCode === 34;  // PAGEDOWN
    },

    isEscape: function (e) {
      return e.keyCode === 27;  // ESCAPE
    },

    // Private properties
    // ------------------

    _data:    null,  // Currently shown zipped data.
    _index:   null,
    _$header: null,
    _$noResultsMessage: null,
    _$footer: null,

    // Private methods
    // ---------------

    _bindEvents: function () {
      this.$el.on('mousedown.' + this.id, '.textcomplete-item', $.proxy(this._onClick, this));
      this.$el.on('touchstart.' + this.id, '.textcomplete-item', $.proxy(this._onClick, this));
      this.$el.on('mouseover.' + this.id, '.textcomplete-item', $.proxy(this._onMouseover, this));
      this.$inputEl.on('keydown.' + this.id, $.proxy(this._onKeydown, this));
    },

    _onClick: function (e) {
      var $el = $(e.target);
      e.preventDefault();
      e.originalEvent.keepTextCompleteDropdown = this.id;
      if (!$el.hasClass('textcomplete-item')) {
        $el = $el.closest('.textcomplete-item');
      }
      var datum = this.data[parseInt($el.data('index'), 10)];
      this.completer.select(datum.value, datum.strategy, e);
      var self = this;
      // Deactive at next tick to allow other event handlers to know whether
      // the dropdown has been shown or not.
      setTimeout(function () {
        self.deactivate();
        if (e.type === 'touchstart') {
          self.$inputEl.focus();
        }
      }, 0);
    },

    // Activate hovered item.
    _onMouseover: function (e) {
      var $el = $(e.target);
      e.preventDefault();
      if (!$el.hasClass('textcomplete-item')) {
        $el = $el.closest('.textcomplete-item');
      }
      this._index = parseInt($el.data('index'), 10);
      this._activateIndexedItem();
    },

    _onKeydown: function (e) {
      if (!this.shown) { return; }

      var command;

      if ($.isFunction(this.option.onKeydown)) {
        command = this.option.onKeydown(e, commands);
      }

      if (command == null) {
        command = this._defaultKeydown(e);
      }

      switch (command) {
        case commands.KEY_UP:
          e.preventDefault();
          this._up();
          break;
        case commands.KEY_DOWN:
          e.preventDefault();
          this._down();
          break;
        case commands.KEY_ENTER:
          e.preventDefault();
          this._enter(e);
          break;
        case commands.KEY_PAGEUP:
          e.preventDefault();
          this._pageup();
          break;
        case commands.KEY_PAGEDOWN:
          e.preventDefault();
          this._pagedown();
          break;
        case commands.KEY_ESCAPE:
          e.preventDefault();
          this.deactivate();
          break;
      }
    },

    _defaultKeydown: function (e) {
      if (this.isUp(e)) {
        return commands.KEY_UP;
      } else if (this.isDown(e)) {
        return commands.KEY_DOWN;
      } else if (this.isEnter(e)) {
        return commands.KEY_ENTER;
      } else if (this.isPageup(e)) {
        return commands.KEY_PAGEUP;
      } else if (this.isPagedown(e)) {
        return commands.KEY_PAGEDOWN;
      } else if (this.isEscape(e)) {
        return commands.KEY_ESCAPE;
      }
    },

    _up: function () {
      if (this._index === 0) {
        this._index = this.data.length - 1;
      } else {
        this._index -= 1;
      }
      this._activateIndexedItem();
      this._setScroll();
    },

    _down: function () {
      if (this._index === this.data.length - 1) {
        this._index = 0;
      } else {
        this._index += 1;
      }
      this._activateIndexedItem();
      this._setScroll();
    },

    _enter: function (e) {
      var datum = this.data[parseInt(this._getActiveElement().data('index'), 10)];
      this.completer.select(datum.value, datum.strategy, e);
      this.deactivate();
    },

    _pageup: function () {
      var target = 0;
      var threshold = this._getActiveElement().position().top - this.$el.innerHeight();
      this.$el.children().each(function (i) {
        if ($(this).position().top + $(this).outerHeight() > threshold) {
          target = i;
          return false;
        }
      });
      this._index = target;
      this._activateIndexedItem();
      this._setScroll();
    },

    _pagedown: function () {
      var target = this.data.length - 1;
      var threshold = this._getActiveElement().position().top + this.$el.innerHeight();
      this.$el.children().each(function (i) {
        if ($(this).position().top > threshold) {
          target = i;
          return false
        }
      });
      this._index = target;
      this._activateIndexedItem();
      this._setScroll();
    },

    _activateIndexedItem: function () {
      this.$el.find('.textcomplete-item.active').removeClass('active');
      this._getActiveElement().addClass('active');
    },

    _getActiveElement: function () {
      return this.$el.children('.textcomplete-item:nth(' + this._index + ')');
    },

    _setScroll: function () {
      var $activeEl = this._getActiveElement();
      var itemTop = $activeEl.position().top;
      var itemHeight = $activeEl.outerHeight();
      var visibleHeight = this.$el.innerHeight();
      var visibleTop = this.$el.scrollTop();
      if (this._index === 0 || this._index == this.data.length - 1 || itemTop < 0) {
        this.$el.scrollTop(itemTop + visibleTop);
      } else if (itemTop + itemHeight > visibleHeight) {
        this.$el.scrollTop(itemTop + itemHeight + visibleTop - visibleHeight);
      }
    },

    _buildContents: function (zippedData) {
      var datum, i, index;
      var html = '';
      for (i = 0; i < zippedData.length; i++) {
        if (this.data.length === this.maxCount) break;
        datum = zippedData[i];
        if (include(this.data, datum)) { continue; }
        index = this.data.length;
        this.data.push(datum);
        html += '<li class="textcomplete-item" data-index="' + index + '"><a>';
        html +=   datum.strategy.template(datum.value, datum.term);
        html += '</a></li>';
      }
      return html;
    },

    _renderHeader: function (unzippedData) {
      if (this.header) {
        if (!this._$header) {
          this._$header = $('<li class="textcomplete-header"></li>').prependTo(this.$el);
        }
        var html = $.isFunction(this.header) ? this.header(unzippedData) : this.header;
        this._$header.html(html);
      }
    },

    _renderFooter: function (unzippedData) {
      if (this.footer) {
        if (!this._$footer) {
          this._$footer = $('<li class="textcomplete-footer"></li>').appendTo(this.$el);
        }
        var html = $.isFunction(this.footer) ? this.footer(unzippedData) : this.footer;
        this._$footer.html(html);
      }
    },

    _renderNoResultsMessage: function (unzippedData) {
      if (this.noResultsMessage) {
        if (!this._$noResultsMessage) {
          this._$noResultsMessage = $('<li class="textcomplete-no-results-message"></li>').appendTo(this.$el);
        }
        var html = $.isFunction(this.noResultsMessage) ? this.noResultsMessage(unzippedData) : this.noResultsMessage;
        this._$noResultsMessage.html(html);
      }
    },

    _renderContents: function (html) {
      if (this._$footer) {
        this._$footer.before(html);
      } else {
        this.$el.append(html);
      }
    },

    _fitToBottom: function() {
      var windowScrollBottom = $window.scrollTop() + $window.height();
      var height = this.$el.height();
      if ((this.$el.position().top + height) > windowScrollBottom) {
        // only do this if we are not in an iframe
        if (!this.completer.$iframe) {
          this.$el.offset({top: windowScrollBottom - height});
        }
      }
    },

    _fitToRight: function() {
      // We don't know how wide our content is until the browser positions us, and at that point it clips us
      // to the document width so we don't know if we would have overrun it. As a heuristic to avoid that clipping
      // (which makes our elements wrap onto the next line and corrupt the next item), if we're close to the right
      // edge, move left. We don't know how far to move left, so just keep nudging a bit.
      var tolerance = this.option.rightEdgeOffset; // pixels. Make wider than vertical scrollbar because we might not be able to use that space.
      var lastOffset = this.$el.offset().left, offset;
      var width = this.$el.width();
      var maxLeft = $window.width() - tolerance;
      while (lastOffset + width > maxLeft) {
        this.$el.offset({left: lastOffset - tolerance});
        offset = this.$el.offset().left;
        if (offset >= lastOffset) { break; }
        lastOffset = offset;
      }
    },

    _applyPlacement: function (position) {
      // If the 'placement' option set to 'top', move the position above the element.
      if (this.placement.indexOf('top') !== -1) {
        // Overwrite the position object to set the 'bottom' property instead of the top.
        position = {
          top: 'auto',
          bottom: this.$el.parent().height() - position.top + position.lineHeight,
          left: position.left
        };
      } else {
        position.bottom = 'auto';
        delete position.lineHeight;
      }
      if (this.placement.indexOf('absleft') !== -1) {
        position.left = 0;
      } else if (this.placement.indexOf('absright') !== -1) {
        position.right = 0;
        position.left = 'auto';
      }
      return position;
    }
  });

  $.fn.textcomplete.Dropdown = Dropdown;
  $.extend($.fn.textcomplete, commands);
}(jQuery);

+function ($) {
  'use strict';

  // Memoize a search function.
  var memoize = function (func) {
    var memo = {};
    return function (term, callback) {
      if (memo[term]) {
        callback(memo[term]);
      } else {
        func.call(this, term, function (data) {
          memo[term] = (memo[term] || []).concat(data);
          callback.apply(null, arguments);
        });
      }
    };
  };

  function Strategy(options) {
    $.extend(this, options);
    if (this.cache) { this.search = memoize(this.search); }
  }

  Strategy.parse = function (strategiesArray, params) {
    return $.map(strategiesArray, function (strategy) {
      var strategyObj = new Strategy(strategy);
      strategyObj.el = params.el;
      strategyObj.$el = params.$el;
      return strategyObj;
    });
  };

  $.extend(Strategy.prototype, {
    // Public properties
    // -----------------

    // Required
    match:      null,
    replace:    null,
    search:     null,

    // Optional
    id:         null,
    cache:      false,
    context:    function () { return true; },
    index:      2,
    template:   function (obj) { return obj; },
    idProperty: null
  });

  $.fn.textcomplete.Strategy = Strategy;

}(jQuery);

+function ($) {
  'use strict';

  var now = Date.now || function () { return new Date().getTime(); };

  // Returns a function, that, as long as it continues to be invoked, will not
  // be triggered. The function will be called after it stops being called for
  // `wait` msec.
  //
  // This utility function was originally implemented at Underscore.js.
  var debounce = function (func, wait) {
    var timeout, args, context, timestamp, result;
    var later = function () {
      var last = now() - timestamp;
      if (last < wait) {
        timeout = setTimeout(later, wait - last);
      } else {
        timeout = null;
        result = func.apply(context, args);
        context = args = null;
      }
    };

    return function () {
      context = this;
      args = arguments;
      timestamp = now();
      if (!timeout) {
        timeout = setTimeout(later, wait);
      }
      return result;
    };
  };

  function Adapter () {}

  $.extend(Adapter.prototype, {
    // Public properties
    // -----------------

    id:        null, // Identity.
    completer: null, // Completer object which creates it.
    el:        null, // Textarea element.
    $el:       null, // jQuery object of the textarea.
    option:    null,

    // Public methods
    // --------------

    initialize: function (element, completer, option) {
      this.el        = element;
      this.$el       = $(element);
      this.id        = completer.id + this.constructor.name;
      this.completer = completer;
      this.option    = option;

      if (this.option.debounce) {
        this._onKeyup = debounce(this._onKeyup, this.option.debounce);
      }

      this._bindEvents();
    },

    destroy: function () {
      this.$el.off('.' + this.id); // Remove all event handlers.
      this.$el = this.el = this.completer = null;
    },

    // Update the element with the given value and strategy.
    //
    // value    - The selected object. It is one of the item of the array
    //            which was callbacked from the search function.
    // strategy - The Strategy associated with the selected value.
    select: function (/* value, strategy */) {
      throw new Error('Not implemented');
    },

    // Returns the caret's relative coordinates from body's left top corner.
    getCaretPosition: function () {
      var position = this._getCaretRelativePosition();
      var offset = this.$el.offset();

      // Calculate the left top corner of `this.option.appendTo` element.
      var $parent = this.option.appendTo;
      if ($parent) {
         if (!($parent instanceof $)) { $parent = $($parent); }
         var parentOffset = $parent.offsetParent().offset();
         offset.top -= parentOffset.top;
         offset.left -= parentOffset.left;
      }

      position.top += offset.top;
      position.left += offset.left;
      return position;
    },

    // Focus on the element.
    focus: function () {
      this.$el.focus();
    },

    // Private methods
    // ---------------

    _bindEvents: function () {
      this.$el.on('keyup.' + this.id, $.proxy(this._onKeyup, this));
    },

    _onKeyup: function (e) {
      if (this._skipSearch(e)) { return; }
      this.completer.trigger(this.getTextFromHeadToCaret(), true);
    },

    // Suppress searching if it returns true.
    _skipSearch: function (clickEvent) {
      switch (clickEvent.keyCode) {
        case 9:  // TAB
        case 13: // ENTER
        case 16: // SHIFT
        case 17: // CTRL
        case 18: // ALT
        case 33: // PAGEUP
        case 34: // PAGEDOWN
        case 40: // DOWN
        case 38: // UP
        case 27: // ESC
          return true;
      }
      if (clickEvent.ctrlKey) switch (clickEvent.keyCode) {
        case 78: // Ctrl-N
        case 80: // Ctrl-P
          return true;
      }
    }
  });

  $.fn.textcomplete.Adapter = Adapter;
}(jQuery);

+function ($) {
  'use strict';

  // Textarea adapter
  // ================
  //
  // Managing a textarea. It doesn't know a Dropdown.
  function Textarea(element, completer, option) {
    this.initialize(element, completer, option);
  }

  $.extend(Textarea.prototype, $.fn.textcomplete.Adapter.prototype, {
    // Public methods
    // --------------

    // Update the textarea with the given value and strategy.
    select: function (value, strategy, e) {
      var pre = this.getTextFromHeadToCaret();
      var post = this.el.value.substring(this.el.selectionEnd);
      var newSubstr = strategy.replace(value, e);
      var regExp;
      if (typeof newSubstr !== 'undefined') {
        if ($.isArray(newSubstr)) {
          post = newSubstr[1] + post;
          newSubstr = newSubstr[0];
        }
        regExp = $.isFunction(strategy.match) ? strategy.match(pre) : strategy.match;
        pre = pre.replace(regExp, newSubstr);
        this.$el.val(pre + post);
        this.el.selectionStart = this.el.selectionEnd = pre.length;
      }
    },

    getTextFromHeadToCaret: function () {
      return this.el.value.substring(0, this.el.selectionEnd);
    },

    // Private methods
    // ---------------

    _getCaretRelativePosition: function () {
      var p = $.fn.textcomplete.getCaretCoordinates(this.el, this.el.selectionStart);
      return {
        top: p.top + this._calculateLineHeight() - this.$el.scrollTop(),
        left: p.left - this.$el.scrollLeft(),
        lineHeight: this._calculateLineHeight()
      };
    },

    _calculateLineHeight: function () {
      var lineHeight = parseInt(this.$el.css('line-height'), 10);
      if (isNaN(lineHeight)) {
        // http://stackoverflow.com/a/4515470/1297336
        var parentNode = this.el.parentNode;
        var temp = document.createElement(this.el.nodeName);
        var style = this.el.style;
        temp.setAttribute(
          'style',
          'margin:0px;padding:0px;font-family:' + style.fontFamily + ';font-size:' + style.fontSize
        );
        temp.innerHTML = 'test';
        parentNode.appendChild(temp);
        lineHeight = temp.clientHeight;
        parentNode.removeChild(temp);
      }
      return lineHeight;
    }
  });

  $.fn.textcomplete.Textarea = Textarea;
}(jQuery);

+function ($) {
  'use strict';

  var sentinelChar = '吶';

  function IETextarea(element, completer, option) {
    this.initialize(element, completer, option);
    $('<span>' + sentinelChar + '</span>').css({
      position: 'absolute',
      top: -9999,
      left: -9999
    }).insertBefore(element);
  }

  $.extend(IETextarea.prototype, $.fn.textcomplete.Textarea.prototype, {
    // Public methods
    // --------------

    select: function (value, strategy, e) {
      var pre = this.getTextFromHeadToCaret();
      var post = this.el.value.substring(pre.length);
      var newSubstr = strategy.replace(value, e);
      var regExp;
      if (typeof newSubstr !== 'undefined') {
        if ($.isArray(newSubstr)) {
          post = newSubstr[1] + post;
          newSubstr = newSubstr[0];
        }
        regExp = $.isFunction(strategy.match) ? strategy.match(pre) : strategy.match;
        pre = pre.replace(regExp, newSubstr);
        this.$el.val(pre + post);
        this.el.focus();
        var range = this.el.createTextRange();
        range.collapse(true);
        range.moveEnd('character', pre.length);
        range.moveStart('character', pre.length);
        range.select();
      }
    },

    getTextFromHeadToCaret: function () {
      this.el.focus();
      var range = document.selection.createRange();
      range.moveStart('character', -this.el.value.length);
      var arr = range.text.split(sentinelChar)
      return arr.length === 1 ? arr[0] : arr[1];
    }
  });

  $.fn.textcomplete.IETextarea = IETextarea;
}(jQuery);

// NOTE: TextComplete plugin has contenteditable support but it does not work
//       fine especially on old IEs.
//       Any pull requests are REALLY welcome.

+function ($) {
  'use strict';

  // ContentEditable adapter
  // =======================
  //
  // Adapter for contenteditable elements.
  function ContentEditable (element, completer, option) {
    this.initialize(element, completer, option);
  }

  $.extend(ContentEditable.prototype, $.fn.textcomplete.Adapter.prototype, {
    // Public methods
    // --------------

    // Update the content with the given value and strategy.
    // When an dropdown item is selected, it is executed.
    select: function (value, strategy, e) {
      var pre = this.getTextFromHeadToCaret();
      // use ownerDocument instead of window to support iframes
      var sel = this.el.ownerDocument.getSelection();
      
      var range = sel.getRangeAt(0);
      var selection = range.cloneRange();
      selection.selectNodeContents(range.startContainer);
      var content = selection.toString();
      var post = content.substring(range.startOffset);
      var newSubstr = strategy.replace(value, e);
      var regExp;
      if (typeof newSubstr !== 'undefined') {
        if ($.isArray(newSubstr)) {
          post = newSubstr[1] + post;
          newSubstr = newSubstr[0];
        }
        regExp = $.isFunction(strategy.match) ? strategy.match(pre) : strategy.match;
        pre = pre.replace(regExp, newSubstr)
            .replace(/ $/, "&nbsp"); // &nbsp necessary at least for CKeditor to not eat spaces
        range.selectNodeContents(range.startContainer);
        range.deleteContents();
        
        // create temporary elements
        var preWrapper = this.el.ownerDocument.createElement("div");
        preWrapper.innerHTML = pre;
        var postWrapper = this.el.ownerDocument.createElement("div");
        postWrapper.innerHTML = post;
        
        // create the fragment thats inserted
        var fragment = this.el.ownerDocument.createDocumentFragment();
        var childNode;
        var lastOfPre;
        while (childNode = preWrapper.firstChild) {
        	lastOfPre = fragment.appendChild(childNode);
        }
        while (childNode = postWrapper.firstChild) {
        	fragment.appendChild(childNode);
        }
        
        // insert the fragment & jump behind the last node in "pre"
        range.insertNode(fragment);
        range.setStartAfter(lastOfPre);
        
        range.collapse(true);
        sel.removeAllRanges();
        sel.addRange(range);
      }
    },

    // Private methods
    // ---------------

    // Returns the caret's relative position from the contenteditable's
    // left top corner.
    //
    // Examples
    //
    //   this._getCaretRelativePosition()
    //   //=> { top: 18, left: 200, lineHeight: 16 }
    //
    // Dropdown's position will be decided using the result.
    _getCaretRelativePosition: function () {
      var range = this.el.ownerDocument.getSelection().getRangeAt(0).cloneRange();
      var wrapperNode = range.endContainer.parentNode;
      var node = this.el.ownerDocument.createElement('span');
      range.insertNode(node);
      range.selectNodeContents(node);
      range.deleteContents();
      setTimeout(function() { wrapperNode.normalize(); }, 0);
      var $node = $(node);
      var position = $node.offset();
      position.left -= this.$el.offset().left;
      position.top += $node.height() - this.$el.offset().top;
      position.lineHeight = $node.height();
      
      // special positioning logic for iframes
      // this is typically used for contenteditables such as tinymce or ckeditor
      if (this.completer.$iframe) {
        var iframePosition = this.completer.$iframe.offset();
        position.top += iframePosition.top;
        position.left += iframePosition.left;
        // We need to get the scrollTop of the html-element inside the iframe and not of the body-element,
        // because on IE the scrollTop of the body-element (this.$el) is always zero.
        position.top -= $(this.completer.$iframe[0].contentWindow.document).scrollTop();
      }
      
      $node.remove();
      return position;
    },

    // Returns the string between the first character and the caret.
    // Completer will be triggered with the result for start autocompleting.
    //
    // Example
    //
    //   // Suppose the html is '<b>hello</b> wor|ld' and | is the caret.
    //   this.getTextFromHeadToCaret()
    //   // => ' wor'  // not '<b>hello</b> wor'
    getTextFromHeadToCaret: function () {
      var range = this.el.ownerDocument.getSelection().getRangeAt(0);
      var selection = range.cloneRange();
      selection.selectNodeContents(range.startContainer);
      return selection.toString().substring(0, range.startOffset);
    }
  });

  $.fn.textcomplete.ContentEditable = ContentEditable;
}(jQuery);

// NOTE: TextComplete plugin has contenteditable support but it does not work
//       fine especially on old IEs.
//       Any pull requests are REALLY welcome.

+function ($) {
  'use strict';

  // CKEditor adapter
  // =======================
  //
  // Adapter for CKEditor, based on contenteditable elements.
  function CKEditor (element, completer, option) {
    this.initialize(element, completer, option);
  }

  $.extend(CKEditor.prototype, $.fn.textcomplete.ContentEditable.prototype, {
    _bindEvents: function () {
      var $this = this;
      this.option.ckeditor_instance.on('key', function(event) {
        var domEvent = event.data;
        $this._onKeyup(domEvent);
        if ($this.completer.dropdown.shown && $this._skipSearch(domEvent)) {
          return false;
        }
      }, null, null, 1); // 1 = Priority = Important!
      // we actually also need the native event, as the CKEditor one is happening to late
      this.$el.on('keyup.' + this.id, $.proxy(this._onKeyup, this));
    },
});

  $.fn.textcomplete.CKEditor = CKEditor;
}(jQuery);

// The MIT License (MIT)
// 
// Copyright (c) 2015 Jonathan Ong me@jongleberry.com
// 
// Permission is hereby granted, free of charge, to any person obtaining a copy of this software and
// associated documentation files (the "Software"), to deal in the Software without restriction,
// including without limitation the rights to use, copy, modify, merge, publish, distribute,
// sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is
// furnished to do so, subject to the following conditions:
// 
// The above copyright notice and this permission notice shall be included in all copies or
// substantial portions of the Software.
// 
// THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT
// NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,
// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
//
// https://github.com/component/textarea-caret-position

(function ($) {

// The properties that we copy into a mirrored div.
// Note that some browsers, such as Firefox,
// do not concatenate properties, i.e. padding-top, bottom etc. -> padding,
// so we have to do every single property specifically.
var properties = [
  'direction',  // RTL support
  'boxSizing',
  'width',  // on Chrome and IE, exclude the scrollbar, so the mirror div wraps exactly as the textarea does
  'height',
  'overflowX',
  'overflowY',  // copy the scrollbar for IE

  'borderTopWidth',
  'borderRightWidth',
  'borderBottomWidth',
  'borderLeftWidth',
  'borderStyle',

  'paddingTop',
  'paddingRight',
  'paddingBottom',
  'paddingLeft',

  // https://developer.mozilla.org/en-US/docs/Web/CSS/font
  'fontStyle',
  'fontVariant',
  'fontWeight',
  'fontStretch',
  'fontSize',
  'fontSizeAdjust',
  'lineHeight',
  'fontFamily',

  'textAlign',
  'textTransform',
  'textIndent',
  'textDecoration',  // might not make a difference, but better be safe

  'letterSpacing',
  'wordSpacing',

  'tabSize',
  'MozTabSize'

];

var isBrowser = (typeof window !== 'undefined');
var isFirefox = (isBrowser && window.mozInnerScreenX != null);

function getCaretCoordinates(element, position, options) {
  if(!isBrowser) {
    throw new Error('textarea-caret-position#getCaretCoordinates should only be called in a browser');
  }

  var debug = options && options.debug || false;
  if (debug) {
    var el = document.querySelector('#input-textarea-caret-position-mirror-div');
    if ( el ) { el.parentNode.removeChild(el); }
  }

  // mirrored div
  var div = document.createElement('div');
  div.id = 'input-textarea-caret-position-mirror-div';
  document.body.appendChild(div);

  var style = div.style;
  var computed = window.getComputedStyle? getComputedStyle(element) : element.currentStyle;  // currentStyle for IE < 9

  // default textarea styles
  style.whiteSpace = 'pre-wrap';
  if (element.nodeName !== 'INPUT')
    style.wordWrap = 'break-word';  // only for textarea-s

  // position off-screen
  style.position = 'absolute';  // required to return coordinates properly
  if (!debug)
    style.visibility = 'hidden';  // not 'display: none' because we want rendering

  // transfer the element's properties to the div
  properties.forEach(function (prop) {
    style[prop] = computed[prop];
  });

  if (isFirefox) {
    // Firefox lies about the overflow property for textareas: https://bugzilla.mozilla.org/show_bug.cgi?id=984275
    if (element.scrollHeight > parseInt(computed.height))
      style.overflowY = 'scroll';
  } else {
    style.overflow = 'hidden';  // for Chrome to not render a scrollbar; IE keeps overflowY = 'scroll'
  }

  div.textContent = element.value.substring(0, position);
  // the second special handling for input type="text" vs textarea: spaces need to be replaced with non-breaking spaces - http://stackoverflow.com/a/13402035/1269037
  if (element.nodeName === 'INPUT')
    div.textContent = div.textContent.replace(/\s/g, '\u00a0');

  var span = document.createElement('span');
  // Wrapping must be replicated *exactly*, including when a long word gets
  // onto the next line, with whitespace at the end of the line before (#7).
  // The  *only* reliable way to do that is to copy the *entire* rest of the
  // textarea's content into the <span> created at the caret position.
  // for inputs, just '.' would be enough, but why bother?
  span.textContent = element.value.substring(position) || '.';  // || because a completely empty faux span doesn't render at all
  div.appendChild(span);

  var coordinates = {
    top: span.offsetTop + parseInt(computed['borderTopWidth']),
    left: span.offsetLeft + parseInt(computed['borderLeftWidth'])
  };

  if (debug) {
    span.style.backgroundColor = '#aaa';
  } else {
    document.body.removeChild(div);
  }

  return coordinates;
}

$.fn.textcomplete.getCaretCoordinates = getCaretCoordinates;

}(jQuery));

return jQuery;
}));


/***/ }),

/***/ 696:
/***/ (function(module, exports, __webpack_require__) {

module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('v-expansion-panel', {
    staticClass: "expansion-pl ext__form"
  }, _vm._l((_vm.formBuilder), function(item, index) {
    return _c('v-expansion-panel-content', {
      key: index,
      attrs: {
        "hide-actions": "",
        "value": "1"
      }
    }, [_c('div', {
      attrs: {
        "slot": "header"
      },
      slot: "header"
    }, [_c('div', {
      staticClass: "background-triangle-small"
    }, [_c('v-icon', {
      attrs: {
        "size": "18",
        "color": "white"
      }
    }, [_vm._v("star_rate")])], 1), _vm._v("\n      " + _vm._s(item.fieldLabel) + "\n      ")]), _vm._v(" "), _c('v-card', [_c('v-card-text', {
      staticClass: "py-2 px-2"
    }, [_c('v-layout', {
      attrs: {
        "wrap": ""
      }
    }, [_c('v-flex', {
      attrs: {
        "xs12": ""
      }
    }, [(item.fieldType === 'textarea') ? _c('v-text-field', {
      attrs: {
        "id": item.fieldName,
        "value": item.value,
        "placeholder": item.placeholder,
        "multi-line": ""
      },
      on: {
        "input": function($event) {
          _vm.inputChangeValue(item)
        }
      }
    }) : _vm._e(), _vm._v(" "), (item.fieldType === 'string') ? _c('v-text-field', {
      attrs: {
        "id": item.fieldName,
        "value": item.value,
        "placeholder": item.placeholder
      },
      on: {
        "input": function($event) {
          _vm.inputChangeValue(item)
        }
      }
    }) : _vm._e(), _vm._v(" "), (item.fieldType === 'number') ? _c('v-text-field', {
      attrs: {
        "id": item.fieldName,
        "value": item.value,
        "placeholder": item.placeholder,
        "rules": [_vm.rulesValid.number]
      },
      on: {
        "input": function($event) {
          _vm.inputChangeValue(item)
        }
      }
    }) : _vm._e(), _vm._v(" "), (item.fieldType === 'date') ? _c('v-text-field', {
      attrs: {
        "id": item.fieldName,
        "value": item.value,
        "placeholder": item.placeholder,
        "readonly": "",
        "append-icon": "event"
      },
      nativeOn: {
        "click": function($event) {
          _vm.openDialogCustom(item, item.fieldName)
        }
      }
    }) : _vm._e()], 1)], 1)], 1), _vm._v(" "), _c('v-dialog', {
      attrs: {
        "width": "500"
      },
      model: {
        value: (_vm.dialog),
        callback: function($$v) {
          _vm.dialog = $$v
        },
        expression: "dialog"
      }
    }, [_c('v-date-picker', {
      attrs: {
        "full-width": "",
        "landscape": ""
      },
      model: {
        value: (_vm.date),
        callback: function($$v) {
          _vm.date = $$v
        },
        expression: "date"
      }
    }), _vm._v(" "), _c('v-card-actions', {
      staticStyle: {
        "background": "#fff"
      }
    }, [_c('v-spacer'), _vm._v(" "), _c('v-btn', {
      attrs: {
        "color": "primary",
        "flat": ""
      },
      on: {
        "click": _vm.pickDateCustom
      }
    }, [_vm._v("\n                Xác nhận\n            ")])], 1)], 1)], 1)], 1)
  }))
},staticRenderFns: []}
module.exports.render._withStripped = true
if (false) {
  module.hot.accept()
  if (module.hot.data) {
     require("vue-hot-reload-api").rerender("data-v-2df4b7d0", module.exports)
  }
}

/***/ }),

/***/ 697:
/***/ (function(module, exports, __webpack_require__) {

module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('div', {
    staticClass: "taotailieuketqua",
    staticStyle: {
      "background-color": "white",
      "width": "100%"
    }
  }, [_c('v-expansion-panel', {
    staticClass: "expansion-pl"
  }, [_c('v-expansion-panel-content', {
    attrs: {
      "hide-actions": "",
      "value": "1"
    }
  }, [_c('div', {
    attrs: {
      "slot": "header"
    },
    slot: "header"
  }, [_c('div', {
    staticClass: "background-triangle-small"
  }, [_c('v-icon', {
    attrs: {
      "size": "18",
      "color": "white"
    }
  }, [_vm._v("star_rate")])], 1), _vm._v(" Kết quả xử lý\n        ")]), _vm._v(" "), _c('v-card', _vm._l((_vm.createFiles), function(item, index) {
    return _c('div', {
      key: item.partNo + 'cr',
      staticClass: "form_alpaca",
      staticStyle: {
        "position": "relative"
      }
    }, [_c('v-expansion-panel', {
      staticClass: "expaned__list__data"
    }, [_c('v-expansion-panel-content', {
      attrs: {
        "hide-actions": "",
        "value": false
      }
    }, [_c('div', {
      staticStyle: {
        "background-color": "#fff"
      },
      attrs: {
        "slot": "header"
      },
      on: {
        "click": function($event) {
          _vm.stateView = false
        }
      },
      slot: "header"
    }, [_c('div', {
      staticStyle: {
        "align-items": "center",
        "min-height": "38px",
        "background": "#fff",
        "padding-left": "15px"
      },
      style: ({
        width: _vm.checkStyle(item)
      })
    }, [_c('div', {
      staticClass: "mr-2",
      staticStyle: {
        "min-width": "18px",
        "display": "flex",
        "min-height": "38px"
      },
      on: {
        "click": function($event) {
          _vm.loadAlpcaForm(item)
        }
      }
    }, [_c('div', {
      staticClass: "header__tphs"
    }, [_c('span', {
      staticClass: "text-bold"
    }, [_vm._v(_vm._s(index + 1) + ".")]), _vm._v("  ")]), _vm._v(" "), _c('div', {
      staticClass: "header__tphs"
    }, [_vm._v("\n                        " + _vm._s(item.partName) + " "), (item.required) ? _c('span', {
      staticStyle: {
        "color": "red"
      }
    }, [_vm._v(" (*)")]) : _vm._e(), _vm._v("\n                          \n                        "), (item.eForm && item.daKhai) ? _c('v-tooltip', {
      attrs: {
        "top": ""
      }
    }, [_c('i', {
      staticClass: "fa fa-file-text-o",
      staticStyle: {
        "color": "#0d71bb",
        "font-size": "13px"
      },
      attrs: {
        "slot": "activator",
        "aria-hidden": "true"
      },
      slot: "activator"
    }), _vm._v(" "), _c('span', [_vm._v("Biểu mẫu trực tuyến (Đã khai)")])]) : _vm._e(), _vm._v(" "), (item.eForm && !item.daKhai) ? _c('v-tooltip', {
      attrs: {
        "top": ""
      }
    }, [_c('i', {
      staticClass: "fa fa-file-o",
      staticStyle: {
        "color": "#0d71bb",
        "font-size": "13px"
      },
      attrs: {
        "slot": "activator"
      },
      slot: "activator"
    }), _vm._v(" "), _c('span', [_vm._v("Biểu mẫu trực tuyến (Chưa khai)")])]) : _vm._e()], 1)]), _vm._v(" "), _vm._l((_vm.dossierFilesItems), function(itemFileView, index) {
      return (item.partNo + _vm.id === itemFileView.dossierPartNo + _vm.id && !itemFileView.eForm) ? _c('div', {
        key: index + 'cr'
      }, [_c('div', {
        staticStyle: {
          "width": "calc(100% - 370px)",
          "display": "flex",
          "align-items": "center",
          "min-height": "38px",
          "background": "#fff",
          "padding-left": "15px",
          "font-size": "12px"
        }
      }, [_c('span', {
        staticClass: "ml-3",
        staticStyle: {
          "cursor": "pointer"
        },
        on: {
          "click": function($event) {
            $event.stopPropagation();
            _vm.viewFile2(itemFileView)
          }
        }
      }, [(itemFileView.eForm) ? _c('v-icon', [_vm._v("border_color")]) : _c('v-icon', [_vm._v("attach_file")]), _vm._v("\n                      " + _vm._s(itemFileView.displayName) + " - \n                      "), _c('i', [_vm._v(_vm._s(itemFileView.modifiedDate))])], 1), _vm._v(" "), _c('v-btn', {
        staticClass: "mx-0 my-0",
        attrs: {
          "icon": "",
          "ripple": ""
        },
        on: {
          "click": function($event) {
            $event.stopPropagation();
            _vm.deleteSingleFile(itemFileView, index)
          }
        }
      }, [_c('v-icon', {
        staticStyle: {
          "color": "red"
        }
      }, [_vm._v("delete_outline")])], 1)], 1)]) : _vm._e()
    })], 2)]), _vm._v(" "), (item.eForm) ? _c('v-card', [_c('v-card-text', {
      staticStyle: {
        "background-color": "rgba(244, 247, 213, 0.19)"
      }
    }, [_c('v-layout', {
      attrs: {
        "wrap": ""
      }
    }, [_c('v-flex', {
      staticClass: "text-xs-right",
      attrs: {
        "xs12": ""
      }
    }, [(item.eForm) ? _c('v-btn', {
      attrs: {
        "color": "primary"
      },
      on: {
        "click": function($event) {
          _vm.saveAlpacaForm(item, index)
        }
      }
    }, [_vm._v("Lưu lại")]) : _vm._e(), _vm._v(" "), (item.daKhai && item.eForm) ? _c('v-btn', {
      attrs: {
        "color": "primary"
      },
      on: {
        "click": function($event) {
          _vm.deleteSingleFileEform(item, index)
        }
      }
    }, [_vm._v("Xóa")]) : _vm._e(), _vm._v(" "), (item.daKhai && item.eForm) ? _c('v-btn', {
      attrs: {
        "color": "primary"
      },
      on: {
        "click": function($event) {
          _vm.previewFileEfom(item, index)
        }
      }
    }, [_vm._v("In")]) : _vm._e(), _vm._v(" "), _c('div', {
      attrs: {
        "id": 'formAlpaca' + item.partNo + _vm.id
      }
    })], 1)], 1)], 1)], 1) : _vm._e()], 1)], 1), _vm._v(" "), _c('div', {
      staticClass: "absolute__btn group__thanh_phan pr-3 mr-1"
    }, [(_vm.loading) ? _c('content-placeholders', {
      staticClass: "mt-1"
    }, [_c('content-placeholders-text', {
      attrs: {
        "lines": 1
      }
    })], 1) : _c('v-layout', {
      attrs: {
        "row": "",
        "wrap": ""
      }
    }, [_c('v-flex', {
      staticStyle: {
        "width": "50px"
      }
    }, [_c('input', {
      staticStyle: {
        "display": "none"
      },
      attrs: {
        "type": "file",
        "id": 'file' + item.partNo
      },
      on: {
        "change": function($event) {
          _vm.onUploadSingleFile($event, item)
        }
      }
    }), _vm._v(" "), (_vm.progressUploadPart + _vm.id === item.partNo + _vm.id) ? _c('v-progress-circular', {
      attrs: {
        "width": 2,
        "size": 25,
        "color": "green",
        "indeterminate": ""
      }
    }) : (_vm.progressUploadPart + _vm.id !== item.partNo + _vm.id) ? _c('v-tooltip', {
      attrs: {
        "top": ""
      }
    }, [_c('v-btn', {
      staticClass: "mx-0 my-0",
      attrs: {
        "slot": "activator",
        "icon": ""
      },
      on: {
        "click": function($event) {
          _vm.pickFile(item)
        }
      },
      slot: "activator"
    }, [_c('v-badge', [_c('v-icon', {
      attrs: {
        "size": "16",
        "color": "primary"
      }
    }, [_vm._v("cloud_upload")])], 1)], 1), _vm._v(" "), _c('span', [_vm._v("Tải file lên")])], 1) : _vm._e()], 1)], 1)], 1)], 1)
  })), _vm._v(" "), _c('v-dialog', {
    staticStyle: {
      "overflow": "hidden"
    },
    attrs: {
      "max-width": "900",
      "transition": "fade-transition"
    },
    model: {
      value: (_vm.dialogPDF),
      callback: function($$v) {
        _vm.dialogPDF = $$v
      },
      expression: "dialogPDF"
    }
  }, [_c('v-card', [_c('v-card-title', {
    staticClass: "headline"
  }, [_vm._v("File đính kèm")]), _vm._v(" "), _c('v-btn', {
    staticClass: "mx-0 my-0 absolute__btn_panel mr-2",
    attrs: {
      "icon": "",
      "dark": ""
    },
    nativeOn: {
      "click": function($event) {
        _vm.dialogPDF = false
      }
    }
  }, [_c('v-icon', [_vm._v("clear")])], 1), _vm._v(" "), (_vm.dialogPDFLoading) ? _c('div', {
    staticStyle: {
      "min-height": "600px",
      "text-align": "center",
      "margin": "auto",
      "padding": "25%"
    }
  }, [_c('v-progress-circular', {
    attrs: {
      "size": 100,
      "width": 1,
      "color": "primary",
      "indeterminate": ""
    }
  })], 1) : _vm._e(), _vm._v(" "), _c('iframe', {
    directives: [{
      name: "show",
      rawName: "v-show",
      value: (!_vm.dialogPDFLoading),
      expression: "!dialogPDFLoading"
    }],
    staticStyle: {
      "overflow": "auto",
      "min-height": "600px"
    },
    attrs: {
      "id": 'dialogPDFPreview' + _vm.id,
      "src": "",
      "type": "application/pdf",
      "width": "100%",
      "height": "100%",
      "frameborder": "0"
    }
  })], 1)], 1)], 1)], 1)], 1)
},staticRenderFns: []}
module.exports.render._withStripped = true
if (false) {
  module.hot.accept()
  if (module.hot.data) {
     require("vue-hot-reload-api").rerender("data-v-5b77eb43", module.exports)
  }
}

/***/ }),

/***/ 699:
/***/ (function(module, exports, __webpack_require__) {

module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('div', {
    staticClass: "comment-temp"
  }, [_c('div', [_c('v-expansion-panel', {
    staticClass: "expansion-pl-transparent"
  }, [_c('v-expansion-panel-content', {
    attrs: {
      "hide-actions": "",
      "value": true
    }
  }, [_c('v-card', {
    staticClass: "comments__container"
  }, [_c('v-card-text', {
    staticClass: "pl-4"
  }, [_c('div', {
    attrs: {
      "id": "comments-container-el"
    }
  })])], 1)], 1)], 1)], 1)])
},staticRenderFns: []}
module.exports.render._withStripped = true
if (false) {
  module.hot.accept()
  if (module.hot.data) {
     require("vue-hot-reload-api").rerender("data-v-c8f36406", module.exports)
  }
}

/***/ }),

/***/ 700:
/***/ (function(module, exports, __webpack_require__) {

module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('div', {
    staticClass: "phancong",
    staticStyle: {
      "background-color": "white",
      "width": "100%"
    }
  }, [_c('v-expansion-panel', {
    staticClass: "expansion-pl"
  }, [_c('v-expansion-panel-content', {
    attrs: {
      "hide-actions": "",
      "value": "1"
    }
  }, [_c('div', {
    attrs: {
      "slot": "header"
    },
    slot: "header"
  }, [_c('div', {
    staticClass: "background-triangle-small"
  }, [_c('v-icon', {
    attrs: {
      "size": "18",
      "color": "white"
    }
  }, [_vm._v("star_rate")])], 1), _vm._v("Duyệt hồ sơ\n      ")]), _vm._v(" "), _c('v-card', [_c('v-card-text', {
    staticClass: "px-0 py-0"
  }, [_c('v-tabs', {
    staticClass: "mb-4",
    attrs: {
      "icons-and-text": ""
    },
    model: {
      value: (_vm.tabActive),
      callback: function($$v) {
        _vm.tabActive = $$v
      },
      expression: "tabActive"
    }
  }, [_c('v-tabs-slider', {
    attrs: {
      "color": "primary"
    }
  }), _vm._v(" "), _c('v-tab', {
    key: 1,
    attrs: {
      "href": "#tabs-1"
    },
    on: {
      "click": _vm.changeActive
    }
  }, [_c('v-btn', {
    staticClass: "px-0 py-0 mx-0 my-0",
    attrs: {
      "flat": ""
    }
  }, [_vm._v("Ký kết quả hồ sơ")])], 1), _vm._v(" "), _c('v-tab', {
    key: 2,
    attrs: {
      "href": "#tabs-3"
    },
    on: {
      "click": _vm.changeActive
    }
  }, [_c('v-btn', {
    staticClass: "px-0 py-0 mx-0 my-0",
    attrs: {
      "flat": ""
    }
  }, [_vm._v("Không ký duyệt")])], 1), _vm._v(" "), _c('v-tab', {
    key: 3,
    attrs: {
      "href": "#tabs-4"
    },
    on: {
      "click": _vm.changeActive
    }
  }, [_c('v-btn', {
    staticClass: "px-0 py-0 mx-0 my-0",
    attrs: {
      "flat": ""
    }
  }, [_vm._v("Yêu cầu trình lại")])], 1), _vm._v(" "), _c('v-tabs-items', {
    staticClass: "px-3 py-3"
  }, [_c('v-tab-item', {
    key: 1,
    attrs: {
      "id": "tabs-1",
      "reverse-transition": "fade-transition",
      "transition": "fade-transition"
    }
  }, [_c('v-checkbox', {
    attrs: {
      "label": "Sử dụng chữ ký số"
    },
    model: {
      value: (_vm.activeKS),
      callback: function($$v) {
        _vm.activeKS = $$v
      },
      expression: "activeKS"
    }
  })], 1), _vm._v(" "), _c('v-tab-item', {
    key: 2,
    attrs: {
      "id": "tabs-3",
      "reverse-transition": "fade-transition",
      "transition": "fade-transition"
    }
  }, [_vm._v("\n                Lý do:\n                "), _c('v-text-field', {
    staticClass: "pt-2",
    attrs: {
      "placeholder": "Lý do không ký hồ sơ",
      "textarea": "",
      "rows": 2
    },
    model: {
      value: (_vm.noteReason),
      callback: function($$v) {
        _vm.noteReason = $$v
      },
      expression: "noteReason"
    }
  })], 1), _vm._v(" "), _c('v-tab-item', {
    key: 3,
    attrs: {
      "id": "tabs-4",
      "reverse-transition": "fade-transition",
      "transition": "fade-transition"
    }
  }, [_c('p', {
    staticClass: "mb-2"
  }, [_vm._v("Trình lại: "), _c('span', {
    staticClass: "text-bold"
  }, [_vm._v(_vm._s(_vm.detailDossier['govAgencyName']))])]), _vm._v("\n                Lý do:\n                "), _c('v-text-field', {
    staticClass: "pt-2",
    attrs: {
      "placeholder": "Lý do trình lại hồ sơ",
      "textarea": "",
      "rows": 2
    },
    model: {
      value: (_vm.noteReason),
      callback: function($$v) {
        _vm.noteReason = $$v
      },
      expression: "noteReason"
    }
  })], 1)], 1)], 1)], 1)], 1)], 1)], 1)], 1)
},staticRenderFns: []}
module.exports.render._withStripped = true
if (false) {
  module.hot.accept()
  if (module.hot.data) {
     require("vue-hot-reload-api").rerender("data-v-f7571a70", module.exports)
  }
}

/***/ }),

/***/ 701:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(jQuery, module) {/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_create__ = __webpack_require__(708);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_create__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys__ = __webpack_require__(517);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_typeof__ = __webpack_require__(645);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_typeof___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_typeof__);





(function (factory) {
	if (typeof define === 'function' && __webpack_require__(246)) {
		define(['jquery'], factory);
	} else if (( false ? 'undefined' : __WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_typeof___default()(module)) === 'object' && module.exports) {
		module.exports = function (root, jQuery) {
			if (jQuery === undefined) {
				if (typeof window !== 'undefined') {
					jQuery = __webpack_require__(36);
				} else {
					jQuery = __webpack_require__(36)(root);
				}
			}
			factory(jQuery);
			return jQuery;
		};
	} else {
		factory(jQuery);
	}
})(function ($) {

	var Comments = {
		$el: null,
		commentsById: {},
		usersById: {},
		dataFetched: false,
		currentSortKey: '',
		options: {},
		events: {
			'click': 'closeDropdowns',

			'keydown [contenteditable]': 'saveOnKeydown',

			'focus [contenteditable]': 'saveEditableContent',
			'keyup [contenteditable]': 'checkEditableContentForChange',
			'paste [contenteditable]': 'checkEditableContentForChange',
			'input [contenteditable]': 'checkEditableContentForChange',
			'blur [contenteditable]': 'checkEditableContentForChange',

			'click .navigation li[data-sort-key]': 'navigationElementClicked',
			'click .navigation li.title': 'toggleNavigationDropdown',

			'click .commenting-field.main .textarea': 'showMainCommentingField',
			'click .commenting-field.main .close': 'hideMainCommentingField',

			'click .commenting-field .textarea': 'increaseTextareaHeight',
			'change .commenting-field .textarea': 'increaseTextareaHeight textareaContentChanged',
			'click .commenting-field:not(.main) .close': 'removeCommentingField',

			'click .commenting-field .send.enabled': 'postComment',
			'click .commenting-field .update.enabled': 'putComment',
			'click .commenting-field .delete.enabled': 'deleteComment',
			'change .commenting-field .upload.enabled input[type="file"]': 'fileInputChanged',

			'click li.comment button.upvote': 'upvoteComment',
			'click li.comment button.delete.enabled': 'deleteComment',
			'click li.comment .hashtag': 'hashtagClicked',
			'click li.comment .ping': 'pingClicked',

			'click li.comment ul.child-comments .toggle-all': 'toggleReplies',
			'click li.comment button.reply': 'replyButtonClicked',
			'click li.comment button.edit': 'editButtonClicked',

			'dragenter': 'showDroppableOverlay',
			'dragenter .droppable-overlay': 'handleDragEnter',
			'dragleave .droppable-overlay': 'handleDragLeaveForOverlay',
			'dragenter .droppable-overlay .droppable': 'handleDragEnter',
			'dragleave .droppable-overlay .droppable': 'handleDragLeaveForDroppable',
			'dragover .droppable-overlay': 'handleDragOverForOverlay',
			'drop .droppable-overlay': 'handleDrop',

			'click .dropdown.autocomplete': 'stopPropagation',
			'mousedown .dropdown.autocomplete': 'stopPropagation',
			'touchstart .dropdown.autocomplete': 'stopPropagation'
		},


		getDefaultOptions: function getDefaultOptions() {
			return {
				profilePictureURL: '',
				currentUserIsAdmin: false,
				currentUserId: null,

				spinnerIconURL: '',
				upvoteIconURL: '',
				replyIconURL: '',
				uploadIconURL: '',
				attachmentIconURL: '',
				fileIconURL: '',
				noCommentsIconURL: '',
				noCommentsImptIconURL: '',

				textareaPlaceholderText: 'Thêm bình luận mới',
				newestText: 'Mới nhất',
				oldestText: 'Cũ nhất',
				importantCmtText: 'Ý kiến chính thức',
				popularText: 'Phổ biến',
				attachmentsText: 'Tệp đính kèm',
				sendText: 'Gửi',
				replyText: 'Trả lời',
				editText: 'Sửa',
				editedText: 'Đã sửa',
				youText: 'You',
				saveText: 'Ghi lại',
				deleteText: 'Xoá',
				newText: 'Mới',
				viewAllRepliesText: 'Xem tất cả __replyCount__ trả lời',
				hideRepliesText: 'Hide replies',
				noCommentsText: 'Không có bình luận',
				noCommentsImportantText: 'Không có ý kiến chính thức',
				noAttachmentsText: 'Không có tệp đính kèm',
				attachmentDropText: 'Kéo thả tệp để tải lên',
				textFormatter: function textFormatter(text) {
					return text;
				},

				enableReplying: true,
				enableEditing: true,
				enableUpvoting: true,
				enableDeleting: true,
				enableAttachments: false,
				enableHashtags: false,
				enablePinging: false,
				enableDeletingCommentWithReplies: false,
				enableNavigation: true,
				postCommentOnEnter: false,
				forceResponsive: false,
				readOnly: false,
				defaultNavigationSortKey: 'newest',

				highlightColor: '#2793e6',
				deleteButtonColor: '#C9302C',
				scrollContainer: this.$el,
				roundProfilePictures: false,
				textareaRows: 2,
				textareaRowsOnFocus: 2,
				textareaMaxRows: 5,
				maxRepliesVisible: 2,

				fieldMappings: {
					id: 'id',
					parent: 'parent',
					created: 'createdDate',
					modified: 'modifiedDate',
					content: 'content',
					file: 'file',
					fileURL: 'file_url',
					fileMimeType: 'file_mime_type',
					pings: 'pings',
					creator: 'creator',
					fullname: 'fullname',
					profileURL: 'profile_url',
					profilePictureURL: 'profile_picture_url',
					isNew: 'is_new',
					createdByAdmin: 'created_by_admin',
					createdByCurrentUser: 'created_by_current_user',
					upvoteCount: 'upvote_count',
					userHasUpvoted: 'user_has_upvoted'
				},

				getUsers: function getUsers(success, error) {
					success([]);
				},
				getComments: function getComments(success, error) {
					success([]);
				},
				postComment: function postComment(commentJSON, success, error) {
					success(commentJSON);
				},
				putComment: function putComment(commentJSON, success, error) {
					success(commentJSON);
				},
				deleteComment: function deleteComment(commentJSON, success, error) {
					success();
				},
				upvoteComment: function upvoteComment(commentJSON, success, error) {
					success(commentJSON);
				},
				hashtagClicked: function hashtagClicked(hashtag) {},
				pingClicked: function pingClicked(userId) {},
				uploadAttachments: function uploadAttachments(commentArray, success, error) {
					success(commentArray);
				},
				refresh: function refresh() {},
				timeFormatter: function timeFormatter(time) {
					return new Date(time).toLocaleDateString();
				},
				appendNewComments: function appendNewComments(commentJSONs, success, error) {
					success([]);
				}
			};
		},

		init: function init(options, el) {
			this.$el = $(el);
			this.$el.addClass('jquery-comments');
			this.undelegateEvents();
			this.delegateEvents();

			(function (a) {
				(jQuery.browser = jQuery.browser || {}).mobile = /(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0, 4));
			})(navigator.userAgent || navigator.vendor || window.opera);
			if ($.browser.mobile) this.$el.addClass('mobile');

			this.options = $.extend(true, {}, this.getDefaultOptions(), options);;

			if (this.options.readOnly) this.$el.addClass('read-only');

			this.currentSortKey = this.options.defaultNavigationSortKey;

			this.createCssDeclarations();

			this.fetchDataAndRender();
		},

		delegateEvents: function delegateEvents() {
			this.bindEvents(false);
		},

		undelegateEvents: function undelegateEvents() {
			this.bindEvents(true);
		},

		bindEvents: function bindEvents(unbind) {
			var bindFunction = unbind ? 'off' : 'on';
			for (var key in this.events) {
				var eventName = key.split(' ')[0];
				var selector = key.split(' ').slice(1).join(' ');
				var methodNames = this.events[key].split(' ');

				for (var index in methodNames) {
					if (methodNames.hasOwnProperty(index)) {
						var method = this[methodNames[index]];

						method = $.proxy(method, this);

						if (selector == '') {
							this.$el[bindFunction](eventName, method);
						} else {
							this.$el[bindFunction](eventName, selector, method);
						}
					}
				}
			}
		},

		fetchDataAndRender: function fetchDataAndRender() {
			var self = this;
			setTimeout(function () {
				self.appendNewComments();
			}, 30000);
			this.commentsById = {};
			this.usersById = {};
			this.$el.empty();
			this.createHTML();

			var dataFetched = this.after(this.options.enablePinging ? 2 : 1, function () {
				self.dataFetched = true;
				self.render();
			});

			var commentsFetched = function commentsFetched(commentsArray) {
				var commentModels = commentsArray.map(function (commentsJSON) {
					return self.createCommentModel(commentsJSON);
				});

				self.sortComments(commentModels, 'oldest');
				$(commentModels).each(function (index, commentModel) {
					self.addCommentToDataModel(commentModel);
				});
				dataFetched();
			};
			this.options.getComments(commentsFetched, dataFetched);

			if (this.options.enablePinging) {
				var usersFetched = function usersFetched(userArray) {
					$(userArray).each(function (index, user) {
						self.usersById[user.id] = user;
					});
					dataFetched();
				};
				this.options.getUsers(usersFetched, dataFetched);
			};
		},

		fetchNext: function fetchNext() {
			var self = this;

			var spinner = this.createSpinner();
			this.$el.find('ul#comment-list').append(spinner);
			var success = function success(commentModels) {
				$(commentModels).each(function (index, commentModel) {
					self.createComment(commentModel);
				});
				spinner.remove();
			};

			var error = function error() {
				spinner.remove();
			};
			this.options.getComments(success, error);
		},

		createCommentModel: function createCommentModel(commentJSON) {
			var commentModel = this.applyInternalMappings(commentJSON);
			commentModel.childs = [];
			this.commentsById[commentModel.id] = commentModel;
			return commentModel;
		},

		addCommentToDataModel: function addCommentToDataModel(commentModel) {
			if (!(commentModel.id in this.commentsById)) {
				this.commentsById[commentModel.id] = commentModel;

				if (commentModel.parent) {
					var outermostParent = this.getOutermostParent(commentModel.parent);
					outermostParent.childs.push(commentModel.id);
				}
			}
		},

		updateCommentModel: function updateCommentModel(commentModel) {
			$.extend(this.commentsById[commentModel.id], commentModel);
		},

		render: function render() {
			var self = this;

			if (!this.dataFetched) return;

			this.showActiveContainer();

			this.createComments();

			if (this.options.enableAttachments) this.createAttachments();

			this.createImportantComments();

			this.$el.find('> .spinner').remove();
			this.options.refresh();
		},

		showActiveContainer: function showActiveContainer() {
			var activeNavigationEl = this.$el.find('.navigation li[data-container-name].active');
			var containerName = activeNavigationEl.data('container-name');
			var containerEl = this.$el.find('[data-container="' + containerName + '"]');
			containerEl.siblings('[data-container]').hide();
			containerEl.show();
		},

		createComments: function createComments() {
			var self = this;

			this.$el.find('#comment-list').remove();
			var commentList = $('<ul/>', {
				id: 'comment-list',
				'class': 'main'
			});

			var mainLevelComments = [];
			var replies = [];

			$(this.getComments()).each(function (index, commentModel) {
				if (commentModel.parent == null) {
					mainLevelComments.push(commentModel);
				} else {
					replies.push(commentModel);
				}
			});

			this.sortComments(mainLevelComments, this.currentSortKey);
			mainLevelComments.reverse();
			$(mainLevelComments).each(function (index, commentModel) {
				self.addComment(commentModel, commentList);
			});

			this.sortComments(replies, 'oldest');
			$(replies).each(function (index, commentModel) {
				self.addComment(commentModel, commentList);
			});

			this.$el.find('[data-container="comments"]').prepend(commentList);
		},

		createAttachments: function createAttachments() {
			var self = this;

			this.$el.find('#attachment-list').remove();
			var attachmentList = $('<ul/>', {
				id: 'attachment-list',
				'class': 'main'
			});

			var attachments = this.getAttachments();
			this.sortComments(attachments, 'newest');
			attachments.reverse();
			$(attachments).each(function (index, commentModel) {
				self.addAttachment(commentModel, attachmentList);
			});

			this.$el.find('[data-container="attachments"]').prepend(attachmentList);
		},
		createImportantComments: function createImportantComments() {
			var self = this;

			this.$el.find('#importantCmt-list').remove();
			var importantCmtList = $('<ul/>', {
				id: 'importantCmt-list',
				'class': 'main'
			});

			var importantCmt = this.getImportantCmt();

			this.sortComments(importantCmt, 'newest');
			importantCmt.reverse();
			$(importantCmt).each(function (index, commentModel) {
				self.addImportantCmt(commentModel, importantCmtList);
			});

			this.$el.find('[data-container="importantCmt"]').prepend(importantCmtList);
		},
		addComment: function addComment(commentModel, commentList) {
			commentList = commentList || this.$el.find('#comment-list');
			var commentEl = this.createCommentElement(commentModel);

			if (commentModel.parent) {
				var directParentEl = commentList.find('.comment[data-id="' + commentModel.parent + '"]');

				this.reRenderCommentActionBar(commentModel.parent);

				var outerMostParent = directParentEl.parents('.comment').last();
				if (outerMostParent.length == 0) outerMostParent = directParentEl;

				var childCommentsEl = outerMostParent.find('.child-comments');
				var commentingField = childCommentsEl.find('.commenting-field');
				if (commentingField.length) {
					commentingField.before(commentEl);
				} else {
					childCommentsEl.append(commentEl);
				}

				this.updateToggleAllButton(outerMostParent);
			} else {
				commentList.prepend(commentEl);
			}
		},
		addAttachment: function addAttachment(commentModel, commentList) {
			commentList = commentList || this.$el.find('#attachment-list');
			var commentEl = this.createCommentElement(commentModel);
			commentList.prepend(commentEl);
		},
		addImportantCmt: function addImportantCmt(commentModel, commentList) {
			commentList = commentList || this.$el.find('#importantCmt-list');
			var commentEl = this.createCommentElement(commentModel);
			commentList.prepend(commentEl);
		},
		removeComment: function removeComment(commentId) {
			var self = this;
			var commentModel = this.commentsById[commentId];

			var childComments = this.getChildComments(commentModel.id);
			$(childComments).each(function (index, childComment) {
				self.removeComment(childComment.id);
			});

			if (commentModel.parent) {
				var outermostParent = this.getOutermostParent(commentModel.parent);
				var indexToRemove = outermostParent.childs.indexOf(commentModel.id);
				outermostParent.childs.splice(indexToRemove, 1);
			}

			delete this.commentsById[commentId];
			var commentElements = this.$el.find('li.comment[data-id="' + commentId + '"]');
			var parentEl = commentElements.parents('li.comment').last();

			commentElements.remove();

			this.updateToggleAllButton(parentEl);
		},

		uploadAttachments: function uploadAttachments(files, commentingField) {
			var self = this;
			if (!commentingField) commentingField = this.$el.find('.commenting-field.main');
			var isReply = !commentingField.hasClass('main');
			var fileCount = files.length;

			if (fileCount) {
				var uploadButton = commentingField.find('.upload');
				var textarea = commentingField.find('.textarea');

				uploadButton.removeClass('enabled');
				var attachmentListSpinner = this.createSpinner();
				var commentListSpinner = this.createSpinner();
				this.$el.find('ul#attachment-list').prepend(attachmentListSpinner);
				if (isReply) {
					commentingField.before(commentListSpinner);
				} else {
					this.$el.find('ul#comment-list').prepend(commentListSpinner);
				}

				var success = function success(commentArray) {
					$(commentArray).each(function (index, commentJSON) {
						var commentModel = self.createCommentModel(commentJSON);
						self.addCommentToDataModel(commentModel);
						self.addComment(commentModel);
						self.addAttachment(commentModel);
					});

					if (commentArray.length == fileCount && self.getTextareaContent(textarea).length == 0) {
						commentingField.find('.close').trigger('click');
					}

					uploadButton.addClass('enabled');
					commentListSpinner.remove();
					attachmentListSpinner.remove();
				};

				var error = function error() {
					uploadButton.addClass('enabled');
					commentListSpinner.remove();
					attachmentListSpinner.remove();
				};

				var commentArray = [];
				$(files).each(function (index, file) {
					var commentJSON = self.createCommentJSON(textarea);
					commentJSON.id += '-' + index;
					commentJSON.content = '';
					commentJSON.file = file;
					commentJSON.fileURL = 'C:/fakepath/' + file.name;
					commentJSON.fileMimeType = file.type;

					commentJSON = self.applyExternalMappings(commentJSON);
					commentArray.push(commentJSON);
				});

				self.options.uploadAttachments(commentArray, success, error);
			}

			uploadButton.find('input').val('');
		},

		updateToggleAllButton: function updateToggleAllButton(parentEl) {
			if (this.options.maxRepliesVisible == null) return;

			var childCommentsEl = parentEl.find('.child-comments');
			var childComments = childCommentsEl.find('.comment');
			var toggleAllButton = childCommentsEl.find('li.toggle-all');
			childComments.removeClass('hidden-reply');

			if (this.options.maxRepliesVisible === 0) {
				var hiddenReplies = childComments;
			} else {
				var hiddenReplies = childComments.slice(0, -this.options.maxRepliesVisible);
			}

			hiddenReplies.addClass('hidden-reply');

			if (toggleAllButton.find('span.text').text() == this.options.textFormatter(this.options.hideRepliesText)) {
				hiddenReplies.addClass('visible');
			}

			if (childComments.length > this.options.maxRepliesVisible) {
				if (!toggleAllButton.length) {

					toggleAllButton = $('<li/>', {
						'class': 'toggle-all highlight-font-bold'
					});
					var toggleAllButtonText = $('<span/>', {
						'class': 'text'
					});
					var caret = $('<span/>', {
						'class': 'caret'
					});

					toggleAllButton.append(toggleAllButtonText).append(caret);
					childCommentsEl.prepend(toggleAllButton);
				}

				this.setToggleAllButtonText(toggleAllButton, false);
			} else {
				toggleAllButton.remove();
			}
		},

		sortComments: function sortComments(comments, sortKey) {
			var self = this;

			if (sortKey == 'popularity') {
				comments.sort(function (commentA, commentB) {
					var pointsOfA = commentA.childs.length;
					var pointsOfB = commentB.childs.length;

					if (self.options.enableUpvoting) {
						pointsOfA += commentA.upvoteCount;
						pointsOfB += commentB.upvoteCount;
					}

					if (pointsOfB != pointsOfA) {
						return pointsOfB - pointsOfA;
					} else {
						var createdA = new Date(commentA.created).getTime();
						var createdB = new Date(commentB.created).getTime();
						return createdB - createdA;
					}
				});
			} else {
				comments.sort(function (commentA, commentB) {
					var createdA = new Date(commentA.created).getTime();
					var createdB = new Date(commentB.created).getTime();
					if (sortKey == 'oldest') {
						return createdA - createdB;
					} else {
						return createdB - createdA;
					}
				});
			}
		},

		sortUsers: function sortUsers(users) {
			users.sort(function (a, b) {
				var nameA = a.fullname.toLowerCase().trim();
				var nameB = b.fullname.toLowerCase().trim();
				if (nameA < nameB) return -1;
				if (nameA > nameB) return 1;
				return 0;
			});
		},

		sortAndReArrangeComments: function sortAndReArrangeComments(sortKey) {
			var commentList = this.$el.find('#comment-list');

			var mainLevelComments = this.getComments().filter(function (commentModel) {
				return !commentModel.parent;
			});
			this.sortComments(mainLevelComments, sortKey);

			$(mainLevelComments).each(function (index, commentModel) {
				var commentEl = commentList.find('> li.comment[data-id=' + commentModel.id + ']');
				commentList.append(commentEl);
			});
		},

		showActiveSort: function showActiveSort() {
			var activeElements = this.$el.find('.navigation li[data-sort-key="' + this.currentSortKey + '"]');

			this.$el.find('.navigation li').removeClass('active');
			activeElements.addClass('active');

			var titleEl = this.$el.find('.navigation .title');
			if (this.currentSortKey != 'attachments') {
				titleEl.addClass('active');
				titleEl.find('header').html(activeElements.first().html());
			} else {
				var defaultDropdownEl = this.$el.find('.navigation ul.dropdown').children().first();
				titleEl.find('header').html(defaultDropdownEl.html());
			}

			this.showActiveContainer();
		},

		forceResponsive: function forceResponsive() {
			this.$el.addClass('responsive');
		},

		closeDropdowns: function closeDropdowns() {
			this.$el.find('.dropdown').hide();
		},

		saveOnKeydown: function saveOnKeydown(ev) {
			if (ev.keyCode == 13) {
				var metaKey = ev.metaKey || ev.ctrlKey;
				if (this.options.postCommentOnEnter || metaKey) {
					var el = $(ev.currentTarget);
					el.siblings('.control-row').find('.save').trigger('click');
					ev.stopPropagation();
					ev.preventDefault();
				}
			}
		},

		saveEditableContent: function saveEditableContent(ev) {
			var el = $(ev.currentTarget);
			el.data('before', el.html());
		},

		checkEditableContentForChange: function checkEditableContentForChange(ev) {
			var el = $(ev.currentTarget);
			if (el.data('before') != el.html()) {
				el.data('before', el.html());
				el.trigger('change');
			}
		},

		navigationElementClicked: function navigationElementClicked(ev) {
			var navigationEl = $(ev.currentTarget);
			var sortKey = navigationEl.data().sortKey;

			if (sortKey != 'attachments') {
				this.sortAndReArrangeComments(sortKey);
			}

			this.currentSortKey = sortKey;
			this.showActiveSort();
		},

		toggleNavigationDropdown: function toggleNavigationDropdown(ev) {
			ev.stopPropagation();

			var dropdown = $(ev.currentTarget).find('~ .dropdown');
			dropdown.toggle();
		},

		showMainCommentingField: function showMainCommentingField(ev) {
			var mainTextarea = $(ev.currentTarget);
			mainTextarea.siblings('.control-row').show();
			mainTextarea.parent().find('.close').show();
			mainTextarea.focus();
		},

		hideMainCommentingField: function hideMainCommentingField(ev) {
			var closeButton = $(ev.currentTarget);
			var mainTextarea = this.$el.find('.commenting-field.main .textarea');
			var mainControlRow = this.$el.find('.commenting-field.main .control-row');

			this.clearTextarea(mainTextarea);
			this.adjustTextareaHeight(mainTextarea, false);

			mainControlRow.hide();
			closeButton.hide();
			mainTextarea.blur();
		},

		increaseTextareaHeight: function increaseTextareaHeight(ev) {
			var textarea = $(ev.currentTarget);
			this.adjustTextareaHeight(textarea, true);
		},

		textareaContentChanged: function textareaContentChanged(ev) {
			var textarea = $(ev.currentTarget);
			var saveButton = textarea.siblings('.control-row').find('.save');

			if (!textarea.find('.reply-to.tag').length) {
				var commentId = textarea.attr('data-comment');

				if (commentId) {
					var parentComments = textarea.parents('li.comment');
					if (parentComments.length > 1) {
						var parentId = parentComments.last().data('id');
						textarea.attr('data-parent', parentId);
					}
				} else {
					var parentId = textarea.parents('li.comment').last().data('id');
					textarea.attr('data-parent', parentId);
				}
			}

			var commentingField = textarea.parents('.commenting-field').first();
			if (textarea[0].scrollHeight > textarea.outerHeight()) {
				commentingField.addClass('scrollable');
			} else {
				commentingField.removeClass('scrollable');
			}

			var contentOrParentChangedIfEditing = true;
			var content = this.getTextareaContent(textarea, true);
			if (commentId = textarea.attr('data-comment')) {
				var contentChanged = content != this.commentsById[commentId].content;
				var parentFromModel;
				if (this.commentsById[commentId].parent) {
					parentFromModel = this.commentsById[commentId].parent.toString();
				}
				var parentChanged = textarea.attr('data-parent') != parentFromModel;
				contentOrParentChangedIfEditing = contentChanged || parentChanged;
			}

			if (content.length && contentOrParentChangedIfEditing) {
				saveButton.addClass('enabled');
			} else {
				saveButton.removeClass('enabled');
			}
		},

		removeCommentingField: function removeCommentingField(ev) {
			var closeButton = $(ev.currentTarget);

			var textarea = closeButton.siblings('.textarea');
			if (textarea.attr('data-comment')) {
				closeButton.parents('li.comment').first().removeClass('edit');
			}

			var commentingField = closeButton.parents('.commenting-field').first();
			commentingField.remove();
		},

		appendNewComments: function appendNewComments() {
			var self = this;

			if ($(self.$el.context).length == 0) {
				clearTimeout(myVar);
				return;
			}
			var commentJSONs = this.getComments();

			var success = function success(commentsNew, commentsEdit) {
				for (var c in commentsNew) {
					self.createComment(commentsNew[c]);
				}

				for (var cmt in commentsEdit) {
					var commentModel = self.createCommentModel(commentsEdit[cmt]);
					self.updateCommentModel(commentModel);
					self.reRenderComment(commentModel.id);
				}
			};

			var error = function error() {};
			var myVar = setTimeout(function () {
				self.appendNewComments();
			}, 30000);
			this.options.appendNewComments(commentJSONs, success, error);
		},

		postComment: function postComment(ev) {
			var self = this;
			var sendButton = $(ev.currentTarget);
			var commentingField = sendButton.parents('.commenting-field').first();
			var textarea = commentingField.find('.textarea');

			sendButton.removeClass('enabled');

			var commentJSON = this.createCommentJSON(textarea);

			commentJSON = this.applyExternalMappings(commentJSON);

			var success = function success(commentJSON) {
				self.currentSortKey = 'newest';
				self.showActiveSort();
				self.createComment(commentJSON);
				commentingField.find('.close').trigger('click');
			};

			var error = function error() {
				sendButton.addClass('enabled');
			};

			this.options.postComment(commentJSON, success, error);
		},

		createComment: function createComment(commentJSON) {
			var commentModel = this.createCommentModel(commentJSON);
			this.addCommentToDataModel(commentModel);
			this.addComment(commentModel);
			if (commentModel.opinion == true) {
				this.addImportantCmt(commentModel);
			}
		},

		putComment: function putComment(ev) {
			var self = this;
			var saveButton = $(ev.currentTarget);
			var commentingField = saveButton.parents('.commenting-field').first();
			var textarea = commentingField.find('.textarea');

			saveButton.removeClass('enabled');

			var commentJSON = $.extend({}, this.commentsById[textarea.attr('data-comment')]);
			$.extend(commentJSON, {
				parent: textarea.attr('data-parent') || null,
				content: this.getTextareaContent(textarea),
				pings: this.getPings(textarea),
				modified: new Date().getTime()
			});

			commentJSON = this.applyExternalMappings(commentJSON);

			var success = function success(commentJSON) {

				var commentModel = self.createCommentModel(commentJSON);

				delete commentModel['childs'];
				self.updateCommentModel(commentModel);

				commentingField.find('.close').trigger('click');

				self.reRenderComment(commentModel.id);
			};

			var error = function error() {
				saveButton.addClass('enabled');
			};

			this.options.putComment(commentJSON, success, error);
		},

		deleteComment: function deleteComment(ev) {
			var self = this;
			var deleteButton = $(ev.currentTarget);
			var commentEl = deleteButton.parents('.comment').first();
			var commentJSON = $.extend({}, this.commentsById[commentEl.attr('data-id')]);
			var commentId = commentJSON.id;
			var parentId = commentJSON.parent;

			deleteButton.removeClass('enabled');

			commentJSON = this.applyExternalMappings(commentJSON);

			var success = function success() {
				self.removeComment(commentId);
				if (parentId) self.reRenderCommentActionBar(parentId);

				if (commentJSON.opinion == true) {
					$('[data-sort-key=' + self.currentSortKey + ']').trigger('click');
				}
			};

			var error = function error() {
				deleteButton.addClass('enabled');
			};

			this.options.deleteComment(commentJSON, success, error);
		},

		hashtagClicked: function hashtagClicked(ev) {
			var el = $(ev.currentTarget);
			var value = el.attr('data-value');
			this.options.hashtagClicked(value);
		},

		pingClicked: function pingClicked(ev) {
			var el = $(ev.currentTarget);
			var value = el.attr('data-value');
			this.options.pingClicked(value);
		},

		fileInputChanged: function fileInputChanged(ev, files) {
			var files = ev.currentTarget.files;
			var commentingField = $(ev.currentTarget).parents('.commenting-field').first();
			this.uploadAttachments(files, commentingField);
		},

		upvoteComment: function upvoteComment(ev) {
			var self = this;
			var commentEl = $(ev.currentTarget).parents('li.comment').first();
			var commentModel = commentEl.data().model;

			var previousUpvoteCount = commentModel.upvoteCount;
			var newUpvoteCount;
			if (commentModel.userHasUpvoted) {
				newUpvoteCount = previousUpvoteCount - 1;
			} else {
				newUpvoteCount = previousUpvoteCount + 1;
			}

			commentModel.userHasUpvoted = !commentModel.userHasUpvoted;
			commentModel.upvoteCount = newUpvoteCount;
			this.reRenderUpvotes(commentModel.id);

			var commentJSON = $.extend({}, commentModel);
			commentJSON = this.applyExternalMappings(commentJSON);

			var success = function success(commentJSON) {
				var commentModel = self.createCommentModel(commentJSON);
				self.updateCommentModel(commentModel);
				self.reRenderUpvotes(commentModel.id);
			};

			var error = function error() {
				commentModel.userHasUpvoted = !commentModel.userHasUpvoted;
				commentModel.upvoteCount = previousUpvoteCount;
				self.reRenderUpvotes(commentModel.id);
			};

			this.options.upvoteComment(commentJSON, success, error);
		},

		toggleReplies: function toggleReplies(ev) {
			var el = $(ev.currentTarget);
			el.siblings('.hidden-reply').toggleClass('visible');
			this.setToggleAllButtonText(el, true);
		},

		replyButtonClicked: function replyButtonClicked(ev) {
			var replyButton = $(ev.currentTarget);
			var outermostParent = replyButton.parents('li.comment').last();
			var parentId = replyButton.parents('.comment').first().data().id;

			var replyField = outermostParent.find('.child-comments > .commenting-field');
			if (replyField.length) replyField.remove();
			var previousParentId = replyField.find('.textarea').attr('data-parent');

			if (previousParentId != parentId) {
				replyField = this.createCommentingFieldElement(parentId, null, false);
				outermostParent.find('.child-comments').append(replyField);

				var textarea = replyField.find('.textarea');
				this.moveCursorToEnd(textarea);

				var scrollTop = this.options.scrollContainer.scrollTop();
				var endOfReply = scrollTop + replyField.position().top + replyField.outerHeight();
				var endOfScrollable = scrollTop + this.options.scrollContainer.outerHeight();
				if (endOfReply > endOfScrollable) {
					var newScrollTop = scrollTop + (endOfReply - endOfScrollable);
					this.options.scrollContainer.scrollTop(newScrollTop);
				}
			}
		},

		editButtonClicked: function editButtonClicked(ev) {
			var editButton = $(ev.currentTarget);
			var commentEl = editButton.parents('li.comment').first();
			var commentModel = commentEl.data().model;

			commentModel = this.commentsById[commentModel.id];
			commentEl.addClass('edit');

			var editField = this.createCommentingFieldElement(commentModel.parent, commentModel.id, false);
			commentEl.find('.comment-wrapper').first().append(editField);

			var textarea = editField.find('.textarea');
			textarea.attr('data-comment', commentModel.id);

			textarea.append(this.getFormattedCommentContent(commentModel, true));

			this.moveCursorToEnd(textarea);
		},

		showDroppableOverlay: function showDroppableOverlay(ev) {
			if (this.options.enableAttachments) {
				this.$el.find('.droppable-overlay').css('top', this.$el[0].scrollTop);
				this.$el.find('.droppable-overlay').show();
				this.$el.addClass('drag-ongoing');
			}
		},

		handleDragEnter: function handleDragEnter(ev) {
			var count = $(ev.currentTarget).data('dnd-count') || 0;
			count++;
			$(ev.currentTarget).data('dnd-count', count);
			$(ev.currentTarget).addClass('drag-over');
		},

		handleDragLeave: function handleDragLeave(ev, callback) {
			var count = $(ev.currentTarget).data('dnd-count');
			count--;
			$(ev.currentTarget).data('dnd-count', count);

			if (count == 0) {
				$(ev.currentTarget).removeClass('drag-over');
				if (callback) callback();
			}
		},

		handleDragLeaveForOverlay: function handleDragLeaveForOverlay(ev) {
			var self = this;
			this.handleDragLeave(ev, function () {
				self.hideDroppableOverlay();
			});
		},

		handleDragLeaveForDroppable: function handleDragLeaveForDroppable(ev) {
			this.handleDragLeave(ev);
		},

		handleDragOverForOverlay: function handleDragOverForOverlay(ev) {
			ev.stopPropagation();
			ev.preventDefault();
			ev.originalEvent.dataTransfer.dropEffect = 'copy';
		},

		hideDroppableOverlay: function hideDroppableOverlay() {
			this.$el.find('.droppable-overlay').hide();
			this.$el.removeClass('drag-ongoing');
		},

		handleDrop: function handleDrop(ev) {
			ev.preventDefault();

			$(ev.target).trigger('dragleave');

			this.hideDroppableOverlay();
			this.uploadAttachments(ev.originalEvent.dataTransfer.files);
		},

		stopPropagation: function stopPropagation(ev) {
			ev.stopPropagation();
		},

		createHTML: function createHTML() {
			var self = this;

			var mainCommentingField = this.createCommentingFieldElement(null, null, true);
			mainCommentingField.addClass('main');
			this.$el.append(mainCommentingField);

			var mainControlRow = mainCommentingField.find('.control-row');
			mainControlRow.hide();
			mainCommentingField.find('.close').hide();

			if (this.options.enableNavigation) {
				this.$el.append(this.createNavigationElement());
				this.showActiveSort();
			}

			var spinner = this.createSpinner();
			this.$el.append(spinner);

			var commentsContainer = $('<div/>', {
				'class': 'data-container overflowComment',
				'data-container': 'comments'
			});
			this.$el.append(commentsContainer);

			var noComments = $('<div/>', {
				'class': 'no-comments no-data',
				text: this.options.textFormatter(this.options.noCommentsText)
			});
			var noCommentsIcon = $('<i/>', {
				'class': 'fa fa-comments fa-2x'
			});
			if (this.options.noCommentsIconURL.length) {
				noCommentsIcon.css('background-image', 'url("' + this.options.noCommentsIconURL + '")');
				noCommentsIcon.addClass('image');
			}
			noComments.prepend($('<br/>')).prepend(noCommentsIcon);
			commentsContainer.append(noComments);

			var importantCmtContainer = $('<div/>', {
				'class': 'data-container overflowComment',
				'data-container': 'importantCmt'
			});
			this.$el.append(importantCmtContainer);

			var noCommentsImpt = $('<div/>', {
				'class': 'no-comments no-data',
				text: this.options.textFormatter(this.options.noCommentsImportantText)
			});
			var noCommentsImptIcon = $('<i/>', {
				'class': 'fa fa-comments fa-2x'
			});
			if (this.options.noCommentsImptIconURL.length) {
				noCommentsImptIcon.css('background-image', 'url("' + this.options.noCommentsImptIconURL + '")');
				noCommentsImptIcon.addClass('image');
			}
			noCommentsImpt.prepend($('<br/>')).prepend(noCommentsImptIcon);
			importantCmtContainer.append(noCommentsImpt);

			if (this.options.enableAttachments) {
				var attachmentsContainer = $('<div/>', {
					'class': 'data-container overflowComment',
					'data-container': 'attachments'
				});
				this.$el.append(attachmentsContainer);

				var noAttachments = $('<div/>', {
					'class': 'no-attachments no-data',
					text: this.options.textFormatter(this.options.noAttachmentsText)
				});
				var noAttachmentsIcon = $('<i/>', {
					'class': 'fa fa-paperclip fa-2x'
				});
				if (this.options.attachmentIconURL.length) {
					noAttachmentsIcon.css('background-image', 'url("' + this.options.attachmentIconURL + '")');
					noAttachmentsIcon.addClass('image');
				}
				noAttachments.prepend($('<br/>')).prepend(noAttachmentsIcon);
				attachmentsContainer.append(noAttachments);

				var droppableOverlay = $('<div/>', {
					'class': 'droppable-overlay'
				});

				var droppableContainer = $('<div/>', {
					'class': 'droppable-container'
				});

				var droppable = $('<div/>', {
					'class': 'droppable'
				});

				var uploadIcon = $('<i/>', {
					'class': 'fa fa-upload fa-4x'
				});
				if (this.options.uploadIconURL.length) {
					uploadIcon.css('background-image', 'url("' + this.options.uploadIconURL + '")');
					uploadIcon.addClass('image');
				}

				var dropAttachmentText = $('<div/>', {
					text: this.options.textFormatter(this.options.attachmentDropText)
				});
				droppable.append(uploadIcon);
				droppable.append(dropAttachmentText);

				droppableOverlay.html(droppableContainer.html(droppable)).hide();
				this.$el.append(droppableOverlay);
			}
		},

		createProfilePictureElement: function createProfilePictureElement(src) {
			if (src) {
				var profilePicture = $('<img/>', {
					src: src
				});
			} else {
				var profilePicture = $('<i/>', {
					'class': 'fa fa-user'
				});
			}
			profilePicture.addClass('profile-picture');
			if (this.options.roundProfilePictures) profilePicture.addClass('round');
			return profilePicture;
		},

		createCommentingFieldElement: function createCommentingFieldElement(parentId, existingCommentId, enableOpinion) {
			var self = this;

			var commentingField = $('<div/>', {
				'class': 'commenting-field'
			});

			if (existingCommentId) {
				var profilePictureURL = this.commentsById[existingCommentId].profilePictureURL;
			} else {
				var profilePictureURL = this.options.profilePictureURL;
			}
			var profilePicture = this.createProfilePictureElement(profilePictureURL);

			var textareaWrapper = $('<div/>', {
				'class': 'textarea-wrapper'
			});

			var controlRow = $('<div/>', {
				'class': 'control-row'
			});

			var textarea = $('<div/>', {
				'class': 'textarea',
				'data-placeholder': this.options.textFormatter(this.options.textareaPlaceholderText),
				contenteditable: true
			});

			this.adjustTextareaHeight(textarea, false);

			var closeButton = $('<span/>', {
				'class': 'close'
			}).append($('<span class="left"/>')).append($('<span class="right"/>'));

			if (existingCommentId) {
				var saveButtonText = this.options.textFormatter(this.options.saveText);
				var opinionCmtId = existingCommentId;
			} else {
				var saveButtonText = this.options.textFormatter(this.options.sendText);
				var opinionCmtId = '';

				if (this.options.enableAttachments) {
					var uploadButton = $('<span/>', {
						'class': 'enabled upload'
					});
					var uploadIcon = $('<i/>', {
						'class': 'md-icon',
						text: 'Tải lên'
					});
					var fileInput = $('<input/>', {
						type: 'file',
						'data-role': 'none' });

					if (!$.browser.mobile) fileInput.attr('multiple', 'multiple');

					if (this.options.uploadIconURL.length) {
						uploadIcon.css('background-image', 'url("' + this.options.uploadIconURL + '")');
						uploadIcon.addClass('image');
					}
					uploadButton.append(uploadIcon).append(fileInput);
					controlRow.append(uploadButton);
				}
			}

			var saveButtonClass = existingCommentId ? 'update' : 'send';
			var saveButton = $('<span/>', {
				'class': saveButtonClass + ' save highlight-background',
				text: saveButtonText
			});


			if (enableOpinion) {
				var checkOpinion = $('<input/>', {
					'class': 'opinion checkOpinion mt-1 mr-1',
					'id': 'opinion' + opinionCmtId,
					'name': 'opinion' + opinionCmtId,
					'type': 'checkbox'
				});
				var labelCheckOpinion = $('<label/>', {
					'class': 'opinion label-opinion',
					'for': 'opinion' + opinionCmtId,
					text: 'Ý kiến chính thức'
				});
				controlRow.append(checkOpinion).append(labelCheckOpinion);
			}

			controlRow.prepend(saveButton);
			textareaWrapper.append(closeButton).append(textarea).append(controlRow);
			commentingField.append(profilePicture).append(textareaWrapper);

			if (parentId) {
				textarea.attr('data-parent', parentId);

				var parentModel = this.commentsById[parentId];
				if (parentModel.parent) {
					textarea.html('&nbsp;');
					var replyToName = '@' + parentModel.fullname;
					var replyToTag = this.createTagElement(replyToName, 'reply-to', parentModel.creator);
					textarea.prepend(replyToTag);
				}
			}

			if (this.options.enablePinging) {
				textarea.textcomplete([{
					match: /(^|\s)@(([0-9]|[^\u0000-\u007F]|[a-zäöüß]|\s)*)$/im,
					search: function search(term, callback) {
						term = self.normalizeSpaces(term);

						var pings = self.getPings(textarea);
						var users = self.getUsers().filter(function (user) {
							var isSelf = user.id == self.options.currentUserId;
							var alreadyPinged = pings.indexOf(user.id) != -1;
							return !isSelf && !alreadyPinged;
						});

						self.sortUsers(users);

						callback($.map(users, function (user) {
							var lowercaseTerm = term.toLowerCase();
							var nameMatch = user.fullname.toLowerCase().indexOf(lowercaseTerm) != -1;
							var emailMatch = user.email.toLowerCase().indexOf(lowercaseTerm) != -1;
							return nameMatch || emailMatch ? user : null;
						}));
					},
					template: function template(user) {
						var wrapper = $('<div/>');

						var profilePictureEl = $('<img/>', {
							src: user.pictureUrl,
							'class': 'profile-picture round'
						});
						var detailsEl = $('<div/>', {
							'class': 'details'
						});
						var nameEl = $('<div/>', {
							'class': 'name'
						}).html(user.fullname);

						var emailEl = $('<div/>', {
							'class': 'email'
						}).html(user.email);

						if (user.email) {
							detailsEl.append(nameEl).append(emailEl);
						} else {
							detailsEl.addClass('no-email');
							detailsEl.append(nameEl);
						}

						wrapper.append(profilePictureEl).append(detailsEl);
						return wrapper.html();
					},
					replace: function replace(user) {
						var tag = self.createTagElement('@' + user.fullname, 'ping', user.id);
						return ' ' + tag[0].outerHTML + ' ';
					}
				}], {
					appendTo: '.jquery-comments',
					dropdownClassName: 'dropdown autocomplete',
					maxCount: 5,
					rightEdgeOffset: 0
				});

				$.fn.textcomplete.Dropdown.prototype.render = function (zippedData) {
					var contentsHtml = this._buildContents(zippedData);
					var unzippedData = $.map(zippedData, function (d) {
						return d.value;
					});
					if (zippedData.length) {
						var strategy = zippedData[0].strategy;
						if (strategy.id) {
							this.$el.attr('data-strategy', strategy.id);
						} else {
							this.$el.removeAttr('data-strategy');
						}
						this._renderHeader(unzippedData);
						this._renderFooter(unzippedData);
						if (contentsHtml) {
							this._renderContents(contentsHtml);
							this._fitToBottom();
							this._fitToRight();
							this._activateIndexedItem();
						}
						this._setScroll();
					} else if (this.noResultsMessage) {
						this._renderNoResultsMessage(unzippedData);
					} else if (this.shown) {
						this.deactivate();
					}

					var top = parseInt(this.$el.css('top')) + self.options.scrollContainer.scrollTop();
					this.$el.css('top', top);

					var originalLeft = this.$el.css('left');
					this.$el.css('left', 0);
					var maxLeft = self.$el.width() - this.$el.outerWidth();
					var left = Math.min(maxLeft, parseInt(originalLeft));
					this.$el.css('left', left);
				};
			}

			return commentingField;
		},

		createNavigationElement: function createNavigationElement() {
			var navigationEl = $('<ul/>', {
				'class': 'navigation'
			});
			var navigationWrapper = $('<div/>', {
				'class': 'navigation-wrapper'
			});
			navigationEl.append(navigationWrapper);

			var newest = $('<li/>', {
				text: this.options.textFormatter(this.options.newestText),
				'data-sort-key': 'newest',
				'data-container-name': 'comments'
			});

			var oldest = $('<li/>', {
				text: this.options.textFormatter(this.options.oldestText),
				'data-sort-key': 'oldest',
				'data-container-name': 'comments'
			});

			var important = $('<li/>', {
				text: this.options.textFormatter(this.options.importantCmtText),
				'data-sort-key': 'important',
				'data-container-name': 'importantCmt'
			});

			var popular = $('<li/>', {
				text: this.options.textFormatter(this.options.popularText),
				'data-sort-key': 'popularity',
				'data-container-name': 'comments'
			});

			var attachments = $('<li/>', {
				text: this.options.textFormatter(this.options.attachmentsText),
				'data-sort-key': 'attachments',
				'data-container-name': 'attachments'
			});

			var attachmentsIcon = $('<i/>', {
				'class': 'fa fa-paperclip'
			});
			if (this.options.attachmentIconURL.length) {
				attachmentsIcon.css('background-image', 'url("' + this.options.attachmentIconURL + '")');
				attachmentsIcon.addClass('image');
			}
			attachments.prepend(attachmentsIcon);

			var dropdownNavigationWrapper = $('<div/>', {
				'class': 'navigation-wrapper responsive'
			});
			var dropdownNavigation = $('<ul/>', {
				'class': 'dropdown'
			});
			var dropdownTitle = $('<li/>', {
				'class': 'title'
			});
			var dropdownTitleHeader = $('<header/>');

			dropdownTitle.append(dropdownTitleHeader);
			dropdownNavigationWrapper.append(dropdownTitle);
			dropdownNavigationWrapper.append(dropdownNavigation);
			navigationEl.append(dropdownNavigationWrapper);

			navigationWrapper.append(newest).append(oldest).append(important);
			dropdownNavigation.append(newest.clone()).append(oldest.clone()).append(important.clone());

			if (this.options.enableReplying || this.options.enableUpvoting) {
				navigationWrapper.append(popular);
				dropdownNavigation.append(popular.clone());
			}
			if (this.options.enableAttachments) {
				navigationWrapper.append(attachments);
				dropdownNavigationWrapper.append(attachments.clone());
			}

			if (this.options.forceResponsive) this.forceResponsive();
			return navigationEl;
		},

		createSpinner: function createSpinner() {
			var spinner = $('<div/>', {
				'class': 'spinner'
			});
			var spinnerIcon = $('<i/>', {
				'class': 'fa fa-spinner fa-spin'
			});
			if (this.options.spinnerIconURL.length) {
				spinnerIcon.css('background-image', 'url("' + this.options.spinnerIconURL + '")');
				spinnerIcon.addClass('image');
			}
			spinner.html(spinnerIcon);
			return spinner;
		},

		createCommentElement: function createCommentElement(commentModel) {
			var commentEl = $('<li/>', {
				'data-id': commentModel.id,
				'class': 'comment'
			}).data('model', commentModel);

			if (commentModel.createdByCurrentUser) commentEl.addClass('by-current-user');
			if (commentModel.createdByAdmin) commentEl.addClass('by-admin');

			var childComments = $('<ul/>', {
				'class': 'child-comments'
			});

			var commentWrapper = this.createCommentWrapperElement(commentModel);

			commentEl.append(commentWrapper);
			if (commentModel.parent == null) commentEl.append(childComments);
			return commentEl;
		},

		createCommentWrapperElement: function createCommentWrapperElement(commentModel) {
			var commentWrapper = $('<div/>', {
				'class': 'comment-wrapper'
			});

			var profilePicture = this.createProfilePictureElement(commentModel.profilePictureURL);

			var time = $('<time/>', {
				text: this.options.timeFormatter(commentModel.created),
				'data-original': commentModel.created
			});

			var nameText = commentModel.createdByCurrentUser ? this.options.textFormatter(this.options.youText) : commentModel.fullname;
			var name = $('<div/>', {
				'class': 'name'
			});
			if (commentModel.profileURL) {
				var link = $('<a/>', {
					href: commentModel.profileURL,
					text: nameText
				});
				name.html(link);
			} else {
				name.text(nameText);
			}

			if (commentModel.createdByCurrentUser || commentModel.createdByAdmin) name.addClass('highlight-font-bold');

			if (commentModel.parent) {
				var parent = this.commentsById[commentModel.parent];
				if (parent.parent) {
					var replyTo = $('<span/>', {
						'class': 'reply-to',
						text: parent.fullname
					});

					var replyIcon = $('<i/>', {
						'class': 'fa fa-share'
					});
					if (this.options.replyIconURL.length) {
						replyIcon.css('background-image', 'url("' + this.options.replyIconURL + '")');
						replyIcon.addClass('image');
					}

					replyTo.prepend(replyIcon);
					name.append(replyTo);
				}
			}

			if (commentModel.isNew) {
				var newTag = $('<span/>', {
					'class': 'new highlight-background',
					text: this.options.newText
				});
				name.append(newTag);
			}

			var wrapper = $('<div/>', {
				'class': 'wrapper'
			});

			var noteOpinion = $('<div/>', {
				'class': 'note-opinion',
				text: '(Ý kiến chính thức)'
			});

			var content = $('<div/>', {
				'class': 'content'
			});

			var isAttachment = commentModel.fileURL != undefined;
			if (isAttachment) {
				var format = null;
				var type = null;

				if (commentModel.fileMimeType) {
					var mimeTypeParts = commentModel.fileMimeType.split('/');
					if (mimeTypeParts.length == 2) {
						format = mimeTypeParts[1];
						type = mimeTypeParts[0];
					}
				}

				var link = $('<a/>', {
					'class': 'attachment',
					href: commentModel.fileURL,
					target: '_blank'
				});

				if (type == 'image') {
					var image = $('<img/>', {
						src: commentModel.fileURL
					});
					link.html(image);
				} else if (type == 'video') {
					var video = $('<video/>', {
						src: commentModel.fileURL,
						type: commentModel.fileMimeType,
						controls: 'controls'
					});
					link.html(video);
				} else {
					var availableIcons = ['archive', 'audio', 'code', 'excel', 'image', 'movie', 'pdf', 'photo', 'picture', 'powerpoint', 'sound', 'video', 'word', 'zip'];

					var iconClass = 'fa fa-file-o';
					if (availableIcons.indexOf(format) > 0) {
						iconClass = 'fa fa-file-' + format + '-o';
					} else if (availableIcons.indexOf(type) > 0) {
						iconClass = 'fa fa-file-' + type + '-o';
					}

					var fileIcon = $('<i/>', {
						'class': iconClass
					});
					if (this.options.fileIconURL.length) {
						fileIcon.css('background-image', 'url("' + this.options.fileIconURL + '")');
						fileIcon.addClass('image');
					}

					var fileName = commentModel.fileName;
					link.text(fileName);
					link.prepend(fileIcon);
				}
				content.html(link);
			} else {
				content.html(this.getFormattedCommentContent(commentModel));
			}

			if (commentModel.modified && commentModel.modified != commentModel.created) {
				var editedTime = this.options.timeFormatter(commentModel.modified);
				var edited = $('<time/>', {
					'class': 'edited',
					text: this.options.textFormatter(this.options.editedText) + ' ' + editedTime,
					'data-original': commentModel.modified
				});
				content.append(edited);
			}

			var actions = $('<span/>', {
				'class': 'actions'
			});

			var reply = $('<button/>', {
				'class': 'action reply',
				'type': 'button',
				text: this.options.textFormatter(this.options.replyText)
			});

			var upvoteIcon = $('<i/>', {
				'class': 'fa fa-thumbs-up'
			});
			if (this.options.upvoteIconURL.length) {
				upvoteIcon.css('background-image', 'url("' + this.options.upvoteIconURL + '")');
				upvoteIcon.addClass('image');
			}

			var upvotes = this.createUpvoteElement(commentModel);

			if (this.options.enableReplying) actions.append(reply);
			if (this.options.enableUpvoting) actions.append(upvotes);

			if (commentModel.createdByCurrentUser || this.options.currentUserIsAdmin) {
				if (isAttachment && this.isAllowedToDelete(commentModel.id)) {
					var deleteButton = $('<button/>', {
						'class': 'action delete enabled',
						text: this.options.textFormatter(this.options.deleteText)
					});
					actions.append(deleteButton);
				} else if (!isAttachment && this.options.enableEditing) {
					var editButton = $('<button/>', {
						'class': 'action edit',
						text: this.options.textFormatter(this.options.editText)
					});
					actions.append(editButton);
					var deleteButton = $('<button/>', {
						'class': 'action delete enabled',
						text: this.options.textFormatter(this.options.deleteText)
					});
					actions.append(deleteButton);
				}
			}

			wrapper.append(content);
			if (commentModel.opinion == true) {
				wrapper.append(noteOpinion);
			}
			wrapper.append(actions);
			commentWrapper.append(profilePicture).append(time).append(name).append(wrapper);
			return commentWrapper;
		},

		createUpvoteElement: function createUpvoteElement(commentModel) {
			var upvoteIcon = $('<i/>', {
				'class': 'fa fa-thumbs-up'
			});
			if (this.options.upvoteIconURL.length) {
				upvoteIcon.css('background-image', 'url("' + this.options.upvoteIconURL + '")');
				upvoteIcon.addClass('image');
			}

			var upvoteEl = $('<button/>', {
				'class': 'action upvote' + (commentModel.userHasUpvoted ? ' highlight-font' : '')
			}).append($('<span/>', {
				text: commentModel.upvoteCount,
				'class': 'upvote-count'
			})).append(upvoteIcon);

			return upvoteEl;
		},

		createTagElement: function createTagElement(text, extraClasses, value) {
			var tagEl = $('<input/>', {
				'class': 'tag',
				'type': 'button',
				'data-role': 'none'
			});
			if (extraClasses) tagEl.addClass(extraClasses);
			tagEl.val(text);
			tagEl.attr('data-value', value);
			return tagEl;
		},

		reRenderComment: function reRenderComment(id) {
			var commentModel = this.commentsById[id];
			var commentElements = this.$el.find('li.comment[data-id="' + commentModel.id + '"]');

			var self = this;
			commentElements.each(function (index, commentEl) {
				var commentWrapper = self.createCommentWrapperElement(commentModel);
				$(commentEl).find('.comment-wrapper').first().replaceWith(commentWrapper);
			});
		},

		reRenderCommentActionBar: function reRenderCommentActionBar(id) {
			var commentModel = this.commentsById[id];
			var commentElements = this.$el.find('li.comment[data-id="' + commentModel.id + '"]');

			var self = this;
			commentElements.each(function (index, commentEl) {
				var commentWrapper = self.createCommentWrapperElement(commentModel);
				$(commentEl).find('.actions').first().replaceWith(commentWrapper.find('.actions'));
			});
		},

		reRenderUpvotes: function reRenderUpvotes(id) {
			var commentModel = this.commentsById[id];
			var commentElements = this.$el.find('li.comment[data-id="' + commentModel.id + '"]');

			var self = this;
			commentElements.each(function (index, commentEl) {
				var upvotes = self.createUpvoteElement(commentModel);
				$(commentEl).find('.upvote').first().replaceWith(upvotes);
			});
		},

		createCssDeclarations: function createCssDeclarations() {
			$('head style.jquery-comments-css').remove();

			this.createCss('.jquery-comments ul.navigation li.active:after {background: ' + this.options.highlightColor + ' !important;', +'}');

			this.createCss('.jquery-comments ul.navigation ul.dropdown li.active {background: ' + this.options.highlightColor + ' !important;', +'}');

			this.createCss('.jquery-comments .highlight-background {background: ' + this.options.highlightColor + ' !important;', +'}');

			this.createCss('.jquery-comments .highlight-font {color: ' + this.options.highlightColor + ' !important;' + '}');
			this.createCss('.jquery-comments .highlight-font-bold {color: ' + this.options.highlightColor + ' !important;' + 'font-weight: bold;' + '}');
		},

		createCss: function createCss(css) {
			var styleEl = $('<style/>', {
				type: 'text/css',
				'class': 'jquery-comments-css',
				text: css
			});
			$('head').append(styleEl);
		},

		getComments: function getComments() {
			var self = this;
			var commentArr = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default()(this.commentsById).map(function (id) {
				return self.commentsById[id];
			});
			var importantCmtArr = commentArr.filter(function (comment) {
				return comment.opinion;
			});
			var importantCmtUser = commentArr.filter(function (comment) {
				return comment.opinion && comment.createdByCurrentUser;
			});
			var attachCmtArr = commentArr.filter(function (comment) {
				return comment.fileURL != undefined;
			});
			if (commentArr.length > 3) {
				$('.data-container[data-container=comments]').addClass('lessEl');
			} else {
				$('.data-container[data-container=comments]').addClass('fullEl');
			}

			if (importantCmtArr.length > 3) {
				$('.data-container[data-container=importantCmt]').addClass('lessEl');
			} else {
				$('.data-container[data-container=importantCmt]').addClass('fullEl');
			}
			if (importantCmtUser.length > 0) {
				$('.opinion').hide();
			} else {
				$('.opinion').show();
			}

			if (attachCmtArr.length > 3) {
				$('.data-container[data-container=attachments]').addClass('lessEl');
			} else {
				$('.data-container[data-container=attachments]').addClass('fullEl');
			}

			return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default()(this.commentsById).map(function (id) {
				return self.commentsById[id];
			});
		},

		getUsers: function getUsers() {
			var self = this;
			return __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default()(this.usersById).map(function (id) {
				return self.usersById[id];
			});
		},

		getChildComments: function getChildComments(parentId) {
			return this.getComments().filter(function (comment) {
				return comment.parent == parentId;
			});
		},

		getAttachments: function getAttachments() {
			var self = this;
			return this.getComments().filter(function (comment) {
				return comment.fileURL != undefined;
			});
		},
		getImportantCmt: function getImportantCmt() {
			var self = this;
			return this.getComments().filter(function (comment) {
				return comment.opinion == true;
			});
		},
		getOutermostParent: function getOutermostParent(directParentId) {
			var parentId = directParentId;
			do {
				var parentComment = this.commentsById[parentId];
				parentId = parentComment.parent;
			} while (parentComment.parent != null);
			return parentComment;
		},

		createCommentJSON: function createCommentJSON(textarea) {
			var time = new Date().toISOString();
			var commentJSON = {
				id: 'c' + (this.getComments().length + 1),
				parent: textarea.attr('data-parent') || null,
				created: time,
				modified: time,
				content: this.getTextareaContent(textarea),
				pings: this.getPings(textarea),
				fullname: this.options.textFormatter(this.options.youText),
				profilePictureURL: this.options.profilePictureURL,
				createdByCurrentUser: true,
				upvoteCount: 0,
				userHasUpvoted: false
			};
			return commentJSON;
		},

		isAllowedToDelete: function isAllowedToDelete(commentId) {
			if (this.options.enableDeleting) {
				var isAllowedToDelete = true;
				if (!this.options.enableDeletingCommentWithReplies) {
					$(this.getComments()).each(function (index, comment) {
						if (comment.parent == commentId) isAllowedToDelete = false;
					});
				}
				return isAllowedToDelete;
			}
			return false;
		},

		setToggleAllButtonText: function setToggleAllButtonText(toggleAllButton, toggle) {
			var self = this;
			var textContainer = toggleAllButton.find('span.text');
			var caret = toggleAllButton.find('.caret');

			var showExpandingText = function showExpandingText() {
				var text = self.options.textFormatter(self.options.viewAllRepliesText);
				var replyCount = toggleAllButton.siblings('.comment').length;
				text = text.replace('__replyCount__', replyCount);
				textContainer.text(text);
			};

			var hideRepliesText = this.options.textFormatter(this.options.hideRepliesText);

			if (toggle) {
				if (textContainer.text() == hideRepliesText) {
					showExpandingText();
				} else {
					textContainer.text(hideRepliesText);
				}

				caret.toggleClass('up');
			} else {
				if (textContainer.text() != hideRepliesText) {
					showExpandingText();
				}
			}
		},

		adjustTextareaHeight: function adjustTextareaHeight(textarea, focus) {
			var textareaBaseHeight = 2.2;
			var lineHeight = 1.45;

			var setRows = function setRows(rows) {
				var height = textareaBaseHeight + (rows - 1) * lineHeight;
				textarea.css('height', height + 'em');
			};

			textarea = $(textarea);
			var rowCount = focus == true ? this.options.textareaRowsOnFocus : this.options.textareaRows;
			do {
				setRows(rowCount);
				rowCount++;
				var isAreaScrollable = textarea[0].scrollHeight > textarea.outerHeight();
				var maxRowsUsed = this.options.textareaMaxRows == false ? false : rowCount > this.options.textareaMaxRows;
			} while (isAreaScrollable && !maxRowsUsed);
		},

		clearTextarea: function clearTextarea(textarea) {
			textarea.empty().trigger('input');
		},

		getTextareaContent: function getTextareaContent(textarea, humanReadable) {
			var textareaClone = textarea.clone();

			textareaClone.find('.reply-to.tag').remove();

			textareaClone.find('.tag.hashtag').replaceWith(function () {
				return humanReadable ? $(this).val() : '#' + $(this).attr('data-value');
			});
			textareaClone.find('.tag.ping').replaceWith(function () {
				return humanReadable ? $(this).val() : '@' + $(this).attr('data-value');
			});

			var ce = $('<pre/>').html(textareaClone.html());
			ce.find('div, p, br').replaceWith(function () {
				return '\n' + this.innerHTML;
			});

			var text = ce.text().replace(/^\s+/g, '');

			var text = this.normalizeSpaces(text);
			return text;
		},

		getFormattedCommentContent: function getFormattedCommentContent(commentModel, replaceNewLines) {
			var html = this.escape(commentModel.content);
			html = this.linkify(html);
			html = this.highlightTags(commentModel, html);
			if (replaceNewLines) html = html.replace(/(?:\n)/g, '<br>');
			return html;
		},

		getPings: function getPings(textarea) {
			return $.map(textarea.find('.ping'), function (el) {
				return parseInt($(el).attr('data-value'));
			});
		},

		moveCursorToEnd: function moveCursorToEnd(el) {
			el = $(el)[0];

			$(el).trigger('input');

			$(el).scrollTop(el.scrollHeight);

			if (typeof window.getSelection != 'undefined' && typeof document.createRange != 'undefined') {
				var range = document.createRange();
				range.selectNodeContents(el);
				range.collapse(false);
				var sel = window.getSelection();
				sel.removeAllRanges();
				sel.addRange(range);
			} else if (typeof document.body.createTextRange != 'undefined') {
				var textRange = document.body.createTextRange();
				textRange.moveToElementText(el);
				textRange.collapse(false);
				textRange.select();
			}

			el.focus();
		},

		escape: function escape(inputText) {
			return $('<pre/>').text(this.normalizeSpaces(inputText)).html();
		},

		normalizeSpaces: function normalizeSpaces(inputText) {
			return inputText.replace(new RegExp('\xA0', 'g'), ' ');
		},

		after: function after(times, func) {
			var self = this;
			return function () {
				times--;
				if (times == 0) {
					return func.apply(self, arguments);
				}
			};
		},

		highlightTags: function highlightTags(commentModel, html) {
			if (this.options.enableHashtags) html = this.highlightHashtags(commentModel, html);
			if (this.options.enablePinging) html = this.highlightPings(commentModel, html);
			return html;
		},

		highlightHashtags: function highlightHashtags(commentModel, html) {
			var self = this;

			if (html.indexOf('#') != -1) {
				var __createTag = function __createTag(tag) {
					var tag = self.createTagElement('#' + tag, 'hashtag', tag);
					return tag[0].outerHTML;
				};

				var regex = /(^|\s)#([a-zäöüß\d-_]+)/gim;
				html = html.replace(regex, function ($0, $1, $2) {
					return $1 + __createTag($2);
				});
			}
			return html;
		},

		highlightPings: function highlightPings(commentModel, html) {
			var self = this;

			if (html.indexOf('@') != -1) {

				var __createTag = function __createTag(user) {
					var tag = self.createTagElement('@' + user.fullname, 'ping', user.id);
					return tag[0].outerHTML;
				};

				var highlightedHtml = '';
				$(commentModel.pings).each(function (index, id) {
					if (id in self.usersById) {
						var user = self.usersById[id];
						var pingText = '@' + user.id;

						var endIndex = html.indexOf(pingText) + pingText.length;
						var current = html.slice(0, endIndex);
						highlightedHtml += current.replace(pingText, __createTag(user));

						html = html.slice(endIndex);
					}
				});
				highlightedHtml += html;
				return highlightedHtml;
			}
			return html;
		},

		linkify: function linkify(inputText) {
			var replacedText, replacePattern1, replacePattern2, replacePattern3;

			replacePattern1 = /(^|\s)((https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gim;
			replacedText = inputText.replace(replacePattern1, '$1<a href="$2" target="_blank">$2</a>');

			replacePattern2 = /(^|\s)(www\.[\S]+(\b|$))/gim;
			replacedText = replacedText.replace(replacePattern2, '$1<a href="http://$2" target="_blank">$2</a>');

			replacePattern3 = /(^|\s)(([a-zA-Z0-9\-\_\.]+)@[a-zA-Z\_]+?(\.[a-zA-Z]{2,6})+)/gim;
			replacedText = replacedText.replace(replacePattern3, '$1<a href="mailto:$2">$2</a>');

			var count = inputText.match(/<a href/g) || [];

			if (count.length > 0) {
				var splitInput = inputText.split(/(<\/a>)/g);
				for (var i = 0; i < splitInput.length; i++) {
					if (splitInput[i].match(/<a href/g) == null) {
						splitInput[i] = splitInput[i].replace(replacePattern1, '<a href="$1" target="_blank">$1</a>').replace(replacePattern2, '$1<a href="http://$2" target="_blank">$2</a>').replace(replacePattern3, '<a href="mailto:$1">$1</a>');
					}
				}
				var combinedReplacedText = splitInput.join('');
				return combinedReplacedText;
			} else {
				return replacedText;
			}
		},

		waitUntil: function waitUntil(condition, callback) {
			var self = this;

			if (condition()) {
				callback();
			} else {
				setTimeout(function () {
					self.waitUntil(condition, callback);
				}, 100);
			}
		},

		applyInternalMappings: function applyInternalMappings(commentJSON) {
			var invertedMappings = {};
			var mappings = this.options.fieldMappings;
			for (var prop in mappings) {
				if (mappings.hasOwnProperty(prop)) {
					invertedMappings[mappings[prop]] = prop;
				}
			}

			return this.applyMappings(invertedMappings, commentJSON);
		},

		applyExternalMappings: function applyExternalMappings(commentJSON) {
			var mappings = this.options.fieldMappings;
			return this.applyMappings(mappings, commentJSON);
		},

		applyMappings: function applyMappings(mappings, commentJSON) {
			var result = {};

			for (var key1 in commentJSON) {
				if (key1 in mappings) {
					var key2 = mappings[key1];
					result[key2] = commentJSON[key1];
				}
			}
			return result;
		}

	};

	$.fn.comments = function (options) {
		return this.each(function () {
			var comments = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_create___default()(Comments);
			$.data(this, 'comments', comments);
			comments.init(options || {}, this);
		});
	};
});
/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__(36), __webpack_require__(719)(module)))

/***/ }),

/***/ 708:
/***/ (function(module, exports, __webpack_require__) {

module.exports = { "default": __webpack_require__(709), __esModule: true };

/***/ }),

/***/ 709:
/***/ (function(module, exports, __webpack_require__) {

__webpack_require__(710);
var $Object = __webpack_require__(30).Object;
module.exports = function create(P, D) {
  return $Object.create(P, D);
};


/***/ }),

/***/ 710:
/***/ (function(module, exports, __webpack_require__) {

var $export = __webpack_require__(51);
// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])
$export($export.S, 'Object', { create: __webpack_require__(218) });


/***/ }),

/***/ 719:
/***/ (function(module, exports) {

module.exports = function(originalModule) {
	if(!originalModule.webpackPolyfill) {
		var module = Object.create(originalModule);
		// module.parent = undefined by default
		if(!module.children) module.children = [];
		Object.defineProperty(module, "loaded", {
			enumerable: true,
			get: function() {
				return module.l;
			}
		});
		Object.defineProperty(module, "id", {
			enumerable: true,
			get: function() {
				return module.i;
			}
		});
		Object.defineProperty(module, "exports", {
			enumerable: true,
		});
		module.webpackPolyfill = 1;
	}
	return module;
};


/***/ }),

/***/ 742:
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
Object.defineProperty(__webpack_exports__, "__esModule", { value: true });
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__ = __webpack_require__(144);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__ = __webpack_require__(139);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2__router__ = __webpack_require__(37);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_jquery__ = __webpack_require__(36);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_jquery__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_4__store_jquery_comment__ = __webpack_require__(701);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__Comment_vue__ = __webpack_require__(224);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_5__Comment_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_5__Comment_vue__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__form_xu_ly_ThongTinCoBanHoSo_vue__ = __webpack_require__(220);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_6__form_xu_ly_ThongTinCoBanHoSo_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_6__form_xu_ly_ThongTinCoBanHoSo_vue__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__form_xu_ly_PhanCongNguoiThucHien_vue__ = __webpack_require__(219);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_7__form_xu_ly_PhanCongNguoiThucHien_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_7__form_xu_ly_PhanCongNguoiThucHien_vue__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__form_xu_ly_TraKetQua_vue__ = __webpack_require__(221);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_8__form_xu_ly_TraKetQua_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_8__form_xu_ly_TraKetQua_vue__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__form_xu_ly_FeeDetail_vue__ = __webpack_require__(216);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_9__form_xu_ly_FeeDetail_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_9__form_xu_ly_FeeDetail_vue__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__form_xu_ly_KyPheDuyetTaiLieu_vue__ = __webpack_require__(226);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_10__form_xu_ly_KyPheDuyetTaiLieu_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_10__form_xu_ly_KyPheDuyetTaiLieu_vue__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__form_xu_ly_YkienCanBoThucHien_vue__ = __webpack_require__(222);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_11__form_xu_ly_YkienCanBoThucHien_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_11__form_xu_ly_YkienCanBoThucHien_vue__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__form_xu_ly_TaoTaiLieuKetQua_vue__ = __webpack_require__(227);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_12__form_xu_ly_TaoTaiLieuKetQua_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_12__form_xu_ly_TaoTaiLieuKetQua_vue__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__form_xu_ly_FormBoSungThongTinNgan_vue__ = __webpack_require__(225);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_13__form_xu_ly_FormBoSungThongTinNgan_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_13__form_xu_ly_FormBoSungThongTinNgan_vue__);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__TiepNhan_TiepNhanHoSo_ThanhPhanHoSo_vue__ = __webpack_require__(212);
/* harmony import */ var __WEBPACK_IMPORTED_MODULE_14__TiepNhan_TiepNhanHoSo_ThanhPhanHoSo_vue___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_14__TiepNhan_TiepNhanHoSo_ThanhPhanHoSo_vue__);

















/* harmony default export */ __webpack_exports__["default"] = ({
  props: ['index'],
  components: {
    'thong-tin-co-ban-ho-so': __WEBPACK_IMPORTED_MODULE_6__form_xu_ly_ThongTinCoBanHoSo_vue___default.a,
    'phan-cong': __WEBPACK_IMPORTED_MODULE_7__form_xu_ly_PhanCongNguoiThucHien_vue___default.a,
    'tra-ket-qua': __WEBPACK_IMPORTED_MODULE_8__form_xu_ly_TraKetQua_vue___default.a,
    'thu-phi': __WEBPACK_IMPORTED_MODULE_9__form_xu_ly_FeeDetail_vue___default.a,
    'ky-duyet': __WEBPACK_IMPORTED_MODULE_10__form_xu_ly_KyPheDuyetTaiLieu_vue___default.a,
    'y-kien-can-bo': __WEBPACK_IMPORTED_MODULE_11__form_xu_ly_YkienCanBoThucHien_vue___default.a,
    'tai-lieu-ket-qua': __WEBPACK_IMPORTED_MODULE_12__form_xu_ly_TaoTaiLieuKetQua_vue___default.a,
    'form-bo-sung-thong-tin': __WEBPACK_IMPORTED_MODULE_13__form_xu_ly_FormBoSungThongTinNgan_vue___default.a,
    'thanh-phan-ho-so': __WEBPACK_IMPORTED_MODULE_14__TiepNhan_TiepNhanHoSo_ThanhPhanHoSo_vue___default.a
  },
  data: function data() {
    return {
      headersTable: [{
        text: '#',
        align: 'center',
        sortable: false
      }, {
        text: 'Mã hồ sơ',
        align: 'center',
        sortable: false
      }, {
        text: 'Chủ hồ sơ',
        align: 'center',
        sortable: false
      }, {
        text: 'Địa chỉ',
        align: 'center',
        sortable: false
      }, {
        text: 'Thời gian',
        align: 'center',
        sortable: false
      }],
      mutilpleAction: false,
      actionExits: [],
      dossierProcess: [],
      countProcessed: 0,
      activeNotify: false,
      dialog_statusAction: false,
      thongTinChiTietHoSo: {},
      nextActions: [],
      payments: '',
      dossierActions: [],
      itemselect: '',
      actionNote: '',
      actionsSubmitLoading: false,
      showThongTinCoBanHoSo: false,
      showYkienCanBoThucHien: false,
      showFormBoSungThongTinNgan: false,
      showPhanCongNguoiThucHien: false,
      showTaoTaiLieuKetQua: false,
      showKyPheDuyetTaiLieu: false,
      showTraKetQua: false,
      showThuPhi: false,
      checkInput: 0,
      viaPortalDetail: 0,
      showThucHienThanhToanDienTu: false,
      dossierItemDialogPick: '',
      itemDialogPick: '',
      resultDialogPick: '',
      indexDialogPick: '',
      userNote: 0,
      partView: '',
      stateView: false,
      payment_type: 0,
      type_assign: 0,
      returnFiles: [],
      assign_items: [],
      btnStateVisible: true,
      dialogActionProcess: false,
      rollbackable: false,
      dialogPDF: false,
      dialogPDFLoading: false,
      loadingActionProcess: false,
      loadingAction: false,
      arrDossierId: [],
      actionActiveTmp: []
    };
  },
  computed: {
    loading: function loading() {
      return this.$store.getters.loading;
    },
    originality: function originality() {
      var vm = this;
      return vm.getOriginality();
    },
    dossierSelected: function dossierSelected() {
      var vm = this;
      return vm.$store.getters.dossierSelected;
    },
    actionActive: function actionActive() {
      return this.$store.getters.actionActive;
    },
    activeGetCounter: function activeGetCounter() {
      return this.$store.getters.activeGetCounter;
    }
  },
  created: function created() {
    var vm = this;

    vm.$nextTick(function () {
      vm.btnIndex = -1;
      var currentQuery = vm.$router.history.current.query;

      if (vm.dossierSelected.length > 0) {
        return vm.$store.getters.dossierSelected;
      } else {
        var arrDossier = [];
        var _currentQuery = vm.$router.history.current.query;
        if (_currentQuery.hasOwnProperty('dossiers')) {
          var arrDossierIdTemp = _currentQuery.dossiers.split(',');
          vm.arrDossierId = arrDossierIdTemp;
          arrDossierIdTemp.forEach(function (dossierId) {
            arrDossier.push(vm.$store.dispatch('getDetailDossier', dossierId));
          });
          __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_promise___default.a.all(arrDossier).then(function (results) {
            vm.$store.dispatch('loadDossierSelected', results);
          }).catch(function (reject) {});
        }
      }
      try {
        if (vm.actionActive.action === undefined || vm.actionActive.action === null || vm.actionActive.action === '') {
          var actionActive = JSON.parse(currentQuery.actionActive);
          if (actionActive) {
            vm.$store.dispatch('loadActionActive', actionActive);
          }
        }
      } catch (e) {}
      vm.getNextActions();
    });
  },
  updated: function updated() {
    var vm = this;
    vm.$nextTick(function () {});
  },

  watch: {},
  methods: {
    initData: function initData(data) {
      var vm = this;
    },
    goBack: function goBack() {
      window.history.back();
    },
    processPullBtnDetailRouter: function processPullBtnDetailRouter(dossierItem, item, result, index) {
      var vm = this;
      var isPopup = false;
      vm.dossierId = dossierItem.dossierId;
      vm.showYkienCanBoThucHien = false;
      vm.showFormBoSungThongTinNgan = false;
      vm.showPhanCongNguoiThucHien = false;
      vm.showTaoTaiLieuKetQua = false;
      vm.showKyPheDuyetTaiLieu = false;
      vm.showTraKetQua = false;
      vm.showThuPhi = false;
      vm.showThucHienThanhToanDienTu = false;
      vm.dossierItemDialogPick = dossierItem;
      vm.itemDialogPick = item;
      vm.resultDialogPick = result;
      vm.indexDialogPick = index;
      vm.userNote = 0;
      if (result !== null && result !== undefined && result !== 'undefined' && (result.hasOwnProperty('userNote') || result.hasOwnProperty('extraForm') || result.hasOwnProperty('allowAssignUser') || result.hasOwnProperty('createFiles') || result.hasOwnProperty('eSignature') || result.hasOwnProperty('returnFiles') || result.hasOwnProperty('payment') || result.hasOwnProperty('checkInput'))) {
        if (result.hasOwnProperty('userNote') && (result.userNote === 1 || result.userNote === '1' || result.userNote === 2 || result.userNote === '2')) {
          isPopup = true;
          vm.showYkienCanBoThucHien = true;
          vm.userNote = result.userNote;
        }
        if (result.hasOwnProperty('extraForm') && result.extraForm) {
          isPopup = true;
          vm.showFormBoSungThongTinNgan = true;
        }
        if (result.hasOwnProperty('allowAssignUser') && result.allowAssignUser !== 0) {
          if (Array.isArray(result.toUsers)) {
            vm.assign_items = result.toUsers;
          } else {
            vm.assign_items = [result.toUsers];
          }
          vm.type_assign = result.allowAssignUser;
          isPopup = true;
          vm.showPhanCongNguoiThucHien = true;
        }
        if (result.hasOwnProperty('createFiles') && result.createFiles !== null && result.createFiles !== undefined && result.createFiles !== 'undefined' && result.createFiles.length > 0) {
          isPopup = true;
          vm.showTaoTaiLieuKetQua = true;
          vm.createFiles = result.createFiles;
        }
        if (result.hasOwnProperty('eSignature') && result.eSignature) {
          isPopup = true;
          vm.showKyPheDuyetTaiLieu = true;
        }
        if (result.hasOwnProperty('returnFiles') && result.returnFiles !== null && result.returnFiles !== undefined && result.returnFiles !== 'undefined' && result.returnFiles.length > 0) {
          isPopup = true;
          vm.showTraKetQua = true;
          vm.returnFiles = result.returnFiles;
        }
        if (result.hasOwnProperty('payment') && result.payment !== null && result.payment !== undefined && result.payment !== 'undefined' && result.payment.requestPayment === 5) {
          isPopup = true;
          vm.showThuPhi = true;
          vm.payments = result.payment;
          vm.viaPortalDetail = dossierItem.viaPostal;
        }
        if (result.hasOwnProperty('checkInput') && result.checkInput !== null && result.checkInput !== undefined && result.checkInput !== 'undefined') {
          vm.checkInput = result.checkInput;
          if (result.checkInput === 2) {
            isPopup = true;
            vm.$refs.thanhphanhoso.initData(vm.thongTinChiTietHoSo);
          }
        }
      }
      if (isPopup) {
        vm.dialogActionProcess = true;
        vm.loadingActionProcess = false;
      }
    },
    processPullBtnDetail: function processPullBtnDetail(item, index) {
      var vm = this;
      vm.btnIndex = index;
      vm.itemAction = item;
      vm.actionIdCurrent = item.processActionId;
      var filter = {
        dossierId: vm.dossierSelected[0].dossierId,
        actionId: item.processActionId
      };
      vm.dialogActionProcess = false;
      vm.$store.dispatch('processPullBtnDetail', filter).then(function (result) {
        vm.processPullBtnDetailRouter(vm.dossierSelected[0], item, result, index);
      });
    },
    doCopy: function doCopy(dossierItem, item, index, isGroup) {
      var vm = this;
      var filter = {
        dossierId: dossierItem.dossierId
      };
      vm.loadingAction = true;
      vm.$store.dispatch('doCopy', filter).then(function (result) {
        vm.loadingAction = false;
        vm.indexAction = -1;
        __WEBPACK_IMPORTED_MODULE_2__router__["a" /* default */].push({
          path: '/danh-sach-ho-so/' + vm.index + '/ho-so/' + result.dossierId + '/' + vm.itemAction.form,
          query: vm.$router.history.current.query
        });
      });
    },
    doCancel: function doCancel(dossierItem, item, index, isGroup) {
      var vm = this;
      vm.loadingAction = true;
      if (isGroup) {} else {
        var filter = {
          dossierId: dossierItem.dossierId
        };
        vm.$store.dispatch('doCancel', filter).then(function (result) {
          vm.loadingAction = false;
          vm.indexAction = -1;
          __WEBPACK_IMPORTED_MODULE_2__router__["a" /* default */].push({
            path: '/danh-sach-ho-so/' + vm.index + '/ho-so/' + result.dossierId + '/' + vm.itemAction.form,
            query: vm.$router.history.current.query
          });
        });
      }
    },
    processAction: function processAction() {
      var vm = this;
      var initData = vm.$store.getters.loadingInitData;
      var actionUser = initData.user.userName ? initData.user.userName : '';
      vm.dossierProcess = vm.dossierSelected.filter(function (item) {
        return item['statusAction'] === false || !item['statusAction'];
      });
      vm.countProcessed = 0;
      if (vm.mutilpleAction) {
        for (var key in vm.actionExits) {
          for (var key2 in vm.dossierSelected) {
            if (vm.dossierSelected[key2]['statusAction'] === false || !vm.dossierSelected[key2]['statusAction']) {
              var filter = {
                dossierId: vm.dossierSelected[key2].dossierId,
                actionCode: vm.actionExits[key].actionCode,
                actionUser: actionUser
              };
              vm.postAction(filter, vm.dossierSelected[key2], key2);
            }
          }
        }
      } else {
        for (var _key in vm.dossierSelected) {
          if (vm.dossierSelected[_key]['statusAction'] === false || !vm.dossierSelected[_key]['statusAction']) {
            var _filter = {
              dossierId: vm.dossierSelected[_key].dossierId,
              actionCode: vm.actionActive.action,
              actionUser: actionUser
            };
            vm.postAction(_filter, vm.dossierSelected[_key], _key);
          }
        }
      }
    },
    postAction: function postAction(filter, dossier, index) {
      var vm = this;
      var validPhanCong = true;
      var validYKien = true;
      if (vm.showPhanCongNguoiThucHien) {
        filter['toUsers'] = vm.assign_items;
        var result = vm.$refs.phancong.doExport();
        if (result) {
          validPhanCong = true;
        } else {
          validPhanCong = false;
        }
      }
      var paymentsOut = null;
      if (vm.payments) {
        paymentsOut = {
          requestPayment: vm.payments['requestPayment'],
          advanceAmount: Number(vm.payments['advanceAmount'].toString().replace(/\./g, '')),
          feeAmount: Number(vm.payments['feeAmount'].toString().replace(/\./g, '')),
          serviceAmount: Number(vm.payments['serviceAmount'].toString().replace(/\./g, '')),
          shipAmount: Number(vm.payments['shipAmount'].toString().replace(/\./g, ''))
        };
      }
      if (vm.showThuPhi) {
        filter['payment'] = paymentsOut;
      }
      if (vm.showFormBoSungThongTinNgan) {
        filter['payload'] = vm.$refs.formBoSungThongTinNgan.formSubmitData();
      }
      if (vm.showKyPheDuyetTaiLieu) {
        var _result = vm.$refs.kypheduyettailieu.doExport();
      }
      if (vm.showYkienCanBoThucHien) {
        var _result2 = vm.$refs.ykiencanbo.doExport();
        var note = '';
        if (_result2.valid) {
          validYKien = true;
          note = _result2.text;
        } else {
          validYKien = false;
        }
        filter['userNote'] = note;
      }
      if (validPhanCong && validYKien) {
        vm.validateAction = true;
      } else {
        vm.validateAction = false;
      }
      var currentQuery = vm.$router.history.current.query;
      if (vm.showYkienCanBoThucHien) {
        if (vm.validateAction) {
          vm.loadingActionProcess = true;
          vm.$store.dispatch('processDossierRouter', filter).then(function (result) {
            vm.countProcessed += 1;
            vm.dossierSelected[index]['statusAction'] = true;

            if (vm.countProcessed === vm.dossierProcess.length * vm.actionExits.length && vm.activeNotify) {
              vm.dialog_statusAction = true;
            } else if (vm.countProcessed === vm.dossierProcess.length * vm.actionExits.length) {
              vm.loadingActionProcess = false;
              vm.loadingAction = false;
              vm.btnStateVisible = false;
            }
          }).catch(function (reject) {
            vm.countProcessed += 1;
            vm.activeNotify = true;
            vm.dossierSelected[index]['statusAction'] = false;

            if (vm.countProcessed === vm.dossierProcess.length * vm.actionExits.length && vm.activeNotify) {
              vm.dialog_statusAction = true;
            } else if (vm.countProcessed === vm.dossierProcess.length * vm.actionExits.length) {
              vm.loadingActionProcess = false;
              vm.loadingAction = false;
              vm.btnStateVisible = false;
            }
          });
        }
      } else {
        vm.loadingActionProcess = true;
        vm.$store.dispatch('processDossierRouter', filter).then(function (result) {
          vm.countProcessed += 1;
          vm.dossierSelected[index]['statusAction'] = true;
          if (vm.countProcessed === vm.dossierProcess.length * vm.actionExits.length && vm.activeNotify) {
            vm.dialog_statusAction = true;
          } else if (vm.countProcessed === vm.dossierProcess.length * vm.actionExits.length) {
            vm.loadingActionProcess = false;
            vm.loadingAction = false;
            vm.btnStateVisible = false;
          }
        }).catch(function (reject) {
          vm.countProcessed += 1;
          vm.activeNotify = true;
          vm.dossierSelected[index]['statusAction'] = false;
          if (vm.countProcessed === vm.dossierProcess.length * vm.actionExits.length && vm.activeNotify) {
            vm.dialog_statusAction = true;
          } else if (vm.countProcessed === vm.dossierProcess.length * vm.actionExits.length) {
            vm.loadingActionProcess = false;
            vm.loadingAction = false;
            vm.btnStateVisible = false;
          }
        });
      }
    },
    doPrint02: function doPrint02(dossierItem, item, index, isGroup) {
      var vm = this;
      if (vm.thuTucHanhChinhSelected === null || vm.thuTucHanhChinhSelected === undefined || vm.thuTucHanhChinhSelected === 'undefined') {
        alert('Loại thủ tục bắt buộc phải chọn');
      } else {
        var filter = {
          document: item.document,
          'serviceCode': vm.thuTucHanhChinhSelected.serviceCode,
          'govAgencyCode': vm.thuTucHanhChinhSelected.govAgencyCode,
          dossiers: __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()(vm.selected)
        };
        vm.dialogPDFLoading = true;
        vm.dialogPDF = true;
        vm.$store.dispatch('doPrint02', filter).then(function (result) {
          vm.dialogPDFLoading = false;
          document.getElementById('dialogPDFPreview').src = result;
        });
      }
    },
    doPrint03: function doPrint03(dossierItem, item, index, isGroup) {
      var vm = this;
      vm.dialogPDFLoading = true;
      vm.dialogPDF = true;
      var filter = {
        dossierId: dossierItem.dossierId,
        document: item.document
      };
      vm.$store.dispatch('doPrint03', filter).then(function (result) {
        vm.dialogPDFLoading = false;
        document.getElementById('dialogPDFPreview').src = result;
      });
    },
    doGuiding: function doGuiding(dossierItem, item, index, isGroup) {
      var vm = this;
      if (vm.thuTucHanhChinhSelected === null || vm.thuTucHanhChinhSelected === undefined || vm.thuTucHanhChinhSelected === 'undefined') {
        alert('Loại thủ tục bắt buộc phải chọn');
      } else {
        var filter = {
          serviceConfigId: vm.thuTucHanhChinhSelected.serviceConfigId
        };
        vm.dialogPDFLoading = true;
        vm.dialogPDF = true;
        vm.$store.dispatch('doGuiding', filter).then(function (result) {
          vm.dialogPDFLoading = false;
          document.getElementById('dialogPDFPreview').src = result;
        });
      }
    },
    getNextActions: function getNextActions() {
      var vm = this;
      var query = vm.$router.history.current.query;
      var filter = {};
      if (vm.dossierSelected.length > 0) {
        filter['dossierId'] = vm.dossierSelected[0].dossierId;
      } else {
        filter['dossierId'] = vm.arrDossierId[0];
      }
      var currentQuery = vm.$router.history.current.query;
      vm.$store.dispatch('pullNextactions', filter).then(function (result) {
        result = result.filter(function (item) {
          return item.enable === 1;
        });
        var actionActiveArr = [];
        if (vm.actionActive.action !== undefined && vm.actionActive.action !== null && vm.actionActive.action !== 'undefined' && vm.actionActive.action !== '') {
          actionActiveArr = vm.actionActive.action.split(',');
        }
        if (actionActiveArr.length === 1) {
          vm.actionExits = actionActiveArr;
          var actionActive = result.filter(function (item) {
            return item.actionCode.toString() === vm.actionActive.action.toString();
          });
          vm.dialogActionProcess = true;
          vm.mutilpleAction = false;
          vm.processPullBtnDetail(actionActive[0], currentQuery.btnIndex);
        } else {
          vm.mutilpleAction = true;
          vm.actionExits = [];
          for (var key in actionActiveArr) {
            var active = false;
            var actionItem;
            for (var key2 in result) {
              if (actionActiveArr[key].toString() === result[key2].actionCode.toString()) {
                active = true;
                actionItem = result[key2];
                break;
              }
            }
            if (active) {
              vm.actionExits.push(actionItem);
            }
          }
          vm.dialogActionProcess = true;

          if (vm.actionExits[0]) {
            vm.processPullBtnDetail(vm.actionExits[0], currentQuery.btnIndex);
          }
        }
      });
    },
    postNextActions: function postNextActions(stepModel) {
      var vm = this;
      stepModel['dossierId'] = vm.thongTinChiTietHoSo.dossierId;
      if (stepModel.allowAssignUser > 0) {
        vm.$store.dispatch('reassignDossier', stepModel).then(function (resReassign) {
          var params = {
            dossierId: vm.dossierId,
            actionCode: stepModel.actionCode,
            actionNote: vm.actionNote,
            actionUser: '',
            payload: '',
            security: '',
            assignUsers: '',
            payment: '',
            createDossiers: ''
          };
          vm.$store.dispatch('postAction', params).then(function (resPostAction) {});
        });
      } else {
        var params = {
          dossierId: vm.dossierId,
          actionCode: stepModel.actionCode,
          actionNote: vm.actionNote,
          actionUser: '',
          payload: '',
          security: '',
          assignUsers: '',
          payment: '',
          createDossiers: ''
        };
        vm.$store.dispatch('postAction', params).then(function (resPostAction) {});
      }
    },
    closeDialogStatusAction: function closeDialogStatusAction() {
      this.dialog_statusAction = false;
      this.btnStateVisible = false;
    }
  },
  filters: {
    dateTimeView: function dateTimeView(arg) {
      if (arg) {
        var value = new Date(arg);
        return value.getDate().toString().padStart(2, '0') + '/' + (value.getMonth() + 1).toString().padStart(2, '0') + '/' + value.getFullYear() + ' | ' + value.getHours().toString().padStart(2, '0') + ':' + value.getMinutes().toString().padStart(2, '0');
      } else {
        return '';
      }
    },
    getMaxDueDate: function getMaxDueDate(arr) {
      var maxDue = Math.max.apply(Math, arr.map(function (item) {
        return item.actionOverdue;
      }));
      return maxDue;
    }
  }
});

/***/ }),

/***/ 751:
/***/ (function(module, exports, __webpack_require__) {

module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;
  return _c('div', [(_vm.loading) ? _c('content-placeholders', {
    staticClass: "mt-3"
  }, [_c('content-placeholders-text', {
    attrs: {
      "lines": 1
    }
  })], 1) : (_vm.dossierSelected.length > 0) ? _c('div', {
    staticClass: "row-header"
  }, [_c('div', {
    staticClass: "background-triangle-big"
  }, [_c('span', [_vm._v("XỬ LÝ HỒ SƠ")])]), _vm._v(" "), _c('div', {
    staticClass: "layout row wrap header_tools row-blue"
  }, [_c('div', {
    staticClass: "flex xs8 sm10 pl-3 text-ellipsis text-bold",
    attrs: {
      "title": _vm.dossierSelected[0].serviceName
    }
  }, [_vm._v("\n        " + _vm._s(_vm.dossierSelected[0].serviceName) + "\n      ")]), _vm._v(" "), _c('div', {
    staticClass: "flex xs4 sm2 text-right",
    staticStyle: {
      "margin-left": "auto"
    }
  }, [_c('v-btn', {
    staticClass: "my-0 mx-0 btn-border-left",
    attrs: {
      "flat": "",
      "active-class": "temp_active"
    },
    on: {
      "click": _vm.goBack
    }
  }, [_vm._v("\n          Quay lại  \n          "), _c('v-icon', {
    attrs: {
      "size": "16"
    }
  }, [_vm._v("undo")])], 1)], 1)])]) : _vm._e(), _vm._v(" "), (_vm.dossierSelected.length > 0) ? _c('v-expansion-panel', {
    staticClass: "expansion-pl"
  }, [_c('v-expansion-panel-content', {
    attrs: {
      "hide-actions": "",
      "value": "1"
    }
  }, [_c('v-card', [_c('v-card-text', {
    staticClass: "px-0 pt-0"
  }, [_c('v-data-table', {
    staticClass: "table-landing table-bordered",
    attrs: {
      "headers": _vm.headersTable,
      "items": _vm.dossierSelected,
      "hide-actions": ""
    },
    scopedSlots: _vm._u([{
      key: "items",
      fn: function(props) {
        return [_c('tr', {
          class: {
            'active': props.index % 2 == 1
          }
        }, [_c('td', {
          staticClass: "text-xs-center"
        }, [_c('div', [_c('span', [_vm._v(_vm._s(props.index + 1))])])]), _vm._v(" "), _c('td', {
          staticClass: "text-xs-left"
        }, [_c('div', [_c('span', [_vm._v(_vm._s(props.item.dossierNo))]), _c('br'), _vm._v(" "), (!props.item.online) ? _c('span', {
          staticStyle: {
            "color": "green"
          }
        }, [_vm._v("Hồ sơ một cửa")]) : _c('span', {
          staticStyle: {
            "color": "blue"
          }
        }, [_vm._v("Hồ sơ trực tuyến")])])]), _vm._v(" "), _c('td', {
          staticClass: "text-xs-left"
        }, [_c('div', [_c('span', [_vm._v(_vm._s(props.item.applicantName))])])]), _vm._v(" "), _c('td', {
          staticClass: "text-xs-left"
        }, [_c('div', [_c('span', [_vm._v(_vm._s(props.item.wardName) + ", " + _vm._s(props.item.districtName) + ", " + _vm._s(props.item.cityName))])])]), _vm._v(" "), _c('td', {
          staticClass: "text-xs-left"
        }, [_c('div', [_c('span', [_vm._v(" Tiếp nhận: " + _vm._s(props.item.receiveDate)), _c('br'), _vm._v("\n                      Hẹn trả: " + _vm._s(props.item.receiveDate)), _c('br'), _vm._v(" "), _c('span', [_vm._v(_vm._s(props.item.dossierOverdue))])])])])])]
      }
    }])
  })], 1)], 1)], 1)], 1) : _vm._e(), _vm._v(" "), _c('v-dialog', {
    attrs: {
      "max-width": "900",
      "transition": "fade-transition"
    },
    model: {
      value: (_vm.dialogPDF),
      callback: function($$v) {
        _vm.dialogPDF = $$v
      },
      expression: "dialogPDF"
    }
  }, [_c('v-card', [_c('v-card-title', {
    staticClass: "headline"
  }, [_vm._v("File đính kèm")]), _vm._v(" "), _c('v-btn', {
    staticClass: "mx-0 my-0 absolute__btn_panel mr-2",
    attrs: {
      "icon": "",
      "dark": ""
    },
    nativeOn: {
      "click": function($event) {
        _vm.dialogPDF = false
      }
    }
  }, [_c('v-icon', [_vm._v("clear")])], 1), _vm._v(" "), (_vm.dialogPDFLoading) ? _c('div', {
    staticStyle: {
      "min-height": "600px",
      "text-align": "center",
      "margin": "auto",
      "padding": "25%"
    }
  }, [_c('v-progress-circular', {
    attrs: {
      "size": 100,
      "width": 1,
      "color": "primary",
      "indeterminate": ""
    }
  })], 1) : _vm._e(), _vm._v(" "), _c('iframe', {
    directives: [{
      name: "show",
      rawName: "v-show",
      value: (!_vm.dialogPDFLoading),
      expression: "!dialogPDFLoading"
    }],
    staticStyle: {
      "overflow": "auto",
      "min-height": "600px"
    },
    attrs: {
      "id": "dialogPDFPreview",
      "src": "",
      "type": "application/pdf",
      "width": "100%",
      "height": "100%",
      "frameborder": "0"
    }
  })], 1)], 1), _vm._v(" "), _c('div', [(_vm.btnStateVisible) ? _c('v-layout', {
    attrs: {
      "wrap": ""
    }
  }, [(_vm.showFormBoSungThongTinNgan) ? _c('form-bo-sung-thong-tin', {
    ref: "formBoSungThongTinNgan",
    attrs: {
      "dossier_id": Number(_vm.id),
      "action_id": Number(_vm.actionIdCurrent)
    }
  }) : _vm._e(), _vm._v(" "), (_vm.showPhanCongNguoiThucHien) ? _c('phan-cong', {
    ref: "phancong",
    attrs: {
      "type": _vm.type_assign
    },
    model: {
      value: (_vm.assign_items),
      callback: function($$v) {
        _vm.assign_items = $$v
      },
      expression: "assign_items"
    }
  }) : _vm._e(), _vm._v(" "), (_vm.showTraKetQua) ? _c('tra-ket-qua', {
    attrs: {
      "resultFiles": _vm.returnFiles
    }
  }) : _vm._e(), _vm._v(" "), (_vm.showThuPhi) ? _c('thu-phi', {
    attrs: {
      "viaPortal": _vm.viaPortalDetail
    },
    model: {
      value: (_vm.payments),
      callback: function($$v) {
        _vm.payments = $$v
      },
      expression: "payments"
    }
  }) : _vm._e(), _vm._v(" "), (_vm.showKyPheDuyetTaiLieu) ? _c('ky-duyet', {
    ref: "kypheduyettailieu",
    attrs: {
      "detailDossier": _vm.thongTinChiTietHoSo
    }
  }) : _vm._e(), _vm._v(" "), (_vm.showYkienCanBoThucHien) ? _c('y-kien-can-bo', {
    ref: "ykiencanbo",
    attrs: {
      "user_note": _vm.userNote
    }
  }) : _vm._e(), _vm._v(" "), _c('v-btn', {
    attrs: {
      "color": "primary",
      "loading": _vm.loadingActionProcess,
      "disabled": _vm.loadingActionProcess
    },
    nativeOn: {
      "click": function($event) {
        _vm.processAction()
      }
    }
  }, [_c('v-icon', [_vm._v("save")]), _vm._v(" \n        Xác nhận\n        "), _c('span', {
    attrs: {
      "slot": "loader"
    },
    slot: "loader"
  }, [_vm._v("Loading...")])], 1), _vm._v(" "), _c('v-btn', {
    attrs: {
      "color": "primary"
    },
    on: {
      "click": function($event) {
        _vm.goBack()
      }
    }
  }, [_c('v-icon', [_vm._v("undo")]), _vm._v(" \n        Quay lại\n      ")], 1)], 1) : _vm._e(), _vm._v(" "), (!_vm.btnStateVisible) ? _c('v-alert', {
    attrs: {
      "outline": "",
      "color": "success",
      "icon": "check_circle",
      "value": true
    }
  }, [_vm._v("\n      Thực hiện thành công!\n    ")]) : _vm._e()], 1), _vm._v(" "), _c('v-dialog', {
    attrs: {
      "scrollable": "",
      "persistent": "",
      "max-width": "700px"
    },
    model: {
      value: (_vm.dialog_statusAction),
      callback: function($$v) {
        _vm.dialog_statusAction = $$v
      },
      expression: "dialog_statusAction"
    }
  }, [_c('v-card', [_c('v-card-title', {
    staticClass: "headline"
  }, [_vm._v("\n        Trạng thái xử lý\n      ")]), _vm._v(" "), _c('v-btn', {
    staticClass: "mx-0 my-0 absolute__btn_panel mr-2",
    attrs: {
      "icon": "",
      "dark": ""
    },
    nativeOn: {
      "click": function($event) {
        return _vm.closeDialogStatusAction($event)
      }
    }
  }, [_c('v-icon', [_vm._v("clear")])], 1), _vm._v(" "), _c('v-card-text', {
    staticStyle: {
      "max-height": "350px"
    }
  }, _vm._l((_vm.dossierSelected), function(item, index) {
    return _c('div', {
      key: item.dossierId
    }, [_c('v-layout', {
      staticClass: "py-1 align-center row-list-style",
      staticStyle: {
        "border-bottom": "1px solid #ddd",
        "position": "relative"
      },
      attrs: {
        "wrap": ""
      }
    }, [_c('v-flex', {
      attrs: {
        "xs11": ""
      }
    }, [_c('span', {
      staticClass: "text-bold",
      staticStyle: {
        "position": "absolute"
      }
    }, [_vm._v(_vm._s(index + 1) + ".")]), _vm._v(" "), _c('div', {
      staticClass: "ml-4"
    }, [_c('span', {
      staticClass: "text-bold"
    }, [_vm._v(_vm._s(item.dossierNo))]), _vm._v(" - " + _vm._s(item.applicantName))])]), _vm._v(" "), _c('v-flex', {
      staticClass: "text-right",
      attrs: {
        "xs1": ""
      }
    }, [(item.statusAction) ? _c('v-tooltip', {
      attrs: {
        "top": ""
      }
    }, [_c('v-icon', {
      attrs: {
        "slot": "activator",
        "size": "20",
        "color": "primary"
      },
      slot: "activator"
    }, [_vm._v("\n                  check\n                ")]), _vm._v(" "), _c('span', [_vm._v("Thành công")])], 1) : _c('v-tooltip', {
      attrs: {
        "top": ""
      }
    }, [_c('v-icon', {
      attrs: {
        "slot": "activator",
        "size": "20",
        "color": "red darken-3"
      },
      slot: "activator"
    }, [_vm._v("\n                  block\n                ")]), _vm._v(" "), _c('span', [_vm._v("Thất bại")])], 1)], 1)], 1)], 1)
  })), _vm._v(" "), _c('v-card-actions', [_c('v-spacer'), _vm._v(" "), _c('v-btn', {
    attrs: {
      "color": "primary",
      "loading": _vm.loadingAction,
      "disabled": _vm.loadingAction
    },
    nativeOn: {
      "click": function($event) {
        _vm.processAction()
      }
    }
  }, [_c('v-icon', {
    attrs: {
      "size": "20"
    }
  }, [_vm._v("refresh")]), _vm._v(" \n          Thử lại\n          "), _c('span', {
    attrs: {
      "slot": "loader"
    },
    slot: "loader"
  }, [_vm._v("Loading...")])], 1), _vm._v(" "), _c('v-btn', {
    attrs: {
      "color": "red",
      "dark": "",
      "loading": _vm.loadingAction,
      "disabled": _vm.loadingAction
    },
    nativeOn: {
      "click": function($event) {
        return _vm.closeDialogStatusAction($event)
      }
    }
  }, [_c('v-icon', [_vm._v("undo")]), _vm._v(" \n          Thoát\n          "), _c('span', {
    attrs: {
      "slot": "loader"
    },
    slot: "loader"
  }, [_vm._v("Loading...")])], 1)], 1)], 1)], 1)], 1)
},staticRenderFns: []}
module.exports.render._withStripped = true
if (false) {
  module.hot.accept()
  if (module.hot.data) {
     require("vue-hot-reload-api").rerender("data-v-b51162c2", module.exports)
  }
}

/***/ })

});
//# sourceMappingURL=6.6b206b70927e23ec0489.js.map