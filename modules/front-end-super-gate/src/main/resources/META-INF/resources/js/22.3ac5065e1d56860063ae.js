webpackJsonp([22],{209:function(t,e,o){var s=o(138)(o(509),o(511),null,null);t.exports=s.exports},509:function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise__=__webpack_require__(139),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise__),__WEBPACK_IMPORTED_MODULE_1_jquery__=__webpack_require__(36),__WEBPACK_IMPORTED_MODULE_1_jquery___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_jquery__);__webpack_exports__.default={data:function(){return{dossierTemplateItems:[],dossierMarksItems:[],dossierFilesItems:[],thongTinHoSo:{}}},computed:{loading:function(){return this.$store.getters.loading}},mounted:function(){var t=this;t.page=1,t.$nextTick(function(){})},methods:{resetCounterTemplate:function(t,e){t.commit,t.state;this.dossierTemplateItems.forEach(function(t){t.partNo===e.partNo&&(t.hasForm?t.count=1:t.count=0)})},recountFileTemplates:function(){var t=this;t.dossierTemplateItems.forEach(function(e){e.count=0,t.dossierFilesItems.forEach(function(t){e.partNo===t.dossierPartNo&&e.count++})})},initData:function(t){var e=this,o=[];console.log(t.dossierId),o.push(e.$store.dispatch("loadDossierTemplates",t)),o.push(e.$store.dispatch("loadDossierMark",t)),o.push(e.$store.dispatch("loadDossierFiles",t.dossierId)),e.thongTinHoSo=t,__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_promise___default.a.all(o).then(function(o){var s=o[0],a=o[1],i=o[2],r=[];r=a?s.map(function(t){return t.hasForm?t.count=1:t.count=0,a.forEach(function(e,o){e.dossierPartNo===t.partNo&&(t.fileType=e.fileType,t.fileCheck=e.fileCheck)}),t}):s.map(function(t){return t.hasForm?t.count=1:t.count=0,t.fileType=0,t.fileCheck=!1,t}),e.dossierTemplateItems=r,e.dossierFilesItems=i,e.dossierMarksItems=a,setTimeout(function(o){if(i.length>0){var s=i.filter(function(t){return t.eForm}),a=r.filter(function(t){return t.hasForm&&1===t.partType});s.length>0?s.forEach(function(t){t.eForm&&e.$store.dispatch("loadAlpcaForm",t)}):r.forEach(function(o){o.hasForm&&1===o.partType&&(o.templateFileNo=t.dossierTemplateNo,e.showAlpacaJSFORM(o))}),a.length!==s.length&&a.forEach(function(o){-1===s.findIndex(function(t){return o.partNo===t.dossierPartNo})&&(o.templateFileNo=t.dossierTemplateNo,e.showAlpacaJSFORM(o))})}else r.forEach(function(o){o.hasForm&&1===o.partType&&(o.templateFileNo=t.dossierTemplateNo,e.showAlpacaJSFORM(o))})},500),console.log("dossierTemplateItems",e.dossierTemplateItems)}).catch(function(t){})},showAlpacaJSFORM:function showAlpacaJSFORM(item){var vm=this;vm.$store.dispatch("loadFormScript",item).then(function(resScript){vm.$store.dispatch("loadFormData",item).then(function(resData){var formScript,formData;formScript=resScript?eval("("+resScript+")"):{},formData=resData?eval("("+resData+")"):{},formScript.data=formData,__WEBPACK_IMPORTED_MODULE_1_jquery___default()("#formAlpaca"+item.partNo).alpaca(formScript)})})},saveAlpacaForm:function(t){var e=this,o=e.dossierFilesItems.find(function(e){return e.dossierPartNo===t.partNo});o?(o.dossierId=e.thongTinHoSo.dossierId,e.$store.dispatch("putAlpacaForm",files).then(function(t){})):(t.dossierId=e.thongTinHoSo.dossierId,e.$store.dispatch("postEform",t).then(function(t){e.$store.dispatch("loadDossierFiles",e.thongTinHoSo.dossierId).then(function(t){e.dossierFilesItems=t})}))},onDeleteAttackFiles:function(t){var e=this;console.log("delete"),confirm("Bạn có muốn xóa toàn bộ file trong thành phần hồ sơ này?")&&e.dossierFilesItems.forEach(function(o){o.dossierPartNo===t.partNo&&(o.dossierId=e.thongTinHoSo.dossierId,e.$store.dispatch("deleteAttackFiles",o).then(function(o){e.resetCounterTemplate(t),e.$store.dispatch("loadDossierFiles",e.thongTinHoSo.dossierId)}).catch(function(t){}))})},pickFile:function(t){document.getElementById("file"+t.partNo).click()},onUploadSingleFile:function(t,e){var o=this;t.dataItem=e,t.dossierId=o.thongTinHoSo.dossierId,t.dossierTemplateNo=o.thongTinHoSo.dossierTemplateNo,o.$store.dispatch("uploadSingleFile",t).then(function(t){o.$store.dispatch("loadDossierFiles",o.thongTinHoSo.dossierId).then(function(t){o.dossierFilesItems=t,o.recountFileTemplates()})}).catch(function(t){})},loadAlpcaForm:function(t){var e=this,o=e.dossierFilesItems.find(function(t){return t.dossierPartNo===item.partNo&&t.eForm});o?e.$store.dispatch("loadAlpcaForm",o):e.dossierTemplateItems.forEach(function(o){o.hasForm&&t.partNo===o.partNo&&(o.templateFileNo=e.thongTinHoSo.dossierTemplateNo,e.showAlpacaJSFORM(o))})},viewFile:function(t){var e=this,o=this;o.dossierFilesItems.forEach(function(s){s.dossierId=o.thongTinHoSo.dossierId,s.dossierPartNo===t.partNo&&e.$store.dispatch("viewFile",s)})}}}},511:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("v-card",t._l(t.dossierTemplateItems,function(e,s){return 1===e.partType?o("div",{key:e.partNo,staticClass:"form_alpaca",staticStyle:{position:"relative"}},[o("v-expansion-panel",{staticClass:"expaned__list__data",class:{no_acction__event:!e.hasForm}},[o("v-expansion-panel-content",{attrs:{"hide-actions":"",value:!1}},[o("div",{attrs:{slot:"header"},slot:"header"},[o("div",{staticStyle:{width:"calc(100% - 370px)",display:"flex","align-items":"center","min-height":"38px",background:"#fff","padding-left":"15px"}},[o("span",{staticClass:"text-bold mr-2"},[t._v(t._s(s+1)+".")]),t._v(" "),o("span",{on:{click:function(o){t.loadAlpcaForm(e)}}},[t._v(t._s(e.partName)+" "),e.required?o("span",{staticStyle:{color:"red"}},[t._v(" (*)")]):t._e(),t._v(" "),e.hasForm?o("i",{staticStyle:{"font-size":"10px",color:"#0d71bb"}},[t._v("(Form trực tuyến)")]):t._e()])])]),t._v(" "),o("v-card",[o("v-card-text",[o("v-layout",{attrs:{wrap:""}},[o("v-flex",{staticClass:"text-xs-right",attrs:{xs12:""}},[o("v-btn",{attrs:{color:"primary"},on:{click:function(o){t.saveAlpacaForm(e)}}},[t._v("Lưu lại")]),t._v(" "),o("div",{attrs:{id:"formAlpaca"+e.partNo}})],1)],1)],1)],1)],1)],1),t._v(" "),o("div",{staticClass:"absolute__btn group__thanh_phan"},[t.loading?o("content-placeholders",{staticClass:"mt-1"},[o("content-placeholders-text",{attrs:{lines:1}})],1):o("v-layout",{staticClass:"flex__checkbox",attrs:{row:"",wrap:""}},[o("v-flex",{staticClass:"layout wrap",staticStyle:{width:"260px"}},[o("v-checkbox",{staticClass:"flex",attrs:{light:"",color:"secondary"},model:{value:t.dossierTemplateItems[s].fileCheck,callback:function(e){t.$set(t.dossierTemplateItems[s],"fileCheck",e)},expression:"dossierTemplateItems[index].fileCheck"}}),t._v(" "),o("v-radio-group",{attrs:{row:""},model:{value:t.dossierTemplateItems[s].fileType,callback:function(e){t.$set(t.dossierTemplateItems[s],"fileType",e)},expression:"dossierTemplateItems[index].fileType"}},[o("v-radio",{attrs:{value:2,disabled:!t.dossierTemplateItems[s].fileCheck}}),t._v(" "),o("v-radio",{attrs:{value:0,disabled:!t.dossierTemplateItems[s].fileCheck}}),t._v(" "),o("v-radio",{attrs:{value:1,disabled:!t.dossierTemplateItems[s].fileCheck}})],1)],1),t._v(" "),o("v-flex",{staticStyle:{width:"110px",background:"#fff"}},[o("v-tooltip",{attrs:{top:""}},[o("v-btn",{staticClass:"mx-0 my-0",attrs:{slot:"activator",icon:""},slot:"activator"},[o("v-badge",[o("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"file"+e.partNo},on:{change:function(o){t.onUploadSingleFile(o,e)}}}),t._v(" "),o("v-icon",{attrs:{size:"16",color:"primary"},on:{click:function(o){t.pickFile(e)}}},[t._v("attach_file")])],1)],1),t._v(" "),o("span",[t._v("Tải file lên")])],1),t._v(" "),o("v-tooltip",{attrs:{top:""}},[o("v-btn",{staticClass:"mx-0",staticStyle:{height:"20px",width:"20px"},attrs:{slot:"activator",fab:"",dark:"",small:"",color:"primary"},on:{click:function(o){t.viewFile(e)}},slot:"activator"},[t._v("\n                "+t._s(e.count)+"\n              ")]),t._v(" "),o("span",[t._v("Xem")])],1),t._v(" "),o("v-tooltip",{attrs:{top:""}},[o("v-btn",{staticClass:"mx-0 my-0",attrs:{slot:"activator",icon:""},on:{click:function(o){t.onDeleteAttackFiles(e)}},slot:"activator"},[o("v-icon",{staticClass:"mx-0",attrs:{size:"16",color:"red darken-3"}},[t._v("delete")])],1),t._v(" "),o("span",[t._v("Xóa")])],1)],1)],1)],1)],1):t._e()})),t._v(" "),t._m(0)],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"absolute-lable",staticStyle:{"font-size":"12px"}},[o("span",[t._v("Bản chính")]),t._v(" "),o("span",[t._v("Bản chụp")]),t._v(" "),o("span",[t._v("Công chứng")])])}]}}});
//# sourceMappingURL=22.3ac5065e1d56860063ae.js.map