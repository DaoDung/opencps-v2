webpackJsonp([25],{231:function(e,t,i){var o=i(137)(i(692),i(699),null,null);o.options.__file="/home/hoanganh/Pictures/FrontEnd_Opencps2.1/frontend-opencps-v2.1/onegate_21_fe/src/components/form_xu_ly/TaoTaiLieuKetQua.vue",o.esModule&&Object.keys(o.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),o.options.functional&&console.error("[vue-loader] TaoTaiLieuKetQua.vue: functional components are not supported with templates, they should use render functions."),e.exports=o.exports},692:function(module,__webpack_exports__,__webpack_require__){"use strict";Object.defineProperty(__webpack_exports__,"__esModule",{value:!0});var __WEBPACK_IMPORTED_MODULE_0_jquery__=__webpack_require__(36),__WEBPACK_IMPORTED_MODULE_0_jquery___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_jquery__),__WEBPACK_IMPORTED_MODULE_1_toastr__=__webpack_require__(142),__WEBPACK_IMPORTED_MODULE_1_toastr___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_toastr__);__webpack_exports__.default={props:{id:{type:String,default:function(){return"nm"}},detailDossier:{type:Object,default:function(){}},createFiles:{type:Array,default:function(){return[]}}},data:function(){return{dossierTemplateItems:[],dossierMarksItems:[],dossierFilesItems:[],thongTinHoSo:{},valid:!0,stateView:!1,dialogAddOtherTemp:!1,loadingAddOther:!1,otherDossierTemplate:"",sheet:!1,partView:"",dossierFileIdView:"",stateEdit:!1,progressUploadPart:"",dialogPDF:!1,dialogPDFLoading:!0,stateAddFileOther:!1,dossierTemplatesItemSelect:{},fileViews:[],sampleCount:0,fileTemplateItems:[]}},computed:{loading:function(){return this.$store.getters.loading},originality:function(){return this.getOriginality()},initDataResource:function(){return this.$store.getters.loadingInitData}},created:function(){var e=this;e.page=1,e.$nextTick(function(){e.detailDossier.dossierId&&e.$store.dispatch("loadDossierFiles",e.detailDossier.dossierId).then(function(t){e.dossierFilesItems=t,e.createFiles=e.mergeDossierTemplateVsDossierFiles(e.createFiles,t)}).catch(function(e){})})},mounted:function(){var e=this;e.$nextTick(function(){e.createFiles.length>0&&setTimeout(function(){e.genAllAlpacaForm(e.dossierFilesItems,e.createFiles)},300)})},methods:{genAllAlpacaForm:function(e,t){var i=this;if(e.length>0){var o=e.filter(function(e){return e.eForm}),a=t.filter(function(e){return e.eForm});o.length>0?o.forEach(function(e){e.eForm&&i.$store.dispatch("loadAlpcaForm",e)}):t.forEach(function(e){e.eForm&&(e.templateFileNo=i.detailDossier.dossierTemplateNo,i.showAlpacaJSFORM(e))}),a.length!==o.length&&a.forEach(function(e){-1===o.findIndex(function(t){return e.partNo===t.dossierPartNo})&&(e.templateFileNo=i.detailDossier.dossierTemplateNo,i.showAlpacaJSFORM(e))})}else t.forEach(function(e){e.eForm&&(e.templateFileNo=i.detailDossier.dossierTemplateNo,i.showAlpacaJSFORM(e))})},mergeDossierTemplateVsDossierFiles:function(e,t){return 0!==t.length?e.forEach(function(e){var i=t.find(function(t){return e.partNo===t.dossierPartNo&&t.eForm});i?e.daKhai=!0:!i&&e.eForm&&(e.daKhai=!1)}):e.forEach(function(e){e.eForm&&(e.daKhai=!1)}),e},showAlpacaJSFORM:function showAlpacaJSFORM(item){var vm=this;item.dossierId=vm.detailDossier.dossierId,vm.$store.dispatch("loadFormScript",item).then(function(resScript){vm.$store.dispatch("loadFormData",item).then(function(resData){__WEBPACK_IMPORTED_MODULE_0_jquery___default()("#formAlpaca"+item.partNo+vm.id).empty();var formScript,formData;formScript=resScript?eval("("+resScript+")"):{},formData=resData?eval("("+resData+")"):{},formScript.data=formData,__WEBPACK_IMPORTED_MODULE_0_jquery___default()("#formAlpaca"+item.partNo+vm.id).alpaca(formScript)})})},saveAlpacaForm:function(e,t){var i=this,o=i.dossierFilesItems.find(function(t){return t.dossierPartNo===e.partNo&&t.eForm});o?(o.dossierId=i.detailDossier.dossierId,o.id=i.id,i.$store.dispatch("putAlpacaForm",o).then(function(e){}).catch(function(e){__WEBPACK_IMPORTED_MODULE_1_toastr___default.a.error("Yêu cầu của bạn được thực hiện thất bại.")})):(e.dossierId=i.detailDossier.dossierId,e.id=i.id,i.$store.dispatch("postEform",e).then(function(e){i.createFiles[t].daKhai=!0,i.$store.dispatch("loadDossierFiles",i.detailDossier.dossierId).then(function(e){i.dossierFilesItems=e}).catch(function(e){__WEBPACK_IMPORTED_MODULE_1_toastr___default.a.error("Yêu cầu của bạn được thực hiện thất bại.")})}).catch(function(e){__WEBPACK_IMPORTED_MODULE_1_toastr___default.a.error("Yêu cầu của bạn được thực hiện thất bại.")}))},onDeleteAttackFiles:function(e){var t=this;confirm("Bạn có muốn xóa toàn bộ file trong thành phần hồ sơ này?")&&t.dossierFilesItems.forEach(function(i){i.dossierPartNo===e.partNo&&(i.dossierId=t.detailDossier.dossierId,t.$store.dispatch("deleteAttackFiles",i).then(function(e){t.$store.dispatch("loadDossierFiles",t.detailDossier.dossierId)}).catch(function(e){}))})},pickFile:function(e){this.stateAddFileOther=!1,document.getElementById("file"+e.partNo).click()},onUploadSingleFile:function(e,t){var i=this;i.dossierTemplatesItemSelect=t,i.progressUploadPart=t.partNo,t.dossierId=i.detailDossier.dossierId,t.dossierTemplateNo=i.detailDossier.dossierTemplateNo,i.$store.dispatch("uploadSingleFile",t).then(function(e){i.progressUploadPart="",i.$store.dispatch("loadDossierFiles",i.detailDossier.dossierId).then(function(e){i.dossierFilesItems=e})}).catch(function(e){i.progressUploadPart=""})},loadAlpcaForm:function(e){var t=this,i=t.dossierFilesItems.find(function(t){return t.dossierPartNo===e.partNo&&t.eForm});i?(i.id=t.id,t.$store.dispatch("loadAlpcaForm",i)):t.createFiles.forEach(function(i){i.eForm&&e.partNo===i.partNo&&(i.templateFileNo=t.detailDossier.dossierTemplateNo,t.showAlpacaJSFORM(i))})},deleteSingleFileEform:function(e,t){var i=this;confirm("Bạn có muốn xóa?")&&(i.dossierFilesItems.forEach(function(t){t.dossierPartNo===e.partNo&&t.eForm&&(t.dossierId=i.detailDossier.dossierId,i.$store.dispatch("deleteDossierFile",t).then(function(t){i.$store.dispatch("loadDossierFiles",i.detailDossier.dossierId).then(function(t){i.dossierFilesItems=t;var o=i.dossierFilesItems.filter(function(t){return t.dossierPartNo===e.partNo&&!t.eForm});o&&(i.fileViews=o)})}))}),i.createFiles[t].daKhai=!1)},previewFileEfom:function(e,t){var i=this;i.dossierFilesItems.forEach(function(t){t.dossierPartNo===e.partNo&&t.eForm&&(t.dossierId=i.detailDossier.dossierId,i.dialogPDFLoading=!0,i.dialogPDF=!0,t.id=i.id,i.$store.dispatch("putAlpacaForm",t).then(function(e){setTimeout(function(){i.$store.dispatch("viewFile",t).then(function(e){i.dialogPDFLoading=!1,document.getElementById("dialogPDFPreview"+i.id).src=e})},1e3)}).catch(function(e){__WEBPACK_IMPORTED_MODULE_1_toastr___default.a.error("Yêu cầu của bạn được thực hiện thất bại.")}))})},deleteSingleFile:function(e,t){var i=this;confirm("Bạn có muốn xóa?")&&(e.dossierId=i.detailDossier.dossierId,i.$store.dispatch("deleteDossierFile",e).then(function(o){i.fileViews.splice(t,1),i.partView=e.dossierPartNo,i.$store.dispatch("loadDossierFiles",i.detailDossier.dossierId).then(function(e){i.dossierFilesItems=e})}).catch(function(e){__WEBPACK_IMPORTED_MODULE_1_toastr___default.a.error("Yêu cầu của bạn được thực hiện thất bại.")}))},viewFile:function(e){var t=this,i=this;i.dossierFilesItems.forEach(function(o){o.dossierId=i.detailDossier.dossierId,o.dossierPartNo===e.partNo&&t.$store.dispatch("viewFile",o)})},viewFile2:function(e){var t=this;if("doc"===e.fileType||"docx"===e.fileType||"xlsx"===e.fileType||"xls"===e.fileType||"zip"===e.fileType||"rar"===e.fileType){var i=t.initDataResource.dossierApi+"/"+t.detailDossier.dossierId+"/files/"+e.referenceUid;window.open(i)}else t.dialogPDFLoading=!0,t.dialogPDF=!0,e.dossierId=t.detailDossier.dossierId,t.$store.dispatch("viewFile",e).then(function(e){t.dialogPDFLoading=!1,document.getElementById("dialogPDFPreview"+t.id).src=e})},viewFileWithPartNo:function(e){var t=this;if(t.dossierFilesItems){var i=t.dossierFilesItems.filter(function(t){return t.dossierPartNo===e.partNo&&!t.eForm});if(!i)return;t.fileViews=i,t.partView!==e.partNo?(t.stateView=!0,t.partView=e.partNo):(t.stateView=!t.stateView,t.partView=e.partNo)}},checkStyle:function(e){return"calc(100% - 50px)"},downloadFileTemplate:function(e,t){var i=this;if(i.fileTemplateItems.length>0){var o=i.fileTemplateItems.find(function(t){return e.fileTemplateNo===t.fileTemplateNo});if(o){var a=i.initDataResource.serviceInfoApi+"/"+o.serviceCode+"/filetemplates/"+o.fileTemplateNo;window.open(a)}}},cancelDialog:function(){var e=this;e.dialogAddOtherTemp=!1,e.progressUploadPart=""},addFileOther:function(e){var t=this;t.dialogAddOtherTemp=!0,t.stateAddFileOther=!0,t.dossierTemplatesItemSelect=e},changeDisplayName:function(e,t){var i=this,o={dossierId:i.detailDossier.dossierId,value:value};i.$store.dispatch("changeDisplayNameFile",o).then(function(e){i.fileViews[t].displayName=e.displayName,i.stateEdit=!1}).catch(function(e){})}}}},699:function(e,t,i){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"taotailieuketqua",staticStyle:{"background-color":"white",width:"100%"}},[i("v-expansion-panel",{staticClass:"expansion-pl"},[i("v-expansion-panel-content",{attrs:{"hide-actions":"",value:"1"}},[i("div",{attrs:{slot:"header"},slot:"header"},[i("div",{staticClass:"background-triangle-small"},[i("v-icon",{attrs:{size:"18",color:"white"}},[e._v("star_rate")])],1),e._v(" Kết quả xử lý\n        ")]),e._v(" "),i("v-card",e._l(e.createFiles,function(t,o){return i("div",{key:t.partNo+"cr",staticClass:"form_alpaca",staticStyle:{position:"relative"}},[i("v-expansion-panel",{staticClass:"expaned__list__data"},[i("v-expansion-panel-content",{attrs:{"hide-actions":"",value:!1}},[i("div",{staticStyle:{"background-color":"#fff"},attrs:{slot:"header"},on:{click:function(t){e.stateView=!1}},slot:"header"},[i("div",{staticStyle:{"align-items":"center","min-height":"38px",background:"#fff","padding-left":"15px"},style:{width:e.checkStyle(t)}},[i("div",{staticClass:"mr-2",staticStyle:{"min-width":"18px",display:"flex","min-height":"38px"},on:{click:function(i){e.loadAlpcaForm(t)}}},[i("div",{staticClass:"header__tphs"},[i("span",{staticClass:"text-bold"},[e._v(e._s(o+1)+".")]),e._v("  ")]),e._v(" "),i("div",{staticClass:"header__tphs"},[e._v("\n                        "+e._s(t.partName)+" "),t.required?i("span",{staticStyle:{color:"red"}},[e._v(" (*)")]):e._e(),e._v("\n                          \n                        "),t.eForm&&t.daKhai?i("v-tooltip",{attrs:{top:""}},[i("i",{staticClass:"fa fa-file-text-o",staticStyle:{color:"#0d71bb","font-size":"13px"},attrs:{slot:"activator","aria-hidden":"true"},slot:"activator"}),e._v(" "),i("span",[e._v("Biểu mẫu trực tuyến (Đã khai)")])]):e._e(),e._v(" "),t.eForm&&!t.daKhai?i("v-tooltip",{attrs:{top:""}},[i("i",{staticClass:"fa fa-file-o",staticStyle:{color:"#0d71bb","font-size":"13px"},attrs:{slot:"activator"},slot:"activator"}),e._v(" "),i("span",[e._v("Biểu mẫu trực tuyến (Chưa khai)")])]):e._e()],1)]),e._v(" "),e._l(e.dossierFilesItems,function(o,a){return t.partNo+e.id!==o.dossierPartNo+e.id||o.eForm?e._e():i("div",{key:a+"cr"},[i("div",{staticStyle:{width:"calc(100% - 370px)",display:"flex","align-items":"center","min-height":"38px",background:"#fff","padding-left":"15px","font-size":"12px"}},[i("span",{staticClass:"ml-3",staticStyle:{cursor:"pointer"},on:{click:function(t){t.stopPropagation(),e.viewFile2(o)}}},[o.eForm?i("v-icon",[e._v("border_color")]):i("v-icon",[e._v("attach_file")]),e._v("\n                      "+e._s(o.displayName)+" - \n                      "),i("i",[e._v(e._s(o.modifiedDate))])],1),e._v(" "),i("v-btn",{staticClass:"mx-0 my-0",attrs:{icon:"",ripple:""},on:{click:function(t){t.stopPropagation(),e.deleteSingleFile(o,a)}}},[i("v-icon",{staticStyle:{color:"red"}},[e._v("delete_outline")])],1)],1)])})],2)]),e._v(" "),t.eForm?i("v-card",[i("v-card-text",{staticStyle:{"background-color":"rgba(244, 247, 213, 0.19)"}},[i("v-layout",{attrs:{wrap:""}},[i("v-flex",{staticClass:"text-xs-right",attrs:{xs12:""}},[t.eForm?i("v-btn",{attrs:{color:"primary"},on:{click:function(i){e.saveAlpacaForm(t,o)}}},[e._v("Lưu lại")]):e._e(),e._v(" "),t.daKhai&&t.eForm?i("v-btn",{attrs:{color:"primary"},on:{click:function(i){e.deleteSingleFileEform(t,o)}}},[e._v("Xóa")]):e._e(),e._v(" "),t.daKhai&&t.eForm?i("v-btn",{attrs:{color:"primary"},on:{click:function(i){e.previewFileEfom(t,o)}}},[e._v("In")]):e._e(),e._v(" "),i("div",{attrs:{id:"formAlpaca"+t.partNo+e.id}})],1)],1)],1)],1):e._e()],1)],1),e._v(" "),i("div",{staticClass:"absolute__btn group__thanh_phan pr-3 mr-1"},[e.loading?i("content-placeholders",{staticClass:"mt-1"},[i("content-placeholders-text",{attrs:{lines:1}})],1):i("v-layout",{attrs:{row:"",wrap:""}},[i("v-flex",{staticStyle:{width:"50px"}},[i("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"file"+t.partNo},on:{change:function(i){e.onUploadSingleFile(i,t)}}}),e._v(" "),e.progressUploadPart+e.id===t.partNo+e.id?i("v-progress-circular",{attrs:{width:2,size:25,color:"green",indeterminate:""}}):e.progressUploadPart+e.id!==t.partNo+e.id?i("v-tooltip",{attrs:{top:""}},[i("v-btn",{staticClass:"mx-0 my-0",attrs:{slot:"activator",icon:""},on:{click:function(i){e.pickFile(t)}},slot:"activator"},[i("v-badge",[i("v-icon",{attrs:{size:"16",color:"primary"}},[e._v("cloud_upload")])],1)],1),e._v(" "),i("span",[e._v("Tải file lên")])],1):e._e()],1)],1)],1)],1)})),e._v(" "),i("v-dialog",{staticStyle:{overflow:"hidden"},attrs:{"max-width":"900",transition:"fade-transition"},model:{value:e.dialogPDF,callback:function(t){e.dialogPDF=t},expression:"dialogPDF"}},[i("v-card",[i("v-card-title",{staticClass:"headline"},[e._v("File đính kèm")]),e._v(" "),i("v-btn",{staticClass:"mx-0 my-0 absolute__btn_panel mr-2",attrs:{icon:"",dark:""},nativeOn:{click:function(t){e.dialogPDF=!1}}},[i("v-icon",[e._v("clear")])],1),e._v(" "),e.dialogPDFLoading?i("div",{staticStyle:{"min-height":"600px","text-align":"center",margin:"auto",padding:"25%"}},[i("v-progress-circular",{attrs:{size:100,width:1,color:"primary",indeterminate:""}})],1):e._e(),e._v(" "),i("iframe",{directives:[{name:"show",rawName:"v-show",value:!e.dialogPDFLoading,expression:"!dialogPDFLoading"}],staticStyle:{overflow:"auto","min-height":"600px"},attrs:{id:"dialogPDFPreview"+e.id,src:"",type:"application/pdf",width:"100%",height:"100%",frameborder:"0"}})],1)],1)],1)],1)],1)},staticRenderFns:[]},e.exports.render._withStripped=!0}});
//# sourceMappingURL=25.d512ce451cbeb7e4da1c.js.map