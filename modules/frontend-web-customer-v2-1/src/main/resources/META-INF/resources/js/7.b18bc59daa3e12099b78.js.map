{"version":3,"sources":["webpack:///o/frontend-web-customer-v2-1/js/7.b18bc59daa3e12099b78.js","webpack:///./src/components/Comment.vue?2e8a**","webpack:///./~/core-js/library/modules/_wks-define.js?b6e0***","webpack:///./~/core-js/library/modules/_wks-ext.js?6ee2***","webpack:///./~/core-js/library/modules/_object-gopn.js?1e07***","webpack:///./~/babel-runtime/core-js/object/keys.js?fe06*****","webpack:///./~/babel-runtime/helpers/typeof.js?f4bd***","webpack:///./~/babel-runtime/core-js/symbol.js?a70d***","webpack:///./~/babel-runtime/core-js/symbol/iterator.js?d16b***","webpack:///./~/core-js/library/fn/object/keys.js?cc3f*****","webpack:///./~/core-js/library/fn/symbol/index.js?f07a***","webpack:///./~/core-js/library/fn/symbol/iterator.js?238d***","webpack:///./~/core-js/library/modules/_enum-keys.js?727a***","webpack:///./~/core-js/library/modules/_is-array.js?1843***","webpack:///./~/core-js/library/modules/_meta.js?553d***","webpack:///./~/core-js/library/modules/_object-gopd.js?d7d8***","webpack:///./~/core-js/library/modules/_object-gopn-ext.js?d238***","webpack:///./~/core-js/library/modules/_object-sap.js?a03e*****","webpack:///./~/core-js/library/modules/es6.object.keys.js?c98f*****","webpack:///./~/core-js/library/modules/es6.symbol.js?670a***","webpack:///./~/core-js/library/modules/es7.symbol.async-iterator.js?b8c5***","webpack:///./~/core-js/library/modules/es7.symbol.observable.js?daa4***","webpack:///./src/store/jquery_comment.js?b1d5**","webpack:///Comment.vue?bcc9**","webpack:///./~/babel-runtime/core-js/object/create.js?aa4b**","webpack:///./~/core-js/library/fn/object/create.js?738c**","webpack:///./~/core-js/library/modules/es6.object.create.js?9034**","webpack:///./~/jquery-textcomplete/dist/jquery.textcomplete.js?3e1f**","webpack:///./src/components/Comment.vue?0237***","webpack:///(webpack)/buildin/harmony-module.js?cc96**"],"names":["webpackJsonp","228","module","exports","__webpack_require__","Component","options","__file","esModule","Object","keys","some","key","console","error","functional","521","global","core","LIBRARY","wksExt","defineProperty","f","name","$Symbol","Symbol","charAt","value","522","523","$keys","hiddenKeys","concat","getOwnPropertyNames","O","524","default","__esModule","525","_interopRequireDefault","obj","_iterator","_iterator2","_symbol","_symbol2","_typeof","constructor","prototype","650","651","652","653","654","655","getKeys","gOPS","pIE","it","result","getSymbols","symbols","isEnum","i","length","call","push","656","cof","Array","isArray","arg","657","META","isObject","has","setDesc","id","isExtensible","FREEZE","preventExtensions","setMeta","w","fastKey","create","getWeak","onFreeze","meta","NEED","KEY","658","createDesc","toIObject","toPrimitive","IE8_DOM_DEFINE","gOPD","getOwnPropertyDescriptor","P","e","659","gOPN","toString","windowNames","window","getWindowNames","slice","660","$export","fails","exec","fn","exp","S","F","661","toObject","662","DESCRIPTORS","redefine","$fails","shared","setToStringTag","uid","wks","wksDefine","enumKeys","anObject","_create","gOPNExt","$GOPD","$DP","dP","$JSON","JSON","_stringify","stringify","HIDDEN","TO_PRIMITIVE","propertyIsEnumerable","SymbolRegistry","AllSymbols","OPSymbols","ObjectProto","USE_NATIVE","QObject","setter","findChild","setSymbolDesc","get","this","a","D","protoDesc","wrap","tag","sym","_k","isSymbol","iterator","$defineProperty","enumerable","$defineProperties","l","$create","undefined","$propertyIsEnumerable","E","$getOwnPropertyDescriptor","$getOwnPropertyNames","names","$getOwnPropertySymbols","IS_OP","TypeError","arguments","$set","configurable","set","G","W","es6Symbols","split","j","wellKnownSymbols","store","k","for","keyFor","useSetter","useSimple","defineProperties","getOwnPropertySymbols","replacer","$replacer","args","apply","valueOf","Math","663","664","671","__webpack_exports__","jQuery","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_create__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_create___default","n","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys__","__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default","__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_typeof__","__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_typeof___default","factory","define","root","$","Comments","$el","commentsById","usersById","dataFetched","currentSortKey","events","click","keydown [contenteditable]","focus [contenteditable]","keyup [contenteditable]","paste [contenteditable]","input [contenteditable]","blur [contenteditable]","click .navigation li[data-sort-key]","click .navigation li.title","click .commenting-field.main .textarea","click .commenting-field.main .close","click .commenting-field .textarea","change .commenting-field .textarea","click .commenting-field:not(.main) .close","click .commenting-field .send.enabled","click .commenting-field .update.enabled","click .commenting-field .delete.enabled","change .commenting-field .upload.enabled input[type=\"file\"]","click li.comment button.upvote","click li.comment button.delete.enabled","click li.comment .hashtag","click li.comment .ping","click li.comment ul.child-comments .toggle-all","click li.comment button.reply","click li.comment button.edit","dragenter","dragenter .droppable-overlay","dragleave .droppable-overlay","dragenter .droppable-overlay .droppable","dragleave .droppable-overlay .droppable","dragover .droppable-overlay","drop .droppable-overlay","click .dropdown.autocomplete","mousedown .dropdown.autocomplete","touchstart .dropdown.autocomplete","getDefaultOptions","profilePictureURL","currentUserIsAdmin","currentUserId","spinnerIconURL","upvoteIconURL","replyIconURL","uploadIconURL","attachmentIconURL","fileIconURL","noCommentsIconURL","noCommentsImptIconURL","textareaPlaceholderText","newestText","oldestText","importantCmtText","popularText","attachmentsText","sendText","replyText","editText","editedText","youText","saveText","deleteText","newText","viewAllRepliesText","hideRepliesText","noCommentsText","noCommentsImportantText","noAttachmentsText","attachmentDropText","textFormatter","text","enableReplying","enableEditing","enableUpvoting","enableDeleting","enableAttachments","enableHashtags","enablePinging","enableDeletingCommentWithReplies","enableNavigation","postCommentOnEnter","forceResponsive","readOnly","defaultNavigationSortKey","highlightColor","deleteButtonColor","scrollContainer","roundProfilePictures","textareaRows","textareaRowsOnFocus","textareaMaxRows","maxRepliesVisible","fieldMappings","parent","created","modified","content","file","fileURL","fileMimeType","pings","creator","fullname","profileURL","isNew","createdByAdmin","createdByCurrentUser","upvoteCount","userHasUpvoted","getUsers","success","getComments","postComment","commentJSON","putComment","deleteComment","upvoteComment","hashtagClicked","hashtag","pingClicked","userId","uploadAttachments","commentArray","refresh","timeFormatter","time","Date","toLocaleDateString","appendNewComments","commentJSONs","init","el","addClass","undelegateEvents","delegateEvents","browser","mobile","test","substr","navigator","userAgent","vendor","opera","extend","createCssDeclarations","fetchDataAndRender","bindEvents","unbind","bindFunction","eventName","selector","join","methodNames","index","hasOwnProperty","method","proxy","self","setTimeout","empty","createHTML","after","render","commentsFetched","commentsArray","commentModels","map","commentsJSON","createCommentModel","sortComments","each","commentModel","addCommentToDataModel","usersFetched","userArray","user","fetchNext","spinner","createSpinner","find","append","createComment","remove","applyInternalMappings","childs","getOutermostParent","updateCommentModel","showActiveContainer","createComments","createAttachments","createImportantComments","activeNavigationEl","containerName","data","containerEl","siblings","hide","show","commentList","class","mainLevelComments","replies","reverse","addComment","prepend","attachmentList","attachments","getAttachments","addAttachment","importantCmtList","importantCmt","getImportantCmt","addImportantCmt","commentEl","createCommentElement","directParentEl","reRenderCommentActionBar","outerMostParent","parents","last","childCommentsEl","commentingField","before","updateToggleAllButton","removeComment","commentId","childComments","getChildComments","childComment","outermostParent","indexToRemove","indexOf","splice","commentElements","parentEl","files","isReply","hasClass","fileCount","uploadButton","textarea","removeClass","attachmentListSpinner","commentListSpinner","getTextareaContent","trigger","createCommentJSON","type","applyExternalMappings","val","toggleAllButton","hiddenReplies","toggleAllButtonText","caret","setToggleAllButtonText","comments","sortKey","sort","commentA","commentB","pointsOfA","pointsOfB","createdA","getTime","createdB","sortUsers","users","b","nameA","toLowerCase","trim","nameB","sortAndReArrangeComments","filter","showActiveSort","activeElements","titleEl","html","first","defaultDropdownEl","children","closeDropdowns","saveOnKeydown","ev","keyCode","metaKey","ctrlKey","currentTarget","stopPropagation","preventDefault","saveEditableContent","checkEditableContentForChange","navigationElementClicked","navigationEl","toggleNavigationDropdown","toggle","showMainCommentingField","mainTextarea","focus","hideMainCommentingField","closeButton","mainControlRow","clearTextarea","adjustTextareaHeight","blur","increaseTextareaHeight","textareaContentChanged","saveButton","attr","parentComments","parentId","scrollHeight","outerHeight","contentOrParentChangedIfEditing","parentFromModel","contentChanged","parentChanged","removeCommentingField","context","clearTimeout","myVar","commentsNew","commentsEdit","c","cmt","reRenderComment","sendButton","opinion","getPings","deleteButton","fileInputChanged","newUpvoteCount","model","previousUpvoteCount","reRenderUpvotes","toggleReplies","toggleClass","replyButtonClicked","replyButton","replyField","createCommentingFieldElement","moveCursorToEnd","scrollTop","endOfReply","position","top","endOfScrollable","newScrollTop","editButtonClicked","editButton","editField","getFormattedCommentContent","showDroppableOverlay","css","handleDragEnter","count","handleDragLeave","callback","handleDragLeaveForOverlay","hideDroppableOverlay","handleDragLeaveForDroppable","handleDragOverForOverlay","originalEvent","dataTransfer","dropEffect","handleDrop","target","mainCommentingField","createNavigationElement","commentsContainer","data-container","noComments","noCommentsIcon","importantCmtContainer","noCommentsImpt","noCommentsImptIcon","attachmentsContainer","noAttachments","noAttachmentsIcon","droppableOverlay","droppableContainer","droppable","uploadIcon","dropAttachmentText","createProfilePictureElement","src","profilePicture","existingCommentId","enableOpinion","textareaWrapper","controlRow","data-placeholder","contenteditable","saveButtonText","opinionCmtId","fileInput","data-role","saveButtonClass","checkOpinion","labelCheckOpinion","parentModel","replyToName","replyToTag","createTagElement","textcomplete","match","search","term","normalizeSpaces","isSelf","alreadyPinged","lowercaseTerm","nameMatch","emailMatch","email","template","wrapper","profilePictureEl","pictureUrl","detailsEl","nameEl","emailEl","replace","outerHTML","appendTo","dropdownClassName","maxCount","rightEdgeOffset","Dropdown","zippedData","contentsHtml","_buildContents","unzippedData","d","strategy","removeAttr","_renderHeader","_renderFooter","_renderContents","_fitToBottom","_fitToRight","_activateIndexedItem","_setScroll","noResultsMessage","_renderNoResultsMessage","shown","deactivate","parseInt","originalLeft","maxLeft","width","outerWidth","left","min","navigationWrapper","newest","data-sort-key","data-container-name","oldest","important","popular","attachmentsIcon","dropdownNavigationWrapper","dropdownNavigation","dropdownTitle","dropdownTitleHeader","clone","spinnerIcon","data-id","commentWrapper","createCommentWrapperElement","data-original","nameText","link","href","replyTo","replyIcon","newTag","noteOpinion","isAttachment","format","mimeTypeParts","image","video","controls","availableIcons","iconClass","fileIcon","fileName","editedTime","edited","actions","reply","upvoteIcon","upvotes","createUpvoteElement","isAllowedToDelete","extraClasses","tagEl","replaceWith","createCss","styleEl","commentArr","importantCmtArr","comment","importantCmtUser","attachCmtArr","directParentId","parentComment","toISOString","textContainer","showExpandingText","replyCount","rowCount","rows","height","isAreaScrollable","maxRowsUsed","humanReadable","textareaClone","ce","innerHTML","replaceNewLines","escape","linkify","highlightTags","getSelection","document","createRange","range","selectNodeContents","collapse","sel","removeAllRanges","addRange","body","createTextRange","textRange","moveToElementText","select","inputText","RegExp","times","func","highlightHashtags","highlightPings","__createTag","regex","$0","$1","$2","highlightedHtml","pingText","endIndex","current","replacedText","replacePattern1","replacePattern2","replacePattern3","splitInput","waitUntil","condition","invertedMappings","mappings","prop","applyMappings","key1","key2","689","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__","__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default","__WEBPACK_IMPORTED_MODULE_1_jquery__","__WEBPACK_IMPORTED_MODULE_1_jquery___default","__WEBPACK_IMPORTED_MODULE_2_jquery_textcomplete__","props","usersComment","argShowMore","computed","loading","$store","getters","initData","loadingInitData","watch","classPK","vm","dispatch","then","initComment","catch","reject","mounted","methods","runComment","className","setHours","getHours","getDate","padStart","getMonth","getFullYear","getMinutes","onSuccess","onError","dataGet","item","formatComment","getElementById","checked","responses","successfulUploads","serverResponded","formData","FormData","size","userEmail","userName","ajax","url","commentApi","dataType","headers","groupId","cache","contentType","processData","xhr","fileType","fileUrl","createdDate","createDate","modifiedDate","dateTimeView","filters","694","695","$Object","696","697","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","Error","warn","message","strategies","option","$this","completer","_oid","Completer","shift","removeData","register","Strategy","parse","element","uniqueId","views","defaults","is","isContentEditable","contentEditable","ownerDocument","activeElement","initialize","one","adapter","CKEDITOR","on","event","inArray","editor","initializedEditors","event2","editable","ckeditor_instance","isString","zIndex","dropdown","$iframe","frames","iframeIndex","frameElement","Adapter","viewName","selectionEnd","destroy","off","skipUnchangedTerm","getTextFromHeadToCaret","searchQuery","_extractSearchQuery","_term","_search","fire","_clearAtNext","matchRegexp","isFunction","locked","queuedArgsToReplay","unshift","replayOrFree","replayArgs","free","stillSearching","activate","clear","setPosition","getCaretPosition","_zip","createElement","_data","$inputEl","listPosition","_i","_bindEvents","dropdownViews","$window","include","datum","elem","idProperty","keepTextCompleteDropdown","view","commands","SKIP_DEFAULT","KEY_UP","KEY_DOWN","KEY_ENTER","KEY_PAGEUP","KEY_PAGEDOWN","KEY_ESCAPE","$parent","display","footer","header","placement","pos","add","scrollLeft","_applyPlacement","_index","_$header","_$footer","_$noResultsMessage","isUp","isDown","isEnter","altKey","shiftKey","completeOnSpace","isPageup","isPagedown","isEscape","_onClick","_onMouseover","_onKeydown","closest","command","onKeydown","_defaultKeydown","_up","_down","_enter","_pageup","_pagedown","_getActiveElement","threshold","innerHeight","$activeEl","itemTop","itemHeight","visibleHeight","visibleTop","prependTo","windowScrollBottom","offset","tolerance","lastOffset","bottom","lineHeight","right","memoize","memo","strategiesArray","params","strategyObj","now","debounce","wait","timeout","timestamp","later","_onKeyup","_getCaretRelativePosition","parentOffset","offsetParent","_skipSearch","clickEvent","Textarea","regExp","pre","post","substring","newSubstr","selectionStart","p","getCaretCoordinates","_calculateLineHeight","isNaN","parentNode","temp","nodeName","style","setAttribute","fontFamily","fontSize","appendChild","clientHeight","removeChild","IETextarea","sentinelChar","insertBefore","moveEnd","moveStart","selection","arr","ContentEditable","getRangeAt","cloneRange","startContainer","startOffset","deleteContents","preWrapper","postWrapper","childNode","lastOfPre","fragment","createDocumentFragment","firstChild","insertNode","setStartAfter","wrapperNode","endContainer","node","normalize","$node","iframePosition","contentWindow","CKEditor","domEvent","isBrowser","debug","querySelector","div","getComputedStyle","currentStyle","whiteSpace","wordWrap","visibility","properties","forEach","isFirefox","overflowY","overflow","textContent","span","coordinates","offsetTop","offsetLeft","backgroundColor","mozInnerScreenX","701","_vm","_h","$createElement","_c","_self","staticClass","attrs","hide-actions","staticRenderFns","_withStripped","703","originalModule","webpackPolyfill"],"mappings":"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","file":"o/frontend-web-customer-v2-1/js/7.b18bc59daa3e12099b78.js","sourcesContent":["webpackJsonp([7],{\n\n/***/ 228:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar Component = __webpack_require__(137)(\n  /* script */\n  __webpack_require__(689),\n  /* template */\n  __webpack_require__(701),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\nComponent.options.__file = \"/home/hoanganh/Pictures/FrontEnd_Opencps2.1/frontend-opencps-v2.1/onegate_21_fe/src/components/Comment.vue\"\nif (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== \"default\" && key !== \"__esModule\"})) {console.error(\"named exports are not supported in *.vue files.\")}\nif (Component.options.functional) {console.error(\"[vue-loader] Comment.vue: functional components are not supported with templates, they should use render functions.\")}\n\n/* hot reload */\nif (false) {(function () {\n  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), false)\n  if (!hotAPI.compatible) return\n  module.hot.accept()\n  if (!module.hot.data) {\n    hotAPI.createRecord(\"data-v-c8f36406\", Component.options)\n  } else {\n    hotAPI.reload(\"data-v-c8f36406\", Component.options)\n  }\n})()}\n\nmodule.exports = Component.exports\n\n\n/***/ }),\n\n/***/ 521:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar global = __webpack_require__(20);\nvar core = __webpack_require__(30);\nvar LIBRARY = __webpack_require__(140);\nvar wksExt = __webpack_require__(522);\nvar defineProperty = __webpack_require__(57).f;\nmodule.exports = function (name) {\n  var $Symbol = core.Symbol || (core.Symbol = LIBRARY ? {} : global.Symbol || {});\n  if (name.charAt(0) != '_' && !(name in $Symbol)) defineProperty($Symbol, name, { value: wksExt.f(name) });\n};\n\n\n/***/ }),\n\n/***/ 522:\n/***/ (function(module, exports, __webpack_require__) {\n\nexports.f = __webpack_require__(19);\n\n\n/***/ }),\n\n/***/ 523:\n/***/ (function(module, exports, __webpack_require__) {\n\n// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)\nvar $keys = __webpack_require__(225);\nvar hiddenKeys = __webpack_require__(145).concat('length', 'prototype');\n\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return $keys(O, hiddenKeys);\n};\n\n\n/***/ }),\n\n/***/ 524:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = { \"default\": __webpack_require__(652), __esModule: true };\n\n/***/ }),\n\n/***/ 525:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nexports.__esModule = true;\n\nvar _iterator = __webpack_require__(651);\n\nvar _iterator2 = _interopRequireDefault(_iterator);\n\nvar _symbol = __webpack_require__(650);\n\nvar _symbol2 = _interopRequireDefault(_symbol);\n\nvar _typeof = typeof _symbol2.default === \"function\" && typeof _iterator2.default === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof _symbol2.default === \"function\" && obj.constructor === _symbol2.default && obj !== _symbol2.default.prototype ? \"symbol\" : typeof obj; };\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = typeof _symbol2.default === \"function\" && _typeof(_iterator2.default) === \"symbol\" ? function (obj) {\n  return typeof obj === \"undefined\" ? \"undefined\" : _typeof(obj);\n} : function (obj) {\n  return obj && typeof _symbol2.default === \"function\" && obj.constructor === _symbol2.default && obj !== _symbol2.default.prototype ? \"symbol\" : typeof obj === \"undefined\" ? \"undefined\" : _typeof(obj);\n};\n\n/***/ }),\n\n/***/ 650:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = { \"default\": __webpack_require__(653), __esModule: true };\n\n/***/ }),\n\n/***/ 651:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = { \"default\": __webpack_require__(654), __esModule: true };\n\n/***/ }),\n\n/***/ 652:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(661);\nmodule.exports = __webpack_require__(30).Object.keys;\n\n\n/***/ }),\n\n/***/ 653:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(662);\n__webpack_require__(227);\n__webpack_require__(663);\n__webpack_require__(664);\nmodule.exports = __webpack_require__(30).Symbol;\n\n\n/***/ }),\n\n/***/ 654:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(144);\n__webpack_require__(218);\nmodule.exports = __webpack_require__(522).f('iterator');\n\n\n/***/ }),\n\n/***/ 655:\n/***/ (function(module, exports, __webpack_require__) {\n\n// all enumerable object keys, includes symbols\nvar getKeys = __webpack_require__(138);\nvar gOPS = __webpack_require__(213);\nvar pIE = __webpack_require__(211);\nmodule.exports = function (it) {\n  var result = getKeys(it);\n  var getSymbols = gOPS.f;\n  if (getSymbols) {\n    var symbols = getSymbols(it);\n    var isEnum = pIE.f;\n    var i = 0;\n    var key;\n    while (symbols.length > i) if (isEnum.call(it, key = symbols[i++])) result.push(key);\n  } return result;\n};\n\n\n/***/ }),\n\n/***/ 656:\n/***/ (function(module, exports, __webpack_require__) {\n\n// 7.2.2 IsArray(argument)\nvar cof = __webpack_require__(74);\nmodule.exports = Array.isArray || function isArray(arg) {\n  return cof(arg) == 'Array';\n};\n\n\n/***/ }),\n\n/***/ 657:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar META = __webpack_require__(141)('meta');\nvar isObject = __webpack_require__(59);\nvar has = __webpack_require__(73);\nvar setDesc = __webpack_require__(57).f;\nvar id = 0;\nvar isExtensible = Object.isExtensible || function () {\n  return true;\n};\nvar FREEZE = !__webpack_require__(94)(function () {\n  return isExtensible(Object.preventExtensions({}));\n});\nvar setMeta = function (it) {\n  setDesc(it, META, { value: {\n    i: 'O' + ++id, // object ID\n    w: {}          // weak collections IDs\n  } });\n};\nvar fastKey = function (it, create) {\n  // return primitive with prefix\n  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n  if (!has(it, META)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return 'F';\n    // not necessary to add metadata\n    if (!create) return 'E';\n    // add missing metadata\n    setMeta(it);\n  // return object ID\n  } return it[META].i;\n};\nvar getWeak = function (it, create) {\n  if (!has(it, META)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return true;\n    // not necessary to add metadata\n    if (!create) return false;\n    // add missing metadata\n    setMeta(it);\n  // return hash weak collections IDs\n  } return it[META].w;\n};\n// add metadata on freeze-family methods calling\nvar onFreeze = function (it) {\n  if (FREEZE && meta.NEED && isExtensible(it) && !has(it, META)) setMeta(it);\n  return it;\n};\nvar meta = module.exports = {\n  KEY: META,\n  NEED: false,\n  fastKey: fastKey,\n  getWeak: getWeak,\n  onFreeze: onFreeze\n};\n\n\n/***/ }),\n\n/***/ 658:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar pIE = __webpack_require__(211);\nvar createDesc = __webpack_require__(96);\nvar toIObject = __webpack_require__(95);\nvar toPrimitive = __webpack_require__(214);\nvar has = __webpack_require__(73);\nvar IE8_DOM_DEFINE = __webpack_require__(224);\nvar gOPD = Object.getOwnPropertyDescriptor;\n\nexports.f = __webpack_require__(58) ? gOPD : function getOwnPropertyDescriptor(O, P) {\n  O = toIObject(O);\n  P = toPrimitive(P, true);\n  if (IE8_DOM_DEFINE) try {\n    return gOPD(O, P);\n  } catch (e) { /* empty */ }\n  if (has(O, P)) return createDesc(!pIE.f.call(O, P), O[P]);\n};\n\n\n/***/ }),\n\n/***/ 659:\n/***/ (function(module, exports, __webpack_require__) {\n\n// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window\nvar toIObject = __webpack_require__(95);\nvar gOPN = __webpack_require__(523).f;\nvar toString = {}.toString;\n\nvar windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames\n  ? Object.getOwnPropertyNames(window) : [];\n\nvar getWindowNames = function (it) {\n  try {\n    return gOPN(it);\n  } catch (e) {\n    return windowNames.slice();\n  }\n};\n\nmodule.exports.f = function getOwnPropertyNames(it) {\n  return windowNames && toString.call(it) == '[object Window]' ? getWindowNames(it) : gOPN(toIObject(it));\n};\n\n\n/***/ }),\n\n/***/ 660:\n/***/ (function(module, exports, __webpack_require__) {\n\n// most Object methods by ES6 should accept primitives\nvar $export = __webpack_require__(51);\nvar core = __webpack_require__(30);\nvar fails = __webpack_require__(94);\nmodule.exports = function (KEY, exec) {\n  var fn = (core.Object || {})[KEY] || Object[KEY];\n  var exp = {};\n  exp[KEY] = exec(fn);\n  $export($export.S + $export.F * fails(function () { fn(1); }), 'Object', exp);\n};\n\n\n/***/ }),\n\n/***/ 661:\n/***/ (function(module, exports, __webpack_require__) {\n\n// 19.1.2.14 Object.keys(O)\nvar toObject = __webpack_require__(98);\nvar $keys = __webpack_require__(138);\n\n__webpack_require__(660)('keys', function () {\n  return function keys(it) {\n    return $keys(toObject(it));\n  };\n});\n\n\n/***/ }),\n\n/***/ 662:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n// ECMAScript 6 symbols shim\nvar global = __webpack_require__(20);\nvar has = __webpack_require__(73);\nvar DESCRIPTORS = __webpack_require__(58);\nvar $export = __webpack_require__(51);\nvar redefine = __webpack_require__(226);\nvar META = __webpack_require__(657).KEY;\nvar $fails = __webpack_require__(94);\nvar shared = __webpack_require__(146);\nvar setToStringTag = __webpack_require__(97);\nvar uid = __webpack_require__(141);\nvar wks = __webpack_require__(19);\nvar wksExt = __webpack_require__(522);\nvar wksDefine = __webpack_require__(521);\nvar enumKeys = __webpack_require__(655);\nvar isArray = __webpack_require__(656);\nvar anObject = __webpack_require__(38);\nvar isObject = __webpack_require__(59);\nvar toIObject = __webpack_require__(95);\nvar toPrimitive = __webpack_require__(214);\nvar createDesc = __webpack_require__(96);\nvar _create = __webpack_require__(216);\nvar gOPNExt = __webpack_require__(659);\nvar $GOPD = __webpack_require__(658);\nvar $DP = __webpack_require__(57);\nvar $keys = __webpack_require__(138);\nvar gOPD = $GOPD.f;\nvar dP = $DP.f;\nvar gOPN = gOPNExt.f;\nvar $Symbol = global.Symbol;\nvar $JSON = global.JSON;\nvar _stringify = $JSON && $JSON.stringify;\nvar PROTOTYPE = 'prototype';\nvar HIDDEN = wks('_hidden');\nvar TO_PRIMITIVE = wks('toPrimitive');\nvar isEnum = {}.propertyIsEnumerable;\nvar SymbolRegistry = shared('symbol-registry');\nvar AllSymbols = shared('symbols');\nvar OPSymbols = shared('op-symbols');\nvar ObjectProto = Object[PROTOTYPE];\nvar USE_NATIVE = typeof $Symbol == 'function';\nvar QObject = global.QObject;\n// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173\nvar setter = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;\n\n// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687\nvar setSymbolDesc = DESCRIPTORS && $fails(function () {\n  return _create(dP({}, 'a', {\n    get: function () { return dP(this, 'a', { value: 7 }).a; }\n  })).a != 7;\n}) ? function (it, key, D) {\n  var protoDesc = gOPD(ObjectProto, key);\n  if (protoDesc) delete ObjectProto[key];\n  dP(it, key, D);\n  if (protoDesc && it !== ObjectProto) dP(ObjectProto, key, protoDesc);\n} : dP;\n\nvar wrap = function (tag) {\n  var sym = AllSymbols[tag] = _create($Symbol[PROTOTYPE]);\n  sym._k = tag;\n  return sym;\n};\n\nvar isSymbol = USE_NATIVE && typeof $Symbol.iterator == 'symbol' ? function (it) {\n  return typeof it == 'symbol';\n} : function (it) {\n  return it instanceof $Symbol;\n};\n\nvar $defineProperty = function defineProperty(it, key, D) {\n  if (it === ObjectProto) $defineProperty(OPSymbols, key, D);\n  anObject(it);\n  key = toPrimitive(key, true);\n  anObject(D);\n  if (has(AllSymbols, key)) {\n    if (!D.enumerable) {\n      if (!has(it, HIDDEN)) dP(it, HIDDEN, createDesc(1, {}));\n      it[HIDDEN][key] = true;\n    } else {\n      if (has(it, HIDDEN) && it[HIDDEN][key]) it[HIDDEN][key] = false;\n      D = _create(D, { enumerable: createDesc(0, false) });\n    } return setSymbolDesc(it, key, D);\n  } return dP(it, key, D);\n};\nvar $defineProperties = function defineProperties(it, P) {\n  anObject(it);\n  var keys = enumKeys(P = toIObject(P));\n  var i = 0;\n  var l = keys.length;\n  var key;\n  while (l > i) $defineProperty(it, key = keys[i++], P[key]);\n  return it;\n};\nvar $create = function create(it, P) {\n  return P === undefined ? _create(it) : $defineProperties(_create(it), P);\n};\nvar $propertyIsEnumerable = function propertyIsEnumerable(key) {\n  var E = isEnum.call(this, key = toPrimitive(key, true));\n  if (this === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return false;\n  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key] ? E : true;\n};\nvar $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key) {\n  it = toIObject(it);\n  key = toPrimitive(key, true);\n  if (it === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return;\n  var D = gOPD(it, key);\n  if (D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key])) D.enumerable = true;\n  return D;\n};\nvar $getOwnPropertyNames = function getOwnPropertyNames(it) {\n  var names = gOPN(toIObject(it));\n  var result = [];\n  var i = 0;\n  var key;\n  while (names.length > i) {\n    if (!has(AllSymbols, key = names[i++]) && key != HIDDEN && key != META) result.push(key);\n  } return result;\n};\nvar $getOwnPropertySymbols = function getOwnPropertySymbols(it) {\n  var IS_OP = it === ObjectProto;\n  var names = gOPN(IS_OP ? OPSymbols : toIObject(it));\n  var result = [];\n  var i = 0;\n  var key;\n  while (names.length > i) {\n    if (has(AllSymbols, key = names[i++]) && (IS_OP ? has(ObjectProto, key) : true)) result.push(AllSymbols[key]);\n  } return result;\n};\n\n// 19.4.1.1 Symbol([description])\nif (!USE_NATIVE) {\n  $Symbol = function Symbol() {\n    if (this instanceof $Symbol) throw TypeError('Symbol is not a constructor!');\n    var tag = uid(arguments.length > 0 ? arguments[0] : undefined);\n    var $set = function (value) {\n      if (this === ObjectProto) $set.call(OPSymbols, value);\n      if (has(this, HIDDEN) && has(this[HIDDEN], tag)) this[HIDDEN][tag] = false;\n      setSymbolDesc(this, tag, createDesc(1, value));\n    };\n    if (DESCRIPTORS && setter) setSymbolDesc(ObjectProto, tag, { configurable: true, set: $set });\n    return wrap(tag);\n  };\n  redefine($Symbol[PROTOTYPE], 'toString', function toString() {\n    return this._k;\n  });\n\n  $GOPD.f = $getOwnPropertyDescriptor;\n  $DP.f = $defineProperty;\n  __webpack_require__(523).f = gOPNExt.f = $getOwnPropertyNames;\n  __webpack_require__(211).f = $propertyIsEnumerable;\n  __webpack_require__(213).f = $getOwnPropertySymbols;\n\n  if (DESCRIPTORS && !__webpack_require__(140)) {\n    redefine(ObjectProto, 'propertyIsEnumerable', $propertyIsEnumerable, true);\n  }\n\n  wksExt.f = function (name) {\n    return wrap(wks(name));\n  };\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, { Symbol: $Symbol });\n\nfor (var es6Symbols = (\n  // 19.4.2.2, 19.4.2.3, 19.4.2.4, 19.4.2.6, 19.4.2.8, 19.4.2.9, 19.4.2.10, 19.4.2.11, 19.4.2.12, 19.4.2.13, 19.4.2.14\n  'hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'\n).split(','), j = 0; es6Symbols.length > j;)wks(es6Symbols[j++]);\n\nfor (var wellKnownSymbols = $keys(wks.store), k = 0; wellKnownSymbols.length > k;) wksDefine(wellKnownSymbols[k++]);\n\n$export($export.S + $export.F * !USE_NATIVE, 'Symbol', {\n  // 19.4.2.1 Symbol.for(key)\n  'for': function (key) {\n    return has(SymbolRegistry, key += '')\n      ? SymbolRegistry[key]\n      : SymbolRegistry[key] = $Symbol(key);\n  },\n  // 19.4.2.5 Symbol.keyFor(sym)\n  keyFor: function keyFor(sym) {\n    if (!isSymbol(sym)) throw TypeError(sym + ' is not a symbol!');\n    for (var key in SymbolRegistry) if (SymbolRegistry[key] === sym) return key;\n  },\n  useSetter: function () { setter = true; },\n  useSimple: function () { setter = false; }\n});\n\n$export($export.S + $export.F * !USE_NATIVE, 'Object', {\n  // 19.1.2.2 Object.create(O [, Properties])\n  create: $create,\n  // 19.1.2.4 Object.defineProperty(O, P, Attributes)\n  defineProperty: $defineProperty,\n  // 19.1.2.3 Object.defineProperties(O, Properties)\n  defineProperties: $defineProperties,\n  // 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\n  getOwnPropertyDescriptor: $getOwnPropertyDescriptor,\n  // 19.1.2.7 Object.getOwnPropertyNames(O)\n  getOwnPropertyNames: $getOwnPropertyNames,\n  // 19.1.2.8 Object.getOwnPropertySymbols(O)\n  getOwnPropertySymbols: $getOwnPropertySymbols\n});\n\n// 24.3.2 JSON.stringify(value [, replacer [, space]])\n$JSON && $export($export.S + $export.F * (!USE_NATIVE || $fails(function () {\n  var S = $Symbol();\n  // MS Edge converts symbol values to JSON as {}\n  // WebKit converts symbol values to JSON as null\n  // V8 throws on boxed symbols\n  return _stringify([S]) != '[null]' || _stringify({ a: S }) != '{}' || _stringify(Object(S)) != '{}';\n})), 'JSON', {\n  stringify: function stringify(it) {\n    var args = [it];\n    var i = 1;\n    var replacer, $replacer;\n    while (arguments.length > i) args.push(arguments[i++]);\n    $replacer = replacer = args[1];\n    if (!isObject(replacer) && it === undefined || isSymbol(it)) return; // IE8 returns string on undefined\n    if (!isArray(replacer)) replacer = function (key, value) {\n      if (typeof $replacer == 'function') value = $replacer.call(this, key, value);\n      if (!isSymbol(value)) return value;\n    };\n    args[1] = replacer;\n    return _stringify.apply($JSON, args);\n  }\n});\n\n// 19.4.3.4 Symbol.prototype[@@toPrimitive](hint)\n$Symbol[PROTOTYPE][TO_PRIMITIVE] || __webpack_require__(52)($Symbol[PROTOTYPE], TO_PRIMITIVE, $Symbol[PROTOTYPE].valueOf);\n// 19.4.3.5 Symbol.prototype[@@toStringTag]\nsetToStringTag($Symbol, 'Symbol');\n// 20.2.1.9 Math[@@toStringTag]\nsetToStringTag(Math, 'Math', true);\n// 24.3.3 JSON[@@toStringTag]\nsetToStringTag(global.JSON, 'JSON', true);\n\n\n/***/ }),\n\n/***/ 663:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(521)('asyncIterator');\n\n\n/***/ }),\n\n/***/ 664:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(521)('observable');\n\n\n/***/ }),\n\n/***/ 671:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function(jQuery, module) {/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_create__ = __webpack_require__(694);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_create___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_create__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys__ = __webpack_require__(524);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_typeof__ = __webpack_require__(525);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_typeof___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_typeof__);\n\n\n\n\n\n(function (factory) {\n\tif (typeof define === 'function' && __webpack_require__(237)) {\n\t\tdefine(['jquery'], factory);\n\t} else if (( false ? 'undefined' : __WEBPACK_IMPORTED_MODULE_2_babel_runtime_helpers_typeof___default()(module)) === 'object' && module.exports) {\n\t\tmodule.exports = function (root, jQuery) {\n\t\t\tif (jQuery === undefined) {\n\t\t\t\tif (typeof window !== 'undefined') {\n\t\t\t\t\tjQuery = __webpack_require__(36);\n\t\t\t\t} else {\n\t\t\t\t\tjQuery = __webpack_require__(36)(root);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfactory(jQuery);\n\t\t\treturn jQuery;\n\t\t};\n\t} else {\n\t\tfactory(jQuery);\n\t}\n})(function ($) {\n\n\tvar Comments = {\n\t\t$el: null,\n\t\tcommentsById: {},\n\t\tusersById: {},\n\t\tdataFetched: false,\n\t\tcurrentSortKey: '',\n\t\toptions: {},\n\t\tevents: {\n\t\t\t'click': 'closeDropdowns',\n\n\t\t\t'keydown [contenteditable]': 'saveOnKeydown',\n\n\t\t\t'focus [contenteditable]': 'saveEditableContent',\n\t\t\t'keyup [contenteditable]': 'checkEditableContentForChange',\n\t\t\t'paste [contenteditable]': 'checkEditableContentForChange',\n\t\t\t'input [contenteditable]': 'checkEditableContentForChange',\n\t\t\t'blur [contenteditable]': 'checkEditableContentForChange',\n\n\t\t\t'click .navigation li[data-sort-key]': 'navigationElementClicked',\n\t\t\t'click .navigation li.title': 'toggleNavigationDropdown',\n\n\t\t\t'click .commenting-field.main .textarea': 'showMainCommentingField',\n\t\t\t'click .commenting-field.main .close': 'hideMainCommentingField',\n\n\t\t\t'click .commenting-field .textarea': 'increaseTextareaHeight',\n\t\t\t'change .commenting-field .textarea': 'increaseTextareaHeight textareaContentChanged',\n\t\t\t'click .commenting-field:not(.main) .close': 'removeCommentingField',\n\n\t\t\t'click .commenting-field .send.enabled': 'postComment',\n\t\t\t'click .commenting-field .update.enabled': 'putComment',\n\t\t\t'click .commenting-field .delete.enabled': 'deleteComment',\n\t\t\t'change .commenting-field .upload.enabled input[type=\"file\"]': 'fileInputChanged',\n\n\t\t\t'click li.comment button.upvote': 'upvoteComment',\n\t\t\t'click li.comment button.delete.enabled': 'deleteComment',\n\t\t\t'click li.comment .hashtag': 'hashtagClicked',\n\t\t\t'click li.comment .ping': 'pingClicked',\n\n\t\t\t'click li.comment ul.child-comments .toggle-all': 'toggleReplies',\n\t\t\t'click li.comment button.reply': 'replyButtonClicked',\n\t\t\t'click li.comment button.edit': 'editButtonClicked',\n\n\t\t\t'dragenter': 'showDroppableOverlay',\n\t\t\t'dragenter .droppable-overlay': 'handleDragEnter',\n\t\t\t'dragleave .droppable-overlay': 'handleDragLeaveForOverlay',\n\t\t\t'dragenter .droppable-overlay .droppable': 'handleDragEnter',\n\t\t\t'dragleave .droppable-overlay .droppable': 'handleDragLeaveForDroppable',\n\t\t\t'dragover .droppable-overlay': 'handleDragOverForOverlay',\n\t\t\t'drop .droppable-overlay': 'handleDrop',\n\n\t\t\t'click .dropdown.autocomplete': 'stopPropagation',\n\t\t\t'mousedown .dropdown.autocomplete': 'stopPropagation',\n\t\t\t'touchstart .dropdown.autocomplete': 'stopPropagation'\n\t\t},\n\n\n\t\tgetDefaultOptions: function getDefaultOptions() {\n\t\t\treturn {\n\t\t\t\tprofilePictureURL: '',\n\t\t\t\tcurrentUserIsAdmin: false,\n\t\t\t\tcurrentUserId: null,\n\n\t\t\t\tspinnerIconURL: '',\n\t\t\t\tupvoteIconURL: '',\n\t\t\t\treplyIconURL: '',\n\t\t\t\tuploadIconURL: '',\n\t\t\t\tattachmentIconURL: '',\n\t\t\t\tfileIconURL: '',\n\t\t\t\tnoCommentsIconURL: '',\n\t\t\t\tnoCommentsImptIconURL: '',\n\n\t\t\t\ttextareaPlaceholderText: 'Thêm bình luận mới',\n\t\t\t\tnewestText: 'Mới nhất',\n\t\t\t\toldestText: 'Cũ nhất',\n\t\t\t\timportantCmtText: 'Ý kiến chính thức',\n\t\t\t\tpopularText: 'Phổ biến',\n\t\t\t\tattachmentsText: 'Tệp đính kèm',\n\t\t\t\tsendText: 'Gửi',\n\t\t\t\treplyText: 'Trả lời',\n\t\t\t\teditText: 'Sửa',\n\t\t\t\teditedText: 'Đã sửa',\n\t\t\t\tyouText: 'You',\n\t\t\t\tsaveText: 'Ghi lại',\n\t\t\t\tdeleteText: 'Xoá',\n\t\t\t\tnewText: 'Mới',\n\t\t\t\tviewAllRepliesText: 'Xem tất cả __replyCount__ trả lời',\n\t\t\t\thideRepliesText: 'Hide replies',\n\t\t\t\tnoCommentsText: 'Không có bình luận',\n\t\t\t\tnoCommentsImportantText: 'Không có ý kiến chính thức',\n\t\t\t\tnoAttachmentsText: 'Không có tệp đính kèm',\n\t\t\t\tattachmentDropText: 'Kéo thả tệp để tải lên',\n\t\t\t\ttextFormatter: function textFormatter(text) {\n\t\t\t\t\treturn text;\n\t\t\t\t},\n\n\t\t\t\tenableReplying: true,\n\t\t\t\tenableEditing: true,\n\t\t\t\tenableUpvoting: true,\n\t\t\t\tenableDeleting: true,\n\t\t\t\tenableAttachments: false,\n\t\t\t\tenableHashtags: false,\n\t\t\t\tenablePinging: false,\n\t\t\t\tenableDeletingCommentWithReplies: false,\n\t\t\t\tenableNavigation: true,\n\t\t\t\tpostCommentOnEnter: false,\n\t\t\t\tforceResponsive: false,\n\t\t\t\treadOnly: false,\n\t\t\t\tdefaultNavigationSortKey: 'newest',\n\n\t\t\t\thighlightColor: '#2793e6',\n\t\t\t\tdeleteButtonColor: '#C9302C',\n\t\t\t\tscrollContainer: this.$el,\n\t\t\t\troundProfilePictures: false,\n\t\t\t\ttextareaRows: 2,\n\t\t\t\ttextareaRowsOnFocus: 2,\n\t\t\t\ttextareaMaxRows: 5,\n\t\t\t\tmaxRepliesVisible: 2,\n\n\t\t\t\tfieldMappings: {\n\t\t\t\t\tid: 'id',\n\t\t\t\t\tparent: 'parent',\n\t\t\t\t\tcreated: 'createdDate',\n\t\t\t\t\tmodified: 'modifiedDate',\n\t\t\t\t\tcontent: 'content',\n\t\t\t\t\tfile: 'file',\n\t\t\t\t\tfileURL: 'file_url',\n\t\t\t\t\tfileMimeType: 'file_mime_type',\n\t\t\t\t\tpings: 'pings',\n\t\t\t\t\tcreator: 'creator',\n\t\t\t\t\tfullname: 'fullname',\n\t\t\t\t\tprofileURL: 'profile_url',\n\t\t\t\t\tprofilePictureURL: 'profile_picture_url',\n\t\t\t\t\tisNew: 'is_new',\n\t\t\t\t\tcreatedByAdmin: 'created_by_admin',\n\t\t\t\t\tcreatedByCurrentUser: 'created_by_current_user',\n\t\t\t\t\tupvoteCount: 'upvote_count',\n\t\t\t\t\tuserHasUpvoted: 'user_has_upvoted'\n\t\t\t\t},\n\n\t\t\t\tgetUsers: function getUsers(success, error) {\n\t\t\t\t\tsuccess([]);\n\t\t\t\t},\n\t\t\t\tgetComments: function getComments(success, error) {\n\t\t\t\t\tsuccess([]);\n\t\t\t\t},\n\t\t\t\tpostComment: function postComment(commentJSON, success, error) {\n\t\t\t\t\tsuccess(commentJSON);\n\t\t\t\t},\n\t\t\t\tputComment: function putComment(commentJSON, success, error) {\n\t\t\t\t\tsuccess(commentJSON);\n\t\t\t\t},\n\t\t\t\tdeleteComment: function deleteComment(commentJSON, success, error) {\n\t\t\t\t\tsuccess();\n\t\t\t\t},\n\t\t\t\tupvoteComment: function upvoteComment(commentJSON, success, error) {\n\t\t\t\t\tsuccess(commentJSON);\n\t\t\t\t},\n\t\t\t\thashtagClicked: function hashtagClicked(hashtag) {},\n\t\t\t\tpingClicked: function pingClicked(userId) {},\n\t\t\t\tuploadAttachments: function uploadAttachments(commentArray, success, error) {\n\t\t\t\t\tsuccess(commentArray);\n\t\t\t\t},\n\t\t\t\trefresh: function refresh() {},\n\t\t\t\ttimeFormatter: function timeFormatter(time) {\n\t\t\t\t\treturn new Date(time).toLocaleDateString();\n\t\t\t\t},\n\t\t\t\tappendNewComments: function appendNewComments(commentJSONs, success, error) {\n\t\t\t\t\tsuccess([]);\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\n\t\tinit: function init(options, el) {\n\t\t\tthis.$el = $(el);\n\t\t\tthis.$el.addClass('jquery-comments');\n\t\t\tthis.undelegateEvents();\n\t\t\tthis.delegateEvents();\n\n\t\t\t(function (a) {\n\t\t\t\t(jQuery.browser = jQuery.browser || {}).mobile = /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a) || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0, 4));\n\t\t\t})(navigator.userAgent || navigator.vendor || window.opera);\n\t\t\tif ($.browser.mobile) this.$el.addClass('mobile');\n\n\t\t\tthis.options = $.extend(true, {}, this.getDefaultOptions(), options);;\n\n\t\t\tif (this.options.readOnly) this.$el.addClass('read-only');\n\n\t\t\tthis.currentSortKey = this.options.defaultNavigationSortKey;\n\n\t\t\tthis.createCssDeclarations();\n\n\t\t\tthis.fetchDataAndRender();\n\t\t},\n\n\t\tdelegateEvents: function delegateEvents() {\n\t\t\tthis.bindEvents(false);\n\t\t},\n\n\t\tundelegateEvents: function undelegateEvents() {\n\t\t\tthis.bindEvents(true);\n\t\t},\n\n\t\tbindEvents: function bindEvents(unbind) {\n\t\t\tvar bindFunction = unbind ? 'off' : 'on';\n\t\t\tfor (var key in this.events) {\n\t\t\t\tvar eventName = key.split(' ')[0];\n\t\t\t\tvar selector = key.split(' ').slice(1).join(' ');\n\t\t\t\tvar methodNames = this.events[key].split(' ');\n\n\t\t\t\tfor (var index in methodNames) {\n\t\t\t\t\tif (methodNames.hasOwnProperty(index)) {\n\t\t\t\t\t\tvar method = this[methodNames[index]];\n\n\t\t\t\t\t\tmethod = $.proxy(method, this);\n\n\t\t\t\t\t\tif (selector == '') {\n\t\t\t\t\t\t\tthis.$el[bindFunction](eventName, method);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.$el[bindFunction](eventName, selector, method);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tfetchDataAndRender: function fetchDataAndRender() {\n\t\t\tvar self = this;\n\t\t\tsetTimeout(function () {\n\t\t\t\tself.appendNewComments();\n\t\t\t}, 30000);\n\t\t\tthis.commentsById = {};\n\t\t\tthis.usersById = {};\n\t\t\tthis.$el.empty();\n\t\t\tthis.createHTML();\n\n\t\t\tvar dataFetched = this.after(this.options.enablePinging ? 2 : 1, function () {\n\t\t\t\tself.dataFetched = true;\n\t\t\t\tself.render();\n\t\t\t});\n\n\t\t\tvar commentsFetched = function commentsFetched(commentsArray) {\n\t\t\t\tvar commentModels = commentsArray.map(function (commentsJSON) {\n\t\t\t\t\treturn self.createCommentModel(commentsJSON);\n\t\t\t\t});\n\n\t\t\t\tself.sortComments(commentModels, 'oldest');\n\t\t\t\t$(commentModels).each(function (index, commentModel) {\n\t\t\t\t\tself.addCommentToDataModel(commentModel);\n\t\t\t\t});\n\t\t\t\tdataFetched();\n\t\t\t};\n\t\t\tthis.options.getComments(commentsFetched, dataFetched);\n\n\t\t\tif (this.options.enablePinging) {\n\t\t\t\tvar usersFetched = function usersFetched(userArray) {\n\t\t\t\t\t$(userArray).each(function (index, user) {\n\t\t\t\t\t\tself.usersById[user.id] = user;\n\t\t\t\t\t});\n\t\t\t\t\tdataFetched();\n\t\t\t\t};\n\t\t\t\tthis.options.getUsers(usersFetched, dataFetched);\n\t\t\t};\n\t\t},\n\n\t\tfetchNext: function fetchNext() {\n\t\t\tvar self = this;\n\n\t\t\tvar spinner = this.createSpinner();\n\t\t\tthis.$el.find('ul#comment-list').append(spinner);\n\t\t\tvar success = function success(commentModels) {\n\t\t\t\t$(commentModels).each(function (index, commentModel) {\n\t\t\t\t\tself.createComment(commentModel);\n\t\t\t\t});\n\t\t\t\tspinner.remove();\n\t\t\t};\n\n\t\t\tvar error = function error() {\n\t\t\t\tspinner.remove();\n\t\t\t};\n\t\t\tthis.options.getComments(success, error);\n\t\t},\n\n\t\tcreateCommentModel: function createCommentModel(commentJSON) {\n\t\t\tvar commentModel = this.applyInternalMappings(commentJSON);\n\t\t\tcommentModel.childs = [];\n\t\t\tthis.commentsById[commentModel.id] = commentModel;\n\t\t\treturn commentModel;\n\t\t},\n\n\t\taddCommentToDataModel: function addCommentToDataModel(commentModel) {\n\t\t\tif (!(commentModel.id in this.commentsById)) {\n\t\t\t\tthis.commentsById[commentModel.id] = commentModel;\n\n\t\t\t\tif (commentModel.parent) {\n\t\t\t\t\tvar outermostParent = this.getOutermostParent(commentModel.parent);\n\t\t\t\t\toutermostParent.childs.push(commentModel.id);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tupdateCommentModel: function updateCommentModel(commentModel) {\n\t\t\t$.extend(this.commentsById[commentModel.id], commentModel);\n\t\t},\n\n\t\trender: function render() {\n\t\t\tvar self = this;\n\n\t\t\tif (!this.dataFetched) return;\n\n\t\t\tthis.showActiveContainer();\n\n\t\t\tthis.createComments();\n\n\t\t\tif (this.options.enableAttachments) this.createAttachments();\n\n\t\t\tthis.createImportantComments();\n\n\t\t\tthis.$el.find('> .spinner').remove();\n\t\t\tthis.options.refresh();\n\t\t},\n\n\t\tshowActiveContainer: function showActiveContainer() {\n\t\t\tvar activeNavigationEl = this.$el.find('.navigation li[data-container-name].active');\n\t\t\tvar containerName = activeNavigationEl.data('container-name');\n\t\t\tvar containerEl = this.$el.find('[data-container=\"' + containerName + '\"]');\n\t\t\tcontainerEl.siblings('[data-container]').hide();\n\t\t\tcontainerEl.show();\n\t\t},\n\n\t\tcreateComments: function createComments() {\n\t\t\tvar self = this;\n\n\t\t\tthis.$el.find('#comment-list').remove();\n\t\t\tvar commentList = $('<ul/>', {\n\t\t\t\tid: 'comment-list',\n\t\t\t\t'class': 'main'\n\t\t\t});\n\n\t\t\tvar mainLevelComments = [];\n\t\t\tvar replies = [];\n\n\t\t\t$(this.getComments()).each(function (index, commentModel) {\n\t\t\t\tif (commentModel.parent == null) {\n\t\t\t\t\tmainLevelComments.push(commentModel);\n\t\t\t\t} else {\n\t\t\t\t\treplies.push(commentModel);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthis.sortComments(mainLevelComments, this.currentSortKey);\n\t\t\tmainLevelComments.reverse();\n\t\t\t$(mainLevelComments).each(function (index, commentModel) {\n\t\t\t\tself.addComment(commentModel, commentList);\n\t\t\t});\n\n\t\t\tthis.sortComments(replies, 'oldest');\n\t\t\t$(replies).each(function (index, commentModel) {\n\t\t\t\tself.addComment(commentModel, commentList);\n\t\t\t});\n\n\t\t\tthis.$el.find('[data-container=\"comments\"]').prepend(commentList);\n\t\t},\n\n\t\tcreateAttachments: function createAttachments() {\n\t\t\tvar self = this;\n\n\t\t\tthis.$el.find('#attachment-list').remove();\n\t\t\tvar attachmentList = $('<ul/>', {\n\t\t\t\tid: 'attachment-list',\n\t\t\t\t'class': 'main'\n\t\t\t});\n\n\t\t\tvar attachments = this.getAttachments();\n\t\t\tthis.sortComments(attachments, 'newest');\n\t\t\tattachments.reverse();\n\t\t\t$(attachments).each(function (index, commentModel) {\n\t\t\t\tself.addAttachment(commentModel, attachmentList);\n\t\t\t});\n\n\t\t\tthis.$el.find('[data-container=\"attachments\"]').prepend(attachmentList);\n\t\t},\n\t\tcreateImportantComments: function createImportantComments() {\n\t\t\tvar self = this;\n\n\t\t\tthis.$el.find('#importantCmt-list').remove();\n\t\t\tvar importantCmtList = $('<ul/>', {\n\t\t\t\tid: 'importantCmt-list',\n\t\t\t\t'class': 'main'\n\t\t\t});\n\n\t\t\tvar importantCmt = this.getImportantCmt();\n\n\t\t\tthis.sortComments(importantCmt, 'newest');\n\t\t\timportantCmt.reverse();\n\t\t\t$(importantCmt).each(function (index, commentModel) {\n\t\t\t\tself.addImportantCmt(commentModel, importantCmtList);\n\t\t\t});\n\n\t\t\tthis.$el.find('[data-container=\"importantCmt\"]').prepend(importantCmtList);\n\t\t},\n\t\taddComment: function addComment(commentModel, commentList) {\n\t\t\tcommentList = commentList || this.$el.find('#comment-list');\n\t\t\tvar commentEl = this.createCommentElement(commentModel);\n\n\t\t\tif (commentModel.parent) {\n\t\t\t\tvar directParentEl = commentList.find('.comment[data-id=\"' + commentModel.parent + '\"]');\n\n\t\t\t\tthis.reRenderCommentActionBar(commentModel.parent);\n\n\t\t\t\tvar outerMostParent = directParentEl.parents('.comment').last();\n\t\t\t\tif (outerMostParent.length == 0) outerMostParent = directParentEl;\n\n\t\t\t\tvar childCommentsEl = outerMostParent.find('.child-comments');\n\t\t\t\tvar commentingField = childCommentsEl.find('.commenting-field');\n\t\t\t\tif (commentingField.length) {\n\t\t\t\t\tcommentingField.before(commentEl);\n\t\t\t\t} else {\n\t\t\t\t\tchildCommentsEl.append(commentEl);\n\t\t\t\t}\n\n\t\t\t\tthis.updateToggleAllButton(outerMostParent);\n\t\t\t} else {\n\t\t\t\tcommentList.prepend(commentEl);\n\t\t\t}\n\t\t},\n\t\taddAttachment: function addAttachment(commentModel, commentList) {\n\t\t\tcommentList = commentList || this.$el.find('#attachment-list');\n\t\t\tvar commentEl = this.createCommentElement(commentModel);\n\t\t\tcommentList.prepend(commentEl);\n\t\t},\n\t\taddImportantCmt: function addImportantCmt(commentModel, commentList) {\n\t\t\tcommentList = commentList || this.$el.find('#importantCmt-list');\n\t\t\tvar commentEl = this.createCommentElement(commentModel);\n\t\t\tcommentList.prepend(commentEl);\n\t\t},\n\t\tremoveComment: function removeComment(commentId) {\n\t\t\tvar self = this;\n\t\t\tvar commentModel = this.commentsById[commentId];\n\n\t\t\tvar childComments = this.getChildComments(commentModel.id);\n\t\t\t$(childComments).each(function (index, childComment) {\n\t\t\t\tself.removeComment(childComment.id);\n\t\t\t});\n\n\t\t\tif (commentModel.parent) {\n\t\t\t\tvar outermostParent = this.getOutermostParent(commentModel.parent);\n\t\t\t\tvar indexToRemove = outermostParent.childs.indexOf(commentModel.id);\n\t\t\t\toutermostParent.childs.splice(indexToRemove, 1);\n\t\t\t}\n\n\t\t\tdelete this.commentsById[commentId];\n\t\t\tvar commentElements = this.$el.find('li.comment[data-id=\"' + commentId + '\"]');\n\t\t\tvar parentEl = commentElements.parents('li.comment').last();\n\n\t\t\tcommentElements.remove();\n\n\t\t\tthis.updateToggleAllButton(parentEl);\n\t\t},\n\n\t\tuploadAttachments: function uploadAttachments(files, commentingField) {\n\t\t\tvar self = this;\n\t\t\tif (!commentingField) commentingField = this.$el.find('.commenting-field.main');\n\t\t\tvar isReply = !commentingField.hasClass('main');\n\t\t\tvar fileCount = files.length;\n\n\t\t\tif (fileCount) {\n\t\t\t\tvar uploadButton = commentingField.find('.upload');\n\t\t\t\tvar textarea = commentingField.find('.textarea');\n\n\t\t\t\tuploadButton.removeClass('enabled');\n\t\t\t\tvar attachmentListSpinner = this.createSpinner();\n\t\t\t\tvar commentListSpinner = this.createSpinner();\n\t\t\t\tthis.$el.find('ul#attachment-list').prepend(attachmentListSpinner);\n\t\t\t\tif (isReply) {\n\t\t\t\t\tcommentingField.before(commentListSpinner);\n\t\t\t\t} else {\n\t\t\t\t\tthis.$el.find('ul#comment-list').prepend(commentListSpinner);\n\t\t\t\t}\n\n\t\t\t\tvar success = function success(commentArray) {\n\t\t\t\t\t$(commentArray).each(function (index, commentJSON) {\n\t\t\t\t\t\tvar commentModel = self.createCommentModel(commentJSON);\n\t\t\t\t\t\tself.addCommentToDataModel(commentModel);\n\t\t\t\t\t\tself.addComment(commentModel);\n\t\t\t\t\t\tself.addAttachment(commentModel);\n\t\t\t\t\t});\n\n\t\t\t\t\tif (commentArray.length == fileCount && self.getTextareaContent(textarea).length == 0) {\n\t\t\t\t\t\tcommentingField.find('.close').trigger('click');\n\t\t\t\t\t}\n\n\t\t\t\t\tuploadButton.addClass('enabled');\n\t\t\t\t\tcommentListSpinner.remove();\n\t\t\t\t\tattachmentListSpinner.remove();\n\t\t\t\t};\n\n\t\t\t\tvar error = function error() {\n\t\t\t\t\tuploadButton.addClass('enabled');\n\t\t\t\t\tcommentListSpinner.remove();\n\t\t\t\t\tattachmentListSpinner.remove();\n\t\t\t\t};\n\n\t\t\t\tvar commentArray = [];\n\t\t\t\t$(files).each(function (index, file) {\n\t\t\t\t\tvar commentJSON = self.createCommentJSON(textarea);\n\t\t\t\t\tcommentJSON.id += '-' + index;\n\t\t\t\t\tcommentJSON.content = '';\n\t\t\t\t\tcommentJSON.file = file;\n\t\t\t\t\tcommentJSON.fileURL = 'C:/fakepath/' + file.name;\n\t\t\t\t\tcommentJSON.fileMimeType = file.type;\n\n\t\t\t\t\tcommentJSON = self.applyExternalMappings(commentJSON);\n\t\t\t\t\tcommentArray.push(commentJSON);\n\t\t\t\t});\n\n\t\t\t\tself.options.uploadAttachments(commentArray, success, error);\n\t\t\t}\n\n\t\t\tuploadButton.find('input').val('');\n\t\t},\n\n\t\tupdateToggleAllButton: function updateToggleAllButton(parentEl) {\n\t\t\tif (this.options.maxRepliesVisible == null) return;\n\n\t\t\tvar childCommentsEl = parentEl.find('.child-comments');\n\t\t\tvar childComments = childCommentsEl.find('.comment');\n\t\t\tvar toggleAllButton = childCommentsEl.find('li.toggle-all');\n\t\t\tchildComments.removeClass('hidden-reply');\n\n\t\t\tif (this.options.maxRepliesVisible === 0) {\n\t\t\t\tvar hiddenReplies = childComments;\n\t\t\t} else {\n\t\t\t\tvar hiddenReplies = childComments.slice(0, -this.options.maxRepliesVisible);\n\t\t\t}\n\n\t\t\thiddenReplies.addClass('hidden-reply');\n\n\t\t\tif (toggleAllButton.find('span.text').text() == this.options.textFormatter(this.options.hideRepliesText)) {\n\t\t\t\thiddenReplies.addClass('visible');\n\t\t\t}\n\n\t\t\tif (childComments.length > this.options.maxRepliesVisible) {\n\t\t\t\tif (!toggleAllButton.length) {\n\n\t\t\t\t\ttoggleAllButton = $('<li/>', {\n\t\t\t\t\t\t'class': 'toggle-all highlight-font-bold'\n\t\t\t\t\t});\n\t\t\t\t\tvar toggleAllButtonText = $('<span/>', {\n\t\t\t\t\t\t'class': 'text'\n\t\t\t\t\t});\n\t\t\t\t\tvar caret = $('<span/>', {\n\t\t\t\t\t\t'class': 'caret'\n\t\t\t\t\t});\n\n\t\t\t\t\ttoggleAllButton.append(toggleAllButtonText).append(caret);\n\t\t\t\t\tchildCommentsEl.prepend(toggleAllButton);\n\t\t\t\t}\n\n\t\t\t\tthis.setToggleAllButtonText(toggleAllButton, false);\n\t\t\t} else {\n\t\t\t\ttoggleAllButton.remove();\n\t\t\t}\n\t\t},\n\n\t\tsortComments: function sortComments(comments, sortKey) {\n\t\t\tvar self = this;\n\n\t\t\tif (sortKey == 'popularity') {\n\t\t\t\tcomments.sort(function (commentA, commentB) {\n\t\t\t\t\tvar pointsOfA = commentA.childs.length;\n\t\t\t\t\tvar pointsOfB = commentB.childs.length;\n\n\t\t\t\t\tif (self.options.enableUpvoting) {\n\t\t\t\t\t\tpointsOfA += commentA.upvoteCount;\n\t\t\t\t\t\tpointsOfB += commentB.upvoteCount;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (pointsOfB != pointsOfA) {\n\t\t\t\t\t\treturn pointsOfB - pointsOfA;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar createdA = new Date(commentA.created).getTime();\n\t\t\t\t\t\tvar createdB = new Date(commentB.created).getTime();\n\t\t\t\t\t\treturn createdB - createdA;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tcomments.sort(function (commentA, commentB) {\n\t\t\t\t\tvar createdA = new Date(commentA.created).getTime();\n\t\t\t\t\tvar createdB = new Date(commentB.created).getTime();\n\t\t\t\t\tif (sortKey == 'oldest') {\n\t\t\t\t\t\treturn createdA - createdB;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn createdB - createdA;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\tsortUsers: function sortUsers(users) {\n\t\t\tusers.sort(function (a, b) {\n\t\t\t\tvar nameA = a.fullname.toLowerCase().trim();\n\t\t\t\tvar nameB = b.fullname.toLowerCase().trim();\n\t\t\t\tif (nameA < nameB) return -1;\n\t\t\t\tif (nameA > nameB) return 1;\n\t\t\t\treturn 0;\n\t\t\t});\n\t\t},\n\n\t\tsortAndReArrangeComments: function sortAndReArrangeComments(sortKey) {\n\t\t\tvar commentList = this.$el.find('#comment-list');\n\n\t\t\tvar mainLevelComments = this.getComments().filter(function (commentModel) {\n\t\t\t\treturn !commentModel.parent;\n\t\t\t});\n\t\t\tthis.sortComments(mainLevelComments, sortKey);\n\n\t\t\t$(mainLevelComments).each(function (index, commentModel) {\n\t\t\t\tvar commentEl = commentList.find('> li.comment[data-id=' + commentModel.id + ']');\n\t\t\t\tcommentList.append(commentEl);\n\t\t\t});\n\t\t},\n\n\t\tshowActiveSort: function showActiveSort() {\n\t\t\tvar activeElements = this.$el.find('.navigation li[data-sort-key=\"' + this.currentSortKey + '\"]');\n\n\t\t\tthis.$el.find('.navigation li').removeClass('active');\n\t\t\tactiveElements.addClass('active');\n\n\t\t\tvar titleEl = this.$el.find('.navigation .title');\n\t\t\tif (this.currentSortKey != 'attachments') {\n\t\t\t\ttitleEl.addClass('active');\n\t\t\t\ttitleEl.find('header').html(activeElements.first().html());\n\t\t\t} else {\n\t\t\t\tvar defaultDropdownEl = this.$el.find('.navigation ul.dropdown').children().first();\n\t\t\t\ttitleEl.find('header').html(defaultDropdownEl.html());\n\t\t\t}\n\n\t\t\tthis.showActiveContainer();\n\t\t},\n\n\t\tforceResponsive: function forceResponsive() {\n\t\t\tthis.$el.addClass('responsive');\n\t\t},\n\n\t\tcloseDropdowns: function closeDropdowns() {\n\t\t\tthis.$el.find('.dropdown').hide();\n\t\t},\n\n\t\tsaveOnKeydown: function saveOnKeydown(ev) {\n\t\t\tif (ev.keyCode == 13) {\n\t\t\t\tvar metaKey = ev.metaKey || ev.ctrlKey;\n\t\t\t\tif (this.options.postCommentOnEnter || metaKey) {\n\t\t\t\t\tvar el = $(ev.currentTarget);\n\t\t\t\t\tel.siblings('.control-row').find('.save').trigger('click');\n\t\t\t\t\tev.stopPropagation();\n\t\t\t\t\tev.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tsaveEditableContent: function saveEditableContent(ev) {\n\t\t\tvar el = $(ev.currentTarget);\n\t\t\tel.data('before', el.html());\n\t\t},\n\n\t\tcheckEditableContentForChange: function checkEditableContentForChange(ev) {\n\t\t\tvar el = $(ev.currentTarget);\n\t\t\tif (el.data('before') != el.html()) {\n\t\t\t\tel.data('before', el.html());\n\t\t\t\tel.trigger('change');\n\t\t\t}\n\t\t},\n\n\t\tnavigationElementClicked: function navigationElementClicked(ev) {\n\t\t\tvar navigationEl = $(ev.currentTarget);\n\t\t\tvar sortKey = navigationEl.data().sortKey;\n\n\t\t\tif (sortKey != 'attachments') {\n\t\t\t\tthis.sortAndReArrangeComments(sortKey);\n\t\t\t}\n\n\t\t\tthis.currentSortKey = sortKey;\n\t\t\tthis.showActiveSort();\n\t\t},\n\n\t\ttoggleNavigationDropdown: function toggleNavigationDropdown(ev) {\n\t\t\tev.stopPropagation();\n\n\t\t\tvar dropdown = $(ev.currentTarget).find('~ .dropdown');\n\t\t\tdropdown.toggle();\n\t\t},\n\n\t\tshowMainCommentingField: function showMainCommentingField(ev) {\n\t\t\tvar mainTextarea = $(ev.currentTarget);\n\t\t\tmainTextarea.siblings('.control-row').show();\n\t\t\tmainTextarea.parent().find('.close').show();\n\t\t\tmainTextarea.focus();\n\t\t},\n\n\t\thideMainCommentingField: function hideMainCommentingField(ev) {\n\t\t\tvar closeButton = $(ev.currentTarget);\n\t\t\tvar mainTextarea = this.$el.find('.commenting-field.main .textarea');\n\t\t\tvar mainControlRow = this.$el.find('.commenting-field.main .control-row');\n\n\t\t\tthis.clearTextarea(mainTextarea);\n\t\t\tthis.adjustTextareaHeight(mainTextarea, false);\n\n\t\t\tmainControlRow.hide();\n\t\t\tcloseButton.hide();\n\t\t\tmainTextarea.blur();\n\t\t},\n\n\t\tincreaseTextareaHeight: function increaseTextareaHeight(ev) {\n\t\t\tvar textarea = $(ev.currentTarget);\n\t\t\tthis.adjustTextareaHeight(textarea, true);\n\t\t},\n\n\t\ttextareaContentChanged: function textareaContentChanged(ev) {\n\t\t\tvar textarea = $(ev.currentTarget);\n\t\t\tvar saveButton = textarea.siblings('.control-row').find('.save');\n\n\t\t\tif (!textarea.find('.reply-to.tag').length) {\n\t\t\t\tvar commentId = textarea.attr('data-comment');\n\n\t\t\t\tif (commentId) {\n\t\t\t\t\tvar parentComments = textarea.parents('li.comment');\n\t\t\t\t\tif (parentComments.length > 1) {\n\t\t\t\t\t\tvar parentId = parentComments.last().data('id');\n\t\t\t\t\t\ttextarea.attr('data-parent', parentId);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar parentId = textarea.parents('li.comment').last().data('id');\n\t\t\t\t\ttextarea.attr('data-parent', parentId);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar commentingField = textarea.parents('.commenting-field').first();\n\t\t\tif (textarea[0].scrollHeight > textarea.outerHeight()) {\n\t\t\t\tcommentingField.addClass('scrollable');\n\t\t\t} else {\n\t\t\t\tcommentingField.removeClass('scrollable');\n\t\t\t}\n\n\t\t\tvar contentOrParentChangedIfEditing = true;\n\t\t\tvar content = this.getTextareaContent(textarea, true);\n\t\t\tif (commentId = textarea.attr('data-comment')) {\n\t\t\t\tvar contentChanged = content != this.commentsById[commentId].content;\n\t\t\t\tvar parentFromModel;\n\t\t\t\tif (this.commentsById[commentId].parent) {\n\t\t\t\t\tparentFromModel = this.commentsById[commentId].parent.toString();\n\t\t\t\t}\n\t\t\t\tvar parentChanged = textarea.attr('data-parent') != parentFromModel;\n\t\t\t\tcontentOrParentChangedIfEditing = contentChanged || parentChanged;\n\t\t\t}\n\n\t\t\tif (content.length && contentOrParentChangedIfEditing) {\n\t\t\t\tsaveButton.addClass('enabled');\n\t\t\t} else {\n\t\t\t\tsaveButton.removeClass('enabled');\n\t\t\t}\n\t\t},\n\n\t\tremoveCommentingField: function removeCommentingField(ev) {\n\t\t\tvar closeButton = $(ev.currentTarget);\n\n\t\t\tvar textarea = closeButton.siblings('.textarea');\n\t\t\tif (textarea.attr('data-comment')) {\n\t\t\t\tcloseButton.parents('li.comment').first().removeClass('edit');\n\t\t\t}\n\n\t\t\tvar commentingField = closeButton.parents('.commenting-field').first();\n\t\t\tcommentingField.remove();\n\t\t},\n\n\t\tappendNewComments: function appendNewComments() {\n\t\t\tvar self = this;\n\n\t\t\tif ($(self.$el.context).length == 0) {\n\t\t\t\tclearTimeout(myVar);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar commentJSONs = this.getComments();\n\n\t\t\tvar success = function success(commentsNew, commentsEdit) {\n\t\t\t\tfor (var c in commentsNew) {\n\t\t\t\t\tself.createComment(commentsNew[c]);\n\t\t\t\t}\n\n\t\t\t\tfor (var cmt in commentsEdit) {\n\t\t\t\t\tvar commentModel = self.createCommentModel(commentsEdit[cmt]);\n\t\t\t\t\tself.updateCommentModel(commentModel);\n\t\t\t\t\tself.reRenderComment(commentModel.id);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tvar error = function error() {};\n\t\t\tvar myVar = setTimeout(function () {\n\t\t\t\tself.appendNewComments();\n\t\t\t}, 30000);\n\t\t\tthis.options.appendNewComments(commentJSONs, success, error);\n\t\t},\n\n\t\tpostComment: function postComment(ev) {\n\t\t\tvar self = this;\n\t\t\tvar sendButton = $(ev.currentTarget);\n\t\t\tvar commentingField = sendButton.parents('.commenting-field').first();\n\t\t\tvar textarea = commentingField.find('.textarea');\n\n\t\t\tsendButton.removeClass('enabled');\n\n\t\t\tvar commentJSON = this.createCommentJSON(textarea);\n\n\t\t\tcommentJSON = this.applyExternalMappings(commentJSON);\n\n\t\t\tvar success = function success(commentJSON) {\n\t\t\t\tself.currentSortKey = 'newest';\n\t\t\t\tself.showActiveSort();\n\t\t\t\tself.createComment(commentJSON);\n\t\t\t\tcommentingField.find('.close').trigger('click');\n\t\t\t};\n\n\t\t\tvar error = function error() {\n\t\t\t\tsendButton.addClass('enabled');\n\t\t\t};\n\n\t\t\tthis.options.postComment(commentJSON, success, error);\n\t\t},\n\n\t\tcreateComment: function createComment(commentJSON) {\n\t\t\tvar commentModel = this.createCommentModel(commentJSON);\n\t\t\tthis.addCommentToDataModel(commentModel);\n\t\t\tthis.addComment(commentModel);\n\t\t\tif (commentModel.opinion == true) {\n\t\t\t\tthis.addImportantCmt(commentModel);\n\t\t\t}\n\t\t},\n\n\t\tputComment: function putComment(ev) {\n\t\t\tvar self = this;\n\t\t\tvar saveButton = $(ev.currentTarget);\n\t\t\tvar commentingField = saveButton.parents('.commenting-field').first();\n\t\t\tvar textarea = commentingField.find('.textarea');\n\n\t\t\tsaveButton.removeClass('enabled');\n\n\t\t\tvar commentJSON = $.extend({}, this.commentsById[textarea.attr('data-comment')]);\n\t\t\t$.extend(commentJSON, {\n\t\t\t\tparent: textarea.attr('data-parent') || null,\n\t\t\t\tcontent: this.getTextareaContent(textarea),\n\t\t\t\tpings: this.getPings(textarea),\n\t\t\t\tmodified: new Date().getTime()\n\t\t\t});\n\n\t\t\tcommentJSON = this.applyExternalMappings(commentJSON);\n\n\t\t\tvar success = function success(commentJSON) {\n\n\t\t\t\tvar commentModel = self.createCommentModel(commentJSON);\n\n\t\t\t\tdelete commentModel['childs'];\n\t\t\t\tself.updateCommentModel(commentModel);\n\n\t\t\t\tcommentingField.find('.close').trigger('click');\n\n\t\t\t\tself.reRenderComment(commentModel.id);\n\t\t\t};\n\n\t\t\tvar error = function error() {\n\t\t\t\tsaveButton.addClass('enabled');\n\t\t\t};\n\n\t\t\tthis.options.putComment(commentJSON, success, error);\n\t\t},\n\n\t\tdeleteComment: function deleteComment(ev) {\n\t\t\tvar self = this;\n\t\t\tvar deleteButton = $(ev.currentTarget);\n\t\t\tvar commentEl = deleteButton.parents('.comment').first();\n\t\t\tvar commentJSON = $.extend({}, this.commentsById[commentEl.attr('data-id')]);\n\t\t\tvar commentId = commentJSON.id;\n\t\t\tvar parentId = commentJSON.parent;\n\n\t\t\tdeleteButton.removeClass('enabled');\n\n\t\t\tcommentJSON = this.applyExternalMappings(commentJSON);\n\n\t\t\tvar success = function success() {\n\t\t\t\tself.removeComment(commentId);\n\t\t\t\tif (parentId) self.reRenderCommentActionBar(parentId);\n\n\t\t\t\tif (commentJSON.opinion == true) {\n\t\t\t\t\t$('[data-sort-key=' + self.currentSortKey + ']').trigger('click');\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tvar error = function error() {\n\t\t\t\tdeleteButton.addClass('enabled');\n\t\t\t};\n\n\t\t\tthis.options.deleteComment(commentJSON, success, error);\n\t\t},\n\n\t\thashtagClicked: function hashtagClicked(ev) {\n\t\t\tvar el = $(ev.currentTarget);\n\t\t\tvar value = el.attr('data-value');\n\t\t\tthis.options.hashtagClicked(value);\n\t\t},\n\n\t\tpingClicked: function pingClicked(ev) {\n\t\t\tvar el = $(ev.currentTarget);\n\t\t\tvar value = el.attr('data-value');\n\t\t\tthis.options.pingClicked(value);\n\t\t},\n\n\t\tfileInputChanged: function fileInputChanged(ev, files) {\n\t\t\tvar files = ev.currentTarget.files;\n\t\t\tvar commentingField = $(ev.currentTarget).parents('.commenting-field').first();\n\t\t\tthis.uploadAttachments(files, commentingField);\n\t\t},\n\n\t\tupvoteComment: function upvoteComment(ev) {\n\t\t\tvar self = this;\n\t\t\tvar commentEl = $(ev.currentTarget).parents('li.comment').first();\n\t\t\tvar commentModel = commentEl.data().model;\n\n\t\t\tvar previousUpvoteCount = commentModel.upvoteCount;\n\t\t\tvar newUpvoteCount;\n\t\t\tif (commentModel.userHasUpvoted) {\n\t\t\t\tnewUpvoteCount = previousUpvoteCount - 1;\n\t\t\t} else {\n\t\t\t\tnewUpvoteCount = previousUpvoteCount + 1;\n\t\t\t}\n\n\t\t\tcommentModel.userHasUpvoted = !commentModel.userHasUpvoted;\n\t\t\tcommentModel.upvoteCount = newUpvoteCount;\n\t\t\tthis.reRenderUpvotes(commentModel.id);\n\n\t\t\tvar commentJSON = $.extend({}, commentModel);\n\t\t\tcommentJSON = this.applyExternalMappings(commentJSON);\n\n\t\t\tvar success = function success(commentJSON) {\n\t\t\t\tvar commentModel = self.createCommentModel(commentJSON);\n\t\t\t\tself.updateCommentModel(commentModel);\n\t\t\t\tself.reRenderUpvotes(commentModel.id);\n\t\t\t};\n\n\t\t\tvar error = function error() {\n\t\t\t\tcommentModel.userHasUpvoted = !commentModel.userHasUpvoted;\n\t\t\t\tcommentModel.upvoteCount = previousUpvoteCount;\n\t\t\t\tself.reRenderUpvotes(commentModel.id);\n\t\t\t};\n\n\t\t\tthis.options.upvoteComment(commentJSON, success, error);\n\t\t},\n\n\t\ttoggleReplies: function toggleReplies(ev) {\n\t\t\tvar el = $(ev.currentTarget);\n\t\t\tel.siblings('.hidden-reply').toggleClass('visible');\n\t\t\tthis.setToggleAllButtonText(el, true);\n\t\t},\n\n\t\treplyButtonClicked: function replyButtonClicked(ev) {\n\t\t\tvar replyButton = $(ev.currentTarget);\n\t\t\tvar outermostParent = replyButton.parents('li.comment').last();\n\t\t\tvar parentId = replyButton.parents('.comment').first().data().id;\n\n\t\t\tvar replyField = outermostParent.find('.child-comments > .commenting-field');\n\t\t\tif (replyField.length) replyField.remove();\n\t\t\tvar previousParentId = replyField.find('.textarea').attr('data-parent');\n\n\t\t\tif (previousParentId != parentId) {\n\t\t\t\treplyField = this.createCommentingFieldElement(parentId, null, false);\n\t\t\t\toutermostParent.find('.child-comments').append(replyField);\n\n\t\t\t\tvar textarea = replyField.find('.textarea');\n\t\t\t\tthis.moveCursorToEnd(textarea);\n\n\t\t\t\tvar scrollTop = this.options.scrollContainer.scrollTop();\n\t\t\t\tvar endOfReply = scrollTop + replyField.position().top + replyField.outerHeight();\n\t\t\t\tvar endOfScrollable = scrollTop + this.options.scrollContainer.outerHeight();\n\t\t\t\tif (endOfReply > endOfScrollable) {\n\t\t\t\t\tvar newScrollTop = scrollTop + (endOfReply - endOfScrollable);\n\t\t\t\t\tthis.options.scrollContainer.scrollTop(newScrollTop);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\teditButtonClicked: function editButtonClicked(ev) {\n\t\t\tvar editButton = $(ev.currentTarget);\n\t\t\tvar commentEl = editButton.parents('li.comment').first();\n\t\t\tvar commentModel = commentEl.data().model;\n\n\t\t\tcommentModel = this.commentsById[commentModel.id];\n\t\t\tcommentEl.addClass('edit');\n\n\t\t\tvar editField = this.createCommentingFieldElement(commentModel.parent, commentModel.id, false);\n\t\t\tcommentEl.find('.comment-wrapper').first().append(editField);\n\n\t\t\tvar textarea = editField.find('.textarea');\n\t\t\ttextarea.attr('data-comment', commentModel.id);\n\n\t\t\ttextarea.append(this.getFormattedCommentContent(commentModel, true));\n\n\t\t\tthis.moveCursorToEnd(textarea);\n\t\t},\n\n\t\tshowDroppableOverlay: function showDroppableOverlay(ev) {\n\t\t\tif (this.options.enableAttachments) {\n\t\t\t\tthis.$el.find('.droppable-overlay').css('top', this.$el[0].scrollTop);\n\t\t\t\tthis.$el.find('.droppable-overlay').show();\n\t\t\t\tthis.$el.addClass('drag-ongoing');\n\t\t\t}\n\t\t},\n\n\t\thandleDragEnter: function handleDragEnter(ev) {\n\t\t\tvar count = $(ev.currentTarget).data('dnd-count') || 0;\n\t\t\tcount++;\n\t\t\t$(ev.currentTarget).data('dnd-count', count);\n\t\t\t$(ev.currentTarget).addClass('drag-over');\n\t\t},\n\n\t\thandleDragLeave: function handleDragLeave(ev, callback) {\n\t\t\tvar count = $(ev.currentTarget).data('dnd-count');\n\t\t\tcount--;\n\t\t\t$(ev.currentTarget).data('dnd-count', count);\n\n\t\t\tif (count == 0) {\n\t\t\t\t$(ev.currentTarget).removeClass('drag-over');\n\t\t\t\tif (callback) callback();\n\t\t\t}\n\t\t},\n\n\t\thandleDragLeaveForOverlay: function handleDragLeaveForOverlay(ev) {\n\t\t\tvar self = this;\n\t\t\tthis.handleDragLeave(ev, function () {\n\t\t\t\tself.hideDroppableOverlay();\n\t\t\t});\n\t\t},\n\n\t\thandleDragLeaveForDroppable: function handleDragLeaveForDroppable(ev) {\n\t\t\tthis.handleDragLeave(ev);\n\t\t},\n\n\t\thandleDragOverForOverlay: function handleDragOverForOverlay(ev) {\n\t\t\tev.stopPropagation();\n\t\t\tev.preventDefault();\n\t\t\tev.originalEvent.dataTransfer.dropEffect = 'copy';\n\t\t},\n\n\t\thideDroppableOverlay: function hideDroppableOverlay() {\n\t\t\tthis.$el.find('.droppable-overlay').hide();\n\t\t\tthis.$el.removeClass('drag-ongoing');\n\t\t},\n\n\t\thandleDrop: function handleDrop(ev) {\n\t\t\tev.preventDefault();\n\n\t\t\t$(ev.target).trigger('dragleave');\n\n\t\t\tthis.hideDroppableOverlay();\n\t\t\tthis.uploadAttachments(ev.originalEvent.dataTransfer.files);\n\t\t},\n\n\t\tstopPropagation: function stopPropagation(ev) {\n\t\t\tev.stopPropagation();\n\t\t},\n\n\t\tcreateHTML: function createHTML() {\n\t\t\tvar self = this;\n\n\t\t\tvar mainCommentingField = this.createCommentingFieldElement(null, null, true);\n\t\t\tmainCommentingField.addClass('main');\n\t\t\tthis.$el.append(mainCommentingField);\n\n\t\t\tvar mainControlRow = mainCommentingField.find('.control-row');\n\t\t\tmainControlRow.hide();\n\t\t\tmainCommentingField.find('.close').hide();\n\n\t\t\tif (this.options.enableNavigation) {\n\t\t\t\tthis.$el.append(this.createNavigationElement());\n\t\t\t\tthis.showActiveSort();\n\t\t\t}\n\n\t\t\tvar spinner = this.createSpinner();\n\t\t\tthis.$el.append(spinner);\n\n\t\t\tvar commentsContainer = $('<div/>', {\n\t\t\t\t'class': 'data-container overflowComment',\n\t\t\t\t'data-container': 'comments'\n\t\t\t});\n\t\t\tthis.$el.append(commentsContainer);\n\n\t\t\tvar noComments = $('<div/>', {\n\t\t\t\t'class': 'no-comments no-data',\n\t\t\t\ttext: this.options.textFormatter(this.options.noCommentsText)\n\t\t\t});\n\t\t\tvar noCommentsIcon = $('<i/>', {\n\t\t\t\t'class': 'fa fa-comments fa-2x'\n\t\t\t});\n\t\t\tif (this.options.noCommentsIconURL.length) {\n\t\t\t\tnoCommentsIcon.css('background-image', 'url(\"' + this.options.noCommentsIconURL + '\")');\n\t\t\t\tnoCommentsIcon.addClass('image');\n\t\t\t}\n\t\t\tnoComments.prepend($('<br/>')).prepend(noCommentsIcon);\n\t\t\tcommentsContainer.append(noComments);\n\n\t\t\tvar importantCmtContainer = $('<div/>', {\n\t\t\t\t'class': 'data-container overflowComment',\n\t\t\t\t'data-container': 'importantCmt'\n\t\t\t});\n\t\t\tthis.$el.append(importantCmtContainer);\n\n\t\t\tvar noCommentsImpt = $('<div/>', {\n\t\t\t\t'class': 'no-comments no-data',\n\t\t\t\ttext: this.options.textFormatter(this.options.noCommentsImportantText)\n\t\t\t});\n\t\t\tvar noCommentsImptIcon = $('<i/>', {\n\t\t\t\t'class': 'fa fa-comments fa-2x'\n\t\t\t});\n\t\t\tif (this.options.noCommentsImptIconURL.length) {\n\t\t\t\tnoCommentsImptIcon.css('background-image', 'url(\"' + this.options.noCommentsImptIconURL + '\")');\n\t\t\t\tnoCommentsImptIcon.addClass('image');\n\t\t\t}\n\t\t\tnoCommentsImpt.prepend($('<br/>')).prepend(noCommentsImptIcon);\n\t\t\timportantCmtContainer.append(noCommentsImpt);\n\n\t\t\tif (this.options.enableAttachments) {\n\t\t\t\tvar attachmentsContainer = $('<div/>', {\n\t\t\t\t\t'class': 'data-container overflowComment',\n\t\t\t\t\t'data-container': 'attachments'\n\t\t\t\t});\n\t\t\t\tthis.$el.append(attachmentsContainer);\n\n\t\t\t\tvar noAttachments = $('<div/>', {\n\t\t\t\t\t'class': 'no-attachments no-data',\n\t\t\t\t\ttext: this.options.textFormatter(this.options.noAttachmentsText)\n\t\t\t\t});\n\t\t\t\tvar noAttachmentsIcon = $('<i/>', {\n\t\t\t\t\t'class': 'fa fa-paperclip fa-2x'\n\t\t\t\t});\n\t\t\t\tif (this.options.attachmentIconURL.length) {\n\t\t\t\t\tnoAttachmentsIcon.css('background-image', 'url(\"' + this.options.attachmentIconURL + '\")');\n\t\t\t\t\tnoAttachmentsIcon.addClass('image');\n\t\t\t\t}\n\t\t\t\tnoAttachments.prepend($('<br/>')).prepend(noAttachmentsIcon);\n\t\t\t\tattachmentsContainer.append(noAttachments);\n\n\t\t\t\tvar droppableOverlay = $('<div/>', {\n\t\t\t\t\t'class': 'droppable-overlay'\n\t\t\t\t});\n\n\t\t\t\tvar droppableContainer = $('<div/>', {\n\t\t\t\t\t'class': 'droppable-container'\n\t\t\t\t});\n\n\t\t\t\tvar droppable = $('<div/>', {\n\t\t\t\t\t'class': 'droppable'\n\t\t\t\t});\n\n\t\t\t\tvar uploadIcon = $('<i/>', {\n\t\t\t\t\t'class': 'fa fa-upload fa-4x'\n\t\t\t\t});\n\t\t\t\tif (this.options.uploadIconURL.length) {\n\t\t\t\t\tuploadIcon.css('background-image', 'url(\"' + this.options.uploadIconURL + '\")');\n\t\t\t\t\tuploadIcon.addClass('image');\n\t\t\t\t}\n\n\t\t\t\tvar dropAttachmentText = $('<div/>', {\n\t\t\t\t\ttext: this.options.textFormatter(this.options.attachmentDropText)\n\t\t\t\t});\n\t\t\t\tdroppable.append(uploadIcon);\n\t\t\t\tdroppable.append(dropAttachmentText);\n\n\t\t\t\tdroppableOverlay.html(droppableContainer.html(droppable)).hide();\n\t\t\t\tthis.$el.append(droppableOverlay);\n\t\t\t}\n\t\t},\n\n\t\tcreateProfilePictureElement: function createProfilePictureElement(src) {\n\t\t\tif (src) {\n\t\t\t\tvar profilePicture = $('<img/>', {\n\t\t\t\t\tsrc: src\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tvar profilePicture = $('<i/>', {\n\t\t\t\t\t'class': 'fa fa-user'\n\t\t\t\t});\n\t\t\t}\n\t\t\tprofilePicture.addClass('profile-picture');\n\t\t\tif (this.options.roundProfilePictures) profilePicture.addClass('round');\n\t\t\treturn profilePicture;\n\t\t},\n\n\t\tcreateCommentingFieldElement: function createCommentingFieldElement(parentId, existingCommentId, enableOpinion) {\n\t\t\tvar self = this;\n\n\t\t\tvar commentingField = $('<div/>', {\n\t\t\t\t'class': 'commenting-field'\n\t\t\t});\n\n\t\t\tif (existingCommentId) {\n\t\t\t\tvar profilePictureURL = this.commentsById[existingCommentId].profilePictureURL;\n\t\t\t} else {\n\t\t\t\tvar profilePictureURL = this.options.profilePictureURL;\n\t\t\t}\n\t\t\tvar profilePicture = this.createProfilePictureElement(profilePictureURL);\n\n\t\t\tvar textareaWrapper = $('<div/>', {\n\t\t\t\t'class': 'textarea-wrapper'\n\t\t\t});\n\n\t\t\tvar controlRow = $('<div/>', {\n\t\t\t\t'class': 'control-row'\n\t\t\t});\n\n\t\t\tvar textarea = $('<div/>', {\n\t\t\t\t'class': 'textarea',\n\t\t\t\t'data-placeholder': this.options.textFormatter(this.options.textareaPlaceholderText),\n\t\t\t\tcontenteditable: true\n\t\t\t});\n\n\t\t\tthis.adjustTextareaHeight(textarea, false);\n\n\t\t\tvar closeButton = $('<span/>', {\n\t\t\t\t'class': 'close'\n\t\t\t}).append($('<span class=\"left\"/>')).append($('<span class=\"right\"/>'));\n\n\t\t\tif (existingCommentId) {\n\t\t\t\tvar saveButtonText = this.options.textFormatter(this.options.saveText);\n\t\t\t\tvar opinionCmtId = existingCommentId;\n\t\t\t} else {\n\t\t\t\tvar saveButtonText = this.options.textFormatter(this.options.sendText);\n\t\t\t\tvar opinionCmtId = '';\n\n\t\t\t\tif (this.options.enableAttachments) {\n\t\t\t\t\tvar uploadButton = $('<span/>', {\n\t\t\t\t\t\t'class': 'enabled upload'\n\t\t\t\t\t});\n\t\t\t\t\tvar uploadIcon = $('<i/>', {\n\t\t\t\t\t\t'class': 'md-icon',\n\t\t\t\t\t\ttext: 'Tải lên'\n\t\t\t\t\t});\n\t\t\t\t\tvar fileInput = $('<input/>', {\n\t\t\t\t\t\ttype: 'file',\n\t\t\t\t\t\t'data-role': 'none' });\n\n\t\t\t\t\tif (!$.browser.mobile) fileInput.attr('multiple', 'multiple');\n\n\t\t\t\t\tif (this.options.uploadIconURL.length) {\n\t\t\t\t\t\tuploadIcon.css('background-image', 'url(\"' + this.options.uploadIconURL + '\")');\n\t\t\t\t\t\tuploadIcon.addClass('image');\n\t\t\t\t\t}\n\t\t\t\t\tuploadButton.append(uploadIcon).append(fileInput);\n\t\t\t\t\tcontrolRow.append(uploadButton);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar saveButtonClass = existingCommentId ? 'update' : 'send';\n\t\t\tvar saveButton = $('<span/>', {\n\t\t\t\t'class': saveButtonClass + ' save highlight-background',\n\t\t\t\ttext: saveButtonText\n\t\t\t});\n\n\n\t\t\tif (enableOpinion) {\n\t\t\t\tvar checkOpinion = $('<input/>', {\n\t\t\t\t\t'class': 'opinion checkOpinion mt-1 mr-1',\n\t\t\t\t\t'id': 'opinion' + opinionCmtId,\n\t\t\t\t\t'name': 'opinion' + opinionCmtId,\n\t\t\t\t\t'type': 'checkbox'\n\t\t\t\t});\n\t\t\t\tvar labelCheckOpinion = $('<label/>', {\n\t\t\t\t\t'class': 'opinion label-opinion',\n\t\t\t\t\t'for': 'opinion' + opinionCmtId,\n\t\t\t\t\ttext: 'Ý kiến chính thức'\n\t\t\t\t});\n\t\t\t\tcontrolRow.append(checkOpinion).append(labelCheckOpinion);\n\t\t\t}\n\n\t\t\tcontrolRow.prepend(saveButton);\n\t\t\ttextareaWrapper.append(closeButton).append(textarea).append(controlRow);\n\t\t\tcommentingField.append(profilePicture).append(textareaWrapper);\n\n\t\t\tif (parentId) {\n\t\t\t\ttextarea.attr('data-parent', parentId);\n\n\t\t\t\tvar parentModel = this.commentsById[parentId];\n\t\t\t\tif (parentModel.parent) {\n\t\t\t\t\ttextarea.html('&nbsp;');\n\t\t\t\t\tvar replyToName = '@' + parentModel.fullname;\n\t\t\t\t\tvar replyToTag = this.createTagElement(replyToName, 'reply-to', parentModel.creator);\n\t\t\t\t\ttextarea.prepend(replyToTag);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (this.options.enablePinging) {\n\t\t\t\ttextarea.textcomplete([{\n\t\t\t\t\tmatch: /(^|\\s)@(([0-9]|[^\\u0000-\\u007F]|[a-zäöüß]|\\s)*)$/im,\n\t\t\t\t\tsearch: function search(term, callback) {\n\t\t\t\t\t\tterm = self.normalizeSpaces(term);\n\n\t\t\t\t\t\tvar pings = self.getPings(textarea);\n\t\t\t\t\t\tvar users = self.getUsers().filter(function (user) {\n\t\t\t\t\t\t\tvar isSelf = user.id == self.options.currentUserId;\n\t\t\t\t\t\t\tvar alreadyPinged = pings.indexOf(user.id) != -1;\n\t\t\t\t\t\t\treturn !isSelf && !alreadyPinged;\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tself.sortUsers(users);\n\n\t\t\t\t\t\tcallback($.map(users, function (user) {\n\t\t\t\t\t\t\tvar lowercaseTerm = term.toLowerCase();\n\t\t\t\t\t\t\tvar nameMatch = user.fullname.toLowerCase().indexOf(lowercaseTerm) != -1;\n\t\t\t\t\t\t\tvar emailMatch = user.email.toLowerCase().indexOf(lowercaseTerm) != -1;\n\t\t\t\t\t\t\treturn nameMatch || emailMatch ? user : null;\n\t\t\t\t\t\t}));\n\t\t\t\t\t},\n\t\t\t\t\ttemplate: function template(user) {\n\t\t\t\t\t\tvar wrapper = $('<div/>');\n\n\t\t\t\t\t\tvar profilePictureEl = $('<img/>', {\n\t\t\t\t\t\t\tsrc: user.pictureUrl,\n\t\t\t\t\t\t\t'class': 'profile-picture round'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tvar detailsEl = $('<div/>', {\n\t\t\t\t\t\t\t'class': 'details'\n\t\t\t\t\t\t});\n\t\t\t\t\t\tvar nameEl = $('<div/>', {\n\t\t\t\t\t\t\t'class': 'name'\n\t\t\t\t\t\t}).html(user.fullname);\n\n\t\t\t\t\t\tvar emailEl = $('<div/>', {\n\t\t\t\t\t\t\t'class': 'email'\n\t\t\t\t\t\t}).html(user.email);\n\n\t\t\t\t\t\tif (user.email) {\n\t\t\t\t\t\t\tdetailsEl.append(nameEl).append(emailEl);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdetailsEl.addClass('no-email');\n\t\t\t\t\t\t\tdetailsEl.append(nameEl);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\twrapper.append(profilePictureEl).append(detailsEl);\n\t\t\t\t\t\treturn wrapper.html();\n\t\t\t\t\t},\n\t\t\t\t\treplace: function replace(user) {\n\t\t\t\t\t\tvar tag = self.createTagElement('@' + user.fullname, 'ping', user.id);\n\t\t\t\t\t\treturn ' ' + tag[0].outerHTML + ' ';\n\t\t\t\t\t}\n\t\t\t\t}], {\n\t\t\t\t\tappendTo: '.jquery-comments',\n\t\t\t\t\tdropdownClassName: 'dropdown autocomplete',\n\t\t\t\t\tmaxCount: 5,\n\t\t\t\t\trightEdgeOffset: 0\n\t\t\t\t});\n\n\t\t\t\t$.fn.textcomplete.Dropdown.prototype.render = function (zippedData) {\n\t\t\t\t\tvar contentsHtml = this._buildContents(zippedData);\n\t\t\t\t\tvar unzippedData = $.map(zippedData, function (d) {\n\t\t\t\t\t\treturn d.value;\n\t\t\t\t\t});\n\t\t\t\t\tif (zippedData.length) {\n\t\t\t\t\t\tvar strategy = zippedData[0].strategy;\n\t\t\t\t\t\tif (strategy.id) {\n\t\t\t\t\t\t\tthis.$el.attr('data-strategy', strategy.id);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.$el.removeAttr('data-strategy');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._renderHeader(unzippedData);\n\t\t\t\t\t\tthis._renderFooter(unzippedData);\n\t\t\t\t\t\tif (contentsHtml) {\n\t\t\t\t\t\t\tthis._renderContents(contentsHtml);\n\t\t\t\t\t\t\tthis._fitToBottom();\n\t\t\t\t\t\t\tthis._fitToRight();\n\t\t\t\t\t\t\tthis._activateIndexedItem();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._setScroll();\n\t\t\t\t\t} else if (this.noResultsMessage) {\n\t\t\t\t\t\tthis._renderNoResultsMessage(unzippedData);\n\t\t\t\t\t} else if (this.shown) {\n\t\t\t\t\t\tthis.deactivate();\n\t\t\t\t\t}\n\n\t\t\t\t\tvar top = parseInt(this.$el.css('top')) + self.options.scrollContainer.scrollTop();\n\t\t\t\t\tthis.$el.css('top', top);\n\n\t\t\t\t\tvar originalLeft = this.$el.css('left');\n\t\t\t\t\tthis.$el.css('left', 0);\n\t\t\t\t\tvar maxLeft = self.$el.width() - this.$el.outerWidth();\n\t\t\t\t\tvar left = Math.min(maxLeft, parseInt(originalLeft));\n\t\t\t\t\tthis.$el.css('left', left);\n\t\t\t\t};\n\t\t\t}\n\n\t\t\treturn commentingField;\n\t\t},\n\n\t\tcreateNavigationElement: function createNavigationElement() {\n\t\t\tvar navigationEl = $('<ul/>', {\n\t\t\t\t'class': 'navigation'\n\t\t\t});\n\t\t\tvar navigationWrapper = $('<div/>', {\n\t\t\t\t'class': 'navigation-wrapper'\n\t\t\t});\n\t\t\tnavigationEl.append(navigationWrapper);\n\n\t\t\tvar newest = $('<li/>', {\n\t\t\t\ttext: this.options.textFormatter(this.options.newestText),\n\t\t\t\t'data-sort-key': 'newest',\n\t\t\t\t'data-container-name': 'comments'\n\t\t\t});\n\n\t\t\tvar oldest = $('<li/>', {\n\t\t\t\ttext: this.options.textFormatter(this.options.oldestText),\n\t\t\t\t'data-sort-key': 'oldest',\n\t\t\t\t'data-container-name': 'comments'\n\t\t\t});\n\n\t\t\tvar important = $('<li/>', {\n\t\t\t\ttext: this.options.textFormatter(this.options.importantCmtText),\n\t\t\t\t'data-sort-key': 'important',\n\t\t\t\t'data-container-name': 'importantCmt'\n\t\t\t});\n\n\t\t\tvar popular = $('<li/>', {\n\t\t\t\ttext: this.options.textFormatter(this.options.popularText),\n\t\t\t\t'data-sort-key': 'popularity',\n\t\t\t\t'data-container-name': 'comments'\n\t\t\t});\n\n\t\t\tvar attachments = $('<li/>', {\n\t\t\t\ttext: this.options.textFormatter(this.options.attachmentsText),\n\t\t\t\t'data-sort-key': 'attachments',\n\t\t\t\t'data-container-name': 'attachments'\n\t\t\t});\n\n\t\t\tvar attachmentsIcon = $('<i/>', {\n\t\t\t\t'class': 'fa fa-paperclip'\n\t\t\t});\n\t\t\tif (this.options.attachmentIconURL.length) {\n\t\t\t\tattachmentsIcon.css('background-image', 'url(\"' + this.options.attachmentIconURL + '\")');\n\t\t\t\tattachmentsIcon.addClass('image');\n\t\t\t}\n\t\t\tattachments.prepend(attachmentsIcon);\n\n\t\t\tvar dropdownNavigationWrapper = $('<div/>', {\n\t\t\t\t'class': 'navigation-wrapper responsive'\n\t\t\t});\n\t\t\tvar dropdownNavigation = $('<ul/>', {\n\t\t\t\t'class': 'dropdown'\n\t\t\t});\n\t\t\tvar dropdownTitle = $('<li/>', {\n\t\t\t\t'class': 'title'\n\t\t\t});\n\t\t\tvar dropdownTitleHeader = $('<header/>');\n\n\t\t\tdropdownTitle.append(dropdownTitleHeader);\n\t\t\tdropdownNavigationWrapper.append(dropdownTitle);\n\t\t\tdropdownNavigationWrapper.append(dropdownNavigation);\n\t\t\tnavigationEl.append(dropdownNavigationWrapper);\n\n\t\t\tnavigationWrapper.append(newest).append(oldest).append(important);\n\t\t\tdropdownNavigation.append(newest.clone()).append(oldest.clone()).append(important.clone());\n\n\t\t\tif (this.options.enableReplying || this.options.enableUpvoting) {\n\t\t\t\tnavigationWrapper.append(popular);\n\t\t\t\tdropdownNavigation.append(popular.clone());\n\t\t\t}\n\t\t\tif (this.options.enableAttachments) {\n\t\t\t\tnavigationWrapper.append(attachments);\n\t\t\t\tdropdownNavigationWrapper.append(attachments.clone());\n\t\t\t}\n\n\t\t\tif (this.options.forceResponsive) this.forceResponsive();\n\t\t\treturn navigationEl;\n\t\t},\n\n\t\tcreateSpinner: function createSpinner() {\n\t\t\tvar spinner = $('<div/>', {\n\t\t\t\t'class': 'spinner'\n\t\t\t});\n\t\t\tvar spinnerIcon = $('<i/>', {\n\t\t\t\t'class': 'fa fa-spinner fa-spin'\n\t\t\t});\n\t\t\tif (this.options.spinnerIconURL.length) {\n\t\t\t\tspinnerIcon.css('background-image', 'url(\"' + this.options.spinnerIconURL + '\")');\n\t\t\t\tspinnerIcon.addClass('image');\n\t\t\t}\n\t\t\tspinner.html(spinnerIcon);\n\t\t\treturn spinner;\n\t\t},\n\n\t\tcreateCommentElement: function createCommentElement(commentModel) {\n\t\t\tvar commentEl = $('<li/>', {\n\t\t\t\t'data-id': commentModel.id,\n\t\t\t\t'class': 'comment'\n\t\t\t}).data('model', commentModel);\n\n\t\t\tif (commentModel.createdByCurrentUser) commentEl.addClass('by-current-user');\n\t\t\tif (commentModel.createdByAdmin) commentEl.addClass('by-admin');\n\n\t\t\tvar childComments = $('<ul/>', {\n\t\t\t\t'class': 'child-comments'\n\t\t\t});\n\n\t\t\tvar commentWrapper = this.createCommentWrapperElement(commentModel);\n\n\t\t\tcommentEl.append(commentWrapper);\n\t\t\tif (commentModel.parent == null) commentEl.append(childComments);\n\t\t\treturn commentEl;\n\t\t},\n\n\t\tcreateCommentWrapperElement: function createCommentWrapperElement(commentModel) {\n\t\t\tvar commentWrapper = $('<div/>', {\n\t\t\t\t'class': 'comment-wrapper'\n\t\t\t});\n\n\t\t\tvar profilePicture = this.createProfilePictureElement(commentModel.profilePictureURL);\n\n\t\t\tvar time = $('<time/>', {\n\t\t\t\ttext: this.options.timeFormatter(commentModel.created),\n\t\t\t\t'data-original': commentModel.created\n\t\t\t});\n\n\t\t\tvar nameText = commentModel.createdByCurrentUser ? this.options.textFormatter(this.options.youText) : commentModel.fullname;\n\t\t\tvar name = $('<div/>', {\n\t\t\t\t'class': 'name'\n\t\t\t});\n\t\t\tif (commentModel.profileURL) {\n\t\t\t\tvar link = $('<a/>', {\n\t\t\t\t\thref: commentModel.profileURL,\n\t\t\t\t\ttext: nameText\n\t\t\t\t});\n\t\t\t\tname.html(link);\n\t\t\t} else {\n\t\t\t\tname.text(nameText);\n\t\t\t}\n\n\t\t\tif (commentModel.createdByCurrentUser || commentModel.createdByAdmin) name.addClass('highlight-font-bold');\n\n\t\t\tif (commentModel.parent) {\n\t\t\t\tvar parent = this.commentsById[commentModel.parent];\n\t\t\t\tif (parent.parent) {\n\t\t\t\t\tvar replyTo = $('<span/>', {\n\t\t\t\t\t\t'class': 'reply-to',\n\t\t\t\t\t\ttext: parent.fullname\n\t\t\t\t\t});\n\n\t\t\t\t\tvar replyIcon = $('<i/>', {\n\t\t\t\t\t\t'class': 'fa fa-share'\n\t\t\t\t\t});\n\t\t\t\t\tif (this.options.replyIconURL.length) {\n\t\t\t\t\t\treplyIcon.css('background-image', 'url(\"' + this.options.replyIconURL + '\")');\n\t\t\t\t\t\treplyIcon.addClass('image');\n\t\t\t\t\t}\n\n\t\t\t\t\treplyTo.prepend(replyIcon);\n\t\t\t\t\tname.append(replyTo);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (commentModel.isNew) {\n\t\t\t\tvar newTag = $('<span/>', {\n\t\t\t\t\t'class': 'new highlight-background',\n\t\t\t\t\ttext: this.options.newText\n\t\t\t\t});\n\t\t\t\tname.append(newTag);\n\t\t\t}\n\n\t\t\tvar wrapper = $('<div/>', {\n\t\t\t\t'class': 'wrapper'\n\t\t\t});\n\n\t\t\tvar noteOpinion = $('<div/>', {\n\t\t\t\t'class': 'note-opinion',\n\t\t\t\ttext: '(Ý kiến chính thức)'\n\t\t\t});\n\n\t\t\tvar content = $('<div/>', {\n\t\t\t\t'class': 'content'\n\t\t\t});\n\n\t\t\tvar isAttachment = commentModel.fileURL != undefined;\n\t\t\tif (isAttachment) {\n\t\t\t\tvar format = null;\n\t\t\t\tvar type = null;\n\n\t\t\t\tif (commentModel.fileMimeType) {\n\t\t\t\t\tvar mimeTypeParts = commentModel.fileMimeType.split('/');\n\t\t\t\t\tif (mimeTypeParts.length == 2) {\n\t\t\t\t\t\tformat = mimeTypeParts[1];\n\t\t\t\t\t\ttype = mimeTypeParts[0];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tvar link = $('<a/>', {\n\t\t\t\t\t'class': 'attachment',\n\t\t\t\t\thref: commentModel.fileURL,\n\t\t\t\t\ttarget: '_blank'\n\t\t\t\t});\n\n\t\t\t\tif (type == 'image') {\n\t\t\t\t\tvar image = $('<img/>', {\n\t\t\t\t\t\tsrc: commentModel.fileURL\n\t\t\t\t\t});\n\t\t\t\t\tlink.html(image);\n\t\t\t\t} else if (type == 'video') {\n\t\t\t\t\tvar video = $('<video/>', {\n\t\t\t\t\t\tsrc: commentModel.fileURL,\n\t\t\t\t\t\ttype: commentModel.fileMimeType,\n\t\t\t\t\t\tcontrols: 'controls'\n\t\t\t\t\t});\n\t\t\t\t\tlink.html(video);\n\t\t\t\t} else {\n\t\t\t\t\tvar availableIcons = ['archive', 'audio', 'code', 'excel', 'image', 'movie', 'pdf', 'photo', 'picture', 'powerpoint', 'sound', 'video', 'word', 'zip'];\n\n\t\t\t\t\tvar iconClass = 'fa fa-file-o';\n\t\t\t\t\tif (availableIcons.indexOf(format) > 0) {\n\t\t\t\t\t\ticonClass = 'fa fa-file-' + format + '-o';\n\t\t\t\t\t} else if (availableIcons.indexOf(type) > 0) {\n\t\t\t\t\t\ticonClass = 'fa fa-file-' + type + '-o';\n\t\t\t\t\t}\n\n\t\t\t\t\tvar fileIcon = $('<i/>', {\n\t\t\t\t\t\t'class': iconClass\n\t\t\t\t\t});\n\t\t\t\t\tif (this.options.fileIconURL.length) {\n\t\t\t\t\t\tfileIcon.css('background-image', 'url(\"' + this.options.fileIconURL + '\")');\n\t\t\t\t\t\tfileIcon.addClass('image');\n\t\t\t\t\t}\n\n\t\t\t\t\tvar fileName = commentModel.fileName;\n\t\t\t\t\tlink.text(fileName);\n\t\t\t\t\tlink.prepend(fileIcon);\n\t\t\t\t}\n\t\t\t\tcontent.html(link);\n\t\t\t} else {\n\t\t\t\tcontent.html(this.getFormattedCommentContent(commentModel));\n\t\t\t}\n\n\t\t\tif (commentModel.modified && commentModel.modified != commentModel.created) {\n\t\t\t\tvar editedTime = this.options.timeFormatter(commentModel.modified);\n\t\t\t\tvar edited = $('<time/>', {\n\t\t\t\t\t'class': 'edited',\n\t\t\t\t\ttext: this.options.textFormatter(this.options.editedText) + ' ' + editedTime,\n\t\t\t\t\t'data-original': commentModel.modified\n\t\t\t\t});\n\t\t\t\tcontent.append(edited);\n\t\t\t}\n\n\t\t\tvar actions = $('<span/>', {\n\t\t\t\t'class': 'actions'\n\t\t\t});\n\n\t\t\tvar reply = $('<button/>', {\n\t\t\t\t'class': 'action reply',\n\t\t\t\t'type': 'button',\n\t\t\t\ttext: this.options.textFormatter(this.options.replyText)\n\t\t\t});\n\n\t\t\tvar upvoteIcon = $('<i/>', {\n\t\t\t\t'class': 'fa fa-thumbs-up'\n\t\t\t});\n\t\t\tif (this.options.upvoteIconURL.length) {\n\t\t\t\tupvoteIcon.css('background-image', 'url(\"' + this.options.upvoteIconURL + '\")');\n\t\t\t\tupvoteIcon.addClass('image');\n\t\t\t}\n\n\t\t\tvar upvotes = this.createUpvoteElement(commentModel);\n\n\t\t\tif (this.options.enableReplying) actions.append(reply);\n\t\t\tif (this.options.enableUpvoting) actions.append(upvotes);\n\n\t\t\tif (commentModel.createdByCurrentUser || this.options.currentUserIsAdmin) {\n\t\t\t\tif (isAttachment && this.isAllowedToDelete(commentModel.id)) {\n\t\t\t\t\tvar deleteButton = $('<button/>', {\n\t\t\t\t\t\t'class': 'action delete enabled',\n\t\t\t\t\t\ttext: this.options.textFormatter(this.options.deleteText)\n\t\t\t\t\t});\n\t\t\t\t\tactions.append(deleteButton);\n\t\t\t\t} else if (!isAttachment && this.options.enableEditing) {\n\t\t\t\t\tvar editButton = $('<button/>', {\n\t\t\t\t\t\t'class': 'action edit',\n\t\t\t\t\t\ttext: this.options.textFormatter(this.options.editText)\n\t\t\t\t\t});\n\t\t\t\t\tactions.append(editButton);\n\t\t\t\t\tvar deleteButton = $('<button/>', {\n\t\t\t\t\t\t'class': 'action delete enabled',\n\t\t\t\t\t\ttext: this.options.textFormatter(this.options.deleteText)\n\t\t\t\t\t});\n\t\t\t\t\tactions.append(deleteButton);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\twrapper.append(content);\n\t\t\tif (commentModel.opinion == true) {\n\t\t\t\twrapper.append(noteOpinion);\n\t\t\t}\n\t\t\twrapper.append(actions);\n\t\t\tcommentWrapper.append(profilePicture).append(time).append(name).append(wrapper);\n\t\t\treturn commentWrapper;\n\t\t},\n\n\t\tcreateUpvoteElement: function createUpvoteElement(commentModel) {\n\t\t\tvar upvoteIcon = $('<i/>', {\n\t\t\t\t'class': 'fa fa-thumbs-up'\n\t\t\t});\n\t\t\tif (this.options.upvoteIconURL.length) {\n\t\t\t\tupvoteIcon.css('background-image', 'url(\"' + this.options.upvoteIconURL + '\")');\n\t\t\t\tupvoteIcon.addClass('image');\n\t\t\t}\n\n\t\t\tvar upvoteEl = $('<button/>', {\n\t\t\t\t'class': 'action upvote' + (commentModel.userHasUpvoted ? ' highlight-font' : '')\n\t\t\t}).append($('<span/>', {\n\t\t\t\ttext: commentModel.upvoteCount,\n\t\t\t\t'class': 'upvote-count'\n\t\t\t})).append(upvoteIcon);\n\n\t\t\treturn upvoteEl;\n\t\t},\n\n\t\tcreateTagElement: function createTagElement(text, extraClasses, value) {\n\t\t\tvar tagEl = $('<input/>', {\n\t\t\t\t'class': 'tag',\n\t\t\t\t'type': 'button',\n\t\t\t\t'data-role': 'none'\n\t\t\t});\n\t\t\tif (extraClasses) tagEl.addClass(extraClasses);\n\t\t\ttagEl.val(text);\n\t\t\ttagEl.attr('data-value', value);\n\t\t\treturn tagEl;\n\t\t},\n\n\t\treRenderComment: function reRenderComment(id) {\n\t\t\tvar commentModel = this.commentsById[id];\n\t\t\tvar commentElements = this.$el.find('li.comment[data-id=\"' + commentModel.id + '\"]');\n\n\t\t\tvar self = this;\n\t\t\tcommentElements.each(function (index, commentEl) {\n\t\t\t\tvar commentWrapper = self.createCommentWrapperElement(commentModel);\n\t\t\t\t$(commentEl).find('.comment-wrapper').first().replaceWith(commentWrapper);\n\t\t\t});\n\t\t},\n\n\t\treRenderCommentActionBar: function reRenderCommentActionBar(id) {\n\t\t\tvar commentModel = this.commentsById[id];\n\t\t\tvar commentElements = this.$el.find('li.comment[data-id=\"' + commentModel.id + '\"]');\n\n\t\t\tvar self = this;\n\t\t\tcommentElements.each(function (index, commentEl) {\n\t\t\t\tvar commentWrapper = self.createCommentWrapperElement(commentModel);\n\t\t\t\t$(commentEl).find('.actions').first().replaceWith(commentWrapper.find('.actions'));\n\t\t\t});\n\t\t},\n\n\t\treRenderUpvotes: function reRenderUpvotes(id) {\n\t\t\tvar commentModel = this.commentsById[id];\n\t\t\tvar commentElements = this.$el.find('li.comment[data-id=\"' + commentModel.id + '\"]');\n\n\t\t\tvar self = this;\n\t\t\tcommentElements.each(function (index, commentEl) {\n\t\t\t\tvar upvotes = self.createUpvoteElement(commentModel);\n\t\t\t\t$(commentEl).find('.upvote').first().replaceWith(upvotes);\n\t\t\t});\n\t\t},\n\n\t\tcreateCssDeclarations: function createCssDeclarations() {\n\t\t\t$('head style.jquery-comments-css').remove();\n\n\t\t\tthis.createCss('.jquery-comments ul.navigation li.active:after {background: ' + this.options.highlightColor + ' !important;', +'}');\n\n\t\t\tthis.createCss('.jquery-comments ul.navigation ul.dropdown li.active {background: ' + this.options.highlightColor + ' !important;', +'}');\n\n\t\t\tthis.createCss('.jquery-comments .highlight-background {background: ' + this.options.highlightColor + ' !important;', +'}');\n\n\t\t\tthis.createCss('.jquery-comments .highlight-font {color: ' + this.options.highlightColor + ' !important;' + '}');\n\t\t\tthis.createCss('.jquery-comments .highlight-font-bold {color: ' + this.options.highlightColor + ' !important;' + 'font-weight: bold;' + '}');\n\t\t},\n\n\t\tcreateCss: function createCss(css) {\n\t\t\tvar styleEl = $('<style/>', {\n\t\t\t\ttype: 'text/css',\n\t\t\t\t'class': 'jquery-comments-css',\n\t\t\t\ttext: css\n\t\t\t});\n\t\t\t$('head').append(styleEl);\n\t\t},\n\n\t\tgetComments: function getComments() {\n\t\t\tvar self = this;\n\t\t\tvar commentArr = __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default()(this.commentsById).map(function (id) {\n\t\t\t\treturn self.commentsById[id];\n\t\t\t});\n\t\t\tvar importantCmtArr = commentArr.filter(function (comment) {\n\t\t\t\treturn comment.opinion;\n\t\t\t});\n\t\t\tvar importantCmtUser = commentArr.filter(function (comment) {\n\t\t\t\treturn comment.opinion && comment.createdByCurrentUser;\n\t\t\t});\n\t\t\tvar attachCmtArr = commentArr.filter(function (comment) {\n\t\t\t\treturn comment.fileURL != undefined;\n\t\t\t});\n\t\t\tif (commentArr.length > 3) {\n\t\t\t\t$('.data-container[data-container=comments]').addClass('lessEl');\n\t\t\t} else {\n\t\t\t\t$('.data-container[data-container=comments]').addClass('fullEl');\n\t\t\t}\n\n\t\t\tif (importantCmtArr.length > 3) {\n\t\t\t\t$('.data-container[data-container=importantCmt]').addClass('lessEl');\n\t\t\t} else {\n\t\t\t\t$('.data-container[data-container=importantCmt]').addClass('fullEl');\n\t\t\t}\n\t\t\tif (importantCmtUser.length > 0) {\n\t\t\t\t$('.opinion').hide();\n\t\t\t} else {\n\t\t\t\t$('.opinion').show();\n\t\t\t}\n\n\t\t\tif (attachCmtArr.length > 3) {\n\t\t\t\t$('.data-container[data-container=attachments]').addClass('lessEl');\n\t\t\t} else {\n\t\t\t\t$('.data-container[data-container=attachments]').addClass('fullEl');\n\t\t\t}\n\n\t\t\treturn __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default()(this.commentsById).map(function (id) {\n\t\t\t\treturn self.commentsById[id];\n\t\t\t});\n\t\t},\n\n\t\tgetUsers: function getUsers() {\n\t\t\tvar self = this;\n\t\t\treturn __WEBPACK_IMPORTED_MODULE_1_babel_runtime_core_js_object_keys___default()(this.usersById).map(function (id) {\n\t\t\t\treturn self.usersById[id];\n\t\t\t});\n\t\t},\n\n\t\tgetChildComments: function getChildComments(parentId) {\n\t\t\treturn this.getComments().filter(function (comment) {\n\t\t\t\treturn comment.parent == parentId;\n\t\t\t});\n\t\t},\n\n\t\tgetAttachments: function getAttachments() {\n\t\t\tvar self = this;\n\t\t\treturn this.getComments().filter(function (comment) {\n\t\t\t\treturn comment.fileURL != undefined;\n\t\t\t});\n\t\t},\n\t\tgetImportantCmt: function getImportantCmt() {\n\t\t\tvar self = this;\n\t\t\treturn this.getComments().filter(function (comment) {\n\t\t\t\treturn comment.opinion == true;\n\t\t\t});\n\t\t},\n\t\tgetOutermostParent: function getOutermostParent(directParentId) {\n\t\t\tvar parentId = directParentId;\n\t\t\tdo {\n\t\t\t\tvar parentComment = this.commentsById[parentId];\n\t\t\t\tparentId = parentComment.parent;\n\t\t\t} while (parentComment.parent != null);\n\t\t\treturn parentComment;\n\t\t},\n\n\t\tcreateCommentJSON: function createCommentJSON(textarea) {\n\t\t\tvar time = new Date().toISOString();\n\t\t\tvar commentJSON = {\n\t\t\t\tid: 'c' + (this.getComments().length + 1),\n\t\t\t\tparent: textarea.attr('data-parent') || null,\n\t\t\t\tcreated: time,\n\t\t\t\tmodified: time,\n\t\t\t\tcontent: this.getTextareaContent(textarea),\n\t\t\t\tpings: this.getPings(textarea),\n\t\t\t\tfullname: this.options.textFormatter(this.options.youText),\n\t\t\t\tprofilePictureURL: this.options.profilePictureURL,\n\t\t\t\tcreatedByCurrentUser: true,\n\t\t\t\tupvoteCount: 0,\n\t\t\t\tuserHasUpvoted: false\n\t\t\t};\n\t\t\treturn commentJSON;\n\t\t},\n\n\t\tisAllowedToDelete: function isAllowedToDelete(commentId) {\n\t\t\tif (this.options.enableDeleting) {\n\t\t\t\tvar isAllowedToDelete = true;\n\t\t\t\tif (!this.options.enableDeletingCommentWithReplies) {\n\t\t\t\t\t$(this.getComments()).each(function (index, comment) {\n\t\t\t\t\t\tif (comment.parent == commentId) isAllowedToDelete = false;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn isAllowedToDelete;\n\t\t\t}\n\t\t\treturn false;\n\t\t},\n\n\t\tsetToggleAllButtonText: function setToggleAllButtonText(toggleAllButton, toggle) {\n\t\t\tvar self = this;\n\t\t\tvar textContainer = toggleAllButton.find('span.text');\n\t\t\tvar caret = toggleAllButton.find('.caret');\n\n\t\t\tvar showExpandingText = function showExpandingText() {\n\t\t\t\tvar text = self.options.textFormatter(self.options.viewAllRepliesText);\n\t\t\t\tvar replyCount = toggleAllButton.siblings('.comment').length;\n\t\t\t\ttext = text.replace('__replyCount__', replyCount);\n\t\t\t\ttextContainer.text(text);\n\t\t\t};\n\n\t\t\tvar hideRepliesText = this.options.textFormatter(this.options.hideRepliesText);\n\n\t\t\tif (toggle) {\n\t\t\t\tif (textContainer.text() == hideRepliesText) {\n\t\t\t\t\tshowExpandingText();\n\t\t\t\t} else {\n\t\t\t\t\ttextContainer.text(hideRepliesText);\n\t\t\t\t}\n\n\t\t\t\tcaret.toggleClass('up');\n\t\t\t} else {\n\t\t\t\tif (textContainer.text() != hideRepliesText) {\n\t\t\t\t\tshowExpandingText();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tadjustTextareaHeight: function adjustTextareaHeight(textarea, focus) {\n\t\t\tvar textareaBaseHeight = 2.2;\n\t\t\tvar lineHeight = 1.45;\n\n\t\t\tvar setRows = function setRows(rows) {\n\t\t\t\tvar height = textareaBaseHeight + (rows - 1) * lineHeight;\n\t\t\t\ttextarea.css('height', height + 'em');\n\t\t\t};\n\n\t\t\ttextarea = $(textarea);\n\t\t\tvar rowCount = focus == true ? this.options.textareaRowsOnFocus : this.options.textareaRows;\n\t\t\tdo {\n\t\t\t\tsetRows(rowCount);\n\t\t\t\trowCount++;\n\t\t\t\tvar isAreaScrollable = textarea[0].scrollHeight > textarea.outerHeight();\n\t\t\t\tvar maxRowsUsed = this.options.textareaMaxRows == false ? false : rowCount > this.options.textareaMaxRows;\n\t\t\t} while (isAreaScrollable && !maxRowsUsed);\n\t\t},\n\n\t\tclearTextarea: function clearTextarea(textarea) {\n\t\t\ttextarea.empty().trigger('input');\n\t\t},\n\n\t\tgetTextareaContent: function getTextareaContent(textarea, humanReadable) {\n\t\t\tvar textareaClone = textarea.clone();\n\n\t\t\ttextareaClone.find('.reply-to.tag').remove();\n\n\t\t\ttextareaClone.find('.tag.hashtag').replaceWith(function () {\n\t\t\t\treturn humanReadable ? $(this).val() : '#' + $(this).attr('data-value');\n\t\t\t});\n\t\t\ttextareaClone.find('.tag.ping').replaceWith(function () {\n\t\t\t\treturn humanReadable ? $(this).val() : '@' + $(this).attr('data-value');\n\t\t\t});\n\n\t\t\tvar ce = $('<pre/>').html(textareaClone.html());\n\t\t\tce.find('div, p, br').replaceWith(function () {\n\t\t\t\treturn '\\n' + this.innerHTML;\n\t\t\t});\n\n\t\t\tvar text = ce.text().replace(/^\\s+/g, '');\n\n\t\t\tvar text = this.normalizeSpaces(text);\n\t\t\treturn text;\n\t\t},\n\n\t\tgetFormattedCommentContent: function getFormattedCommentContent(commentModel, replaceNewLines) {\n\t\t\tvar html = this.escape(commentModel.content);\n\t\t\thtml = this.linkify(html);\n\t\t\thtml = this.highlightTags(commentModel, html);\n\t\t\tif (replaceNewLines) html = html.replace(/(?:\\n)/g, '<br>');\n\t\t\treturn html;\n\t\t},\n\n\t\tgetPings: function getPings(textarea) {\n\t\t\treturn $.map(textarea.find('.ping'), function (el) {\n\t\t\t\treturn parseInt($(el).attr('data-value'));\n\t\t\t});\n\t\t},\n\n\t\tmoveCursorToEnd: function moveCursorToEnd(el) {\n\t\t\tel = $(el)[0];\n\n\t\t\t$(el).trigger('input');\n\n\t\t\t$(el).scrollTop(el.scrollHeight);\n\n\t\t\tif (typeof window.getSelection != 'undefined' && typeof document.createRange != 'undefined') {\n\t\t\t\tvar range = document.createRange();\n\t\t\t\trange.selectNodeContents(el);\n\t\t\t\trange.collapse(false);\n\t\t\t\tvar sel = window.getSelection();\n\t\t\t\tsel.removeAllRanges();\n\t\t\t\tsel.addRange(range);\n\t\t\t} else if (typeof document.body.createTextRange != 'undefined') {\n\t\t\t\tvar textRange = document.body.createTextRange();\n\t\t\t\ttextRange.moveToElementText(el);\n\t\t\t\ttextRange.collapse(false);\n\t\t\t\ttextRange.select();\n\t\t\t}\n\n\t\t\tel.focus();\n\t\t},\n\n\t\tescape: function escape(inputText) {\n\t\t\treturn $('<pre/>').text(this.normalizeSpaces(inputText)).html();\n\t\t},\n\n\t\tnormalizeSpaces: function normalizeSpaces(inputText) {\n\t\t\treturn inputText.replace(new RegExp('\\xA0', 'g'), ' ');\n\t\t},\n\n\t\tafter: function after(times, func) {\n\t\t\tvar self = this;\n\t\t\treturn function () {\n\t\t\t\ttimes--;\n\t\t\t\tif (times == 0) {\n\t\t\t\t\treturn func.apply(self, arguments);\n\t\t\t\t}\n\t\t\t};\n\t\t},\n\n\t\thighlightTags: function highlightTags(commentModel, html) {\n\t\t\tif (this.options.enableHashtags) html = this.highlightHashtags(commentModel, html);\n\t\t\tif (this.options.enablePinging) html = this.highlightPings(commentModel, html);\n\t\t\treturn html;\n\t\t},\n\n\t\thighlightHashtags: function highlightHashtags(commentModel, html) {\n\t\t\tvar self = this;\n\n\t\t\tif (html.indexOf('#') != -1) {\n\t\t\t\tvar __createTag = function __createTag(tag) {\n\t\t\t\t\tvar tag = self.createTagElement('#' + tag, 'hashtag', tag);\n\t\t\t\t\treturn tag[0].outerHTML;\n\t\t\t\t};\n\n\t\t\t\tvar regex = /(^|\\s)#([a-zäöüß\\d-_]+)/gim;\n\t\t\t\thtml = html.replace(regex, function ($0, $1, $2) {\n\t\t\t\t\treturn $1 + __createTag($2);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn html;\n\t\t},\n\n\t\thighlightPings: function highlightPings(commentModel, html) {\n\t\t\tvar self = this;\n\n\t\t\tif (html.indexOf('@') != -1) {\n\n\t\t\t\tvar __createTag = function __createTag(user) {\n\t\t\t\t\tvar tag = self.createTagElement('@' + user.fullname, 'ping', user.id);\n\t\t\t\t\treturn tag[0].outerHTML;\n\t\t\t\t};\n\n\t\t\t\tvar highlightedHtml = '';\n\t\t\t\t$(commentModel.pings).each(function (index, id) {\n\t\t\t\t\tif (id in self.usersById) {\n\t\t\t\t\t\tvar user = self.usersById[id];\n\t\t\t\t\t\tvar pingText = '@' + user.id;\n\n\t\t\t\t\t\tvar endIndex = html.indexOf(pingText) + pingText.length;\n\t\t\t\t\t\tvar current = html.slice(0, endIndex);\n\t\t\t\t\t\thighlightedHtml += current.replace(pingText, __createTag(user));\n\n\t\t\t\t\t\thtml = html.slice(endIndex);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\thighlightedHtml += html;\n\t\t\t\treturn highlightedHtml;\n\t\t\t}\n\t\t\treturn html;\n\t\t},\n\n\t\tlinkify: function linkify(inputText) {\n\t\t\tvar replacedText, replacePattern1, replacePattern2, replacePattern3;\n\n\t\t\treplacePattern1 = /(^|\\s)((https?|ftp|file):\\/\\/[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|])/gim;\n\t\t\treplacedText = inputText.replace(replacePattern1, '$1<a href=\"$2\" target=\"_blank\">$2</a>');\n\n\t\t\treplacePattern2 = /(^|\\s)(www\\.[\\S]+(\\b|$))/gim;\n\t\t\treplacedText = replacedText.replace(replacePattern2, '$1<a href=\"http://$2\" target=\"_blank\">$2</a>');\n\n\t\t\treplacePattern3 = /(^|\\s)(([a-zA-Z0-9\\-\\_\\.]+)@[a-zA-Z\\_]+?(\\.[a-zA-Z]{2,6})+)/gim;\n\t\t\treplacedText = replacedText.replace(replacePattern3, '$1<a href=\"mailto:$2\">$2</a>');\n\n\t\t\tvar count = inputText.match(/<a href/g) || [];\n\n\t\t\tif (count.length > 0) {\n\t\t\t\tvar splitInput = inputText.split(/(<\\/a>)/g);\n\t\t\t\tfor (var i = 0; i < splitInput.length; i++) {\n\t\t\t\t\tif (splitInput[i].match(/<a href/g) == null) {\n\t\t\t\t\t\tsplitInput[i] = splitInput[i].replace(replacePattern1, '<a href=\"$1\" target=\"_blank\">$1</a>').replace(replacePattern2, '$1<a href=\"http://$2\" target=\"_blank\">$2</a>').replace(replacePattern3, '<a href=\"mailto:$1\">$1</a>');\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar combinedReplacedText = splitInput.join('');\n\t\t\t\treturn combinedReplacedText;\n\t\t\t} else {\n\t\t\t\treturn replacedText;\n\t\t\t}\n\t\t},\n\n\t\twaitUntil: function waitUntil(condition, callback) {\n\t\t\tvar self = this;\n\n\t\t\tif (condition()) {\n\t\t\t\tcallback();\n\t\t\t} else {\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tself.waitUntil(condition, callback);\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t},\n\n\t\tapplyInternalMappings: function applyInternalMappings(commentJSON) {\n\t\t\tvar invertedMappings = {};\n\t\t\tvar mappings = this.options.fieldMappings;\n\t\t\tfor (var prop in mappings) {\n\t\t\t\tif (mappings.hasOwnProperty(prop)) {\n\t\t\t\t\tinvertedMappings[mappings[prop]] = prop;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn this.applyMappings(invertedMappings, commentJSON);\n\t\t},\n\n\t\tapplyExternalMappings: function applyExternalMappings(commentJSON) {\n\t\t\tvar mappings = this.options.fieldMappings;\n\t\t\treturn this.applyMappings(mappings, commentJSON);\n\t\t},\n\n\t\tapplyMappings: function applyMappings(mappings, commentJSON) {\n\t\t\tvar result = {};\n\n\t\t\tfor (var key1 in commentJSON) {\n\t\t\t\tif (key1 in mappings) {\n\t\t\t\t\tvar key2 = mappings[key1];\n\t\t\t\t\tresult[key2] = commentJSON[key1];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\n\t};\n\n\t$.fn.comments = function (options) {\n\t\treturn this.each(function () {\n\t\t\tvar comments = __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_create___default()(Comments);\n\t\t\t$.data(this, 'comments', comments);\n\t\t\tcomments.init(options || {}, this);\n\t\t});\n\t};\n});\n/* WEBPACK VAR INJECTION */}.call(__webpack_exports__, __webpack_require__(36), __webpack_require__(703)(module)))\n\n/***/ }),\n\n/***/ 689:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\nObject.defineProperty(__webpack_exports__, \"__esModule\", { value: true });\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__ = __webpack_require__(524);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_jquery__ = __webpack_require__(36);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_1_jquery___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_1_jquery__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_jquery_textcomplete__ = __webpack_require__(697);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_2_jquery_textcomplete___default = __webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_jquery_textcomplete__);\n/* harmony import */ var __WEBPACK_IMPORTED_MODULE_3__store_jquery_comment__ = __webpack_require__(671);\n\n\n\n\n\n\n\n/* harmony default export */ __webpack_exports__[\"default\"] = ({\n  props: ['classPK', 'className'],\n  data: function data() {\n    return {\n      usersComment: [],\n      comment: [],\n      argShowMore: true,\n\n      checkOpinion: true\n    };\n  },\n  computed: {\n    loading: function loading() {\n      return this.$store.getters.loading;\n    },\n    initData: function initData() {\n      return this.$store.getters.loadingInitData;\n    }\n  },\n  watch: {\n    classPK: function classPK(val) {\n      var vm = this;\n      vm.$store.dispatch('loadUsersComment', val).then(function (result) {\n        vm.usersComment = result;\n        vm.initComment();\n      }).catch(function (reject) {\n        vm.initComment();\n      });\n    }\n  },\n  created: function created() {},\n  mounted: function mounted() {},\n\n  methods: {\n    runComment: function runComment() {\n      var vm = this;\n      if (vm.classPK) {\n        vm.initComment();\n      }\n    },\n\n    initComment: function initComment() {\n      var vm = this;\n      __WEBPACK_IMPORTED_MODULE_1_jquery___default()('#comments-container-el').comments({\n        profilePictureURL: 'https://png.icons8.com/material/50/000000/guest-male.png',\n        textareaRows: 2,\n        enableAttachments: true,\n        enableHashtags: true,\n        enablePinging: true,\n        postCommentOnEnter: false,\n        forceResponsive: false,\n        readOnly: false,\n        textareaPlaceholderText: 'Thêm bình luận mới',\n        newestText: 'Mới nhất',\n        oldestText: 'Cũ nhất',\n        popularText: 'Phổ biến',\n        attachmentsText: 'Đính kèm',\n        sendText: 'Gửi',\n        replyText: 'Trả lời',\n        editText: 'Sửa',\n        editedText: 'Đã sửa',\n        youText: 'Bạn',\n        saveText: 'Ghi lại',\n        deleteText: 'Xóa',\n\n        hideRepliesText: 'Ẩn câu trả lời',\n        noCommentsText: 'Không có bình luận nào',\n        noAttachmentsText: 'Không có tệp đính kèm',\n        attachmentDropText: 'Kéo thả tệp đính kèm',\n        fieldMappings: {\n          id: 'commentId',\n          parent: 'parent',\n          userId: 'userId',\n          created: 'createdDate',\n          modified: 'modifiedDate',\n          content: 'content',\n          fileURL: 'fileUrl',\n          fileMimeType: 'fileType',\n          fileName: 'fileName',\n          pings: 'pings',\n          creator: 'userId',\n          fullname: 'fullname',\n          profileURL: 'profileUrl',\n          profilePictureURL: 'pictureUrl',\n          isNew: 'isNew',\n          createdByAdmin: 'isAdmin',\n          createdByCurrentUser: 'createdByCurrentUser',\n          upvoteCount: 'upvoteCount',\n          userHasUpvoted: 'userHasUpvoted',\n          email: 'email',\n          opinion: 'opinion',\n          className: 'className',\n          classPK: 'classPK'\n        },\n        timeFormatter: function timeFormatter(time) {\n          if (time) {\n            var value = new Date(time);\n            value.setHours(value.getHours() - 7);\n            return value.getDate().toString().padStart(2, '0') + '/' + (value.getMonth() + 1).toString().padStart(2, '0') + '/' + value.getFullYear() + ' ' + value.getHours().toString().padStart(2, '0') + ':' + value.getMinutes().toString().padStart(2, '0');\n          } else {\n            return '';\n          }\n        },\n        getUsers: function getUsers(onSuccess, onError) {\n          onSuccess(vm.usersComment);\n        },\n        getComments: function getComments(onSuccess, onError) {\n          var dataGet = {\n            'classPK': vm.classPK,\n            'className': vm.className\n          };\n          var promise = vm.$store.dispatch('loadCommentItems', dataGet);\n          promise.then(function (result) {\n            var data = [];\n            __WEBPACK_IMPORTED_MODULE_1_jquery___default.a.each(result, function (index, item) {\n              vm.comment = item;\n              vm.formatComment(vm.comment);\n              data.push(vm.comment);\n            });\n            onSuccess(data);\n          }).catch(function (reject) {\n            onSuccess([]);\n            onError();\n          });\n        },\n        postComment: function postComment(data, onSuccess, onError) {\n          data.classPK = vm.classPK;\n          data.className = vm.className;\n          data.opinion = document.getElementById('opinion').checked;\n          vm.$store.dispatch('postComment', data).then(function (result) {\n            if (result.opinion) {\n              __WEBPACK_IMPORTED_MODULE_1_jquery___default()('.opinion').hide();\n            }\n            document.getElementById('opinion').checked = false;\n            vm.comment = result;\n            vm.formatComment(vm.comment);\n            onSuccess(vm.comment);\n          });\n        },\n        putComment: function putComment(data, onSuccess, onError) {\n          data.classPK = vm.classPK;\n          data.className = vm.className;\n          vm.$store.dispatch('putComment', data).then(function (result) {\n            vm.comment = result;\n            vm.formatComment(vm.comment);\n            onSuccess(vm.comment);\n          });\n        },\n        deleteComment: function deleteComment(data, onSuccess, onError) {\n          data.classPK = vm.classPK;\n          data.className = vm.className;\n          vm.$store.dispatch('deleteComment', data).then(function (result) {\n            onSuccess();\n          }).catch(function (reject) {\n            onError();\n          });\n        },\n        upvoteComment: function upvoteComment(data, onSuccess, onError) {\n          data.classPK = vm.classPK;\n          data.className = vm.className;\n          vm.$store.dispatch('upvoteComment', data).then(function (result) {\n            vm.comment = result;\n            vm.formatComment(vm.comment);\n            onSuccess(vm.comment);\n          }).catch(function (reject) {});\n        },\n        uploadAttachments: function uploadAttachments(comments, onSuccess, onError) {\n          var responses = 0;\n          var successfulUploads = [];\n          var serverResponded = function serverResponded() {\n            responses++;\n            if (responses === comments.length) {\n              if (successfulUploads.length === 0) {\n                onError();\n              } else {\n                onSuccess(successfulUploads);\n              }\n            }\n          };\n          __WEBPACK_IMPORTED_MODULE_1_jquery___default()(comments).each(function (index, comment) {\n            var formData = new FormData();\n            __WEBPACK_IMPORTED_MODULE_1_jquery___default()(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_object_keys___default()(comment)).each(function (index, key) {\n              var value = comment[key];\n              if (value) {\n                formData.append(key, value);\n              }\n            });\n            formData.append('file', comment.file);\n            formData.append('className', vm.className);\n            formData.append('classPK', vm.classPK);\n            formData.append('parent', comment.parent != null ? comment.parent : 0);\n            formData.append('fileName', comment.file.name);\n            formData.append('fileType', comment.file.type);\n            formData.append('fileSize', comment.file.size);\n            formData.append('pings', comment.pings.join());\n\n            formData.append('email', vm.initData.user.userEmail);\n            formData.append('fullname', vm.initData.user.userName);\n            formData.append('opinion', document.getElementById('opinion').checked);\n            __WEBPACK_IMPORTED_MODULE_1_jquery___default.a.ajax({\n              url: vm.initData.commentApi + '/uploads',\n              dataType: 'json',\n              type: 'POST',\n              headers: {\n                'groupId': vm.initData.groupId\n              },\n              data: formData,\n              cache: false,\n              contentType: false,\n              processData: false,\n              success: function success(comment) {\n                vm.formatComment(comment);\n                successfulUploads.push(vm.comment);\n                serverResponded();\n                if (comment.opinion) {\n                  __WEBPACK_IMPORTED_MODULE_1_jquery___default()('.opinion').hide();\n                }\n                document.getElementById('opinion').checked = false;\n              },\n              error: function error(xhr, data) {\n                serverResponded();\n              }\n            });\n          });\n        }\n      });\n    },\n    formatComment: function formatComment(comment) {\n      var vm = this;\n      vm.comment = comment;\n      if (comment.parent === 0) {\n        vm.comment.parent = null;\n      }\n      if (comment.fileName === '') {\n        vm.comment.fileName = null;\n      }\n      if (comment.fileType === '') {\n        vm.comment.fileType = null;\n      }\n      if (comment.fileUrl === '') {\n        vm.comment.fileUrl = null;\n      }\n      if (comment.pictureUrl === '') {\n        vm.comment.pictureUrl = 'https://png.icons8.com/material/50/000000/guest-male.png';\n      }\n      vm.comment.fullname = comment.fullname;\n      vm.comment.opinion = comment.opinion;\n      vm.comment.pings = comment.pings.toString().split(',');\n      vm.comment.createdDate = vm.comment.createDate;\n      vm.comment.modifiedDate = vm.comment.modifiedDate;\n    },\n    dateTimeView: function dateTimeView(arg) {\n      if (arg) {\n        var value = new Date(arg);\n        return value.getDate().toString().padStart(2, '0') + '/' + (value.getMonth() + 1).toString().padStart(2, '0') + '/' + value.getFullYear() + ' ' + value.getHours().toString().padStart(2, '0') + ':' + value.getMinutes().toString().padStart(2, '0');\n      } else {\n        return '';\n      }\n    }\n  },\n  filters: {\n    dateTimeView: function dateTimeView(arg) {\n      if (arg) {\n        var value = new Date(arg);\n        return value.getDate().toString().padStart(2, '0') + '/' + (value.getMonth() + 1).toString().padStart(2, '0') + '/' + value.getFullYear() + '  ' + value.getHours().toString().padStart(2, '0') + ':' + value.getMinutes().toString().padStart(2, '0');\n      } else {\n        return '';\n      }\n    }\n  }\n});\n\n/***/ }),\n\n/***/ 694:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = { \"default\": __webpack_require__(695), __esModule: true };\n\n/***/ }),\n\n/***/ 695:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(696);\nvar $Object = __webpack_require__(30).Object;\nmodule.exports = function create(P, D) {\n  return $Object.create(P, D);\n};\n\n\n/***/ }),\n\n/***/ 696:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar $export = __webpack_require__(51);\n// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\n$export($export.S, 'Object', { create: __webpack_require__(216) });\n\n\n/***/ }),\n\n/***/ 697:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;(function (factory) {\n  if (true) {\n    // AMD. Register as an anonymous module.\n    !(__WEBPACK_AMD_DEFINE_ARRAY__ = [__webpack_require__(36)], __WEBPACK_AMD_DEFINE_FACTORY__ = (factory),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__));\n  } else if (typeof module === \"object\" && module.exports) {\n    var $ = require('jquery');\n    module.exports = factory($);\n  } else {\n    // Browser globals\n    factory(jQuery);\n  }\n}(function (jQuery) {\n\n/*!\n * jQuery.textcomplete\n *\n * Repository: https://github.com/yuku-t/jquery-textcomplete\n * License:    MIT (https://github.com/yuku-t/jquery-textcomplete/blob/master/LICENSE)\n * Author:     Yuku Takahashi\n */\n\nif (typeof jQuery === 'undefined') {\n  throw new Error('jQuery.textcomplete requires jQuery');\n}\n\n+function ($) {\n  'use strict';\n\n  var warn = function (message) {\n    if (console.warn) { console.warn(message); }\n  };\n\n  var id = 1;\n\n  $.fn.textcomplete = function (strategies, option) {\n    var args = Array.prototype.slice.call(arguments);\n    return this.each(function () {\n      var self = this;\n      var $this = $(this);\n      var completer = $this.data('textComplete');\n      if (!completer) {\n        option || (option = {});\n        option._oid = id++;  // unique object id\n        completer = new $.fn.textcomplete.Completer(this, option);\n        $this.data('textComplete', completer);\n      }\n      if (typeof strategies === 'string') {\n        if (!completer) return;\n        args.shift()\n        completer[strategies].apply(completer, args);\n        if (strategies === 'destroy') {\n          $this.removeData('textComplete');\n        }\n      } else {\n        // For backward compatibility.\n        // TODO: Remove at v0.4\n        $.each(strategies, function (obj) {\n          $.each(['header', 'footer', 'placement', 'maxCount'], function (name) {\n            if (obj[name]) {\n              completer.option[name] = obj[name];\n              warn(name + 'as a strategy param is deprecated. Use option.');\n              delete obj[name];\n            }\n          });\n        });\n        completer.register($.fn.textcomplete.Strategy.parse(strategies, {\n          el: self,\n          $el: $this\n        }));\n      }\n    });\n  };\n\n}(jQuery);\n\n+function ($) {\n  'use strict';\n\n  // Exclusive execution control utility.\n  //\n  // func - The function to be locked. It is executed with a function named\n  //        `free` as the first argument. Once it is called, additional\n  //        execution are ignored until the free is invoked. Then the last\n  //        ignored execution will be replayed immediately.\n  //\n  // Examples\n  //\n  //   var lockedFunc = lock(function (free) {\n  //     setTimeout(function { free(); }, 1000); // It will be free in 1 sec.\n  //     console.log('Hello, world');\n  //   });\n  //   lockedFunc();  // => 'Hello, world'\n  //   lockedFunc();  // none\n  //   lockedFunc();  // none\n  //   // 1 sec past then\n  //   // => 'Hello, world'\n  //   lockedFunc();  // => 'Hello, world'\n  //   lockedFunc();  // none\n  //\n  // Returns a wrapped function.\n  var lock = function (func) {\n    var locked, queuedArgsToReplay;\n\n    return function () {\n      // Convert arguments into a real array.\n      var args = Array.prototype.slice.call(arguments);\n      if (locked) {\n        // Keep a copy of this argument list to replay later.\n        // OK to overwrite a previous value because we only replay\n        // the last one.\n        queuedArgsToReplay = args;\n        return;\n      }\n      locked = true;\n      var self = this;\n      args.unshift(function replayOrFree() {\n        if (queuedArgsToReplay) {\n          // Other request(s) arrived while we were locked.\n          // Now that the lock is becoming available, replay\n          // the latest such request, then call back here to\n          // unlock (or replay another request that arrived\n          // while this one was in flight).\n          var replayArgs = queuedArgsToReplay;\n          queuedArgsToReplay = undefined;\n          replayArgs.unshift(replayOrFree);\n          func.apply(self, replayArgs);\n        } else {\n          locked = false;\n        }\n      });\n      func.apply(this, args);\n    };\n  };\n\n  var isString = function (obj) {\n    return Object.prototype.toString.call(obj) === '[object String]';\n  };\n\n  var uniqueId = 0;\n  var initializedEditors = [];\n\n  function Completer(element, option) {\n    this.$el        = $(element);\n    this.id         = 'textcomplete' + uniqueId++;\n    this.strategies = [];\n    this.views      = [];\n    this.option     = $.extend({}, Completer.defaults, option);\n\n    if (!this.$el.is('input[type=text]') && !this.$el.is('input[type=search]') && !this.$el.is('textarea') && !element.isContentEditable && element.contentEditable != 'true') {\n      throw new Error('textcomplete must be called on a Textarea or a ContentEditable.');\n    }\n\n    // use ownerDocument to fix iframe / IE issues\n    if (element === element.ownerDocument.activeElement) {\n      // element has already been focused. Initialize view objects immediately.\n      this.initialize()\n    } else {\n      // Initialize view objects lazily.\n      var self = this;\n      this.$el.one('focus.' + this.id, function () { self.initialize(); });\n\n      // Special handling for CKEditor: lazy init on instance load\n      if ((!this.option.adapter || this.option.adapter == 'CKEditor') && typeof CKEDITOR != 'undefined' && (this.$el.is('textarea'))) {\n        CKEDITOR.on(\"instanceReady\", function(event) { //For multiple ckeditors on one page: this needs to be executed each time a ckeditor-instance is ready.\n\n          if($.inArray(event.editor.id, initializedEditors) == -1) { //For multiple ckeditors on one page: focus-eventhandler should only be added once for every editor.\n            initializedEditors.push(event.editor.id);\n\t\t\t\n            event.editor.on(\"focus\", function(event2) {\n\t\t\t\t//replace the element with the Iframe element and flag it as CKEditor\n\t\t\t\tself.$el = $(event.editor.editable().$);\n\t\t\t\tif (!self.option.adapter) {\n\t\t\t\t\tself.option.adapter = $.fn.textcomplete['CKEditor'];\n\t\t\t\t}\n\t\t\t\tself.option.ckeditor_instance = event.editor; //For multiple ckeditors on one page: in the old code this was not executed when adapter was alread set. So we were ALWAYS working with the FIRST instance.\n              \tself.initialize();\n            });\n          }\n        });\n      }\n    }\n  }\n\n  Completer.defaults = {\n    appendTo: 'body',\n    className: '',  // deprecated option\n    dropdownClassName: 'dropdown-menu textcomplete-dropdown',\n    maxCount: 10,\n    zIndex: '100',\n    rightEdgeOffset: 30\n  };\n\n  $.extend(Completer.prototype, {\n    // Public properties\n    // -----------------\n\n    id:         null,\n    option:     null,\n    strategies: null,\n    adapter:    null,\n    dropdown:   null,\n    $el:        null,\n    $iframe:    null,\n\n    // Public methods\n    // --------------\n\n    initialize: function () {\n      var element = this.$el.get(0);\n      \n      // check if we are in an iframe\n      // we need to alter positioning logic if using an iframe\n      if (this.$el.prop('ownerDocument') !== document && window.frames.length) {\n        for (var iframeIndex = 0; iframeIndex < window.frames.length; iframeIndex++) {\n          if (this.$el.prop('ownerDocument') === window.frames[iframeIndex].document) {\n            this.$iframe = $(window.frames[iframeIndex].frameElement);\n            break;\n          }\n        }\n      }\n      \n      \n      // Initialize view objects.\n      this.dropdown = new $.fn.textcomplete.Dropdown(element, this, this.option);\n      var Adapter, viewName;\n      if (this.option.adapter) {\n        Adapter = this.option.adapter;\n      } else {\n        if (this.$el.is('textarea') || this.$el.is('input[type=text]') || this.$el.is('input[type=search]')) {\n          viewName = typeof element.selectionEnd === 'number' ? 'Textarea' : 'IETextarea';\n        } else {\n          viewName = 'ContentEditable';\n        }\n        Adapter = $.fn.textcomplete[viewName];\n      }\n      this.adapter = new Adapter(element, this, this.option);\n    },\n\n    destroy: function () {\n      this.$el.off('.' + this.id);\n      if (this.adapter) {\n        this.adapter.destroy();\n      }\n      if (this.dropdown) {\n        this.dropdown.destroy();\n      }\n      this.$el = this.adapter = this.dropdown = null;\n    },\n\n    deactivate: function () {\n      if (this.dropdown) {\n        this.dropdown.deactivate();\n      }\n    },\n\n    // Invoke textcomplete.\n    trigger: function (text, skipUnchangedTerm) {\n      if (!this.dropdown) { this.initialize(); }\n      text != null || (text = this.adapter.getTextFromHeadToCaret());\n      var searchQuery = this._extractSearchQuery(text);\n      if (searchQuery.length) {\n        var term = searchQuery[1];\n        // Ignore shift-key, ctrl-key and so on.\n        if (skipUnchangedTerm && this._term === term && term !== \"\") { return; }\n        this._term = term;\n        this._search.apply(this, searchQuery);\n      } else {\n        this._term = null;\n        this.dropdown.deactivate();\n      }\n    },\n\n    fire: function (eventName) {\n      var args = Array.prototype.slice.call(arguments, 1);\n      this.$el.trigger(eventName, args);\n      return this;\n    },\n\n    register: function (strategies) {\n      Array.prototype.push.apply(this.strategies, strategies);\n    },\n\n    // Insert the value into adapter view. It is called when the dropdown is clicked\n    // or selected.\n    //\n    // value    - The selected element of the array callbacked from search func.\n    // strategy - The Strategy object.\n    // e        - Click or keydown event object.\n    select: function (value, strategy, e) {\n      this._term = null;\n      this.adapter.select(value, strategy, e);\n      this.fire('change').fire('textComplete:select', value, strategy);\n      this.adapter.focus();\n    },\n\n    // Private properties\n    // ------------------\n\n    _clearAtNext: true,\n    _term:        null,\n\n    // Private methods\n    // ---------------\n\n    // Parse the given text and extract the first matching strategy.\n    //\n    // Returns an array including the strategy, the query term and the match\n    // object if the text matches an strategy; otherwise returns an empty array.\n    _extractSearchQuery: function (text) {\n      for (var i = 0; i < this.strategies.length; i++) {\n        var strategy = this.strategies[i];\n        var context = strategy.context(text);\n        if (context || context === '') {\n          var matchRegexp = $.isFunction(strategy.match) ? strategy.match(text) : strategy.match;\n          if (isString(context)) { text = context; }\n          var match = text.match(matchRegexp);\n          if (match) { return [strategy, match[strategy.index], match]; }\n        }\n      }\n      return []\n    },\n\n    // Call the search method of selected strategy..\n    _search: lock(function (free, strategy, term, match) {\n      var self = this;\n      strategy.search(term, function (data, stillSearching) {\n        if (!self.dropdown.shown) {\n          self.dropdown.activate();\n        }\n        if (self._clearAtNext) {\n          // The first callback in the current lock.\n          self.dropdown.clear();\n          self._clearAtNext = false;\n        }\n        self.dropdown.setPosition(self.adapter.getCaretPosition());\n        self.dropdown.render(self._zip(data, strategy, term));\n        if (!stillSearching) {\n          // The last callback in the current lock.\n          free();\n          self._clearAtNext = true; // Call dropdown.clear at the next time.\n        }\n      }, match);\n    }),\n\n    // Build a parameter for Dropdown#render.\n    //\n    // Examples\n    //\n    //  this._zip(['a', 'b'], 's');\n    //  //=> [{ value: 'a', strategy: 's' }, { value: 'b', strategy: 's' }]\n    _zip: function (data, strategy, term) {\n      return $.map(data, function (value) {\n        return { value: value, strategy: strategy, term: term };\n      });\n    }\n  });\n\n  $.fn.textcomplete.Completer = Completer;\n}(jQuery);\n\n+function ($) {\n  'use strict';\n\n  var $window = $(window);\n\n  var include = function (zippedData, datum) {\n    var i, elem;\n    var idProperty = datum.strategy.idProperty\n    for (i = 0; i < zippedData.length; i++) {\n      elem = zippedData[i];\n      if (elem.strategy !== datum.strategy) continue;\n      if (idProperty) {\n        if (elem.value[idProperty] === datum.value[idProperty]) return true;\n      } else {\n        if (elem.value === datum.value) return true;\n      }\n    }\n    return false;\n  };\n\n  var dropdownViews = {};\n  $(document).on('click', function (e) {\n    var id = e.originalEvent && e.originalEvent.keepTextCompleteDropdown;\n    $.each(dropdownViews, function (key, view) {\n      if (key !== id) { view.deactivate(); }\n    });\n  });\n\n  var commands = {\n    SKIP_DEFAULT: 0,\n    KEY_UP: 1,\n    KEY_DOWN: 2,\n    KEY_ENTER: 3,\n    KEY_PAGEUP: 4,\n    KEY_PAGEDOWN: 5,\n    KEY_ESCAPE: 6\n  };\n\n  // Dropdown view\n  // =============\n\n  // Construct Dropdown object.\n  //\n  // element - Textarea or contenteditable element.\n  function Dropdown(element, completer, option) {\n    this.$el       = Dropdown.createElement(option);\n    this.completer = completer;\n    this.id        = completer.id + 'dropdown';\n    this._data     = []; // zipped data.\n    this.$inputEl  = $(element);\n    this.option    = option;\n\n    // Override setPosition method.\n    if (option.listPosition) { this.setPosition = option.listPosition; }\n    if (option.height) { this.$el.height(option.height); }\n    var self = this;\n    $.each(['maxCount', 'placement', 'footer', 'header', 'noResultsMessage', 'className'], function (_i, name) {\n      if (option[name] != null) { self[name] = option[name]; }\n    });\n    this._bindEvents(element);\n    dropdownViews[this.id] = this;\n  }\n\n  $.extend(Dropdown, {\n    // Class methods\n    // -------------\n\n    createElement: function (option) {\n      var $parent = option.appendTo;\n      if (!($parent instanceof $)) { $parent = $($parent); }\n      var $el = $('<ul></ul>')\n        .addClass(option.dropdownClassName)\n        .attr('id', 'textcomplete-dropdown-' + option._oid)\n        .css({\n          display: 'none',\n          left: 0,\n          position: 'absolute',\n          zIndex: option.zIndex\n        })\n        .appendTo($parent);\n      return $el;\n    }\n  });\n\n  $.extend(Dropdown.prototype, {\n    // Public properties\n    // -----------------\n\n    $el:       null,  // jQuery object of ul.dropdown-menu element.\n    $inputEl:  null,  // jQuery object of target textarea.\n    completer: null,\n    footer:    null,\n    header:    null,\n    id:        null,\n    maxCount:  null,\n    placement: '',\n    shown:     false,\n    data:      [],     // Shown zipped data.\n    className: '',\n\n    // Public methods\n    // --------------\n\n    destroy: function () {\n      // Don't remove $el because it may be shared by several textcompletes.\n      this.deactivate();\n\n      this.$el.off('.' + this.id);\n      this.$inputEl.off('.' + this.id);\n      this.clear();\n      this.$el.remove();\n      this.$el = this.$inputEl = this.completer = null;\n      delete dropdownViews[this.id]\n    },\n\n    render: function (zippedData) {\n      var contentsHtml = this._buildContents(zippedData);\n      var unzippedData = $.map(zippedData, function (d) { return d.value; });\n      if (zippedData.length) {\n        var strategy = zippedData[0].strategy;\n        if (strategy.id) {\n          this.$el.attr('data-strategy', strategy.id);\n        } else {\n          this.$el.removeAttr('data-strategy');\n        }\n        this._renderHeader(unzippedData);\n        this._renderFooter(unzippedData);\n        if (contentsHtml) {\n          this._renderContents(contentsHtml);\n          this._fitToBottom();\n          this._fitToRight();\n          this._activateIndexedItem();\n        }\n        this._setScroll();\n      } else if (this.noResultsMessage) {\n        this._renderNoResultsMessage(unzippedData);\n      } else if (this.shown) {\n        this.deactivate();\n      }\n    },\n\n    setPosition: function (pos) {\n      // Make the dropdown fixed if the input is also fixed\n      // This can't be done during init, as textcomplete may be used on multiple elements on the same page\n      // Because the same dropdown is reused behind the scenes, we need to recheck every time the dropdown is showed\n      var position = 'absolute';\n      // Check if input or one of its parents has positioning we need to care about\n      this.$inputEl.add(this.$inputEl.parents()).each(function() {\n        if($(this).css('position') === 'absolute') // The element has absolute positioning, so it's all OK\n          return false;\n        if($(this).css('position') === 'fixed') {\n          pos.top -= $window.scrollTop();\n          pos.left -= $window.scrollLeft();\n          position = 'fixed';\n          return false;\n        }\n      });\n      this.$el.css(this._applyPlacement(pos));\n      this.$el.css({ position: position }); // Update positioning\n\n      return this;\n    },\n\n    clear: function () {\n      this.$el.html('');\n      this.data = [];\n      this._index = 0;\n      this._$header = this._$footer = this._$noResultsMessage = null;\n    },\n\n    activate: function () {\n      if (!this.shown) {\n        this.clear();\n        this.$el.show();\n        if (this.className) { this.$el.addClass(this.className); }\n        this.completer.fire('textComplete:show');\n        this.shown = true;\n      }\n      return this;\n    },\n\n    deactivate: function () {\n      if (this.shown) {\n        this.$el.hide();\n        if (this.className) { this.$el.removeClass(this.className); }\n        this.completer.fire('textComplete:hide');\n        this.shown = false;\n      }\n      return this;\n    },\n\n    isUp: function (e) {\n      return e.keyCode === 38 || (e.ctrlKey && e.keyCode === 80);  // UP, Ctrl-P\n    },\n\n    isDown: function (e) {\n      return e.keyCode === 40 || (e.ctrlKey && e.keyCode === 78);  // DOWN, Ctrl-N\n    },\n\n    isEnter: function (e) {\n      var modifiers = e.ctrlKey || e.altKey || e.metaKey || e.shiftKey;\n      return !modifiers && (e.keyCode === 13 || e.keyCode === 9 || (this.option.completeOnSpace === true && e.keyCode === 32))  // ENTER, TAB\n    },\n\n    isPageup: function (e) {\n      return e.keyCode === 33;  // PAGEUP\n    },\n\n    isPagedown: function (e) {\n      return e.keyCode === 34;  // PAGEDOWN\n    },\n\n    isEscape: function (e) {\n      return e.keyCode === 27;  // ESCAPE\n    },\n\n    // Private properties\n    // ------------------\n\n    _data:    null,  // Currently shown zipped data.\n    _index:   null,\n    _$header: null,\n    _$noResultsMessage: null,\n    _$footer: null,\n\n    // Private methods\n    // ---------------\n\n    _bindEvents: function () {\n      this.$el.on('mousedown.' + this.id, '.textcomplete-item', $.proxy(this._onClick, this));\n      this.$el.on('touchstart.' + this.id, '.textcomplete-item', $.proxy(this._onClick, this));\n      this.$el.on('mouseover.' + this.id, '.textcomplete-item', $.proxy(this._onMouseover, this));\n      this.$inputEl.on('keydown.' + this.id, $.proxy(this._onKeydown, this));\n    },\n\n    _onClick: function (e) {\n      var $el = $(e.target);\n      e.preventDefault();\n      e.originalEvent.keepTextCompleteDropdown = this.id;\n      if (!$el.hasClass('textcomplete-item')) {\n        $el = $el.closest('.textcomplete-item');\n      }\n      var datum = this.data[parseInt($el.data('index'), 10)];\n      this.completer.select(datum.value, datum.strategy, e);\n      var self = this;\n      // Deactive at next tick to allow other event handlers to know whether\n      // the dropdown has been shown or not.\n      setTimeout(function () {\n        self.deactivate();\n        if (e.type === 'touchstart') {\n          self.$inputEl.focus();\n        }\n      }, 0);\n    },\n\n    // Activate hovered item.\n    _onMouseover: function (e) {\n      var $el = $(e.target);\n      e.preventDefault();\n      if (!$el.hasClass('textcomplete-item')) {\n        $el = $el.closest('.textcomplete-item');\n      }\n      this._index = parseInt($el.data('index'), 10);\n      this._activateIndexedItem();\n    },\n\n    _onKeydown: function (e) {\n      if (!this.shown) { return; }\n\n      var command;\n\n      if ($.isFunction(this.option.onKeydown)) {\n        command = this.option.onKeydown(e, commands);\n      }\n\n      if (command == null) {\n        command = this._defaultKeydown(e);\n      }\n\n      switch (command) {\n        case commands.KEY_UP:\n          e.preventDefault();\n          this._up();\n          break;\n        case commands.KEY_DOWN:\n          e.preventDefault();\n          this._down();\n          break;\n        case commands.KEY_ENTER:\n          e.preventDefault();\n          this._enter(e);\n          break;\n        case commands.KEY_PAGEUP:\n          e.preventDefault();\n          this._pageup();\n          break;\n        case commands.KEY_PAGEDOWN:\n          e.preventDefault();\n          this._pagedown();\n          break;\n        case commands.KEY_ESCAPE:\n          e.preventDefault();\n          this.deactivate();\n          break;\n      }\n    },\n\n    _defaultKeydown: function (e) {\n      if (this.isUp(e)) {\n        return commands.KEY_UP;\n      } else if (this.isDown(e)) {\n        return commands.KEY_DOWN;\n      } else if (this.isEnter(e)) {\n        return commands.KEY_ENTER;\n      } else if (this.isPageup(e)) {\n        return commands.KEY_PAGEUP;\n      } else if (this.isPagedown(e)) {\n        return commands.KEY_PAGEDOWN;\n      } else if (this.isEscape(e)) {\n        return commands.KEY_ESCAPE;\n      }\n    },\n\n    _up: function () {\n      if (this._index === 0) {\n        this._index = this.data.length - 1;\n      } else {\n        this._index -= 1;\n      }\n      this._activateIndexedItem();\n      this._setScroll();\n    },\n\n    _down: function () {\n      if (this._index === this.data.length - 1) {\n        this._index = 0;\n      } else {\n        this._index += 1;\n      }\n      this._activateIndexedItem();\n      this._setScroll();\n    },\n\n    _enter: function (e) {\n      var datum = this.data[parseInt(this._getActiveElement().data('index'), 10)];\n      this.completer.select(datum.value, datum.strategy, e);\n      this.deactivate();\n    },\n\n    _pageup: function () {\n      var target = 0;\n      var threshold = this._getActiveElement().position().top - this.$el.innerHeight();\n      this.$el.children().each(function (i) {\n        if ($(this).position().top + $(this).outerHeight() > threshold) {\n          target = i;\n          return false;\n        }\n      });\n      this._index = target;\n      this._activateIndexedItem();\n      this._setScroll();\n    },\n\n    _pagedown: function () {\n      var target = this.data.length - 1;\n      var threshold = this._getActiveElement().position().top + this.$el.innerHeight();\n      this.$el.children().each(function (i) {\n        if ($(this).position().top > threshold) {\n          target = i;\n          return false\n        }\n      });\n      this._index = target;\n      this._activateIndexedItem();\n      this._setScroll();\n    },\n\n    _activateIndexedItem: function () {\n      this.$el.find('.textcomplete-item.active').removeClass('active');\n      this._getActiveElement().addClass('active');\n    },\n\n    _getActiveElement: function () {\n      return this.$el.children('.textcomplete-item:nth(' + this._index + ')');\n    },\n\n    _setScroll: function () {\n      var $activeEl = this._getActiveElement();\n      var itemTop = $activeEl.position().top;\n      var itemHeight = $activeEl.outerHeight();\n      var visibleHeight = this.$el.innerHeight();\n      var visibleTop = this.$el.scrollTop();\n      if (this._index === 0 || this._index == this.data.length - 1 || itemTop < 0) {\n        this.$el.scrollTop(itemTop + visibleTop);\n      } else if (itemTop + itemHeight > visibleHeight) {\n        this.$el.scrollTop(itemTop + itemHeight + visibleTop - visibleHeight);\n      }\n    },\n\n    _buildContents: function (zippedData) {\n      var datum, i, index;\n      var html = '';\n      for (i = 0; i < zippedData.length; i++) {\n        if (this.data.length === this.maxCount) break;\n        datum = zippedData[i];\n        if (include(this.data, datum)) { continue; }\n        index = this.data.length;\n        this.data.push(datum);\n        html += '<li class=\"textcomplete-item\" data-index=\"' + index + '\"><a>';\n        html +=   datum.strategy.template(datum.value, datum.term);\n        html += '</a></li>';\n      }\n      return html;\n    },\n\n    _renderHeader: function (unzippedData) {\n      if (this.header) {\n        if (!this._$header) {\n          this._$header = $('<li class=\"textcomplete-header\"></li>').prependTo(this.$el);\n        }\n        var html = $.isFunction(this.header) ? this.header(unzippedData) : this.header;\n        this._$header.html(html);\n      }\n    },\n\n    _renderFooter: function (unzippedData) {\n      if (this.footer) {\n        if (!this._$footer) {\n          this._$footer = $('<li class=\"textcomplete-footer\"></li>').appendTo(this.$el);\n        }\n        var html = $.isFunction(this.footer) ? this.footer(unzippedData) : this.footer;\n        this._$footer.html(html);\n      }\n    },\n\n    _renderNoResultsMessage: function (unzippedData) {\n      if (this.noResultsMessage) {\n        if (!this._$noResultsMessage) {\n          this._$noResultsMessage = $('<li class=\"textcomplete-no-results-message\"></li>').appendTo(this.$el);\n        }\n        var html = $.isFunction(this.noResultsMessage) ? this.noResultsMessage(unzippedData) : this.noResultsMessage;\n        this._$noResultsMessage.html(html);\n      }\n    },\n\n    _renderContents: function (html) {\n      if (this._$footer) {\n        this._$footer.before(html);\n      } else {\n        this.$el.append(html);\n      }\n    },\n\n    _fitToBottom: function() {\n      var windowScrollBottom = $window.scrollTop() + $window.height();\n      var height = this.$el.height();\n      if ((this.$el.position().top + height) > windowScrollBottom) {\n        // only do this if we are not in an iframe\n        if (!this.completer.$iframe) {\n          this.$el.offset({top: windowScrollBottom - height});\n        }\n      }\n    },\n\n    _fitToRight: function() {\n      // We don't know how wide our content is until the browser positions us, and at that point it clips us\n      // to the document width so we don't know if we would have overrun it. As a heuristic to avoid that clipping\n      // (which makes our elements wrap onto the next line and corrupt the next item), if we're close to the right\n      // edge, move left. We don't know how far to move left, so just keep nudging a bit.\n      var tolerance = this.option.rightEdgeOffset; // pixels. Make wider than vertical scrollbar because we might not be able to use that space.\n      var lastOffset = this.$el.offset().left, offset;\n      var width = this.$el.width();\n      var maxLeft = $window.width() - tolerance;\n      while (lastOffset + width > maxLeft) {\n        this.$el.offset({left: lastOffset - tolerance});\n        offset = this.$el.offset().left;\n        if (offset >= lastOffset) { break; }\n        lastOffset = offset;\n      }\n    },\n\n    _applyPlacement: function (position) {\n      // If the 'placement' option set to 'top', move the position above the element.\n      if (this.placement.indexOf('top') !== -1) {\n        // Overwrite the position object to set the 'bottom' property instead of the top.\n        position = {\n          top: 'auto',\n          bottom: this.$el.parent().height() - position.top + position.lineHeight,\n          left: position.left\n        };\n      } else {\n        position.bottom = 'auto';\n        delete position.lineHeight;\n      }\n      if (this.placement.indexOf('absleft') !== -1) {\n        position.left = 0;\n      } else if (this.placement.indexOf('absright') !== -1) {\n        position.right = 0;\n        position.left = 'auto';\n      }\n      return position;\n    }\n  });\n\n  $.fn.textcomplete.Dropdown = Dropdown;\n  $.extend($.fn.textcomplete, commands);\n}(jQuery);\n\n+function ($) {\n  'use strict';\n\n  // Memoize a search function.\n  var memoize = function (func) {\n    var memo = {};\n    return function (term, callback) {\n      if (memo[term]) {\n        callback(memo[term]);\n      } else {\n        func.call(this, term, function (data) {\n          memo[term] = (memo[term] || []).concat(data);\n          callback.apply(null, arguments);\n        });\n      }\n    };\n  };\n\n  function Strategy(options) {\n    $.extend(this, options);\n    if (this.cache) { this.search = memoize(this.search); }\n  }\n\n  Strategy.parse = function (strategiesArray, params) {\n    return $.map(strategiesArray, function (strategy) {\n      var strategyObj = new Strategy(strategy);\n      strategyObj.el = params.el;\n      strategyObj.$el = params.$el;\n      return strategyObj;\n    });\n  };\n\n  $.extend(Strategy.prototype, {\n    // Public properties\n    // -----------------\n\n    // Required\n    match:      null,\n    replace:    null,\n    search:     null,\n\n    // Optional\n    id:         null,\n    cache:      false,\n    context:    function () { return true; },\n    index:      2,\n    template:   function (obj) { return obj; },\n    idProperty: null\n  });\n\n  $.fn.textcomplete.Strategy = Strategy;\n\n}(jQuery);\n\n+function ($) {\n  'use strict';\n\n  var now = Date.now || function () { return new Date().getTime(); };\n\n  // Returns a function, that, as long as it continues to be invoked, will not\n  // be triggered. The function will be called after it stops being called for\n  // `wait` msec.\n  //\n  // This utility function was originally implemented at Underscore.js.\n  var debounce = function (func, wait) {\n    var timeout, args, context, timestamp, result;\n    var later = function () {\n      var last = now() - timestamp;\n      if (last < wait) {\n        timeout = setTimeout(later, wait - last);\n      } else {\n        timeout = null;\n        result = func.apply(context, args);\n        context = args = null;\n      }\n    };\n\n    return function () {\n      context = this;\n      args = arguments;\n      timestamp = now();\n      if (!timeout) {\n        timeout = setTimeout(later, wait);\n      }\n      return result;\n    };\n  };\n\n  function Adapter () {}\n\n  $.extend(Adapter.prototype, {\n    // Public properties\n    // -----------------\n\n    id:        null, // Identity.\n    completer: null, // Completer object which creates it.\n    el:        null, // Textarea element.\n    $el:       null, // jQuery object of the textarea.\n    option:    null,\n\n    // Public methods\n    // --------------\n\n    initialize: function (element, completer, option) {\n      this.el        = element;\n      this.$el       = $(element);\n      this.id        = completer.id + this.constructor.name;\n      this.completer = completer;\n      this.option    = option;\n\n      if (this.option.debounce) {\n        this._onKeyup = debounce(this._onKeyup, this.option.debounce);\n      }\n\n      this._bindEvents();\n    },\n\n    destroy: function () {\n      this.$el.off('.' + this.id); // Remove all event handlers.\n      this.$el = this.el = this.completer = null;\n    },\n\n    // Update the element with the given value and strategy.\n    //\n    // value    - The selected object. It is one of the item of the array\n    //            which was callbacked from the search function.\n    // strategy - The Strategy associated with the selected value.\n    select: function (/* value, strategy */) {\n      throw new Error('Not implemented');\n    },\n\n    // Returns the caret's relative coordinates from body's left top corner.\n    getCaretPosition: function () {\n      var position = this._getCaretRelativePosition();\n      var offset = this.$el.offset();\n\n      // Calculate the left top corner of `this.option.appendTo` element.\n      var $parent = this.option.appendTo;\n      if ($parent) {\n         if (!($parent instanceof $)) { $parent = $($parent); }\n         var parentOffset = $parent.offsetParent().offset();\n         offset.top -= parentOffset.top;\n         offset.left -= parentOffset.left;\n      }\n\n      position.top += offset.top;\n      position.left += offset.left;\n      return position;\n    },\n\n    // Focus on the element.\n    focus: function () {\n      this.$el.focus();\n    },\n\n    // Private methods\n    // ---------------\n\n    _bindEvents: function () {\n      this.$el.on('keyup.' + this.id, $.proxy(this._onKeyup, this));\n    },\n\n    _onKeyup: function (e) {\n      if (this._skipSearch(e)) { return; }\n      this.completer.trigger(this.getTextFromHeadToCaret(), true);\n    },\n\n    // Suppress searching if it returns true.\n    _skipSearch: function (clickEvent) {\n      switch (clickEvent.keyCode) {\n        case 9:  // TAB\n        case 13: // ENTER\n        case 16: // SHIFT\n        case 17: // CTRL\n        case 18: // ALT\n        case 33: // PAGEUP\n        case 34: // PAGEDOWN\n        case 40: // DOWN\n        case 38: // UP\n        case 27: // ESC\n          return true;\n      }\n      if (clickEvent.ctrlKey) switch (clickEvent.keyCode) {\n        case 78: // Ctrl-N\n        case 80: // Ctrl-P\n          return true;\n      }\n    }\n  });\n\n  $.fn.textcomplete.Adapter = Adapter;\n}(jQuery);\n\n+function ($) {\n  'use strict';\n\n  // Textarea adapter\n  // ================\n  //\n  // Managing a textarea. It doesn't know a Dropdown.\n  function Textarea(element, completer, option) {\n    this.initialize(element, completer, option);\n  }\n\n  $.extend(Textarea.prototype, $.fn.textcomplete.Adapter.prototype, {\n    // Public methods\n    // --------------\n\n    // Update the textarea with the given value and strategy.\n    select: function (value, strategy, e) {\n      var pre = this.getTextFromHeadToCaret();\n      var post = this.el.value.substring(this.el.selectionEnd);\n      var newSubstr = strategy.replace(value, e);\n      var regExp;\n      if (typeof newSubstr !== 'undefined') {\n        if ($.isArray(newSubstr)) {\n          post = newSubstr[1] + post;\n          newSubstr = newSubstr[0];\n        }\n        regExp = $.isFunction(strategy.match) ? strategy.match(pre) : strategy.match;\n        pre = pre.replace(regExp, newSubstr);\n        this.$el.val(pre + post);\n        this.el.selectionStart = this.el.selectionEnd = pre.length;\n      }\n    },\n\n    getTextFromHeadToCaret: function () {\n      return this.el.value.substring(0, this.el.selectionEnd);\n    },\n\n    // Private methods\n    // ---------------\n\n    _getCaretRelativePosition: function () {\n      var p = $.fn.textcomplete.getCaretCoordinates(this.el, this.el.selectionStart);\n      return {\n        top: p.top + this._calculateLineHeight() - this.$el.scrollTop(),\n        left: p.left - this.$el.scrollLeft(),\n        lineHeight: this._calculateLineHeight()\n      };\n    },\n\n    _calculateLineHeight: function () {\n      var lineHeight = parseInt(this.$el.css('line-height'), 10);\n      if (isNaN(lineHeight)) {\n        // http://stackoverflow.com/a/4515470/1297336\n        var parentNode = this.el.parentNode;\n        var temp = document.createElement(this.el.nodeName);\n        var style = this.el.style;\n        temp.setAttribute(\n          'style',\n          'margin:0px;padding:0px;font-family:' + style.fontFamily + ';font-size:' + style.fontSize\n        );\n        temp.innerHTML = 'test';\n        parentNode.appendChild(temp);\n        lineHeight = temp.clientHeight;\n        parentNode.removeChild(temp);\n      }\n      return lineHeight;\n    }\n  });\n\n  $.fn.textcomplete.Textarea = Textarea;\n}(jQuery);\n\n+function ($) {\n  'use strict';\n\n  var sentinelChar = '吶';\n\n  function IETextarea(element, completer, option) {\n    this.initialize(element, completer, option);\n    $('<span>' + sentinelChar + '</span>').css({\n      position: 'absolute',\n      top: -9999,\n      left: -9999\n    }).insertBefore(element);\n  }\n\n  $.extend(IETextarea.prototype, $.fn.textcomplete.Textarea.prototype, {\n    // Public methods\n    // --------------\n\n    select: function (value, strategy, e) {\n      var pre = this.getTextFromHeadToCaret();\n      var post = this.el.value.substring(pre.length);\n      var newSubstr = strategy.replace(value, e);\n      var regExp;\n      if (typeof newSubstr !== 'undefined') {\n        if ($.isArray(newSubstr)) {\n          post = newSubstr[1] + post;\n          newSubstr = newSubstr[0];\n        }\n        regExp = $.isFunction(strategy.match) ? strategy.match(pre) : strategy.match;\n        pre = pre.replace(regExp, newSubstr);\n        this.$el.val(pre + post);\n        this.el.focus();\n        var range = this.el.createTextRange();\n        range.collapse(true);\n        range.moveEnd('character', pre.length);\n        range.moveStart('character', pre.length);\n        range.select();\n      }\n    },\n\n    getTextFromHeadToCaret: function () {\n      this.el.focus();\n      var range = document.selection.createRange();\n      range.moveStart('character', -this.el.value.length);\n      var arr = range.text.split(sentinelChar)\n      return arr.length === 1 ? arr[0] : arr[1];\n    }\n  });\n\n  $.fn.textcomplete.IETextarea = IETextarea;\n}(jQuery);\n\n// NOTE: TextComplete plugin has contenteditable support but it does not work\n//       fine especially on old IEs.\n//       Any pull requests are REALLY welcome.\n\n+function ($) {\n  'use strict';\n\n  // ContentEditable adapter\n  // =======================\n  //\n  // Adapter for contenteditable elements.\n  function ContentEditable (element, completer, option) {\n    this.initialize(element, completer, option);\n  }\n\n  $.extend(ContentEditable.prototype, $.fn.textcomplete.Adapter.prototype, {\n    // Public methods\n    // --------------\n\n    // Update the content with the given value and strategy.\n    // When an dropdown item is selected, it is executed.\n    select: function (value, strategy, e) {\n      var pre = this.getTextFromHeadToCaret();\n      // use ownerDocument instead of window to support iframes\n      var sel = this.el.ownerDocument.getSelection();\n      \n      var range = sel.getRangeAt(0);\n      var selection = range.cloneRange();\n      selection.selectNodeContents(range.startContainer);\n      var content = selection.toString();\n      var post = content.substring(range.startOffset);\n      var newSubstr = strategy.replace(value, e);\n      var regExp;\n      if (typeof newSubstr !== 'undefined') {\n        if ($.isArray(newSubstr)) {\n          post = newSubstr[1] + post;\n          newSubstr = newSubstr[0];\n        }\n        regExp = $.isFunction(strategy.match) ? strategy.match(pre) : strategy.match;\n        pre = pre.replace(regExp, newSubstr)\n            .replace(/ $/, \"&nbsp\"); // &nbsp necessary at least for CKeditor to not eat spaces\n        range.selectNodeContents(range.startContainer);\n        range.deleteContents();\n        \n        // create temporary elements\n        var preWrapper = this.el.ownerDocument.createElement(\"div\");\n        preWrapper.innerHTML = pre;\n        var postWrapper = this.el.ownerDocument.createElement(\"div\");\n        postWrapper.innerHTML = post;\n        \n        // create the fragment thats inserted\n        var fragment = this.el.ownerDocument.createDocumentFragment();\n        var childNode;\n        var lastOfPre;\n        while (childNode = preWrapper.firstChild) {\n        \tlastOfPre = fragment.appendChild(childNode);\n        }\n        while (childNode = postWrapper.firstChild) {\n        \tfragment.appendChild(childNode);\n        }\n        \n        // insert the fragment & jump behind the last node in \"pre\"\n        range.insertNode(fragment);\n        range.setStartAfter(lastOfPre);\n        \n        range.collapse(true);\n        sel.removeAllRanges();\n        sel.addRange(range);\n      }\n    },\n\n    // Private methods\n    // ---------------\n\n    // Returns the caret's relative position from the contenteditable's\n    // left top corner.\n    //\n    // Examples\n    //\n    //   this._getCaretRelativePosition()\n    //   //=> { top: 18, left: 200, lineHeight: 16 }\n    //\n    // Dropdown's position will be decided using the result.\n    _getCaretRelativePosition: function () {\n      var range = this.el.ownerDocument.getSelection().getRangeAt(0).cloneRange();\n      var wrapperNode = range.endContainer.parentNode;\n      var node = this.el.ownerDocument.createElement('span');\n      range.insertNode(node);\n      range.selectNodeContents(node);\n      range.deleteContents();\n      setTimeout(function() { wrapperNode.normalize(); }, 0);\n      var $node = $(node);\n      var position = $node.offset();\n      position.left -= this.$el.offset().left;\n      position.top += $node.height() - this.$el.offset().top;\n      position.lineHeight = $node.height();\n      \n      // special positioning logic for iframes\n      // this is typically used for contenteditables such as tinymce or ckeditor\n      if (this.completer.$iframe) {\n        var iframePosition = this.completer.$iframe.offset();\n        position.top += iframePosition.top;\n        position.left += iframePosition.left;\n        // We need to get the scrollTop of the html-element inside the iframe and not of the body-element,\n        // because on IE the scrollTop of the body-element (this.$el) is always zero.\n        position.top -= $(this.completer.$iframe[0].contentWindow.document).scrollTop();\n      }\n      \n      $node.remove();\n      return position;\n    },\n\n    // Returns the string between the first character and the caret.\n    // Completer will be triggered with the result for start autocompleting.\n    //\n    // Example\n    //\n    //   // Suppose the html is '<b>hello</b> wor|ld' and | is the caret.\n    //   this.getTextFromHeadToCaret()\n    //   // => ' wor'  // not '<b>hello</b> wor'\n    getTextFromHeadToCaret: function () {\n      var range = this.el.ownerDocument.getSelection().getRangeAt(0);\n      var selection = range.cloneRange();\n      selection.selectNodeContents(range.startContainer);\n      return selection.toString().substring(0, range.startOffset);\n    }\n  });\n\n  $.fn.textcomplete.ContentEditable = ContentEditable;\n}(jQuery);\n\n// NOTE: TextComplete plugin has contenteditable support but it does not work\n//       fine especially on old IEs.\n//       Any pull requests are REALLY welcome.\n\n+function ($) {\n  'use strict';\n\n  // CKEditor adapter\n  // =======================\n  //\n  // Adapter for CKEditor, based on contenteditable elements.\n  function CKEditor (element, completer, option) {\n    this.initialize(element, completer, option);\n  }\n\n  $.extend(CKEditor.prototype, $.fn.textcomplete.ContentEditable.prototype, {\n    _bindEvents: function () {\n      var $this = this;\n      this.option.ckeditor_instance.on('key', function(event) {\n        var domEvent = event.data;\n        $this._onKeyup(domEvent);\n        if ($this.completer.dropdown.shown && $this._skipSearch(domEvent)) {\n          return false;\n        }\n      }, null, null, 1); // 1 = Priority = Important!\n      // we actually also need the native event, as the CKEditor one is happening to late\n      this.$el.on('keyup.' + this.id, $.proxy(this._onKeyup, this));\n    },\n});\n\n  $.fn.textcomplete.CKEditor = CKEditor;\n}(jQuery);\n\n// The MIT License (MIT)\n// \n// Copyright (c) 2015 Jonathan Ong me@jongleberry.com\n// \n// Permission is hereby granted, free of charge, to any person obtaining a copy of this software and\n// associated documentation files (the \"Software\"), to deal in the Software without restriction,\n// including without limitation the rights to use, copy, modify, merge, publish, distribute,\n// sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n// \n// The above copyright notice and this permission notice shall be included in all copies or\n// substantial portions of the Software.\n// \n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT\n// NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\n// https://github.com/component/textarea-caret-position\n\n(function ($) {\n\n// The properties that we copy into a mirrored div.\n// Note that some browsers, such as Firefox,\n// do not concatenate properties, i.e. padding-top, bottom etc. -> padding,\n// so we have to do every single property specifically.\nvar properties = [\n  'direction',  // RTL support\n  'boxSizing',\n  'width',  // on Chrome and IE, exclude the scrollbar, so the mirror div wraps exactly as the textarea does\n  'height',\n  'overflowX',\n  'overflowY',  // copy the scrollbar for IE\n\n  'borderTopWidth',\n  'borderRightWidth',\n  'borderBottomWidth',\n  'borderLeftWidth',\n  'borderStyle',\n\n  'paddingTop',\n  'paddingRight',\n  'paddingBottom',\n  'paddingLeft',\n\n  // https://developer.mozilla.org/en-US/docs/Web/CSS/font\n  'fontStyle',\n  'fontVariant',\n  'fontWeight',\n  'fontStretch',\n  'fontSize',\n  'fontSizeAdjust',\n  'lineHeight',\n  'fontFamily',\n\n  'textAlign',\n  'textTransform',\n  'textIndent',\n  'textDecoration',  // might not make a difference, but better be safe\n\n  'letterSpacing',\n  'wordSpacing',\n\n  'tabSize',\n  'MozTabSize'\n\n];\n\nvar isBrowser = (typeof window !== 'undefined');\nvar isFirefox = (isBrowser && window.mozInnerScreenX != null);\n\nfunction getCaretCoordinates(element, position, options) {\n  if(!isBrowser) {\n    throw new Error('textarea-caret-position#getCaretCoordinates should only be called in a browser');\n  }\n\n  var debug = options && options.debug || false;\n  if (debug) {\n    var el = document.querySelector('#input-textarea-caret-position-mirror-div');\n    if ( el ) { el.parentNode.removeChild(el); }\n  }\n\n  // mirrored div\n  var div = document.createElement('div');\n  div.id = 'input-textarea-caret-position-mirror-div';\n  document.body.appendChild(div);\n\n  var style = div.style;\n  var computed = window.getComputedStyle? getComputedStyle(element) : element.currentStyle;  // currentStyle for IE < 9\n\n  // default textarea styles\n  style.whiteSpace = 'pre-wrap';\n  if (element.nodeName !== 'INPUT')\n    style.wordWrap = 'break-word';  // only for textarea-s\n\n  // position off-screen\n  style.position = 'absolute';  // required to return coordinates properly\n  if (!debug)\n    style.visibility = 'hidden';  // not 'display: none' because we want rendering\n\n  // transfer the element's properties to the div\n  properties.forEach(function (prop) {\n    style[prop] = computed[prop];\n  });\n\n  if (isFirefox) {\n    // Firefox lies about the overflow property for textareas: https://bugzilla.mozilla.org/show_bug.cgi?id=984275\n    if (element.scrollHeight > parseInt(computed.height))\n      style.overflowY = 'scroll';\n  } else {\n    style.overflow = 'hidden';  // for Chrome to not render a scrollbar; IE keeps overflowY = 'scroll'\n  }\n\n  div.textContent = element.value.substring(0, position);\n  // the second special handling for input type=\"text\" vs textarea: spaces need to be replaced with non-breaking spaces - http://stackoverflow.com/a/13402035/1269037\n  if (element.nodeName === 'INPUT')\n    div.textContent = div.textContent.replace(/\\s/g, '\\u00a0');\n\n  var span = document.createElement('span');\n  // Wrapping must be replicated *exactly*, including when a long word gets\n  // onto the next line, with whitespace at the end of the line before (#7).\n  // The  *only* reliable way to do that is to copy the *entire* rest of the\n  // textarea's content into the <span> created at the caret position.\n  // for inputs, just '.' would be enough, but why bother?\n  span.textContent = element.value.substring(position) || '.';  // || because a completely empty faux span doesn't render at all\n  div.appendChild(span);\n\n  var coordinates = {\n    top: span.offsetTop + parseInt(computed['borderTopWidth']),\n    left: span.offsetLeft + parseInt(computed['borderLeftWidth'])\n  };\n\n  if (debug) {\n    span.style.backgroundColor = '#aaa';\n  } else {\n    document.body.removeChild(div);\n  }\n\n  return coordinates;\n}\n\n$.fn.textcomplete.getCaretCoordinates = getCaretCoordinates;\n\n}(jQuery));\n\nreturn jQuery;\n}));\n\n\n/***/ }),\n\n/***/ 701:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"comment-temp\"\n  }, [_c('div', [_c('v-expansion-panel', {\n    staticClass: \"expansion-pl-transparent\"\n  }, [_c('v-expansion-panel-content', {\n    attrs: {\n      \"hide-actions\": \"\",\n      \"value\": true\n    }\n  }, [_c('v-card', {\n    staticClass: \"comments__container\"\n  }, [_c('v-card-text', {\n    staticClass: \"pl-4\"\n  }, [_c('div', {\n    attrs: {\n      \"id\": \"comments-container-el\"\n    }\n  })])], 1)], 1)], 1)], 1)])\n},staticRenderFns: []}\nmodule.exports.render._withStripped = true\nif (false) {\n  module.hot.accept()\n  if (module.hot.data) {\n     require(\"vue-hot-reload-api\").rerender(\"data-v-c8f36406\", module.exports)\n  }\n}\n\n/***/ }),\n\n/***/ 703:\n/***/ (function(module, exports) {\n\nmodule.exports = function(originalModule) {\r\n\tif(!originalModule.webpackPolyfill) {\r\n\t\tvar module = Object.create(originalModule);\r\n\t\t// module.parent = undefined by default\r\n\t\tif(!module.children) module.children = [];\r\n\t\tObject.defineProperty(module, \"loaded\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.l;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(module, \"id\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.i;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(module, \"exports\", {\r\n\t\t\tenumerable: true,\r\n\t\t});\r\n\t\tmodule.webpackPolyfill = 1;\r\n\t}\r\n\treturn module;\r\n};\r\n\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// o/frontend-web-customer-v2-1/js/7.b18bc59daa3e12099b78.js","var Component = require(\"!../../node_modules/vue-loader/lib/component-normalizer\")(\n  /* script */\n  require(\"!!babel-loader!../../node_modules/vue-loader/lib/selector?type=script&index=0!./Comment.vue\"),\n  /* template */\n  require(\"!!../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-c8f36406\\\"}!../../node_modules/vue-loader/lib/selector?type=template&index=0!./Comment.vue\"),\n  /* scopeId */\n  null,\n  /* cssModules */\n  null\n)\nComponent.options.__file = \"/home/hoanganh/Pictures/FrontEnd_Opencps2.1/frontend-opencps-v2.1/onegate_21_fe/src/components/Comment.vue\"\nif (Component.esModule && Object.keys(Component.esModule).some(function (key) {return key !== \"default\" && key !== \"__esModule\"})) {console.error(\"named exports are not supported in *.vue files.\")}\nif (Component.options.functional) {console.error(\"[vue-loader] Comment.vue: functional components are not supported with templates, they should use render functions.\")}\n\n/* hot reload */\nif (module.hot) {(function () {\n  var hotAPI = require(\"vue-hot-reload-api\")\n  hotAPI.install(require(\"vue\"), false)\n  if (!hotAPI.compatible) return\n  module.hot.accept()\n  if (!module.hot.data) {\n    hotAPI.createRecord(\"data-v-c8f36406\", Component.options)\n  } else {\n    hotAPI.reload(\"data-v-c8f36406\", Component.options)\n  }\n})()}\n\nmodule.exports = Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/components/Comment.vue\n// module id = 228\n// module chunks = 0 1 5 7","var global = require('./_global');\nvar core = require('./_core');\nvar LIBRARY = require('./_library');\nvar wksExt = require('./_wks-ext');\nvar defineProperty = require('./_object-dp').f;\nmodule.exports = function (name) {\n  var $Symbol = core.Symbol || (core.Symbol = LIBRARY ? {} : global.Symbol || {});\n  if (name.charAt(0) != '_' && !(name in $Symbol)) defineProperty($Symbol, name, { value: wksExt.f(name) });\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_wks-define.js\n// module id = 521\n// module chunks = 0 1 5 6 7 8 9","exports.f = require('./_wks');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_wks-ext.js\n// module id = 522\n// module chunks = 0 1 5 6 7 8 9","// 19.1.2.7 / 15.2.3.4 Object.getOwnPropertyNames(O)\nvar $keys = require('./_object-keys-internal');\nvar hiddenKeys = require('./_enum-bug-keys').concat('length', 'prototype');\n\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return $keys(O, hiddenKeys);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_object-gopn.js\n// module id = 523\n// module chunks = 0 1 5 6 7 8 9","module.exports = { \"default\": require(\"core-js/library/fn/object/keys\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/object/keys.js\n// module id = 524\n// module chunks = 0 1 2 3 4 5 7","\"use strict\";\n\nexports.__esModule = true;\n\nvar _iterator = require(\"../core-js/symbol/iterator\");\n\nvar _iterator2 = _interopRequireDefault(_iterator);\n\nvar _symbol = require(\"../core-js/symbol\");\n\nvar _symbol2 = _interopRequireDefault(_symbol);\n\nvar _typeof = typeof _symbol2.default === \"function\" && typeof _iterator2.default === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof _symbol2.default === \"function\" && obj.constructor === _symbol2.default && obj !== _symbol2.default.prototype ? \"symbol\" : typeof obj; };\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = typeof _symbol2.default === \"function\" && _typeof(_iterator2.default) === \"symbol\" ? function (obj) {\n  return typeof obj === \"undefined\" ? \"undefined\" : _typeof(obj);\n} : function (obj) {\n  return obj && typeof _symbol2.default === \"function\" && obj.constructor === _symbol2.default && obj !== _symbol2.default.prototype ? \"symbol\" : typeof obj === \"undefined\" ? \"undefined\" : _typeof(obj);\n};\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/helpers/typeof.js\n// module id = 525\n// module chunks = 0 1 5 6 7 8 9","module.exports = { \"default\": require(\"core-js/library/fn/symbol\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/symbol.js\n// module id = 650\n// module chunks = 0 1 5 6 7 8 9","module.exports = { \"default\": require(\"core-js/library/fn/symbol/iterator\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/symbol/iterator.js\n// module id = 651\n// module chunks = 0 1 5 6 7 8 9","require('../../modules/es6.object.keys');\nmodule.exports = require('../../modules/_core').Object.keys;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/fn/object/keys.js\n// module id = 652\n// module chunks = 0 1 2 3 4 5 7","require('../../modules/es6.symbol');\nrequire('../../modules/es6.object.to-string');\nrequire('../../modules/es7.symbol.async-iterator');\nrequire('../../modules/es7.symbol.observable');\nmodule.exports = require('../../modules/_core').Symbol;\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/fn/symbol/index.js\n// module id = 653\n// module chunks = 0 1 5 6 7 8 9","require('../../modules/es6.string.iterator');\nrequire('../../modules/web.dom.iterable');\nmodule.exports = require('../../modules/_wks-ext').f('iterator');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/fn/symbol/iterator.js\n// module id = 654\n// module chunks = 0 1 5 6 7 8 9","// all enumerable object keys, includes symbols\nvar getKeys = require('./_object-keys');\nvar gOPS = require('./_object-gops');\nvar pIE = require('./_object-pie');\nmodule.exports = function (it) {\n  var result = getKeys(it);\n  var getSymbols = gOPS.f;\n  if (getSymbols) {\n    var symbols = getSymbols(it);\n    var isEnum = pIE.f;\n    var i = 0;\n    var key;\n    while (symbols.length > i) if (isEnum.call(it, key = symbols[i++])) result.push(key);\n  } return result;\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_enum-keys.js\n// module id = 655\n// module chunks = 0 1 5 6 7 8 9","// 7.2.2 IsArray(argument)\nvar cof = require('./_cof');\nmodule.exports = Array.isArray || function isArray(arg) {\n  return cof(arg) == 'Array';\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_is-array.js\n// module id = 656\n// module chunks = 0 1 5 6 7 8 9","var META = require('./_uid')('meta');\nvar isObject = require('./_is-object');\nvar has = require('./_has');\nvar setDesc = require('./_object-dp').f;\nvar id = 0;\nvar isExtensible = Object.isExtensible || function () {\n  return true;\n};\nvar FREEZE = !require('./_fails')(function () {\n  return isExtensible(Object.preventExtensions({}));\n});\nvar setMeta = function (it) {\n  setDesc(it, META, { value: {\n    i: 'O' + ++id, // object ID\n    w: {}          // weak collections IDs\n  } });\n};\nvar fastKey = function (it, create) {\n  // return primitive with prefix\n  if (!isObject(it)) return typeof it == 'symbol' ? it : (typeof it == 'string' ? 'S' : 'P') + it;\n  if (!has(it, META)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return 'F';\n    // not necessary to add metadata\n    if (!create) return 'E';\n    // add missing metadata\n    setMeta(it);\n  // return object ID\n  } return it[META].i;\n};\nvar getWeak = function (it, create) {\n  if (!has(it, META)) {\n    // can't set metadata to uncaught frozen object\n    if (!isExtensible(it)) return true;\n    // not necessary to add metadata\n    if (!create) return false;\n    // add missing metadata\n    setMeta(it);\n  // return hash weak collections IDs\n  } return it[META].w;\n};\n// add metadata on freeze-family methods calling\nvar onFreeze = function (it) {\n  if (FREEZE && meta.NEED && isExtensible(it) && !has(it, META)) setMeta(it);\n  return it;\n};\nvar meta = module.exports = {\n  KEY: META,\n  NEED: false,\n  fastKey: fastKey,\n  getWeak: getWeak,\n  onFreeze: onFreeze\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_meta.js\n// module id = 657\n// module chunks = 0 1 5 6 7 8 9","var pIE = require('./_object-pie');\nvar createDesc = require('./_property-desc');\nvar toIObject = require('./_to-iobject');\nvar toPrimitive = require('./_to-primitive');\nvar has = require('./_has');\nvar IE8_DOM_DEFINE = require('./_ie8-dom-define');\nvar gOPD = Object.getOwnPropertyDescriptor;\n\nexports.f = require('./_descriptors') ? gOPD : function getOwnPropertyDescriptor(O, P) {\n  O = toIObject(O);\n  P = toPrimitive(P, true);\n  if (IE8_DOM_DEFINE) try {\n    return gOPD(O, P);\n  } catch (e) { /* empty */ }\n  if (has(O, P)) return createDesc(!pIE.f.call(O, P), O[P]);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_object-gopd.js\n// module id = 658\n// module chunks = 0 1 5 6 7 8 9","// fallback for IE11 buggy Object.getOwnPropertyNames with iframe and window\nvar toIObject = require('./_to-iobject');\nvar gOPN = require('./_object-gopn').f;\nvar toString = {}.toString;\n\nvar windowNames = typeof window == 'object' && window && Object.getOwnPropertyNames\n  ? Object.getOwnPropertyNames(window) : [];\n\nvar getWindowNames = function (it) {\n  try {\n    return gOPN(it);\n  } catch (e) {\n    return windowNames.slice();\n  }\n};\n\nmodule.exports.f = function getOwnPropertyNames(it) {\n  return windowNames && toString.call(it) == '[object Window]' ? getWindowNames(it) : gOPN(toIObject(it));\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_object-gopn-ext.js\n// module id = 659\n// module chunks = 0 1 5 6 7 8 9","// most Object methods by ES6 should accept primitives\nvar $export = require('./_export');\nvar core = require('./_core');\nvar fails = require('./_fails');\nmodule.exports = function (KEY, exec) {\n  var fn = (core.Object || {})[KEY] || Object[KEY];\n  var exp = {};\n  exp[KEY] = exec(fn);\n  $export($export.S + $export.F * fails(function () { fn(1); }), 'Object', exp);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/_object-sap.js\n// module id = 660\n// module chunks = 0 1 2 3 4 5 7","// 19.1.2.14 Object.keys(O)\nvar toObject = require('./_to-object');\nvar $keys = require('./_object-keys');\n\nrequire('./_object-sap')('keys', function () {\n  return function keys(it) {\n    return $keys(toObject(it));\n  };\n});\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/es6.object.keys.js\n// module id = 661\n// module chunks = 0 1 2 3 4 5 7","'use strict';\n// ECMAScript 6 symbols shim\nvar global = require('./_global');\nvar has = require('./_has');\nvar DESCRIPTORS = require('./_descriptors');\nvar $export = require('./_export');\nvar redefine = require('./_redefine');\nvar META = require('./_meta').KEY;\nvar $fails = require('./_fails');\nvar shared = require('./_shared');\nvar setToStringTag = require('./_set-to-string-tag');\nvar uid = require('./_uid');\nvar wks = require('./_wks');\nvar wksExt = require('./_wks-ext');\nvar wksDefine = require('./_wks-define');\nvar enumKeys = require('./_enum-keys');\nvar isArray = require('./_is-array');\nvar anObject = require('./_an-object');\nvar isObject = require('./_is-object');\nvar toIObject = require('./_to-iobject');\nvar toPrimitive = require('./_to-primitive');\nvar createDesc = require('./_property-desc');\nvar _create = require('./_object-create');\nvar gOPNExt = require('./_object-gopn-ext');\nvar $GOPD = require('./_object-gopd');\nvar $DP = require('./_object-dp');\nvar $keys = require('./_object-keys');\nvar gOPD = $GOPD.f;\nvar dP = $DP.f;\nvar gOPN = gOPNExt.f;\nvar $Symbol = global.Symbol;\nvar $JSON = global.JSON;\nvar _stringify = $JSON && $JSON.stringify;\nvar PROTOTYPE = 'prototype';\nvar HIDDEN = wks('_hidden');\nvar TO_PRIMITIVE = wks('toPrimitive');\nvar isEnum = {}.propertyIsEnumerable;\nvar SymbolRegistry = shared('symbol-registry');\nvar AllSymbols = shared('symbols');\nvar OPSymbols = shared('op-symbols');\nvar ObjectProto = Object[PROTOTYPE];\nvar USE_NATIVE = typeof $Symbol == 'function';\nvar QObject = global.QObject;\n// Don't use setters in Qt Script, https://github.com/zloirock/core-js/issues/173\nvar setter = !QObject || !QObject[PROTOTYPE] || !QObject[PROTOTYPE].findChild;\n\n// fallback for old Android, https://code.google.com/p/v8/issues/detail?id=687\nvar setSymbolDesc = DESCRIPTORS && $fails(function () {\n  return _create(dP({}, 'a', {\n    get: function () { return dP(this, 'a', { value: 7 }).a; }\n  })).a != 7;\n}) ? function (it, key, D) {\n  var protoDesc = gOPD(ObjectProto, key);\n  if (protoDesc) delete ObjectProto[key];\n  dP(it, key, D);\n  if (protoDesc && it !== ObjectProto) dP(ObjectProto, key, protoDesc);\n} : dP;\n\nvar wrap = function (tag) {\n  var sym = AllSymbols[tag] = _create($Symbol[PROTOTYPE]);\n  sym._k = tag;\n  return sym;\n};\n\nvar isSymbol = USE_NATIVE && typeof $Symbol.iterator == 'symbol' ? function (it) {\n  return typeof it == 'symbol';\n} : function (it) {\n  return it instanceof $Symbol;\n};\n\nvar $defineProperty = function defineProperty(it, key, D) {\n  if (it === ObjectProto) $defineProperty(OPSymbols, key, D);\n  anObject(it);\n  key = toPrimitive(key, true);\n  anObject(D);\n  if (has(AllSymbols, key)) {\n    if (!D.enumerable) {\n      if (!has(it, HIDDEN)) dP(it, HIDDEN, createDesc(1, {}));\n      it[HIDDEN][key] = true;\n    } else {\n      if (has(it, HIDDEN) && it[HIDDEN][key]) it[HIDDEN][key] = false;\n      D = _create(D, { enumerable: createDesc(0, false) });\n    } return setSymbolDesc(it, key, D);\n  } return dP(it, key, D);\n};\nvar $defineProperties = function defineProperties(it, P) {\n  anObject(it);\n  var keys = enumKeys(P = toIObject(P));\n  var i = 0;\n  var l = keys.length;\n  var key;\n  while (l > i) $defineProperty(it, key = keys[i++], P[key]);\n  return it;\n};\nvar $create = function create(it, P) {\n  return P === undefined ? _create(it) : $defineProperties(_create(it), P);\n};\nvar $propertyIsEnumerable = function propertyIsEnumerable(key) {\n  var E = isEnum.call(this, key = toPrimitive(key, true));\n  if (this === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return false;\n  return E || !has(this, key) || !has(AllSymbols, key) || has(this, HIDDEN) && this[HIDDEN][key] ? E : true;\n};\nvar $getOwnPropertyDescriptor = function getOwnPropertyDescriptor(it, key) {\n  it = toIObject(it);\n  key = toPrimitive(key, true);\n  if (it === ObjectProto && has(AllSymbols, key) && !has(OPSymbols, key)) return;\n  var D = gOPD(it, key);\n  if (D && has(AllSymbols, key) && !(has(it, HIDDEN) && it[HIDDEN][key])) D.enumerable = true;\n  return D;\n};\nvar $getOwnPropertyNames = function getOwnPropertyNames(it) {\n  var names = gOPN(toIObject(it));\n  var result = [];\n  var i = 0;\n  var key;\n  while (names.length > i) {\n    if (!has(AllSymbols, key = names[i++]) && key != HIDDEN && key != META) result.push(key);\n  } return result;\n};\nvar $getOwnPropertySymbols = function getOwnPropertySymbols(it) {\n  var IS_OP = it === ObjectProto;\n  var names = gOPN(IS_OP ? OPSymbols : toIObject(it));\n  var result = [];\n  var i = 0;\n  var key;\n  while (names.length > i) {\n    if (has(AllSymbols, key = names[i++]) && (IS_OP ? has(ObjectProto, key) : true)) result.push(AllSymbols[key]);\n  } return result;\n};\n\n// 19.4.1.1 Symbol([description])\nif (!USE_NATIVE) {\n  $Symbol = function Symbol() {\n    if (this instanceof $Symbol) throw TypeError('Symbol is not a constructor!');\n    var tag = uid(arguments.length > 0 ? arguments[0] : undefined);\n    var $set = function (value) {\n      if (this === ObjectProto) $set.call(OPSymbols, value);\n      if (has(this, HIDDEN) && has(this[HIDDEN], tag)) this[HIDDEN][tag] = false;\n      setSymbolDesc(this, tag, createDesc(1, value));\n    };\n    if (DESCRIPTORS && setter) setSymbolDesc(ObjectProto, tag, { configurable: true, set: $set });\n    return wrap(tag);\n  };\n  redefine($Symbol[PROTOTYPE], 'toString', function toString() {\n    return this._k;\n  });\n\n  $GOPD.f = $getOwnPropertyDescriptor;\n  $DP.f = $defineProperty;\n  require('./_object-gopn').f = gOPNExt.f = $getOwnPropertyNames;\n  require('./_object-pie').f = $propertyIsEnumerable;\n  require('./_object-gops').f = $getOwnPropertySymbols;\n\n  if (DESCRIPTORS && !require('./_library')) {\n    redefine(ObjectProto, 'propertyIsEnumerable', $propertyIsEnumerable, true);\n  }\n\n  wksExt.f = function (name) {\n    return wrap(wks(name));\n  };\n}\n\n$export($export.G + $export.W + $export.F * !USE_NATIVE, { Symbol: $Symbol });\n\nfor (var es6Symbols = (\n  // 19.4.2.2, 19.4.2.3, 19.4.2.4, 19.4.2.6, 19.4.2.8, 19.4.2.9, 19.4.2.10, 19.4.2.11, 19.4.2.12, 19.4.2.13, 19.4.2.14\n  'hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables'\n).split(','), j = 0; es6Symbols.length > j;)wks(es6Symbols[j++]);\n\nfor (var wellKnownSymbols = $keys(wks.store), k = 0; wellKnownSymbols.length > k;) wksDefine(wellKnownSymbols[k++]);\n\n$export($export.S + $export.F * !USE_NATIVE, 'Symbol', {\n  // 19.4.2.1 Symbol.for(key)\n  'for': function (key) {\n    return has(SymbolRegistry, key += '')\n      ? SymbolRegistry[key]\n      : SymbolRegistry[key] = $Symbol(key);\n  },\n  // 19.4.2.5 Symbol.keyFor(sym)\n  keyFor: function keyFor(sym) {\n    if (!isSymbol(sym)) throw TypeError(sym + ' is not a symbol!');\n    for (var key in SymbolRegistry) if (SymbolRegistry[key] === sym) return key;\n  },\n  useSetter: function () { setter = true; },\n  useSimple: function () { setter = false; }\n});\n\n$export($export.S + $export.F * !USE_NATIVE, 'Object', {\n  // 19.1.2.2 Object.create(O [, Properties])\n  create: $create,\n  // 19.1.2.4 Object.defineProperty(O, P, Attributes)\n  defineProperty: $defineProperty,\n  // 19.1.2.3 Object.defineProperties(O, Properties)\n  defineProperties: $defineProperties,\n  // 19.1.2.6 Object.getOwnPropertyDescriptor(O, P)\n  getOwnPropertyDescriptor: $getOwnPropertyDescriptor,\n  // 19.1.2.7 Object.getOwnPropertyNames(O)\n  getOwnPropertyNames: $getOwnPropertyNames,\n  // 19.1.2.8 Object.getOwnPropertySymbols(O)\n  getOwnPropertySymbols: $getOwnPropertySymbols\n});\n\n// 24.3.2 JSON.stringify(value [, replacer [, space]])\n$JSON && $export($export.S + $export.F * (!USE_NATIVE || $fails(function () {\n  var S = $Symbol();\n  // MS Edge converts symbol values to JSON as {}\n  // WebKit converts symbol values to JSON as null\n  // V8 throws on boxed symbols\n  return _stringify([S]) != '[null]' || _stringify({ a: S }) != '{}' || _stringify(Object(S)) != '{}';\n})), 'JSON', {\n  stringify: function stringify(it) {\n    var args = [it];\n    var i = 1;\n    var replacer, $replacer;\n    while (arguments.length > i) args.push(arguments[i++]);\n    $replacer = replacer = args[1];\n    if (!isObject(replacer) && it === undefined || isSymbol(it)) return; // IE8 returns string on undefined\n    if (!isArray(replacer)) replacer = function (key, value) {\n      if (typeof $replacer == 'function') value = $replacer.call(this, key, value);\n      if (!isSymbol(value)) return value;\n    };\n    args[1] = replacer;\n    return _stringify.apply($JSON, args);\n  }\n});\n\n// 19.4.3.4 Symbol.prototype[@@toPrimitive](hint)\n$Symbol[PROTOTYPE][TO_PRIMITIVE] || require('./_hide')($Symbol[PROTOTYPE], TO_PRIMITIVE, $Symbol[PROTOTYPE].valueOf);\n// 19.4.3.5 Symbol.prototype[@@toStringTag]\nsetToStringTag($Symbol, 'Symbol');\n// 20.2.1.9 Math[@@toStringTag]\nsetToStringTag(Math, 'Math', true);\n// 24.3.3 JSON[@@toStringTag]\nsetToStringTag(global.JSON, 'JSON', true);\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/es6.symbol.js\n// module id = 662\n// module chunks = 0 1 5 6 7 8 9","require('./_wks-define')('asyncIterator');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/es7.symbol.async-iterator.js\n// module id = 663\n// module chunks = 0 1 5 6 7 8 9","require('./_wks-define')('observable');\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/es7.symbol.observable.js\n// module id = 664\n// module chunks = 0 1 5 6 7 8 9","/* eslint-disable */\n\n(function (factory) {\n\tif (typeof define === 'function' && define.amd) {\n\t\t// AMD. Register as an anonymous module.\n\t\tdefine(['jquery'], factory);\n\t} else if (typeof module === 'object' && module.exports) {\n\t\t// Node/CommonJS\n\t\tmodule.exports = function(root, jQuery) {\n\t\t\tif (jQuery === undefined) {\n\t\t\t\t// require('jQuery') returns a factory that requires window to\n\t\t\t\t// build a jQuery instance, we normalize how we use modules\n\t\t\t\t// that require this pattern but the window provided is a noop\n\t\t\t\t// if it's defined (how jquery works)\n\t\t\t\tif (typeof window !== 'undefined') {\n\t\t\t\t\tjQuery = require('jquery');\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tjQuery = require('jquery')(root);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfactory(jQuery);\n\t\t\treturn jQuery;\n\t\t};\n\t} else {\n\t\t// Browser globals\n\t\tfactory(jQuery);\n\t}\n}(function($) {\n\n\tvar Comments = {\n\t\t// Instance variables\n\t\t$el: null,\n\t\tcommentsById: {},\n\t\tusersById: {},\n\t\tdataFetched: false,\n\t\tcurrentSortKey: '',\n\t\toptions: {},\n\t\tevents: {\n\t\t\t// Close dropdowns\n\t\t\t'click': 'closeDropdowns',\n\t\t\t// Save comment on keydown\n\t\t\t'keydown [contenteditable]' : 'saveOnKeydown',\n\t\t\t// Listening changes in contenteditable fields (due to input event not working with IE)\n\t\t\t'focus [contenteditable]' : 'saveEditableContent',\n\t\t\t'keyup [contenteditable]' : 'checkEditableContentForChange',\n\t\t\t'paste [contenteditable]' : 'checkEditableContentForChange',\n\t\t\t'input [contenteditable]' : 'checkEditableContentForChange',\n\t\t\t'blur [contenteditable]' : 'checkEditableContentForChange',\n\t\t\t// Navigation\n\t\t\t'click .navigation li[data-sort-key]' : 'navigationElementClicked',\n\t\t\t'click .navigation li.title' : 'toggleNavigationDropdown',\n\t\t\t// Main comenting field\n\t\t\t'click .commenting-field.main .textarea': 'showMainCommentingField',\n\t\t\t'click .commenting-field.main .close' : 'hideMainCommentingField',\n\t\t\t// All commenting fields\n\t\t\t'click .commenting-field .textarea' : 'increaseTextareaHeight',\n\t\t\t'change .commenting-field .textarea' : 'increaseTextareaHeight textareaContentChanged',\n\t\t\t'click .commenting-field:not(.main) .close' : 'removeCommentingField',\n\t\t\t// Edit mode actions\n\t\t\t'click .commenting-field .send.enabled' : 'postComment',\n\t\t\t'click .commenting-field .update.enabled' : 'putComment',\n\t\t\t'click .commenting-field .delete.enabled' : 'deleteComment',\n\t\t\t'change .commenting-field .upload.enabled input[type=\"file\"]' : 'fileInputChanged',\n\t\t\t// Other actions\n\t\t\t'click li.comment button.upvote' : 'upvoteComment',\n\t\t\t'click li.comment button.delete.enabled' : 'deleteComment',\n\t\t\t'click li.comment .hashtag' : 'hashtagClicked',\n\t\t\t'click li.comment .ping' : 'pingClicked',\n\t\t\t// Other\n\t\t\t'click li.comment ul.child-comments .toggle-all': 'toggleReplies',\n\t\t\t'click li.comment button.reply': 'replyButtonClicked',\n\t\t\t'click li.comment button.edit': 'editButtonClicked',\n\t\t\t// Drag & dropping attachments\n\t\t\t'dragenter' : 'showDroppableOverlay',\n\t\t\t'dragenter .droppable-overlay' : 'handleDragEnter',\n\t\t\t'dragleave .droppable-overlay' : 'handleDragLeaveForOverlay',\n\t\t\t'dragenter .droppable-overlay .droppable' : 'handleDragEnter',\n\t\t\t'dragleave .droppable-overlay .droppable' : 'handleDragLeaveForDroppable',\n\t\t\t'dragover .droppable-overlay' : 'handleDragOverForOverlay',\n\t\t\t'drop .droppable-overlay' : 'handleDrop',\n\t\t\t// Prevent propagating the click event into buttons under the autocomplete dropdown\n\t\t\t'click .dropdown.autocomplete': 'stopPropagation',\n\t\t\t'mousedown .dropdown.autocomplete': 'stopPropagation',\n\t\t\t'touchstart .dropdown.autocomplete': 'stopPropagation',\n\t\t},\n\t\t// Default options\n\n\t\tgetDefaultOptions: function() {\n\t\t\treturn {\n\t\t\t\t// User        \n\t\t\t\tprofilePictureURL: '',\n\t\t\t\tcurrentUserIsAdmin: false,\n\t\t\t\tcurrentUserId: null,\n\t\t\t\t// Font awesome icon overrides        \n\t\t\t\tspinnerIconURL: '',\n\t\t\t\tupvoteIconURL: '',\n\t\t\t\treplyIconURL: '',\n\t\t\t\tuploadIconURL: '',\n\t\t\t\tattachmentIconURL: '',\n\t\t\t\tfileIconURL: '',\n\t\t\t\tnoCommentsIconURL: '',\n\t\t\t\tnoCommentsImptIconURL: '',\n\t\t\t\t// Strings to be formatted (for example localization)     \n\t\t\t\ttextareaPlaceholderText: 'Thêm bình luận mới',\n\t\t\t\tnewestText: 'Mới nhất',\n\t\t\t\toldestText: 'Cũ nhất',\n\t\t\t\timportantCmtText: 'Ý kiến chính thức',\n\t\t\t\tpopularText: 'Phổ biến',\n\t\t\t\tattachmentsText: 'Tệp đính kèm',\n\t\t\t\tsendText: 'Gửi',\n\t\t\t\treplyText: 'Trả lời',\n\t\t\t\teditText: 'Sửa',\n\t\t\t\teditedText: 'Đã sửa',\n\t\t\t\tyouText: 'You',\n\t\t\t\tsaveText: 'Ghi lại',\n\t\t\t\tdeleteText: 'Xoá',\n\t\t\t\tnewText: 'Mới',\n\t\t\t\tviewAllRepliesText: 'Xem tất cả __replyCount__ trả lời',\n\t\t\t\thideRepliesText: 'Hide replies',\n\t\t\t\tnoCommentsText: 'Không có bình luận',\n\t\t\t\tnoCommentsImportantText: 'Không có ý kiến chính thức',\n\t\t\t\tnoAttachmentsText: 'Không có tệp đính kèm',\n\t\t\t\tattachmentDropText: 'Kéo thả tệp để tải lên',\n\t\t\t\ttextFormatter: function(text) {return text},\n\t\t\t\t\n\t\t\t\t// Functionalities        \n\t\t\t\tenableReplying: true,\n\t\t\t\tenableEditing: true,\n\t\t\t\tenableUpvoting: true,\n\t\t\t\tenableDeleting: true,\n\t\t\t\tenableAttachments: false,\n\t\t\t\tenableHashtags: false,\n\t\t\t\tenablePinging: false,\n\t\t\t\tenableDeletingCommentWithReplies: false,\n\t\t\t\tenableNavigation: true,\n\t\t\t\tpostCommentOnEnter: false,\n\t\t\t\tforceResponsive: false,\n\t\t\t\treadOnly: false,\n\t\t\t\tdefaultNavigationSortKey: 'newest',\n\t\t\t\t// Colors     \n\t\t\t\thighlightColor: '#2793e6',\n\t\t\t\tdeleteButtonColor: '#C9302C',\n\t\t\t\tscrollContainer: this.$el,\n\t\t\t\troundProfilePictures: false,\n\t\t\t\ttextareaRows: 2,\n\t\t\t\ttextareaRowsOnFocus: 2,\n\t\t\t\ttextareaMaxRows: 5,\n\t\t\t\tmaxRepliesVisible: 2,\n\t\t\t\t\n\t\t\t\tfieldMappings: {\n\t\t\t\t\tid: 'id',\n\t\t\t\t\tparent: 'parent',\n\t\t\t\t\tcreated: 'createdDate',\n\t\t\t\t\tmodified: 'modifiedDate',\n\t\t\t\t\tcontent: 'content',\n\t\t\t\t\tfile: 'file',\n\t\t\t\t\tfileURL: 'file_url',\n\t\t\t\t\tfileMimeType: 'file_mime_type',\n\t\t\t\t\tpings: 'pings',\n\t\t\t\t\tcreator: 'creator',\n\t\t\t\t\tfullname: 'fullname',\n\t\t\t\t\tprofileURL: 'profile_url',\n\t\t\t\t\tprofilePictureURL: 'profile_picture_url',\n\t\t\t\t\tisNew: 'is_new',\n\t\t\t\t\tcreatedByAdmin: 'created_by_admin',\n\t\t\t\t\tcreatedByCurrentUser: 'created_by_current_user',\n\t\t\t\t\tupvoteCount: 'upvote_count',\n\t\t\t\t\tuserHasUpvoted: 'user_has_upvoted'\n\t\t\t\t},\n\t\t\t\t\n\t\t\t\tgetUsers: function(success, error) {success([])},\n\t\t\t\tgetComments: function(success, error) {success([])},\n\t\t\t\tpostComment: function(commentJSON, success, error) {success(commentJSON)},\n\t\t\t\tputComment: function(commentJSON, success, error) {success(commentJSON)},\n\t\t\t\tdeleteComment: function(commentJSON, success, error) {success()},\n\t\t\t\tupvoteComment: function(commentJSON, success, error) {success(commentJSON)},\n\t\t\t\thashtagClicked: function(hashtag) {},\n\t\t\t\tpingClicked: function(userId) {},\n\t\t\t\tuploadAttachments: function(commentArray, success, error) {success(commentArray)},\n\t\t\t\trefresh: function() {},\n\t\t\t\ttimeFormatter: function(time) {return new Date(time).toLocaleDateString()},\n\t\t\t\tappendNewComments: function(commentJSONs, success, error) {success([])}\n\t\t\t}\n\t\t},\n\n\t\t// Initialization\n\t\tinit: function(options, el) {\n\t\t\tthis.$el = $(el);\n\t\t\tthis.$el.addClass('jquery-comments');\n\t\t\tthis.undelegateEvents();\n\t\t\tthis.delegateEvents();\n\t\t\t// Detect mobile devices\n\t\t\t(function(a){(jQuery.browser=jQuery.browser||{}).mobile=/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(a.substr(0,4))})(navigator.userAgent||navigator.vendor||window.opera);\n\t\t\tif($.browser.mobile) this.$el.addClass('mobile');\n\t\t\t// Init options\n\t\t\tthis.options = $.extend(true, {}, this.getDefaultOptions(), options);;\n\t\t\t// Read-only mode\n\t\t\tif(this.options.readOnly) this.$el.addClass('read-only');\n\t\t\t// Set initial sort key\n\t\t\tthis.currentSortKey = this.options.defaultNavigationSortKey;\n\t\t\t// Create CSS declarations for highlight color\n\t\t\tthis.createCssDeclarations();\n\t\t\t// Fetching data and rendering\n\t\t\tthis.fetchDataAndRender();\n\t\t},\n\n\t\tdelegateEvents: function() {\n\t\t\tthis.bindEvents(false);\n\t\t},\n\n\t\tundelegateEvents: function() {\n\t\t\tthis.bindEvents(true);\n\t\t},\n\n\t\tbindEvents: function(unbind) {\n\t\t\t\tvar bindFunction = unbind ? 'off' : 'on';\n\t\t\t\tfor (var key in this.events) {\n\t\t\t\t\t\tvar eventName = key.split(' ')[0];\n\t\t\t\t\t\tvar selector = key.split(' ').slice(1).join(' ');\n\t\t\t\t\t\tvar methodNames = this.events[key].split(' ');\n\n\t\t\t\t\t\tfor(var index in methodNames) {\n\t\t\t\t\t\t\t\tif(methodNames.hasOwnProperty(index)) {\n\t\t\t\t\t\t\t\t\t\tvar method = this[methodNames[index]];\n\n\t\t\t\t\t\t\t\t\t\t// Keep the context\n\t\t\t\t\t\t\t\t\t\tmethod = $.proxy(method, this);\n\n\t\t\t\t\t\t\t\t\t\tif (selector == '') {\n\t\t\t\t\t\t\t\t\t\t\t\tthis.$el[bindFunction](eventName, method);\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\tthis.$el[bindFunction](eventName, selector, method);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t}\n\t\t},\n\n\t\t// Basic functionalities\n\t\tfetchDataAndRender: function () {\n\t\t\tvar self = this;\n\t\t\tsetTimeout(function(){self.appendNewComments()},30000);\n\t\t\tthis.commentsById = {};\n\t\t\tthis.usersById = {};\n\t\t\tthis.$el.empty();\n\t\t\tthis.createHTML();\n\t\t\t// Render after data has been fetched\n\t\t\tvar dataFetched = this.after(this.options.enablePinging ? 2 : 1, function() {\n\t\t\t\tself.dataFetched = true;\n\t\t\t\tself.render();\n\t\t\t});\n\n\t\t\t// Comments\n\t\t\tvar commentsFetched = function(commentsArray) {\n\t\t\t\t// Convert comments to custom data model\n\t\t\t\tvar commentModels = commentsArray.map(function(commentsJSON){\n\t\t\t\t\treturn self.createCommentModel(commentsJSON)\n\t\t\t\t});\n\t\t\t\t// Sort comments by date (oldest first so that they can be appended to the data model\n\t\t\t\t// without caring dependencies)\n\t\t\t\tself.sortComments(commentModels, 'oldest');\n\t\t\t\t$(commentModels).each(function(index, commentModel) {\n\t\t\t\t\t\tself.addCommentToDataModel(commentModel);\n\t\t\t\t});\n\t\t\t\tdataFetched();\n\t\t\t};\n\t\t\tthis.options.getComments(commentsFetched, dataFetched);\n\n\t\t\t// Users\n\t\t\tif(this.options.enablePinging) {\n\t\t\t\tvar usersFetched = function(userArray) {\n\t\t\t\t\t$(userArray).each(function(index, user) {\n\t\t\t\t\t\tself.usersById[user.id] = user;\n\t\t\t\t\t});\n\t\t\t\t\tdataFetched();\n\t\t\t\t}\n\t\t\t\tthis.options.getUsers(usersFetched, dataFetched);\n\t\t\t};\n\t\t},\n\n\t\tfetchNext: function() {\n\t\t\tvar self = this;\n\t\t\t// Loading indicator\n\t\t\tvar spinner = this.createSpinner();\n\t\t\tthis.$el.find('ul#comment-list').append(spinner);\n\t\t\tvar success = function (commentModels) {\n\t\t\t\t$(commentModels).each(function(index, commentModel) {\n\t\t\t\t\tself.createComment(commentModel);\n\t\t\t\t});\n\t\t\t\tspinner.remove();\n\t\t\t}\n\n\t\t\tvar error = function() {\n\t\t\t\tspinner.remove();\n\t\t\t}\n\t\t\tthis.options.getComments(success, error);\n\t\t},\n\n\t\tcreateCommentModel: function(commentJSON) {\n\t\t\tvar commentModel = this.applyInternalMappings(commentJSON);\n\t\t\tcommentModel.childs = [];\n\t\t\tthis.commentsById[commentModel.id] = commentModel;\n\t\t\treturn commentModel;\n\t\t},\n\n\t\taddCommentToDataModel: function(commentModel) {\n\t\t\tif(!(commentModel.id in this.commentsById)) {\n\t\t\t\tthis.commentsById[commentModel.id] = commentModel;\n\n\t\t\t\t// Update child array of the parent (append childs to the array of outer most parent)\n\t\t\t\tif(commentModel.parent) {\n\t\t\t\t\tvar outermostParent = this.getOutermostParent(commentModel.parent);\n\t\t\t\t\toutermostParent.childs.push(commentModel.id);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tupdateCommentModel: function(commentModel) {\n\t\t\t$.extend(this.commentsById[commentModel.id], commentModel);\n\t\t},\n\n\t\trender: function() {\n\t\t\tvar self = this;\n\t\t\t// Prevent re-rendering if data hasn't been fetched\n\t\t\tif(!this.dataFetched) return;\n\t\t\t// Show active container\n\t\t\tthis.showActiveContainer();\n\t\t\t// Create comments\n\t\t\tthis.createComments();\n\t\t\t// Create attachments if enabled\n\t\t\tif(this.options.enableAttachments) this.createAttachments(); \n\t\t\t// Create important comment\n\t\t\tthis.createImportantComments();\n\t\t\t// Remove spinner\n\t\t\tthis.$el.find('> .spinner').remove();\n\t\t\tthis.options.refresh();\n\t\t},\n\n\t\tshowActiveContainer: function() {\n\t\t\tvar activeNavigationEl = this.$el.find('.navigation li[data-container-name].active');\n\t\t\tvar containerName = activeNavigationEl.data('container-name');\n\t\t\tvar containerEl = this.$el.find('[data-container=\"' + containerName + '\"]');\n\t\t\tcontainerEl.siblings('[data-container]').hide();\n\t\t\tcontainerEl.show();\n\t\t},\n\n\t\tcreateComments: function() {\n\t\t\tvar self = this;\n\t\t\t// Create the list element before appending to DOM in order to reach better performance\n\t\t\tthis.$el.find('#comment-list').remove();\n\t\t\tvar commentList = $('<ul/>', {\n\t\t\t\tid: 'comment-list',\n\t\t\t\t'class': 'main'\n\t\t\t});\n\n\t\t\t// Divide commments into main level comments and replies\n\t\t\tvar mainLevelComments = [];\n\t\t\tvar replies = [];\n\n\t\t\t$(this.getComments()).each(function(index, commentModel) {\n\t\t\t\tif(commentModel.parent == null) {\n\t\t\t\t\tmainLevelComments.push(commentModel);\n\t\t\t\t} else {\n\t\t\t\t\treplies.push(commentModel);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Append main level comments\n\t\t\tthis.sortComments(mainLevelComments, this.currentSortKey);\n\t\t\tmainLevelComments.reverse();    // Reverse the order as they are prepended to DOM\n\t\t\t$(mainLevelComments).each(function(index, commentModel) {\n\t\t\t\tself.addComment(commentModel, commentList);\n\t\t\t});\n\n\t\t\t// Append replies in chronological order\n\t\t\tthis.sortComments(replies, 'oldest');\n\t\t\t$(replies).each(function(index, commentModel) {\n\t\t\t\tself.addComment(commentModel, commentList);\n\t\t\t});\n\n\t\t\t// Appned list to DOM\n\t\t\tthis.$el.find('[data-container=\"comments\"]').prepend(commentList);\n\t\t},\n\n\t\tcreateAttachments: function() {\n\t\t\tvar self = this;\n\t\t\t// Create the list element before appending to DOM in order to reach better performance\n\t\t\tthis.$el.find('#attachment-list').remove();\n\t\t\tvar attachmentList = $('<ul/>', {\n\t\t\t\tid: 'attachment-list',\n\t\t\t\t'class': 'main'\n\t\t\t});\n\n\t\t\tvar attachments = this.getAttachments();\n\t\t\tthis.sortComments(attachments, 'newest');\n\t\t\tattachments.reverse();    // Reverse the order as they are prepended to DOM\n\t\t\t$(attachments).each(function(index, commentModel) {\n\t\t\t\tself.addAttachment(commentModel, attachmentList);\n\t\t\t});\n\n\t\t\t// Appned list to DOM\n\t\t\tthis.$el.find('[data-container=\"attachments\"]').prepend(attachmentList);\n\t\t},\n\t\tcreateImportantComments: function() {\n\t\t\tvar self = this;\n\t\t\t// Create the list element before appending to DOM in order to reach better performance\n\t\t\tthis.$el.find('#importantCmt-list').remove();\n\t\t\tvar importantCmtList = $('<ul/>', {\n\t\t\t\t\tid: 'importantCmt-list',\n\t\t\t\t\t'class': 'main'\n\t\t\t});\n\n\t\t\tvar importantCmt = this.getImportantCmt();\n\n\t\t\tthis.sortComments(importantCmt, 'newest');\n\t\t\timportantCmt.reverse();    // Reverse the order as they are prepended to DOM\n\t\t\t$(importantCmt).each(function(index, commentModel) {\n\t\t\t\t\tself.addImportantCmt(commentModel, importantCmtList);\n\t\t\t});\n\n\t\t\t// Appned list to DOM\n\t\t\tthis.$el.find('[data-container=\"importantCmt\"]').prepend(importantCmtList);\n\t\t},\n\t\taddComment: function(commentModel, commentList) {\n\t\t\tcommentList = commentList || this.$el.find('#comment-list');\n\t\t\tvar commentEl = this.createCommentElement(commentModel);\n\n\t\t\t// Case: reply\n\t\t\tif(commentModel.parent) {\n\t\t\t\tvar directParentEl = commentList.find('.comment[data-id=\"'+commentModel.parent+'\"]');\n\n\t\t\t\t// Re-render action bar of direct parent element\n\t\t\t\tthis.reRenderCommentActionBar(commentModel.parent);\n\n\t\t\t\t// Force replies into one level only\n\t\t\t\tvar outerMostParent = directParentEl.parents('.comment').last();\n\t\t\t\tif(outerMostParent.length == 0) outerMostParent = directParentEl;\n\n\t\t\t\t// Append element to DOM\n\t\t\t\tvar childCommentsEl = outerMostParent.find('.child-comments');\n\t\t\t\tvar commentingField = childCommentsEl.find('.commenting-field');\n\t\t\t\tif(commentingField.length) {\n\t\t\t\t\tcommentingField.before(commentEl)\n\t\t\t\t} else {\n\t\t\t\t\tchildCommentsEl.append(commentEl);\n\t\t\t\t}\n\n\t\t\t\t// Update toggle all -button\n\t\t\t\tthis.updateToggleAllButton(outerMostParent);\n\n\t\t\t// Case: main level comment\n\t\t\t} else {\n\t\t\t\tcommentList.prepend(commentEl);\n\t\t\t}\n\t\t},\n\t\taddAttachment: function(commentModel, commentList) {\n\t\t\tcommentList = commentList || this.$el.find('#attachment-list');\n\t\t\tvar commentEl = this.createCommentElement(commentModel);\n\t\t\tcommentList.prepend(commentEl);\n\t\t},\n\t\taddImportantCmt: function(commentModel, commentList) {\n\t\t\tcommentList = commentList || this.$el.find('#importantCmt-list');\n\t\t\tvar commentEl = this.createCommentElement(commentModel);\n\t\t\tcommentList.prepend(commentEl);\n\t\t},\n\t\tremoveComment: function(commentId) {\n\t\t\tvar self = this;\n\t\t\tvar commentModel = this.commentsById[commentId];\n\n\t\t\t// Remove child comments recursively\n\t\t\tvar childComments = this.getChildComments(commentModel.id);\n\t\t\t$(childComments).each(function(index, childComment) {\n\t\t\t\tself.removeComment(childComment.id);\n\t\t\t});\n\n\t\t\t// Update the child array of outermost parent\n\t\t\tif(commentModel.parent) {\n\t\t\t\tvar outermostParent = this.getOutermostParent(commentModel.parent);\n\t\t\t\tvar indexToRemove = outermostParent.childs.indexOf(commentModel.id);\n\t\t\t\toutermostParent.childs.splice(indexToRemove, 1);\n\t\t\t}\n\n\t\t\t// Remove the comment from data model\n\t\t\tdelete this.commentsById[commentId];\n\t\t\tvar commentElements = this.$el.find('li.comment[data-id=\"'+commentId+'\"]');\n\t\t\tvar parentEl = commentElements.parents('li.comment').last();\n\n\t\t\t// Remove the element\n\t\t\tcommentElements.remove();\n\n\t\t\t// Update the toggle all button\n\t\t\tthis.updateToggleAllButton(parentEl);\n\t\t},\n\n\t\tuploadAttachments: function(files, commentingField) {\n\t\t\tvar self = this;\n\t\t\tif(!commentingField) commentingField = this.$el.find('.commenting-field.main');\n\t\t\tvar isReply = !commentingField.hasClass('main');\n\t\t\tvar fileCount = files.length;\n\n\t\t\tif(fileCount) {\n\t\t\t\tvar uploadButton = commentingField.find('.upload');\n\t\t\t\tvar textarea = commentingField.find('.textarea');\n\n\t\t\t\t// Disable upload button and append spinners while request is pending\n\t\t\t\tuploadButton.removeClass('enabled');\n\t\t\t\tvar attachmentListSpinner = this.createSpinner();\n\t\t\t\tvar commentListSpinner = this.createSpinner();\n\t\t\t\tthis.$el.find('ul#attachment-list').prepend(attachmentListSpinner);\n\t\t\t\tif(isReply) {\n\t\t\t\t\tcommentingField.before(commentListSpinner);\n\t\t\t\t} else {\n\t\t\t\t\tthis.$el.find('ul#comment-list').prepend(commentListSpinner);\n\t\t\t\t}\n\n\t\t\t\tvar success = function(commentArray) {\n\t\t\t\t\t$(commentArray).each(function(index, commentJSON) {\n\t\t\t\t\t\tvar commentModel = self.createCommentModel(commentJSON);\n\t\t\t\t\t\tself.addCommentToDataModel(commentModel);\n\t\t\t\t\t\tself.addComment(commentModel);\n\t\t\t\t\t\tself.addAttachment(commentModel);\n\t\t\t\t\t});\n\n\t\t\t\t\t// Close the commenting field if all the uploads were successfull\n\t\t\t\t\t// and there's no content besides the attachment\n\t\t\t\t\tif(commentArray.length == fileCount && self.getTextareaContent(textarea).length == 0) {\n\t\t\t\t\t\tcommentingField.find('.close').trigger('click');\n\t\t\t\t\t}\n\n\t\t\t\t\t// Enable upload button and remove spinners\n\t\t\t\t\tuploadButton.addClass('enabled');\n\t\t\t\t\tcommentListSpinner.remove();\n\t\t\t\t\tattachmentListSpinner.remove();\n\t\t\t\t};\n\n\t\t\t\tvar error = function() {\n\t\t\t\t\t// Enable upload button and remove spinners\n\t\t\t\t\tuploadButton.addClass('enabled');\n\t\t\t\t\tcommentListSpinner.remove();\n\t\t\t\t\tattachmentListSpinner.remove();\n\t\t\t\t};\n\n\t\t\t\tvar commentArray = [];\n\t\t\t\t$(files).each(function(index, file) {\n\t\t\t\t\t// Create comment JSON\n\t\t\t\t\tvar commentJSON = self.createCommentJSON(textarea);\n\t\t\t\t\tcommentJSON.id += '-' + index;\n\t\t\t\t\tcommentJSON.content = '';\n\t\t\t\t\tcommentJSON.file = file;\n\t\t\t\t\tcommentJSON.fileURL = 'C:/fakepath/' + file.name;\n\t\t\t\t\tcommentJSON.fileMimeType = file.type;\n\t\t\t\t\t// Reverse mapping\n\t\t\t\t\tcommentJSON = self.applyExternalMappings(commentJSON);\n\t\t\t\t\tcommentArray.push(commentJSON);\n\t\t\t\t});\n\n\t\t\t\tself.options.uploadAttachments(commentArray, success, error);\n\t\t\t}\n\n\t\t\t// Clear the input field\n\t\t\tuploadButton.find('input').val('');\n\t\t},\n\n\t\tupdateToggleAllButton: function(parentEl) {\n\t\t\t// Don't hide replies if maxRepliesVisible is null or undefined\n\t\t\tif (this.options.maxRepliesVisible == null) return;\n\n\t\t\tvar childCommentsEl = parentEl.find('.child-comments');\n\t\t\tvar childComments = childCommentsEl.find('.comment');\n\t\t\tvar toggleAllButton = childCommentsEl.find('li.toggle-all');\n\t\t\tchildComments.removeClass('hidden-reply');\n\n\t\t\t// Select replies to be hidden\n\t\t\tif (this.options.maxRepliesVisible === 0) {\n\t\t\t\tvar hiddenReplies = childComments;\n\t\t\t} else {\n\t\t\t\tvar hiddenReplies = childComments.slice(0, -this.options.maxRepliesVisible);\n\t\t\t}\n\n\t\t\t// Add identifying class for hidden replies so they can be toggled\n\t\t\thiddenReplies.addClass('hidden-reply');\n\n\t\t\t// Show all replies if replies are expanded\n\t\t\tif(toggleAllButton.find('span.text').text() == this.options.textFormatter(this.options.hideRepliesText)) {\n\t\t\t\thiddenReplies.addClass('visible');\n\t\t\t}\n\n\t\t\t// Make sure that toggle all button is present\n\t\t\tif(childComments.length > this.options.maxRepliesVisible) {\n\n\t\t\t\t// Append button to toggle all replies if necessary\n\t\t\t\tif(!toggleAllButton.length) {\n\n\t\t\t\t\ttoggleAllButton = $('<li/>', {\n\t\t\t\t\t\t'class': 'toggle-all highlight-font-bold'\n\t\t\t\t\t});\n\t\t\t\t\tvar toggleAllButtonText = $('<span/>', {\n\t\t\t\t\t\t'class': 'text'\n\t\t\t\t\t});\n\t\t\t\t\tvar caret = $('<span/>', {\n\t\t\t\t\t\t'class': 'caret'\n\t\t\t\t\t});\n\n\t\t\t\t\t// Append toggle button to DOM\n\t\t\t\t\ttoggleAllButton.append(toggleAllButtonText).append(caret);\n\t\t\t\t\tchildCommentsEl.prepend(toggleAllButton);\n\t\t\t\t}\n\n\t\t\t\t// Update the text of toggle all -button\n\t\t\t\tthis.setToggleAllButtonText(toggleAllButton, false);\n\t\t\t// Make sure that toggle all button is not present\n\t\t\t} else {\n\t\t\t\ttoggleAllButton.remove();\n\t\t\t}\n\t\t},\n\n\t\tsortComments: function (comments, sortKey) {\n\t\t\tvar self = this;\n\t\t\t// Sort by popularity\n\t\t\tif(sortKey == 'popularity') {\n\t\t\t\tcomments.sort(function(commentA, commentB) {\n\t\t\t\t\tvar pointsOfA = commentA.childs.length;\n\t\t\t\t\tvar pointsOfB = commentB.childs.length;\n\n\t\t\t\t\tif(self.options.enableUpvoting) {\n\t\t\t\t\t\tpointsOfA += commentA.upvoteCount;\n\t\t\t\t\t\tpointsOfB += commentB.upvoteCount;\n\t\t\t\t\t}\n\n\t\t\t\t\tif(pointsOfB != pointsOfA) {\n\t\t\t\t\t\treturn pointsOfB - pointsOfA;\n\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Return newer if popularity is the same\n\t\t\t\t\t\tvar createdA = new Date(commentA.created).getTime();\n\t\t\t\t\t\tvar createdB = new Date(commentB.created).getTime();\n\t\t\t\t\t\treturn createdB - createdA;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t// Sort by date\n\t\t\t} else {\n\t\t\t\tcomments.sort(function(commentA, commentB) {\n\t\t\t\t\tvar createdA = (new Date(commentA.created)).getTime();\n\t\t\t\t\tvar createdB = (new Date(commentB.created)).getTime();\n\t\t\t\t\tif(sortKey == 'oldest') {\n\t\t\t\t\t\treturn createdA - createdB;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn createdB - createdA;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\tsortUsers: function(users) {\n\t\t\tusers.sort(function(a,b) {\n\t\t\t\tvar nameA = a.fullname.toLowerCase().trim();\n\t\t\t\tvar nameB = b.fullname.toLowerCase().trim();\n\t\t\t\tif(nameA < nameB) return -1;\n\t\t\t\tif(nameA > nameB) return 1;\n\t\t\t\treturn 0;\n\t\t\t});\n\t\t},\n\n\t\tsortAndReArrangeComments: function(sortKey) {\n\t\t\tvar commentList = this.$el.find('#comment-list');\n\n\t\t\t// Get main level comments\n\t\t\tvar mainLevelComments = this.getComments().filter(function(commentModel){return !commentModel.parent});\n\t\t\tthis.sortComments(mainLevelComments, sortKey);\n\n\t\t\t// Rearrange the main level comments\n\t\t\t$(mainLevelComments).each(function(index, commentModel) {\n\t\t\t\t\tvar commentEl = commentList.find('> li.comment[data-id='+commentModel.id+']');\n\t\t\t\t\tcommentList.append(commentEl);\n\t\t\t});\n\t\t},\n\n\t\tshowActiveSort: function() {\n\t\t\tvar activeElements = this.$el.find('.navigation li[data-sort-key=\"' + this.currentSortKey + '\"]');\n\n\t\t\t// Indicate active sort\n\t\t\tthis.$el.find('.navigation li').removeClass('active');\n\t\t\tactiveElements.addClass('active');\n\n\t\t\t// Update title for dropdown\n\t\t\tvar titleEl = this.$el.find('.navigation .title');\n\t\t\tif(this.currentSortKey != 'attachments') {\n\t\t\t\ttitleEl.addClass('active');\n\t\t\t\ttitleEl.find('header').html(activeElements.first().html());\n\t\t\t} else {\n\t\t\t\tvar defaultDropdownEl = this.$el.find('.navigation ul.dropdown').children().first();\n\t\t\t\ttitleEl.find('header').html(defaultDropdownEl.html());\n\t\t\t} \n\n\t\t\t// Show active container\n\t\t\tthis.showActiveContainer();\n\t\t},\n\n\t\tforceResponsive: function() {\n\t\t\tthis.$el.addClass('responsive');\n\t\t},\n\n\t\t// Event handlers\n\n\t\tcloseDropdowns: function() {\n\t\t\tthis.$el.find('.dropdown').hide();\n\t\t},\n\n\t\tsaveOnKeydown: function(ev) {\n\t\t\t// Save comment on cmd/ctrl + enter\n\t\t\tif(ev.keyCode == 13) {\n\t\t\t\tvar metaKey = ev.metaKey || ev.ctrlKey;\n\t\t\t\tif(this.options.postCommentOnEnter || metaKey) {                \n\t\t\t\t\tvar el = $(ev.currentTarget);\n\t\t\t\t\tel.siblings('.control-row').find('.save').trigger('click');\n\t\t\t\t\tev.stopPropagation();\n\t\t\t\t\tev.preventDefault();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\tsaveEditableContent: function(ev) {\n\t\t\tvar el = $(ev.currentTarget);\n\t\t\tel.data('before', el.html());\n\t\t},\n\n\t\tcheckEditableContentForChange: function(ev) {\n\t\t\tvar el = $(ev.currentTarget);\n\t\t\tif (el.data('before') != el.html()) {\n\t\t\t\tel.data('before', el.html());\n\t\t\t\tel.trigger('change');\n\t\t\t}\n\t\t},\n\n\t\tnavigationElementClicked: function(ev) {\n\t\t\tvar navigationEl = $(ev.currentTarget);\n\t\t\tvar sortKey = navigationEl.data().sortKey;\n\n\t\t\t// Sort the comments if necessary\n\t\t\tif(sortKey != 'attachments') {\n\t\t\t\t\tthis.sortAndReArrangeComments(sortKey);\n\t\t\t}\n\t\t\t// Save the current sort key\n\t\t\tthis.currentSortKey = sortKey;\n\t\t\tthis.showActiveSort();\n\t\t},\n\n\t\ttoggleNavigationDropdown: function(ev) {\n\t\t\t// Prevent closing immediately\n\t\t\tev.stopPropagation();\n\n\t\t\tvar dropdown = $(ev.currentTarget).find('~ .dropdown');\n\t\t\tdropdown.toggle();\n\t\t},\n\n\t\tshowMainCommentingField: function(ev) {\n\t\t\tvar mainTextarea = $(ev.currentTarget);\n\t\t\tmainTextarea.siblings('.control-row').show();\n\t\t\tmainTextarea.parent().find('.close').show();\n\t\t\tmainTextarea.focus();\n\t\t},\n\n\t\thideMainCommentingField: function(ev) {\n\t\t\tvar closeButton = $(ev.currentTarget);\n\t\t\tvar mainTextarea = this.$el.find('.commenting-field.main .textarea');\n\t\t\tvar mainControlRow = this.$el.find('.commenting-field.main .control-row');\n\n\t\t\tthis.clearTextarea(mainTextarea);\n\t\t\tthis.adjustTextareaHeight(mainTextarea, false);\n\n\t\t\tmainControlRow.hide();\n\t\t\tcloseButton.hide();\n\t\t\tmainTextarea.blur();\n\t\t},\n\n\t\tincreaseTextareaHeight: function(ev) {\n\t\t\tvar textarea = $(ev.currentTarget);\n\t\t\tthis.adjustTextareaHeight(textarea, true);\n\t\t},\n\n\t\ttextareaContentChanged: function(ev) {\n\t\t\tvar textarea = $(ev.currentTarget);\n\t\t\tvar saveButton = textarea.siblings('.control-row').find('.save');\n\n\t\t\t// Update parent id if reply-to tag was removed\n\t\t\tif(!textarea.find('.reply-to.tag').length) {\n\t\t\t\tvar commentId = textarea.attr('data-comment');\n\n\t\t\t\t// Case: editing comment\n\t\t\t\tif(commentId) {\n\t\t\t\t\tvar parentComments = textarea.parents('li.comment');\n\t\t\t\t\tif(parentComments.length > 1) {\n\t\t\t\t\t\tvar parentId = parentComments.last().data('id');\n\t\t\t\t\t\ttextarea.attr('data-parent', parentId);\n\t\t\t\t\t}\n\n\t\t\t\t// Case: new comment\n\t\t\t\t} else {\n\t\t\t\t\tvar parentId = textarea.parents('li.comment').last().data('id');\n\t\t\t\t\ttextarea.attr('data-parent', parentId);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Move close button if scrollbar is visible\n\t\t\tvar commentingField = textarea.parents('.commenting-field').first();\n\t\t\tif(textarea[0].scrollHeight > textarea.outerHeight()) {\n\t\t\t\tcommentingField.addClass('scrollable');\n\t\t\t} else {\n\t\t\t\tcommentingField.removeClass('scrollable');\n\t\t\t}\n\n\t\t\t// Check if content or parent has changed if editing\n\t\t\tvar contentOrParentChangedIfEditing = true;\n\t\t\tvar content = this.getTextareaContent(textarea, true);\n\t\t\tif(commentId = textarea.attr('data-comment')) {\n\t\t\t\tvar contentChanged = content != this.commentsById[commentId].content;\n\t\t\t\tvar parentFromModel;\n\t\t\t\tif(this.commentsById[commentId].parent) {\n\t\t\t\t\tparentFromModel = this.commentsById[commentId].parent.toString();\n\t\t\t\t}\n\t\t\t\tvar parentChanged = textarea.attr('data-parent') != parentFromModel;\n\t\t\t\tcontentOrParentChangedIfEditing = contentChanged || parentChanged;\n\t\t\t}\n\n\t\t\t// Check whether save button needs to be enabled\n\t\t\tif(content.length && contentOrParentChangedIfEditing) {\n\t\t\t\tsaveButton.addClass('enabled');\n\t\t\t} else {\n\t\t\t\tsaveButton.removeClass('enabled');\n\t\t\t}\n\t\t},\n\n\t\tremoveCommentingField: function(ev) {\n\t\t\tvar closeButton = $(ev.currentTarget);\n\n\t\t\t// Remove edit class from comment if user was editing the comment\n\t\t\tvar textarea = closeButton.siblings('.textarea');\n\t\t\tif(textarea.attr('data-comment')) {\n\t\t\t\tcloseButton.parents('li.comment').first().removeClass('edit');\n\t\t\t}\n\n\t\t\t// Remove the field\n\t\t\tvar commentingField = closeButton.parents('.commenting-field').first();\n\t\t\tcommentingField.remove();\n\t\t},\n\n\t\tappendNewComments: function() {\n\t\t\tvar self = this;\n\t\t\tconsole.log($(self.$el.context), $(self.$el.context).length);\n\t\t\tif ($(self.$el.context).length == 0) {\n\t\t\t\tclearTimeout(myVar);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar commentJSONs = this.getComments();\n\n\t\t\tvar success = function(commentsNew, commentsEdit) {\n\t\t\t\tfor (var c in commentsNew) {\n\t\t\t\t\tself.createComment(commentsNew[c]);\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tfor (var cmt in commentsEdit) {\n\t\t\t\t\tvar commentModel = self.createCommentModel(commentsEdit[cmt]);\n\t\t\t\t\tself.updateCommentModel(commentModel);\n\t\t\t\t\tself.reRenderComment(commentModel.id);\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tvar error = function() {\n\t\t\t\tconsole.log('jquery comment append new error');\n\t\t\t};\n\t\t\tvar myVar = setTimeout(function(){self.appendNewComments()},30000);\n\t\t\tthis.options.appendNewComments(commentJSONs, success, error);\n\t\t},\n\t\t\t\n\t\tpostComment: function(ev) {\n\t\t\tvar self = this;\n\t\t\tvar sendButton = $(ev.currentTarget);\n\t\t\tvar commentingField = sendButton.parents('.commenting-field').first();\n\t\t\tvar textarea = commentingField.find('.textarea');\n\n\t\t\t// Disable send button while request is pending\n\t\t\tsendButton.removeClass('enabled');\n\n\t\t\t// Create comment JSON\n\t\t\tvar commentJSON = this.createCommentJSON(textarea);\n\n\t\t\t// Reverse mapping\n\t\t\tcommentJSON = this.applyExternalMappings(commentJSON);\n\n\t\t\tvar success = function(commentJSON) {\n\t\t\t\tself.currentSortKey = 'newest'\n\t\t\t\tself.showActiveSort()\n\t\t\t\tself.createComment(commentJSON);\n\t\t\t\tcommentingField.find('.close').trigger('click');\n\t\t\t};\n\n\t\t\tvar error = function() {\n\t\t\t\tsendButton.addClass('enabled');\n\t\t\t};\n\n\t\t\tthis.options.postComment(commentJSON, success, error);\n\t\t},\n\n\t\tcreateComment: function(commentJSON) {\n\t\t\tvar commentModel = this.createCommentModel(commentJSON);\n\t\t\tthis.addCommentToDataModel(commentModel);\n\t\t\tthis.addComment(commentModel);\n\t\t\tif (commentModel.opinion == true) {\n\t\t\t\tthis.addImportantCmt(commentModel);\n\t\t\t}\n\t\t},\n\n\t\tputComment: function(ev) {\n\t\t\tvar self = this;\n\t\t\tvar saveButton = $(ev.currentTarget);\n\t\t\tvar commentingField = saveButton.parents('.commenting-field').first();\n\t\t\tvar textarea = commentingField.find('.textarea');\n\n\t\t\t// Disable send button while request is pending\n\t\t\tsaveButton.removeClass('enabled');\n\n\t\t\t// Use a clone of the existing model and update the model after succesfull update\n\t\t\tvar commentJSON =  $.extend({}, this.commentsById[textarea.attr('data-comment')]);\n\t\t\t$.extend(commentJSON, {\n\t\t\t\tparent: textarea.attr('data-parent') || null,\n\t\t\t\tcontent: this.getTextareaContent(textarea),\n\t\t\t\tpings: this.getPings(textarea),\n\t\t\t\tmodified: new Date().getTime()\n\t\t\t});\n\n\t\t\t// Reverse mapping\n\t\t\tcommentJSON = this.applyExternalMappings(commentJSON);\n\t\t\t\n\t\t\tvar success = function(commentJSON) {\n\t\t\t\t// The outermost parent can not be changed by editing the comment so the childs array\n\t\t\t\t// of parent does not require an update\n\n\t\t\t\tvar commentModel = self.createCommentModel(commentJSON);\n\t\t\t\n\t\t\t\t// Delete childs array from new comment model since it doesn't need an update\n\t\t\t\tdelete commentModel['childs'];\n\t\t\t\tself.updateCommentModel(commentModel);\n\t\t\t\t// Close the editing field\n\t\t\t\tcommentingField.find('.close').trigger('click');\n\n\t\t\t\t// Re-render the comment\n\t\t\t\tself.reRenderComment(commentModel.id);\n\t\t\t};\n\n\t\t\tvar error = function() {\n\t\t\t\tsaveButton.addClass('enabled');\n\t\t\t};\n\n\t\t\tthis.options.putComment(commentJSON, success, error);\n\t\t},\n\n\t\tdeleteComment: function(ev) {\n\t\t\tvar self = this;\n\t\t\tvar deleteButton = $(ev.currentTarget);\n\t\t\tvar commentEl = deleteButton.parents('.comment').first();\n\t\t\tvar commentJSON =  $.extend({}, this.commentsById[commentEl.attr('data-id')]);\n\t\t\tvar commentId = commentJSON.id;\n\t\t\tvar parentId = commentJSON.parent;\n\n\t\t\t// Disable send button while request is pending\n\t\t\tdeleteButton.removeClass('enabled');\n\n\t\t\t// Reverse mapping\n\t\t\tcommentJSON = this.applyExternalMappings(commentJSON);\n\n\t\t\tvar success = function() {\n\t\t\t\tself.removeComment(commentId);\n\t\t\t\tif(parentId) self.reRenderCommentActionBar(parentId);\n\t\t\t\t// \n\t\t\t\tif (commentJSON.opinion==true) {\n\t\t\t\t\t$(`[data-sort-key=${self.currentSortKey}]`).trigger('click')\n\t\t\t\t}\n\t\t\t\t// \n\t\t\t};\n\n\t\t\tvar error = function() {\n\t\t\t\tdeleteButton.addClass('enabled');\n\t\t\t};\n\n\t\t\tthis.options.deleteComment(commentJSON, success, error);\n\t\t},\n\n\t\thashtagClicked: function(ev) {\n\t\t\tvar el = $(ev.currentTarget);\n\t\t\tvar value = el.attr('data-value');\n\t\t\tthis.options.hashtagClicked(value);\n\t\t},\n\n\t\tpingClicked: function(ev) {\n\t\t\tvar el = $(ev.currentTarget);\n\t\t\tvar value = el.attr('data-value');\n\t\t\tthis.options.pingClicked(value);\n\t\t},\n\n\t\tfileInputChanged: function(ev, files) {\n\t\t\tvar files = ev.currentTarget.files;\n\t\t\tvar commentingField = $(ev.currentTarget).parents('.commenting-field').first();\n\t\t\tthis.uploadAttachments(files, commentingField);\n\t\t},\n\n\t\tupvoteComment: function(ev) {\n\t\t\tvar self = this;\n\t\t\tvar commentEl = $(ev.currentTarget).parents('li.comment').first();\n\t\t\tvar commentModel = commentEl.data().model;\n\n\t\t\t// Check whether user upvoted the comment or revoked the upvote\n\t\t\tvar previousUpvoteCount = commentModel.upvoteCount;\n\t\t\tvar newUpvoteCount;\n\t\t\tif(commentModel.userHasUpvoted) {\n\t\t\t\tnewUpvoteCount = previousUpvoteCount - 1;\n\t\t\t} else {\n\t\t\t\tnewUpvoteCount = previousUpvoteCount + 1;\n\t\t\t}\n\n\t\t\t// Show changes immediatelly\n\t\t\tcommentModel.userHasUpvoted = !commentModel.userHasUpvoted;\n\t\t\tcommentModel.upvoteCount = newUpvoteCount;\n\t\t\tthis.reRenderUpvotes(commentModel.id);\n\n\t\t\t// Reverse mapping\n\t\t\tvar commentJSON = $.extend({}, commentModel);\n\t\t\tcommentJSON = this.applyExternalMappings(commentJSON);\n\n\t\t\tvar success = function(commentJSON) {\n\t\t\t\tvar commentModel = self.createCommentModel(commentJSON);\n\t\t\t\tself.updateCommentModel(commentModel);\n\t\t\t\tself.reRenderUpvotes(commentModel.id);\n\t\t\t};\n\n\t\t\tvar error = function() {\n\t\t\t\t// Revert changes\n\t\t\t\tcommentModel.userHasUpvoted = !commentModel.userHasUpvoted;\n\t\t\t\tcommentModel.upvoteCount = previousUpvoteCount;\n\t\t\t\tself.reRenderUpvotes(commentModel.id);\n\t\t\t};\n\n\t\t\tthis.options.upvoteComment(commentJSON, success, error);\n\t\t},\n\n\t\ttoggleReplies: function(ev) {\n\t\t\tvar el = $(ev.currentTarget);\n\t\t\tel.siblings('.hidden-reply').toggleClass('visible');\n\t\t\tthis.setToggleAllButtonText(el, true);\n\t\t},\n\n\t\treplyButtonClicked: function(ev) {\n\t\t\tvar replyButton = $(ev.currentTarget);\n\t\t\tvar outermostParent = replyButton.parents('li.comment').last();\n\t\t\tvar parentId = replyButton.parents('.comment').first().data().id;\n\n\t\t\t// Remove existing field\n\t\t\tvar replyField = outermostParent.find('.child-comments > .commenting-field');\n\t\t\tif(replyField.length) replyField.remove();\n\t\t\tvar previousParentId = replyField.find('.textarea').attr('data-parent');\n\n\t\t\t// Create the reply field (do not re-create)\n\t\t\tif(previousParentId != parentId) {\n\t\t\t\treplyField = this.createCommentingFieldElement(parentId, null, false);\n\t\t\t\toutermostParent.find('.child-comments').append(replyField);\n\n\t\t\t\t// Move cursor to end\n\t\t\t\tvar textarea = replyField.find('.textarea');\n\t\t\t\tthis.moveCursorToEnd(textarea)\n\n\t\t\t\t// Make sure the reply field will be displayed\n\t\t\t\tvar scrollTop = this.options.scrollContainer.scrollTop();\n\t\t\t\tvar endOfReply = scrollTop + replyField.position().top + replyField.outerHeight();\n\t\t\t\tvar endOfScrollable = scrollTop + this.options.scrollContainer.outerHeight();\n\t\t\t\tif(endOfReply > endOfScrollable) {\n\t\t\t\t\tvar newScrollTop = scrollTop + (endOfReply - endOfScrollable);\n\t\t\t\t\tthis.options.scrollContainer.scrollTop(newScrollTop);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\teditButtonClicked: function(ev) {\n\t\t\tvar editButton = $(ev.currentTarget);\n\t\t\tvar commentEl = editButton.parents('li.comment').first();\n\t\t\tvar commentModel = commentEl.data().model;\n\t\t\t\n\t\t\tcommentModel = this.commentsById[commentModel.id];\n\t\t\tcommentEl.addClass('edit');\n\n\t\t\t// Create the editing field\n\t\t\tvar editField = this.createCommentingFieldElement(commentModel.parent, commentModel.id, false);\n\t\t\tcommentEl.find('.comment-wrapper').first().append(editField);\n\n\t\t\t// Append original content\n\t\t\tvar textarea = editField.find('.textarea');\n\t\t\ttextarea.attr('data-comment', commentModel.id);\n\n\t\t\t// Escaping HTML\n\t\t\ttextarea.append(this.getFormattedCommentContent(commentModel, true));\n\n\t\t\t// Move cursor to end\n\t\t\tthis.moveCursorToEnd(textarea);\n\t\t},\n\n\t\tshowDroppableOverlay: function(ev) {\n\t\t\tif(this.options.enableAttachments) {\n\t\t\t\tthis.$el.find('.droppable-overlay').css('top', this.$el[0].scrollTop);\n\t\t\t\tthis.$el.find('.droppable-overlay').show();\n\t\t\t\tthis.$el.addClass('drag-ongoing');\n\t\t\t}\n\t\t},\n\n\t\thandleDragEnter: function(ev) {\n\t\t\tvar count = $(ev.currentTarget).data('dnd-count') || 0;\n\t\t\tcount++;\n\t\t\t$(ev.currentTarget).data('dnd-count', count);\n\t\t\t$(ev.currentTarget).addClass('drag-over');\n\t\t},\n\n\t\thandleDragLeave: function(ev, callback) {\n\t\t\tvar count = $(ev.currentTarget).data('dnd-count');\n\t\t\tcount--;\n\t\t\t$(ev.currentTarget).data('dnd-count', count);\n\n\t\t\tif(count == 0) {            \n\t\t\t\t$(ev.currentTarget).removeClass('drag-over');\n\t\t\t\tif(callback) callback();\n\t\t\t}\n\t\t},\n\n\t\thandleDragLeaveForOverlay: function(ev) {\n\t\t\tvar self = this;\n\t\t\tthis.handleDragLeave(ev, function() {\n\t\t\t\tself.hideDroppableOverlay();\n\t\t\t});\n\t\t},\n\n\t\thandleDragLeaveForDroppable: function(ev) {\n\t\t\tthis.handleDragLeave(ev);\n\t\t},\n\n\t\thandleDragOverForOverlay: function(ev) {\n\t\t\tev.stopPropagation();\n\t\t\tev.preventDefault();\n\t\t\tev.originalEvent.dataTransfer.dropEffect = 'copy';\n\t\t},\n\n\t\thideDroppableOverlay: function() {\n\t\t\tthis.$el.find('.droppable-overlay').hide();\n\t\t\tthis.$el.removeClass('drag-ongoing');\n\t\t},\n\n\t\thandleDrop: function(ev) {\n\t\t\tev.preventDefault();\n\n\t\t\t// Reset DND counts\n\t\t\t$(ev.target).trigger('dragleave');\n\n\t\t\t// Hide the overlay and upload the files\n\t\t\tthis.hideDroppableOverlay();\n\t\t\tthis.uploadAttachments(ev.originalEvent.dataTransfer.files);\n\t\t},\n\n\t\tstopPropagation: function(ev) {\n\t\t\tev.stopPropagation();\n\t\t},\n\n\n\t\t// HTML elements\n\n\t\tcreateHTML: function() {\n\t\t\tvar self = this;\n\t\t\t// Commenting field\n\t\t\tvar mainCommentingField = this.createCommentingFieldElement(null, null, true);\n\t\t\tmainCommentingField.addClass('main');\n\t\t\tthis.$el.append(mainCommentingField);\n\n\t\t\t// Hide control row and close button\n\t\t\tvar mainControlRow = mainCommentingField.find('.control-row');\n\t\t\tmainControlRow.hide();\n\t\t\tmainCommentingField.find('.close').hide();\n\n\t\t\t// Navigation bar\n\t\t\tif (this.options.enableNavigation) {\n\t\t\t\tthis.$el.append(this.createNavigationElement());\n\t\t\t\tthis.showActiveSort();\n\t\t\t}\n\n\t\t\t// Loading spinner\n\t\t\tvar spinner = this.createSpinner();\n\t\t\tthis.$el.append(spinner);\n\n\t\t\t// Comments container\n\t\t\tvar commentsContainer = $('<div/>', {\n\t\t\t\t'class': 'data-container overflowComment',\n\t\t\t\t'data-container': 'comments'\n\t\t\t});\n\t\t\tthis.$el.append(commentsContainer);\n\t\t\t\t\n\t\t\t// \"No comments\" placeholder\n\t\t\tvar noComments = $('<div/>', {\n\t\t\t\t'class': 'no-comments no-data',\n\t\t\t\ttext: this.options.textFormatter(this.options.noCommentsText)\n\t\t\t});\n\t\t\tvar noCommentsIcon = $('<i/>', {\n\t\t\t\t'class': 'fa fa-comments fa-2x'\n\t\t\t});\n\t\t\tif(this.options.noCommentsIconURL.length) {\n\t\t\t\tnoCommentsIcon.css('background-image', 'url(\"'+this.options.noCommentsIconURL+'\")');\n\t\t\t\tnoCommentsIcon.addClass('image');\n\t\t\t}\n\t\t\tnoComments.prepend($('<br/>')).prepend(noCommentsIcon);            \n\t\t\tcommentsContainer.append(noComments);\n\n\t\t\t// important Comment Container\n\t\t\tvar importantCmtContainer = $('<div/>', {\n\t\t\t\t'class': 'data-container overflowComment',\n\t\t\t\t'data-container': 'importantCmt'\n\t\t\t});\n\t\t\tthis.$el.append(importantCmtContainer);\n\t\t\t\t// \"No comments Important\" placeholder\n\t\t\tvar noCommentsImpt = $('<div/>', {\n\t\t\t\t'class': 'no-comments no-data',\n\t\t\t\ttext: this.options.textFormatter(this.options.noCommentsImportantText)\n\t\t\t});\n\t\t\tvar noCommentsImptIcon = $('<i/>', {\n\t\t\t\t'class': 'fa fa-comments fa-2x'\n\t\t\t});\n\t\t\tif(this.options.noCommentsImptIconURL.length) {\n\t\t\t\tnoCommentsImptIcon.css('background-image', 'url(\"'+this.options.noCommentsImptIconURL+'\")');\n\t\t\t\tnoCommentsImptIcon.addClass('image');\n\t\t\t}\n\t\t\tnoCommentsImpt.prepend($('<br/>')).prepend(noCommentsImptIcon);            \n\t\t\timportantCmtContainer.append(noCommentsImpt);\n\n\t\t\t// Attachments\n\t\t\tif(this.options.enableAttachments) {\n\t\t\t\t// Attachments container\n\t\t\t\tvar attachmentsContainer = $('<div/>', {\n\t\t\t\t\t'class': 'data-container overflowComment',\n\t\t\t\t\t'data-container': 'attachments'\n\t\t\t\t});\n\t\t\t\tthis.$el.append(attachmentsContainer);\n\t\t\t\t\n\t\t\t\t// \"No attachments\" placeholder\n\t\t\t\tvar noAttachments = $('<div/>', {\n\t\t\t\t\t'class': 'no-attachments no-data',\n\t\t\t\t\ttext: this.options.textFormatter(this.options.noAttachmentsText)\n\t\t\t\t});\n\t\t\t\tvar noAttachmentsIcon = $('<i/>', {\n\t\t\t\t\t'class': 'fa fa-paperclip fa-2x'\n\t\t\t\t});\n\t\t\t\tif(this.options.attachmentIconURL.length) {\n\t\t\t\t\tnoAttachmentsIcon.css('background-image', 'url(\"'+this.options.attachmentIconURL+'\")');\n\t\t\t\t\tnoAttachmentsIcon.addClass('image');\n\t\t\t\t}\n\t\t\t\tnoAttachments.prepend($('<br/>')).prepend(noAttachmentsIcon);\n\t\t\t\tattachmentsContainer.append(noAttachments);\n\n\n\t\t\t\t// Drag & dropping attachments\n\t\t\t\tvar droppableOverlay = $('<div/>', {\n\t\t\t\t\t'class': 'droppable-overlay'\n\t\t\t\t});\n\n\t\t\t\tvar droppableContainer = $('<div/>', {\n\t\t\t\t\t'class': 'droppable-container'\n\t\t\t\t});\n\n\t\t\t\tvar droppable = $('<div/>', {\n\t\t\t\t\t'class': 'droppable'\n\t\t\t\t});\n\n\t\t\t\tvar uploadIcon = $('<i/>', {\n\t\t\t\t\t'class': 'fa fa-upload fa-4x'\n\t\t\t\t});\n\t\t\t\tif(this.options.uploadIconURL.length) {\n\t\t\t\t\tuploadIcon.css('background-image', 'url(\"'+this.options.uploadIconURL+'\")');\n\t\t\t\t\tuploadIcon.addClass('image');\n\t\t\t\t}\n\n\t\t\t\tvar dropAttachmentText = $('<div/>', {\n\t\t\t\t\ttext: this.options.textFormatter(this.options.attachmentDropText)\n\t\t\t\t});\n\t\t\t\tdroppable.append(uploadIcon);\n\t\t\t\tdroppable.append(dropAttachmentText);\n\n\t\t\t\tdroppableOverlay.html(droppableContainer.html(droppable)).hide();\n\t\t\t\tthis.$el.append(droppableOverlay);\n\t\t\t}\n\t\t},\n\n\t\tcreateProfilePictureElement: function(src) {\n\t\t\tif(src) {\n\t\t\t\tvar profilePicture = $('<img/>', {\n\t\t\t\t\tsrc: src\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tvar profilePicture = $('<i/>', {\n\t\t\t\t\t'class': 'fa fa-user'\n\t\t\t\t});\n\t\t\t}\n\t\t\tprofilePicture.addClass('profile-picture');\n\t\t\tif(this.options.roundProfilePictures) profilePicture.addClass('round');\n\t\t\treturn profilePicture;\n\t\t},\n\n\t\tcreateCommentingFieldElement: function(parentId, existingCommentId, enableOpinion) {\n\t\t\tvar self = this;\n\t\t\t// Commenting field\n\t\t\tvar commentingField = $('<div/>', {\n\t\t\t\t'class': 'commenting-field'\n\t\t\t});\n\n\t\t\t// Profile picture\n\t\t\tif(existingCommentId) {\n\t\t\t\tvar profilePictureURL = this.commentsById[existingCommentId].profilePictureURL;\n\t\t\t} else {\n\t\t\t\tvar profilePictureURL = this.options.profilePictureURL;\n\t\t\t}\n\t\t\tvar profilePicture = this.createProfilePictureElement(profilePictureURL);\n\n\t\t\t// New comment\n\t\t\tvar textareaWrapper = $('<div/>', {\n\t\t\t\t'class': 'textarea-wrapper'\n\t\t\t});\n\n\t\t\t// Control row\n\t\t\tvar controlRow = $('<div/>', {\n\t\t\t\t'class': 'control-row'\n\t\t\t});\n\n\t\t\t// Textarea\n\t\t\tvar textarea = $('<div/>', {\n\t\t\t\t'class': 'textarea',\n\t\t\t\t'data-placeholder': this.options.textFormatter(this.options.textareaPlaceholderText),\n\t\t\t\tcontenteditable: true\n\t\t\t});\n\n\t\t\t// Setting the initial height for the textarea\n\t\t\tthis.adjustTextareaHeight(textarea, false);\n\n\t\t\t// Close button\n\t\t\tvar closeButton = $('<span/>', {\n\t\t\t\t'class': 'close'\n\t\t\t}).append($('<span class=\"left\"/>')).append($('<span class=\"right\"/>'));\n\n\t\t\t// Save button text\n\t\t\tif(existingCommentId) {\n\t\t\t\tvar saveButtonText = this.options.textFormatter(this.options.saveText);\n\t\t\t\tvar opinionCmtId = existingCommentId\n\t\t\t\t// Delete button Edit Comment\n\t\t\t\t// var deleteButton = $('<span/>', {\n\t\t\t\t// \t\t'class': 'delete',\n\t\t\t\t// \t\ttext: this.options.textFormatter(this.options.deleteText)\n\t\t\t\t// }).css('background-color', this.options.deleteButtonColor);\n\t\t\t\t// controlRow.append(deleteButton);\n\n\t\t\t\t// // Enable the delete button only if the user is allowed to delete\n\t\t\t\t// if(this.isAllowedToDelete(existingCommentId)) deleteButton.addClass('enabled')\n\n\t\t\t} else {\n\t\t\t\tvar saveButtonText = this.options.textFormatter(this.options.sendText);\n\t\t\t\tvar opinionCmtId =''\n\t\t\t\t// Add upload button if attachments are enabled\n\t\t\t\tif(this.options.enableAttachments) {\n\t\t\t\t\tvar uploadButton = $('<span/>', {\n\t\t\t\t\t\t'class': 'enabled upload'\n\t\t\t\t\t});\n\t\t\t\t\tvar uploadIcon = $('<i/>', {\n\t\t\t\t\t\t'class': 'md-icon',\n\t\t\t\t\t\ttext: 'Tải lên'\n\t\t\t\t\t});\n\t\t\t\t\tvar fileInput = $('<input/>', {\n\t\t\t\t\t\ttype: 'file',\n\t\t\t\t\t\t'data-role': 'none' // Prevent jquery-mobile for adding classes\n\t\t\t\t\t});\n\t\t\t\t\t// Multi file upload might not work with backend as the the file names\n\t\t\t\t\t// may be the same causing duplicates\n\t\t\t\t\tif(!$.browser.mobile) fileInput.attr('multiple', 'multiple');\n\n\t\t\t\t\tif(this.options.uploadIconURL.length) {\n\t\t\t\t\t\tuploadIcon.css('background-image', 'url(\"'+this.options.uploadIconURL+'\")');\n\t\t\t\t\t\tuploadIcon.addClass('image');\n\t\t\t\t\t}\n\t\t\t\t\tuploadButton.append(uploadIcon).append(fileInput);\n\t\t\t\t\tcontrolRow.append(uploadButton);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Save button\n\t\t\tvar saveButtonClass = existingCommentId ? 'update' : 'send';\n\t\t\tvar saveButton = $('<span/>', {\n\t\t\t\t'class': saveButtonClass + ' save highlight-background',\n\t\t\t\ttext: saveButtonText\n\t\t\t});\n\t\t\t// Check opinion\n\n\t\t\tif (enableOpinion) {\n\t\t\t\tvar checkOpinion = $('<input/>', {\n\t\t\t\t\t'class': 'opinion checkOpinion mt-1 mr-1',\n\t\t\t\t\t'id': 'opinion' + opinionCmtId,\n\t\t\t\t\t'name': 'opinion' + opinionCmtId,\n\t\t\t\t\t'type': 'checkbox'\n\t\t\t\t});\n\t\t\t\tvar labelCheckOpinion = $('<label/>', {\n\t\t\t\t\t'class': 'opinion label-opinion',\n\t\t\t\t\t'for': 'opinion'+opinionCmtId,\n\t\t\t\t\ttext: 'Ý kiến chính thức'\n\t\t\t\t});\n\t\t\t\tcontrolRow.append(checkOpinion).append(labelCheckOpinion);\n\t\t\t}\n\t\t\t\n\t\t\t// Populate the element\n\t\t\tcontrolRow.prepend(saveButton);\n\t\t\ttextareaWrapper.append(closeButton).append(textarea).append(controlRow);\n\t\t\tcommentingField.append(profilePicture).append(textareaWrapper);\n\n\n\t\t\tif(parentId) {\n\n\t\t\t\t\t// Set the parent id to the field if necessary\n\t\t\t\ttextarea.attr('data-parent', parentId);\n\n\t\t\t\t// Append reply-to tag if necessary\n\t\t\t\tvar parentModel = this.commentsById[parentId];\n\t\t\t\tif(parentModel.parent) {\n\t\t\t\t\ttextarea.html('&nbsp;');    // Needed to set the cursor to correct place\n\n\t\t\t\t\t// Creating the reply-to tag\n\t\t\t\t\tvar replyToName = '@' + parentModel.fullname;\n\t\t\t\t\tvar replyToTag = this.createTagElement(replyToName, 'reply-to', parentModel.creator);\n\t\t\t\t\ttextarea.prepend(replyToTag);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Pinging users\n\t\t\tif(this.options.enablePinging) {\n\t\t\t\t\ttextarea.textcomplete([{\n\t\t\t\t\t\t\t/**match: /(^|\\s)@(([a-zäöüß]|\\s)*)$/im,*/\n\t\t\t\t\t\tmatch: /(^|\\s)@(([0-9]|[^\\u0000-\\u007F]|[a-zäöüß]|\\s)*)$/im,\n\t\t\t\t\t\t\tsearch: function (term, callback) {\n\t\t\t\t\t\t\t\t// console.log(term);\n\t\t\t\t\t\t\t\t\tterm = self.normalizeSpaces(term);\n\n\t\t\t\t\t\t\t\t\t// Users excluding self and already pinged users\n\t\t\t\t\t\t\t\t\tvar pings = self.getPings(textarea);\n\t\t\t\t\t\t\t\t\tvar users = self.getUsers().filter(function(user) {\n\t\t\t\t\t\t\t\t\t\t\tvar isSelf = user.id == self.options.currentUserId;\n\t\t\t\t\t\t\t\t\t\t\tvar alreadyPinged = pings.indexOf(user.id) != -1;\n\t\t\t\t\t\t\t\t\t\t\treturn !isSelf && !alreadyPinged;\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t// Sort users\n\t\t\t\t\t\t\t\t\tself.sortUsers(users);\n\n\t\t\t\t\t\t\t\t\tcallback($.map(users, function (user) {\n\t\t\t\t\t\t\t\t\t\t\tvar lowercaseTerm = term.toLowerCase();\n\t\t\t\t\t\t\t\t\t\t\tvar nameMatch = user.fullname.toLowerCase().indexOf(lowercaseTerm) != -1;\n\t\t\t\t\t\t\t\t\t\t\tvar emailMatch = user.email.toLowerCase().indexOf(lowercaseTerm) != -1;\n\t\t\t\t\t\t\t\t\t\t\treturn nameMatch || emailMatch ? user : null;\n\t\t\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\ttemplate: function(user) {\n\t\t\t\t\t\t\t\t\tvar wrapper = $('<div/>');\n\n\t\t\t\t\t\t\t\t\tvar profilePictureEl = $('<img/>', {\n\t\t\t\t\t\t\t\t\t\t\tsrc: user.pictureUrl,\n\t\t\t\t\t\t\t\t\t\t\t'class': 'profile-picture round'\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tvar detailsEl = $('<div/>', {\n\t\t\t\t\t\t\t\t\t\t\t'class': 'details',\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tvar nameEl = $('<div/>', {\n\t\t\t\t\t\t\t\t\t\t\t'class': 'name',\n\t\t\t\t\t\t\t\t\t}).html(user.fullname);\n\n\t\t\t\t\t\t\t\t\tvar emailEl = $('<div/>', {\n\t\t\t\t\t\t\t\t\t\t\t'class': 'email',\n\t\t\t\t\t\t\t\t\t}).html(user.email);\n\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\tif (user.email) {\n\t\t\t\t\t\t\t\t\t\t\tdetailsEl.append(nameEl).append(emailEl);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tdetailsEl.addClass('no-email')\n\t\t\t\t\t\t\t\t\t\t\tdetailsEl.append(nameEl)\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\twrapper.append(profilePictureEl).append(detailsEl);\n\t\t\t\t\t\t\t\t\treturn wrapper.html();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\treplace: function (user) {\n\t\t\t\t\t\t\t\t\tvar tag = self.createTagElement('@' + user.fullname, 'ping', user.id);\n\t\t\t\t\t\t\t\t\treturn ' ' + tag[0].outerHTML + ' ';\n\t\t\t\t\t\t\t},\n\t\t\t\t\t}], {\n\t\t\t\t\t\t\tappendTo: '.jquery-comments',\n\t\t\t\t\t\t\tdropdownClassName: 'dropdown autocomplete',\n\t\t\t\t\t\t\tmaxCount: 5,\n\t\t\t\t\t\t\trightEdgeOffset: 0,\n\t\t\t\t\t});\n\n\n\t\t\t\t\t// OVERIDE TEXTCOMPLETE DROPDOWN POSITIONING\n\n\t\t\t\t\t$.fn.textcomplete.Dropdown.prototype.render = function(zippedData) {\n\t\t\t\t\t\tvar contentsHtml = this._buildContents(zippedData);\n\t\t\t\t\t\tvar unzippedData = $.map(zippedData, function (d) { return d.value; });\n\t\t\t\t\t\tif (zippedData.length) {\n\t\t\t\t\t\t\tvar strategy = zippedData[0].strategy;\n\t\t\t\t\t\t\tif (strategy.id) {\n\t\t\t\t\t\t\t\tthis.$el.attr('data-strategy', strategy.id);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.$el.removeAttr('data-strategy');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis._renderHeader(unzippedData);\n\t\t\t\t\t\t\tthis._renderFooter(unzippedData);\n\t\t\t\t\t\t\tif (contentsHtml) {\n\t\t\t\t\t\t\t\tthis._renderContents(contentsHtml);\n\t\t\t\t\t\t\t\tthis._fitToBottom();\n\t\t\t\t\t\t\t\tthis._fitToRight();\n\t\t\t\t\t\t\t\tthis._activateIndexedItem();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis._setScroll();\n\t\t\t\t\t\t} else if (this.noResultsMessage) {\n\t\t\t\t\t\t\tthis._renderNoResultsMessage(unzippedData);\n\t\t\t\t\t\t} else if (this.shown) {\n\t\t\t\t\t\t\tthis.deactivate();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// CUSTOM CODE\n\t\t\t\t\t\t// ===========\n\n\t\t\t\t\t\t// Adjust vertical position\n\t\t\t\t\t\tvar top = parseInt(this.$el.css('top')) + self.options.scrollContainer.scrollTop();\n\t\t\t\t\t\tthis.$el.css('top', top);\n\n\t\t\t\t\t\t// Adjust horizontal position\n\t\t\t\t\t\tvar originalLeft = this.$el.css('left');\n\t\t\t\t\t\tthis.$el.css('left', 0);    // Left must be set to 0 in order to get the real width of the el\n\t\t\t\t\t\tvar maxLeft = self.$el.width() - this.$el.outerWidth();\n\t\t\t\t\t\tvar left = Math.min(maxLeft, parseInt(originalLeft));\n\t\t\t\t\t\tthis.$el.css('left', left);\n\n\t\t\t\t\t\t// ===========\n\t\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn commentingField;\n\t},\n\n\tcreateNavigationElement: function() {\n\t\tvar navigationEl = $('<ul/>', {\n\t\t\t'class': 'navigation'\n\t\t});\n\t\tvar navigationWrapper = $('<div/>', {\n\t\t\t'class': 'navigation-wrapper'\n\t\t});\n\t\tnavigationEl.append(navigationWrapper);\n\n\t\t// Newest\n\t\tvar newest = $('<li/>', {\n\t\t\ttext: this.options.textFormatter(this.options.newestText),\n\t\t\t'data-sort-key': 'newest',\n\t\t\t'data-container-name': 'comments'\n\t\t});\n\n\t\t// Oldest\n\t\tvar oldest = $('<li/>', {\n\t\t\ttext: this.options.textFormatter(this.options.oldestText),\n\t\t\t'data-sort-key': 'oldest',\n\t\t\t'data-container-name': 'comments'\n\t\t});\n\t\t// Important\n\t\tvar important = $('<li/>', {\n\t\t\ttext: this.options.textFormatter(this.options.importantCmtText),\n\t\t\t'data-sort-key': 'important',\n\t\t\t'data-container-name': 'importantCmt'\n\t\t});\n\t\t// Popular\n\t\tvar popular = $('<li/>', {\n\t\t\ttext: this.options.textFormatter(this.options.popularText),\n\t\t\t'data-sort-key': 'popularity',\n\t\t\t'data-container-name': 'comments'\n\t\t});\n\n\t\t// Attachments\n\t\tvar attachments = $('<li/>', {\n\t\t\ttext: this.options.textFormatter(this.options.attachmentsText),\n\t\t\t'data-sort-key': 'attachments',\n\t\t\t'data-container-name': 'attachments'\n\t\t});\n\n\t\t// Attachments icon\n\t\tvar attachmentsIcon = $('<i/>', {\n\t\t\t'class': 'fa fa-paperclip'\n\t\t});\n\t\tif(this.options.attachmentIconURL.length) {\n\t\t\tattachmentsIcon.css('background-image', 'url(\"'+this.options.attachmentIconURL+'\")');\n\t\t\tattachmentsIcon.addClass('image');\n\t\t}\n\t\tattachments.prepend(attachmentsIcon);\n\n\t\t// Responsive navigation\n\t\tvar dropdownNavigationWrapper = $('<div/>', {\n\t\t\t'class': 'navigation-wrapper responsive'\n\t\t});\n\t\tvar dropdownNavigation = $('<ul/>', {\n\t\t\t'class': 'dropdown'\n\t\t});\n\t\tvar dropdownTitle = $('<li/>', {\n\t\t\t'class': 'title'\n\t\t});\n\t\tvar dropdownTitleHeader = $('<header/>');\n\n\t\tdropdownTitle.append(dropdownTitleHeader);\n\t\tdropdownNavigationWrapper.append(dropdownTitle);\n\t\tdropdownNavigationWrapper.append(dropdownNavigation);\n\t\tnavigationEl.append(dropdownNavigationWrapper);\n\n\t\t// Populate elements\n\t\tnavigationWrapper.append(newest).append(oldest).append(important);\n\t\tdropdownNavigation.append(newest.clone()).append(oldest.clone()).append(important.clone());\n\n\t\tif(this.options.enableReplying || this.options.enableUpvoting) {\n\t\t\tnavigationWrapper.append(popular);\n\t\t\tdropdownNavigation.append(popular.clone());\n\t\t}\n\t\tif(this.options.enableAttachments) {\n\t\t\tnavigationWrapper.append(attachments);\n\t\t\tdropdownNavigationWrapper.append(attachments.clone());\n\t\t}\n\n\t\tif(this.options.forceResponsive) this.forceResponsive();\n\t\treturn navigationEl;\n\t},\n\n\tcreateSpinner: function() {\n\t\tvar spinner = $('<div/>', {\n\t\t\t'class': 'spinner'\n\t\t});\n\t\tvar spinnerIcon = $('<i/>', {\n\t\t\t'class': 'fa fa-spinner fa-spin'\n\t\t});\n\t\tif(this.options.spinnerIconURL.length) {\n\t\t\tspinnerIcon.css('background-image', 'url(\"'+this.options.spinnerIconURL+'\")');\n\t\t\tspinnerIcon.addClass('image');\n\t\t}\n\t\tspinner.html(spinnerIcon);\n\t\treturn spinner;\n\t},\n\n\tcreateCommentElement: function(commentModel) {\n\n\t\t// Comment container element\n\t\tvar commentEl = $('<li/>', {\n\t\t\t'data-id': commentModel.id,\n\t\t\t'class': 'comment'\n\t\t}).data('model', commentModel);\n\n\t\tif(commentModel.createdByCurrentUser) commentEl.addClass('by-current-user');\n\t\tif(commentModel.createdByAdmin) commentEl.addClass('by-admin');\n\n\t\t// Child comments\n\t\tvar childComments = $('<ul/>', {\n\t\t\t'class': 'child-comments'\n\t\t});\n\n\t\t// Comment wrapper\n\t\tvar commentWrapper = this.createCommentWrapperElement(commentModel);\n\n\t\tcommentEl.append(commentWrapper);\n\t\tif(commentModel.parent == null) commentEl.append(childComments);\n\t\treturn commentEl;\n\t},\n\n\tcreateCommentWrapperElement: function(commentModel) {\n\t\tvar commentWrapper = $('<div/>', {\n\t\t\t'class': 'comment-wrapper'\n\t\t});\n\n\t\t// Profile picture\n\t\tvar profilePicture = this.createProfilePictureElement(commentModel.profilePictureURL);\n\n\t\t// Time\n\t\tvar time = $('<time/>', {\n\t\t\ttext: this.options.timeFormatter(commentModel.created),\n\t\t\t'data-original': commentModel.created\n\t\t});\n\n\t\t// Name\n\t\tvar nameText = commentModel.createdByCurrentUser ? this.options.textFormatter(this.options.youText) : commentModel.fullname;\n\t\tvar name = $('<div/>', {\n\t\t\t'class': 'name'\n\t\t});\n\t\tif(commentModel.profileURL) {\n\t\t\tvar link = $('<a/>', {\n\t\t\t\thref: commentModel.profileURL,\n\t\t\t\ttext: nameText\n\t\t\t});\n\t\t\tname.html(link);\n\t\t} else {\n\t\t\tname.text(nameText);\n\t\t}\n\n\t\t// Highlight name for own comments and admin\n\t\tif(commentModel.createdByCurrentUser || commentModel.createdByAdmin) name.addClass('highlight-font-bold');\n\n\t\t// Show reply-to name if parent of parent exists\n\t\tif(commentModel.parent) {\n\t\t\tvar parent = this.commentsById[commentModel.parent];\n\t\t\tif(parent.parent) {\n\t\t\t\tvar replyTo = $('<span/>', {\n\t\t\t\t\t'class': 'reply-to',\n\t\t\t\t\ttext: parent.fullname\n\t\t\t\t});\n\n\t\t\t\t// reply icon\n\t\t\t\tvar replyIcon = $('<i/>', {\n\t\t\t\t\t'class': 'fa fa-share'\n\t\t\t\t});\n\t\t\t\tif(this.options.replyIconURL.length) {\n\t\t\t\t\treplyIcon.css('background-image', 'url(\"'+this.options.replyIconURL+'\")');\n\t\t\t\t\treplyIcon.addClass('image');\n\t\t\t\t}\n\n\t\t\t\treplyTo.prepend(replyIcon);\n\t\t\t\tname.append(replyTo);\n\t\t\t}\n\t\t}\n\n\t\t// New tag\n\t\tif(commentModel.isNew) {\n\t\t\tvar newTag = $('<span/>', {\n\t\t\t\t'class': 'new highlight-background',\n\t\t\t\ttext: this.options.newText\n\t\t\t});\n\t\t\tname.append(newTag);\n\t\t}\n\n\t\t// Wrapper\n\t\tvar wrapper = $('<div/>', {\n\t\t\t'class': 'wrapper'\n\t\t});\n\t\t// Note Ý kiến chính thức\n\t\tvar noteOpinion = $('<div/>', {\n\t\t\t'class': 'note-opinion',\n\t\t\ttext: '(Ý kiến chính thức)'\n\t\t});\n\t\t// Content\n\t\tvar content = $('<div/>', {\n\t\t\t'class': 'content'\n\t\t});\n\n\t\t// Case: attachment\n\t\tvar isAttachment = commentModel.fileURL != undefined;\n\t\tif(isAttachment) {\n\t\t\tvar format = null;\n\t\t\tvar type = null;\n\n\t\t\t// Type and format\n\t\t\tif(commentModel.fileMimeType) {\n\t\t\t\tvar mimeTypeParts = commentModel.fileMimeType.split('/');\n\t\t\t\tif(mimeTypeParts.length == 2) {\n\t\t\t\t\tformat = mimeTypeParts[1];\n\t\t\t\t\ttype = mimeTypeParts[0];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Attachment link\n\t\t\tvar link = $('<a/>', {\n\t\t\t\t'class': 'attachment',\n\t\t\t\thref: commentModel.fileURL,\n\t\t\t\ttarget: '_blank'\n\t\t\t});\n\t\t\t\n\t\t\t// var link = $('<a/>', {\n\t\t\t// \t\t'class': 'attachment',\n\t\t\t// \t\thref: 'javascript:viewCommentFileAttach(\"' + commentModel.fileURL + '\",\"' + commentModel.fileMimeType + '\");'\n\t\t\t// });\n\t\t\t\n\t\t\t// Case: image preview\n\t\t\tif(type == 'image') {\n\t\t\t\tvar image = $('<img/>', {\n\t\t\t\t\tsrc: commentModel.fileURL\n\t\t\t\t});\n\t\t\t\tlink.html(image);\n\t\t\t// Case: video preview\n\t\t\t} else if(type == 'video') {\n\t\t\t\tvar video = $('<video/>', {\n\t\t\t\t\tsrc: commentModel.fileURL,\n\t\t\t\t\ttype: commentModel.fileMimeType,\n\t\t\t\t\tcontrols: 'controls'\n\t\t\t\t});\n\t\t\t\tlink.html(video);\n\n\t\t\t// Case: icon and text\n\t\t\t} else {\n\n\t\t\t\t// Icon\n\t\t\t\tvar availableIcons = ['archive', 'audio', 'code', 'excel', 'image', 'movie', 'pdf', 'photo',\n\t\t\t\t\t'picture', 'powerpoint', 'sound', 'video', 'word', 'zip'];\n\t\t\t\t\n\t\t\t\tvar iconClass = 'fa fa-file-o';\n\t\t\t\tif(availableIcons.indexOf(format) > 0) {\n\t\t\t\t\ticonClass = 'fa fa-file-' + format + '-o';\n\t\t\t\t} else if(availableIcons.indexOf(type) > 0) {\n\t\t\t\t\ticonClass = 'fa fa-file-' + type + '-o';\n\t\t\t\t}\n\n\t\t\t\tvar fileIcon = $('<i/>', {\n\t\t\t\t\t'class': iconClass\n\t\t\t\t});\n\t\t\t\tif(this.options.fileIconURL.length) {\n\t\t\t\t\tfileIcon.css('background-image', 'url(\"'+this.options.fileIconURL+'\")');\n\t\t\t\t\tfileIcon.addClass('image');\n\t\t\t\t}\n\t\t\t\t// File name\n\t\t\t\t/**\n\t\t\t\tvar parts = commentModel.fileURL.split('/');\n\t\t\t\tvar fileName = parts[parts.length - 1];\n\t\t\t\tfileName = fileName.split('?')[0];\n\t\t\t\tfileName = decodeURIComponent(fileName);\n\t\t\t\t*/\n\t\t\t\tvar fileName = commentModel.fileName;\n\t\t\t\tlink.text(fileName);\n\t\t\t\tlink.prepend(fileIcon);\n\t\t\t}\n\t\t\tcontent.html(link);\n\t\t// Case: regular comment\n\t\t} else {\n\t\t\tcontent.html(this.getFormattedCommentContent(commentModel));\n\t\t}\n\n\t\t// Edited timestamp\n\t\tif(commentModel.modified && commentModel.modified != commentModel.created) {\n\t\t\tvar editedTime = this.options.timeFormatter(commentModel.modified);\n\t\t\tvar edited = $('<time/>', {\n\t\t\t\t'class': 'edited',\n\t\t\t\ttext: this.options.textFormatter(this.options.editedText) + ' ' + editedTime,\n\t\t\t\t'data-original': commentModel.modified\n\t\t\t});\n\t\t\tcontent.append(edited);\n\t\t}\n\n\t\t// Actions\n\t\tvar actions = $('<span/>', {\n\t\t\t'class': 'actions'\n\t\t});\n\n\t\t// Reply\n\t\tvar reply = $('<button/>', {\n\t\t\t'class': 'action reply',\n\t\t\t'type': 'button',\n\t\t\ttext: this.options.textFormatter(this.options.replyText)\n\t\t});\n\n\t\t// Upvote icon\n\t\tvar upvoteIcon = $('<i/>', {\n\t\t\t'class': 'fa fa-thumbs-up'\n\t\t});\n\t\tif(this.options.upvoteIconURL.length) {\n\t\t\tupvoteIcon.css('background-image', 'url(\"'+this.options.upvoteIconURL+'\")');\n\t\t\tupvoteIcon.addClass('image');\n\t\t}\n\n\t\t// Upvotes\n\t\tvar upvotes = this.createUpvoteElement(commentModel);\n\n\t\t// Append buttons for actions that are enabled\n\t\tif(this.options.enableReplying) actions.append(reply);\n\t\tif(this.options.enableUpvoting) actions.append(upvotes);\n\n\t\tif(commentModel.createdByCurrentUser || this.options.currentUserIsAdmin) {\n\t\t\t// Case: delete button for attachment and currentUser\n\t\t\tif(isAttachment && this.isAllowedToDelete(commentModel.id)) {\n\t\t\t\tvar deleteButton = $('<button/>', {\n\t\t\t\t\t'class': 'action delete enabled',\n\t\t\t\t\ttext: this.options.textFormatter(this.options.deleteText)\n\t\t\t\t});\n\t\t\t\tactions.append(deleteButton);\n\n\t\t\t// Case: edit button for regular comment\n\t\t\t} else if(!isAttachment && this.options.enableEditing) {\n\t\t\t\tvar editButton = $('<button/>', {\n\t\t\t\t\t'class': 'action edit',\n\t\t\t\t\ttext: this.options.textFormatter(this.options.editText)\n\t\t\t\t});\n\t\t\t\tactions.append(editButton);\n\t\t\t\tvar deleteButton = $('<button/>', {\n\t\t\t\t\t'class': 'action delete enabled',\n\t\t\t\t\ttext: this.options.textFormatter(this.options.deleteText)\n\t\t\t\t});\n\t\t\t\tactions.append(deleteButton);\n\t\t\t}\n\t\t}\n\n\t\twrapper.append(content);\n\t\tif(commentModel.opinion == true) {\n\t\t\twrapper.append(noteOpinion);\n\t\t}\n\t\twrapper.append(actions);\n\t\tcommentWrapper.append(profilePicture).append(time).append(name).append(wrapper);\n\t\treturn commentWrapper;\n\t},\n\n\tcreateUpvoteElement: function(commentModel) {\n\t\t// Upvote icon\n\t\tvar upvoteIcon = $('<i/>', {\n\t\t\t'class': 'fa fa-thumbs-up'\n\t\t});\n\t\tif(this.options.upvoteIconURL.length) {\n\t\t\tupvoteIcon.css('background-image', 'url(\"'+this.options.upvoteIconURL+'\")');\n\t\t\tupvoteIcon.addClass('image');\n\t\t}\n\n\t\t// Upvotes\n\t\tvar upvoteEl = $('<button/>', {\n\t\t\t'class': 'action upvote' + (commentModel.userHasUpvoted ? ' highlight-font' : '')\n\t\t}).append($('<span/>', {\n\t\t\ttext: commentModel.upvoteCount,\n\t\t\t'class': 'upvote-count'\n\t\t})).append(upvoteIcon);\n\n\t\treturn upvoteEl;\n\t},\n\n\tcreateTagElement: function(text, extraClasses, value) {\n\t\tvar tagEl = $('<input/>', {\n\t\t\t'class': 'tag',\n\t\t\t'type': 'button',\n\t\t\t'data-role': 'none',\n\t\t});\n\t\tif(extraClasses) tagEl.addClass(extraClasses);\n\t\ttagEl.val(text);\n\t\ttagEl.attr('data-value', value);\n\t\treturn tagEl;\n\t},\n\n\treRenderComment: function(id) {\n\t\tvar commentModel = this.commentsById[id];\n\t\tvar commentElements = this.$el.find('li.comment[data-id=\"'+commentModel.id+'\"]');\n\n\t\tvar self = this;\n\t\tcommentElements.each(function(index, commentEl) {\n\t\t\tvar commentWrapper = self.createCommentWrapperElement(commentModel);\n\t\t\t$(commentEl).find('.comment-wrapper').first().replaceWith(commentWrapper);\n\t\t});\n\t},\n\n\treRenderCommentActionBar: function(id) {\n\t\tvar commentModel = this.commentsById[id];\n\t\tvar commentElements = this.$el.find('li.comment[data-id=\"'+commentModel.id+'\"]');\n\n\t\tvar self = this;\n\t\tcommentElements.each(function(index, commentEl) {\n\t\t\tvar commentWrapper = self.createCommentWrapperElement(commentModel);\n\t\t\t$(commentEl).find('.actions').first().replaceWith(commentWrapper.find('.actions'));\n\t\t});\n\t},\n\n\treRenderUpvotes: function(id) {\n\t\tvar commentModel = this.commentsById[id];\n\t\tvar commentElements = this.$el.find('li.comment[data-id=\"'+commentModel.id+'\"]');\n\n\t\tvar self = this;\n\t\tcommentElements.each(function(index, commentEl) {\n\t\t\tvar upvotes = self.createUpvoteElement(commentModel);\n\t\t\t$(commentEl).find('.upvote').first().replaceWith(upvotes);\n\t\t});\n\t},\n\n\n\t// Styling\n\tcreateCssDeclarations: function() {\n\n\t\t// Remove previous css-declarations\n\t\t$('head style.jquery-comments-css').remove();\n\n\t\t// Navigation underline\n\t\tthis.createCss('.jquery-comments ul.navigation li.active:after {background: '\n\t\t\t+ this.options.highlightColor  + ' !important;',\n\t\t\t+'}');\n\n\t\t// Dropdown active element\n\t\tthis.createCss('.jquery-comments ul.navigation ul.dropdown li.active {background: '\n\t\t\t+ this.options.highlightColor  + ' !important;',\n\t\t\t+'}');\n\n\t\t// Background highlight\n\t\tthis.createCss('.jquery-comments .highlight-background {background: '\n\t\t\t+ this.options.highlightColor  + ' !important;',\n\t\t\t+'}');\n\n\t\t// Font highlight\n\t\tthis.createCss('.jquery-comments .highlight-font {color: '\n\t\t\t+ this.options.highlightColor + ' !important;'\n\t\t\t+'}');\n\t\tthis.createCss('.jquery-comments .highlight-font-bold {color: '\n\t\t\t+ this.options.highlightColor + ' !important;'\n\t\t\t+ 'font-weight: bold;'\n\t\t\t+'}');\n\t},\n\n\tcreateCss: function(css) {\n\t\tvar styleEl = $('<style/>', {\n\t\t\ttype: 'text/css',\n\t\t\t'class': 'jquery-comments-css',\n\t\t\ttext: css\n\t\t});\n\t\t$('head').append(styleEl);\n\t},\n\n\t//\n\tgetComments: function() {\n\t\tvar self = this;\n\t\tlet commentArr = Object.keys(this.commentsById).map(function(id){return self.commentsById[id]})\n\t\tlet importantCmtArr = commentArr.filter(function(comment){return comment.opinion})\n\t\tlet importantCmtUser = commentArr.filter(function(comment){return comment.opinion&&comment.createdByCurrentUser})\n\t\tlet attachCmtArr = commentArr.filter(function(comment){return comment.fileURL != undefined})\n\t\tif (commentArr.length > 3) {\n\t\t\t$('.data-container[data-container=comments]').addClass('lessEl')\n\t\t} else {\n\t\t\t$('.data-container[data-container=comments]').addClass('fullEl')\n\t\t}\n\t\t// \n\t\tif (importantCmtArr.length > 3) {\n\t\t\t$('.data-container[data-container=importantCmt]').addClass('lessEl')\n\t\t} else {\n\t\t\t$('.data-container[data-container=importantCmt]').addClass('fullEl')\n\t\t}\n\t\tif (importantCmtUser.length > 0) {\n\t\t\t$('.opinion').hide()\n\t\t} else {\n\t\t\t$('.opinion').show()\n\t\t}\n\t\t// \n\t\tif (attachCmtArr.length > 3) {\n\t\t\t$('.data-container[data-container=attachments]').addClass('lessEl')\n\t\t} else {\n\t\t\t$('.data-container[data-container=attachments]').addClass('fullEl')\n\t\t}\n\n\t\treturn Object.keys(this.commentsById).map(function(id){return self.commentsById[id]});\n\t},\n\n\tgetUsers: function() {\n\t\tvar self = this;\n\t\treturn Object.keys(this.usersById).map(function(id){return self.usersById[id]});\n\t},\n\n\tgetChildComments: function(parentId) {\n\t\treturn this.getComments().filter(function(comment){return comment.parent == parentId});\n\t},\n\n\tgetAttachments: function() {\n\t\tvar self = this;\n\t\treturn this.getComments().filter(function(comment){return comment.fileURL != undefined});\n\t},\n\tgetImportantCmt: function() {\n\t\tvar self = this;\n\t\treturn this.getComments().filter(function(comment){return comment.opinion == true});\n\t},\n\tgetOutermostParent: function(directParentId) {\n\t\tvar parentId = directParentId;\n\t\tdo {\n\t\t\tvar parentComment = this.commentsById[parentId];\n\t\t\tparentId = parentComment.parent;\n\t\t} while(parentComment.parent != null);\n\t\treturn parentComment;\n\t},\n\n\tcreateCommentJSON: function(textarea) {\n\t\tvar time = new Date().toISOString();\n\t\tvar commentJSON = {\n\t\t\tid: 'c' +  (this.getComments().length + 1),   // Temporary id\n\t\t\tparent: textarea.attr('data-parent') || null,\n\t\t\tcreated: time,\n\t\t\tmodified: time,\n\t\t\tcontent: this.getTextareaContent(textarea),\n\t\t\tpings: this.getPings(textarea),\n\t\t\tfullname: this.options.textFormatter(this.options.youText),\n\t\t\tprofilePictureURL: this.options.profilePictureURL,\n\t\t\tcreatedByCurrentUser: true,\n\t\t\tupvoteCount: 0,\n\t\t\tuserHasUpvoted: false\n\t\t};\n\t\treturn commentJSON;\n\t},\n\n\tisAllowedToDelete: function(commentId) {\n\t\tif(this.options.enableDeleting) {\n\t\t\tvar isAllowedToDelete = true;\n\t\t\tif(!this.options.enableDeletingCommentWithReplies) {\n\t\t\t\t$(this.getComments()).each(function(index, comment) {\n\t\t\t\t\tif(comment.parent == commentId) isAllowedToDelete = false;\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn isAllowedToDelete;\n\t\t}\n\t\treturn false;\n\t},\n\n\tsetToggleAllButtonText: function(toggleAllButton, toggle) {\n\t\tvar self = this;\n\t\tvar textContainer = toggleAllButton.find('span.text');\n\t\tvar caret = toggleAllButton.find('.caret');\n\n\t\tvar showExpandingText = function() {\n\t\t\t\tvar text = self.options.textFormatter(self.options.viewAllRepliesText);\n\t\t\t\tvar replyCount = toggleAllButton.siblings('.comment').length;\n\t\t\t\ttext = text.replace('__replyCount__', replyCount);\n\t\t\t\ttextContainer.text(text);\n\t\t};\n\n\t\tvar hideRepliesText = this.options.textFormatter(this.options.hideRepliesText);\n\n\t\tif(toggle) {\n\t\t\t// Toggle text\n\t\t\tif(textContainer.text() == hideRepliesText) {\n\t\t\t\tshowExpandingText();\n\t\t\t} else {\n\t\t\t\ttextContainer.text(hideRepliesText);\n\t\t\t}\n\t\t\t// Toggle direction of the caret\n\t\t\tcaret.toggleClass('up');\n\t\t} else {\n\t\t\t// Update text if necessary\n\t\t\tif(textContainer.text() != hideRepliesText) {\n\t\t\t\tshowExpandingText();\n\t\t\t}\n\t\t}\n\t},\n\n\tadjustTextareaHeight: function(textarea, focus) {\n\t\tvar textareaBaseHeight = 2.2;\n\t\tvar lineHeight = 1.45;\n\n\t\tvar setRows = function(rows) {\n\t\t\tvar height = textareaBaseHeight + (rows - 1) * lineHeight;\n\t\t\ttextarea.css('height', height + 'em');\n\t\t};\n\n\t\ttextarea = $(textarea);\n\t\tvar rowCount = focus == true ? this.options.textareaRowsOnFocus : this.options.textareaRows;\n\t\tdo {\n\t\t\tsetRows(rowCount);\n\t\t\trowCount++;\n\t\t\tvar isAreaScrollable = textarea[0].scrollHeight > textarea.outerHeight();\n\t\t\tvar maxRowsUsed = this.options.textareaMaxRows == false ?\n\t\t\t\tfalse : rowCount > this.options.textareaMaxRows;\n\t\t} while(isAreaScrollable && !maxRowsUsed);\n\t},\n\n\tclearTextarea: function(textarea) {\n\t\ttextarea.empty().trigger('input');\n\t},\n\n\tgetTextareaContent: function(textarea, humanReadable) {\n\t\tvar textareaClone = textarea.clone();\n\n\t\t// Remove reply-to tag\n\t\ttextareaClone.find('.reply-to.tag').remove();\n\n\t\t// Replace tags with text values\n\t\ttextareaClone.find('.tag.hashtag').replaceWith(function(){\n\t\t\treturn humanReadable ? $(this).val() : '#' + $(this).attr('data-value');\n\t\t});\n\t\ttextareaClone.find('.tag.ping').replaceWith(function(){\n\t\t\treturn humanReadable ? $(this).val() : '@' + $(this).attr('data-value');\n\t\t});\n\n\t\tvar ce = $('<pre/>').html(textareaClone.html());\n\t\tce.find('div, p, br').replaceWith(function() { return '\\n' + this.innerHTML; });\n\n\t\t// Trim leading spaces\n\t\tvar text = ce.text().replace(/^\\s+/g, '');\n\n\t\t// Normalize spaces\n\t\tvar text = this.normalizeSpaces(text);\n\t\treturn text;\n\t},\n\n\tgetFormattedCommentContent: function(commentModel, replaceNewLines) {\n\t\tvar html = this.escape(commentModel.content);\n\t\thtml = this.linkify(html);\n\t\thtml = this.highlightTags(commentModel, html);\n\t\tif(replaceNewLines) html = html.replace(/(?:\\n)/g, '<br>');\n\t\treturn html;\n\t},\n\n\tgetPings: function(textarea) {\n\t\treturn $.map(textarea.find('.ping'), function(el){return parseInt($(el).attr('data-value'))});\n\t},\n\n\tmoveCursorToEnd: function(el) {\n\t\tel = $(el)[0];\n\n\t\t// Trigger input to adjust size\n\t\t$(el).trigger('input');\n\n\t\t// Scroll to bottom\n\t\t$(el).scrollTop(el.scrollHeight);\n\n\t\t// Move cursor to end\n\t\tif (typeof window.getSelection != 'undefined' && typeof document.createRange != 'undefined') {\n\t\t\tvar range = document.createRange();\n\t\t\trange.selectNodeContents(el);\n\t\t\trange.collapse(false);\n\t\t\tvar sel = window.getSelection();\n\t\t\tsel.removeAllRanges();\n\t\t\tsel.addRange(range);\n\t\t} else if (typeof document.body.createTextRange != 'undefined') {\n\t\t\tvar textRange = document.body.createTextRange();\n\t\t\ttextRange.moveToElementText(el);\n\t\t\ttextRange.collapse(false);\n\t\t\ttextRange.select();\n\t\t}\n\n\t\t// Focus\n\t\tel.focus();\n\t},\n\n\tescape: function(inputText) {\n\t\treturn $('<pre/>').text(this.normalizeSpaces(inputText)).html();\n\t},\n\n\tnormalizeSpaces: function(inputText) {\n\t\treturn inputText.replace(new RegExp('\\u00a0', 'g'), ' ');   // Convert non-breaking spaces to reguar spaces\n\t},\n\n\tafter: function(times, func) {\n\t\tvar self = this;\n\t\treturn function() {\n\t\t\ttimes--;\n\t\t\tif (times == 0) {\n\t\t\t\treturn func.apply(self, arguments);\n\t\t\t}\n\t\t}\n\t},\n\n\thighlightTags: function(commentModel, html) {\n\t\tif(this.options.enableHashtags) html = this.highlightHashtags(commentModel, html);\n\t\tif(this.options.enablePinging) html = this.highlightPings(commentModel, html);\n\t\treturn html;\n\t},\n\n\thighlightHashtags: function(commentModel, html) {\n\t\tvar self = this;\n\n\t\tif(html.indexOf('#') != -1) {\n\t\t\tvar __createTag = function(tag) {\n\t\t\t\tvar tag = self.createTagElement('#' + tag, 'hashtag', tag);\n\t\t\t\treturn tag[0].outerHTML;\n\t\t\t}\n\n\t\t\tvar regex = /(^|\\s)#([a-zäöüß\\d-_]+)/gim;\n\t\t\thtml = html.replace(regex, function($0, $1, $2){\n\t\t\t\treturn $1 + __createTag($2);\n\t\t\t});\n\t\t}\n\t\treturn html;\n\t},\n\n\thighlightPings: function(commentModel, html) {\n\t\tvar self = this;\n\n\t\tif(html.indexOf('@') != -1) {\n\n\t\t\tvar __createTag = function(user) {\n\t\t\t\tvar tag = self.createTagElement('@' + user.fullname, 'ping', user.id);\n\t\t\t\treturn tag[0].outerHTML;\n\t\t\t}\n\n\t\t\tvar highlightedHtml = '';\n\t\t\t$(commentModel.pings).each(function(index, id) {\n\t\t\t\tif(id in self.usersById) {\n\t\t\t\t\tvar user = self.usersById[id];\n\t\t\t\t\tvar pingText = '@' + user.id;\n\n\t\t\t\t\tvar endIndex = html.indexOf(pingText) + pingText.length;\n\t\t\t\t\tvar current = html.slice(0, endIndex);\n\t\t\t\t\thighlightedHtml += current.replace(pingText, __createTag(user));\n\n\t\t\t\t\thtml = html.slice(endIndex);\n\t\t\t\t}\n\t\t\t});\n\t\t\thighlightedHtml += html;\n\t\t\treturn highlightedHtml;\n\t\t}\n\t\treturn html;\n\t},\n\n\tlinkify: function(inputText) {\n\t\tvar replacedText, replacePattern1, replacePattern2, replacePattern3;\n\n\t\t// URLs starting with http://, https://, file:// or ftp://\n\t\treplacePattern1 = /(^|\\s)((https?|ftp|file):\\/\\/[-A-Z0-9+&@#\\/%?=~_|!:,.;]*[-A-Z0-9+&@#\\/%=~_|])/gim;\n\t\treplacedText = inputText.replace(replacePattern1, '$1<a href=\"$2\" target=\"_blank\">$2</a>');\n\n\t\t// URLs starting with \"www.\" (without // before it, or it'd re-link the ones done above).\n\t\treplacePattern2 = /(^|\\s)(www\\.[\\S]+(\\b|$))/gim;\n\t\treplacedText = replacedText.replace(replacePattern2, '$1<a href=\"http://$2\" target=\"_blank\">$2</a>');\n\n\t\t// Change email addresses to mailto:: links.\n\t\treplacePattern3 = /(^|\\s)(([a-zA-Z0-9\\-\\_\\.]+)@[a-zA-Z\\_]+?(\\.[a-zA-Z]{2,6})+)/gim;\n\t\treplacedText = replacedText.replace(replacePattern3, '$1<a href=\"mailto:$2\">$2</a>');\n\n\t\t// If there are hrefs in the original text, let's split\n\t\t// the text up and only work on the parts that don't have urls yet.\n\t\tvar count = inputText.match(/<a href/g) || [];\n\n\t\tif(count.length > 0){\n\t\t\t// Keep delimiter when splitting\n\t\t\tvar splitInput = inputText.split(/(<\\/a>)/g);\n\t\t\tfor (var i = 0 ; i < splitInput.length ; i++){\n\t\t\t\tif(splitInput[i].match(/<a href/g) == null){\n\t\t\t\t\tsplitInput[i] = splitInput[i].replace(replacePattern1, '<a href=\"$1\" target=\"_blank\">$1</a>').replace(replacePattern2, '$1<a href=\"http://$2\" target=\"_blank\">$2</a>').replace(replacePattern3, '<a href=\"mailto:$1\">$1</a>');\n\t\t\t\t}\n\t\t\t}\n\t\t\tvar combinedReplacedText = splitInput.join('');\n\t\t\treturn combinedReplacedText;\n\t\t} else {\n\t\t\treturn replacedText;\n\t\t}\n\t},\n\n\twaitUntil: function(condition, callback) {\n\t\tvar self = this;\n\n\t\tif(condition()) {\n\t\t\tcallback();\n\t\t} else {\n\t\t\tsetTimeout(function() {\n\t\t\t\tself.waitUntil(condition, callback);\n\t\t\t}, 100);\n\t\t}\n\t},\n\n\tapplyInternalMappings: function(commentJSON) {\n\t\t// Inverting field mappings\n\t\tvar invertedMappings = {};\n\t\tvar mappings = this.options.fieldMappings;\n\t\tfor (var prop in mappings) {\n\t\t\tif(mappings.hasOwnProperty(prop)) {\n\t\t\t\tinvertedMappings[mappings[prop]] = prop;\n\t\t\t}\n\t\t}\n\n\t\treturn this.applyMappings(invertedMappings, commentJSON);\n\t},\n\n\tapplyExternalMappings: function(commentJSON) {\n\t\tvar mappings = this.options.fieldMappings;\n\t\treturn this.applyMappings(mappings, commentJSON);\n\t},\n\n\tapplyMappings: function(mappings, commentJSON) {\n\t\tvar result = {};\n\n\t\tfor(var key1 in commentJSON) {\n\t\t\tif(key1 in mappings) {\n\t\t\t\tvar key2 = mappings[key1];\n\t\t\t\tresult[key2] = commentJSON[key1];\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\t};\n\n\t$.fn.comments = function(options) {\n\t\treturn this.each(function() {\n\t\t\tvar comments = Object.create(Comments);\n\t\t\t$.data(this, 'comments', comments);\n\t\t\tcomments.init(options || {}, this);\n\t\t});\n\t};\n}));\n\n\n/* eslint-disable */\n\n\n// WEBPACK FOOTER //\n// ./src/store/jquery_comment.js","<template>\n  <div class=\"comment-temp\">\n    <!-- Component Trao đổi thảo luận -->\n    <div>\n      <v-expansion-panel class=\"expansion-pl-transparent\">\n        <v-expansion-panel-content hide-actions :value=\"true\">\n          <!-- <div slot=\"header\">\n            <div class=\"background-triangle-small\"> \n              <v-icon size=\"18\" color=\"white\">star_rate</v-icon> \n            </div>\n            TRAO ĐỔI THÔNG TIN\n          </div> -->\n          \n          <v-card class=\"comments__container\" >\n            <v-card-text class=\"pl-4\">\n              <div id=\"comments-container-el\"></div>\n              \n              <!-- <v-flex v-if=\"argShowMore2\"><span class=\"action-show primary--text mx-2 my-2\" @click=\"showMore2\">Xem thêm</span></v-flex>\n              <v-flex v-if=\"!argShowMore2\"><span class=\"action-show primary--text mx-2 my-2\" @click=\"showMore2\">Rút gọn</span></v-flex> -->\n            </v-card-text>\n          </v-card>\n        </v-expansion-panel-content>\n      </v-expansion-panel>\n    </div>\n  </div>\n</template>\n\n<script>\nimport $ from 'jquery'\n// import axios from 'axios'\nimport 'jquery-textcomplete'\nimport '../store/jquery_comment'\nexport default {\n  props: ['classPK', 'className'],\n  data: () => ({\n    usersComment: [\n      // {\n      //   id: 1,\n      //   fullname: 'Trịnh Công Trình',\n      //   email: 'trinhtc@fds.vn.com',\n      //   pictureUrl: 'https://app.viima.com/static/media/user_profiles/user-icon.png'\n      // },\n      // {\n      //   id: 2,\n      //   fullname: 'Thái Hoàng Anh',\n      //   email: 'anhth@fds.vn',\n      //   pictureUrl: 'https://app.viima.com/static/media/user_profiles/user-icon.png'\n      // }\n    ],\n    comment: [],\n    argShowMore: true,\n    //\n    checkOpinion: true\n  }),\n  computed: {\n    loading () {\n      return this.$store.getters.loading\n    },\n    initData () {\n      return this.$store.getters.loadingInitData\n    }\n  },\n  watch: {\n    classPK (val) {\n      var vm = this\n      vm.$store.dispatch('loadUsersComment', val).then(result => {\n        vm.usersComment = result\n        vm.initComment()\n      }).catch(reject => {\n        vm.initComment()\n      })\n    }\n  },\n  created () {\n    // var vm = this\n    // vm.$nextTick(function () {\n    //   vm.$store.dispatch('loadUsersComment', vm.classPK).then(result => {\n    //     vm.usersComment = result\n    //   })\n    // })\n  },\n  mounted () {\n    // var vm = this\n    // if (vm.classPK) {\n    //   vm.$store.dispatch('loadUsersComment', vm.classPK).then(result => {\n    //     vm.usersComment = result\n    //     vm.initComment()\n    //   }).catch(reject => {\n    //     vm.initComment()\n    //   })\n    // }\n  },\n  methods: {\n    runComment () {\n      var vm = this\n      if (vm.classPK) {\n        vm.initComment()\n        // vm.$store.dispatch('loadUsersComment', vm.classPK).then(result => {\n        //   vm.usersComment = result\n        //   vm.initComment()\n        // }).catch(reject => {\n        //   vm.initComment()\n        // })\n      }\n    },\n    initComment: function () {\n      var vm = this\n      $('#comments-container-el').comments({\n        profilePictureURL: 'https://png.icons8.com/material/50/000000/guest-male.png',\n        textareaRows: 2,\n        enableAttachments: true,\n        enableHashtags: true,\n        enablePinging: true,\n        postCommentOnEnter: false,\n        forceResponsive: false,\n        readOnly: false,\n        textareaPlaceholderText: 'Thêm bình luận mới',\n        newestText: 'Mới nhất',\n        oldestText: 'Cũ nhất',\n        popularText: 'Phổ biến',\n        attachmentsText: 'Đính kèm',\n        sendText: 'Gửi',\n        replyText: 'Trả lời',\n        editText: 'Sửa',\n        editedText: 'Đã sửa',\n        youText: 'Bạn',\n        saveText: 'Ghi lại',\n        deleteText: 'Xóa',\n        // viewAllRepliesText: 'Xem tất cả câu trả lời',\n        hideRepliesText: 'Ẩn câu trả lời',\n        noCommentsText: 'Không có bình luận nào',\n        noAttachmentsText: 'Không có tệp đính kèm',\n        attachmentDropText: 'Kéo thả tệp đính kèm',\n        fieldMappings: {\n          id: 'commentId',\n          parent: 'parent',\n          userId: 'userId',\n          created: 'createdDate',\n          modified: 'modifiedDate',\n          content: 'content',\n          fileURL: 'fileUrl',\n          fileMimeType: 'fileType',\n          fileName: 'fileName',\n          pings: 'pings',\n          creator: 'userId',\n          fullname: 'fullname',\n          profileURL: 'profileUrl',\n          profilePictureURL: 'pictureUrl',\n          isNew: 'isNew',\n          createdByAdmin: 'isAdmin',\n          createdByCurrentUser: 'createdByCurrentUser',\n          upvoteCount: 'upvoteCount',\n          userHasUpvoted: 'userHasUpvoted',\n          email: 'email',\n          opinion: 'opinion',\n          className: 'className',\n          classPK: 'classPK'\n        },\n        timeFormatter: function (time) {\n          if (time) {\n            let value = new Date(time)\n            value.setHours(value.getHours() - 7)\n            return `${value.getDate().toString().padStart(2, '0')}/${(value.getMonth() + 1).toString().padStart(2, '0')}/${value.getFullYear()} ${value.getHours().toString().padStart(2, '0')}:${value.getMinutes().toString().padStart(2, '0')}`\n          } else {\n            return ''\n          }\n        },\n        getUsers: function (onSuccess, onError) {\n          onSuccess(vm.usersComment)\n        },\n        getComments: function (onSuccess, onError) {\n          var dataGet = {\n            'classPK': vm.classPK,\n            'className': vm.className\n          }\n          let promise = vm.$store.dispatch('loadCommentItems', dataGet)\n          promise.then(result => {\n            var data = []\n            $.each(result, function (index, item) {\n              vm.comment = item\n              vm.formatComment(vm.comment)\n              data.push(vm.comment)\n            })\n            onSuccess(data)\n          }).catch(reject => {\n            onSuccess([])\n            onError()\n          })\n        },\n        postComment: function (data, onSuccess, onError) {\n          data.classPK = vm.classPK\n          data.className = vm.className\n          data.opinion = document.getElementById('opinion').checked\n          vm.$store.dispatch('postComment', data).then(result => {\n            if (result.opinion) {\n              $('.opinion').hide()\n            }\n            document.getElementById('opinion').checked = false\n            vm.comment = result\n            vm.formatComment(vm.comment)\n            onSuccess(vm.comment)\n          })\n        },\n        putComment: function (data, onSuccess, onError) {\n          data.classPK = vm.classPK\n          data.className = vm.className\n          vm.$store.dispatch('putComment', data).then(result => {\n            vm.comment = result\n            vm.formatComment(vm.comment)\n            onSuccess(vm.comment)\n          })\n        },\n        deleteComment: function (data, onSuccess, onError) {\n          data.classPK = vm.classPK\n          data.className = vm.className\n          vm.$store.dispatch('deleteComment', data).then(result => {\n            onSuccess()\n          }).catch(reject => {\n            onError()\n            console.log(reject)\n          })\n        },\n        upvoteComment: function (data, onSuccess, onError) {\n          data.classPK = vm.classPK\n          data.className = vm.className\n          vm.$store.dispatch('upvoteComment', data).then(result => {\n            vm.comment = result\n            vm.formatComment(vm.comment)\n            onSuccess(vm.comment)\n          }).catch(reject => {\n            console.log(reject)\n          })\n        },\n        uploadAttachments: function (comments, onSuccess, onError) {\n          var responses = 0\n          var successfulUploads = []\n          var serverResponded = function () {\n            responses++\n            if (responses === comments.length) {\n              if (successfulUploads.length === 0) {\n                onError()\n              } else {\n                onSuccess(successfulUploads)\n              }\n            }\n          }\n          $(comments).each(function (index, comment) {\n            var formData = new FormData()\n            $(Object.keys(comment)).each(function (index, key) {\n              var value = comment[key]\n              if (value) {\n                formData.append(key, value)\n              }\n            })\n            formData.append('file', comment.file)\n            formData.append('className', vm.className)\n            formData.append('classPK', vm.classPK)\n            formData.append('parent', comment.parent != null ? comment.parent : 0)\n            formData.append('fileName', comment.file.name)\n            formData.append('fileType', comment.file.type)\n            formData.append('fileSize', comment.file.size)\n            formData.append('pings', comment.pings.join())\n            // formData.append('email', 'congtrinh0209@gmail.com')\n            // formData.append('fullname', 'Công Trình')\n            formData.append('email', vm.initData.user.userEmail)\n            formData.append('fullname', vm.initData.user.userName)\n            formData.append('opinion', document.getElementById('opinion').checked)\n            $.ajax({\n              url: vm.initData.commentApi + '/uploads',\n              dataType: 'json',\n              type: 'POST',\n              headers: {\n                'groupId': vm.initData.groupId\n                // 'groupId': 55301\n              },\n              data: formData,\n              cache: false,\n              contentType: false,\n              processData: false,\n              success: function (comment) {\n                vm.formatComment(comment)\n                successfulUploads.push(vm.comment)\n                serverResponded()\n                if (comment.opinion) {\n                  $('.opinion').hide()\n                }\n                document.getElementById('opinion').checked = false\n              },\n              error: function (xhr, data) {\n                serverResponded()\n              }\n            })\n          })\n        }\n        // appendNewComments: function (commentJSONs, onSuccess, onError) {\n        //   const config = {\n        //     headers: {\n        //       'groupId': vm.group_id\n        //     }\n        //   }\n        //   let commentById = {}\n        //   let oldCommentsId = commentJSONs.map(function (c) {\n        //     commentById[c.id] = c.id + '' + c.userHasUpvoted + '' + c.upvoteCount + '' + c.content\n        //     return c.id\n        //   })\n        //   let url = vm.initData.commentApi + '/org.opencps.dossiermgt.model.Dossier/' + vm.classPK + '?start=0&end=10&sort=modified_Number&order=true'\n        //   axios.get(url, config).then(function (response) {\n        //     let data = []\n        //     let dataEdited = []\n        //     if (response.hasOwnProperty('data')) {\n        //       var serializable = response.data.data\n        //       let curId = 0\n        //       let code = ''\n        //       for (var key in serializable) {\n        //         vm.comment = serializable[key]\n        //         curId = vm.comment['commentId']\n        //         code = vm.comment['commentId'] + '' + vm.comment['userHasUpvoted'] + '' + vm.comment['upvoteCount'] + '' + vm.comment['content']\n        //         vm.formatComment(vm.comment)\n        //         /* check return if not exist */\n        //         if (oldCommentsId.indexOf(curId) === -1) {\n        //           data.push(vm.comment)\n        //         } else if (code !== commentById[curId]) {\n        //           /* if have changed */\n        //           dataEdited.push(vm.comment)\n        //         }\n        //       }\n        //       onSuccess(data, dataEdited)\n        //     }\n        //   })\n        //   .catch(function (error) {\n        //     console.log(error)\n        //   })\n        // }\n      })\n    },\n    formatComment: function (comment) {\n      var vm = this\n      vm.comment = comment\n      if (comment.parent === 0) {\n        vm.comment.parent = null\n      }\n      if (comment.fileName === '') {\n        vm.comment.fileName = null\n      }\n      if (comment.fileType === '') {\n        vm.comment.fileType = null\n      }\n      if (comment.fileUrl === '') {\n        vm.comment.fileUrl = null\n      }\n      if (comment.pictureUrl === '') {\n        vm.comment.pictureUrl = 'https://png.icons8.com/material/50/000000/guest-male.png'\n      }\n      vm.comment.fullname = comment.fullname\n      vm.comment.opinion = comment.opinion\n      vm.comment.pings = comment.pings.toString().split(',')\n      vm.comment.createdDate = vm.comment.createDate\n      vm.comment.modifiedDate = vm.comment.modifiedDate\n    },\n    dateTimeView (arg) {\n      if (arg) {\n        let value = new Date(arg)\n        return `${value.getDate().toString().padStart(2, '0')}/${(value.getMonth() + 1).toString().padStart(2, '0')}/${value.getFullYear()} ${value.getHours().toString().padStart(2, '0')}:${value.getMinutes().toString().padStart(2, '0')}`\n      } else {\n        return ''\n      }\n    }\n  },\n  filters: {\n    dateTimeView (arg) {\n      if (arg) {\n        let value = new Date(arg)\n        return `${value.getDate().toString().padStart(2, '0')}/${(value.getMonth() + 1).toString().padStart(2, '0')}/${value.getFullYear()}  ${value.getHours().toString().padStart(2, '0')}:${value.getMinutes().toString().padStart(2, '0')}`\n      } else {\n        return ''\n      }\n    }\n  }\n}\n</script>\n\n\n\n// WEBPACK FOOTER //\n// Comment.vue?c5cd8c96","module.exports = { \"default\": require(\"core-js/library/fn/object/create\"), __esModule: true };\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/babel-runtime/core-js/object/create.js\n// module id = 694\n// module chunks = 0 1 5 7","require('../../modules/es6.object.create');\nvar $Object = require('../../modules/_core').Object;\nmodule.exports = function create(P, D) {\n  return $Object.create(P, D);\n};\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/fn/object/create.js\n// module id = 695\n// module chunks = 0 1 5 7","var $export = require('./_export');\n// 19.1.2.2 / 15.2.3.5 Object.create(O [, Properties])\n$export($export.S, 'Object', { create: require('./_object-create') });\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/core-js/library/modules/es6.object.create.js\n// module id = 696\n// module chunks = 0 1 5 7","(function (factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD. Register as an anonymous module.\n    define(['jquery'], factory);\n  } else if (typeof module === \"object\" && module.exports) {\n    var $ = require('jquery');\n    module.exports = factory($);\n  } else {\n    // Browser globals\n    factory(jQuery);\n  }\n}(function (jQuery) {\n\n/*!\n * jQuery.textcomplete\n *\n * Repository: https://github.com/yuku-t/jquery-textcomplete\n * License:    MIT (https://github.com/yuku-t/jquery-textcomplete/blob/master/LICENSE)\n * Author:     Yuku Takahashi\n */\n\nif (typeof jQuery === 'undefined') {\n  throw new Error('jQuery.textcomplete requires jQuery');\n}\n\n+function ($) {\n  'use strict';\n\n  var warn = function (message) {\n    if (console.warn) { console.warn(message); }\n  };\n\n  var id = 1;\n\n  $.fn.textcomplete = function (strategies, option) {\n    var args = Array.prototype.slice.call(arguments);\n    return this.each(function () {\n      var self = this;\n      var $this = $(this);\n      var completer = $this.data('textComplete');\n      if (!completer) {\n        option || (option = {});\n        option._oid = id++;  // unique object id\n        completer = new $.fn.textcomplete.Completer(this, option);\n        $this.data('textComplete', completer);\n      }\n      if (typeof strategies === 'string') {\n        if (!completer) return;\n        args.shift()\n        completer[strategies].apply(completer, args);\n        if (strategies === 'destroy') {\n          $this.removeData('textComplete');\n        }\n      } else {\n        // For backward compatibility.\n        // TODO: Remove at v0.4\n        $.each(strategies, function (obj) {\n          $.each(['header', 'footer', 'placement', 'maxCount'], function (name) {\n            if (obj[name]) {\n              completer.option[name] = obj[name];\n              warn(name + 'as a strategy param is deprecated. Use option.');\n              delete obj[name];\n            }\n          });\n        });\n        completer.register($.fn.textcomplete.Strategy.parse(strategies, {\n          el: self,\n          $el: $this\n        }));\n      }\n    });\n  };\n\n}(jQuery);\n\n+function ($) {\n  'use strict';\n\n  // Exclusive execution control utility.\n  //\n  // func - The function to be locked. It is executed with a function named\n  //        `free` as the first argument. Once it is called, additional\n  //        execution are ignored until the free is invoked. Then the last\n  //        ignored execution will be replayed immediately.\n  //\n  // Examples\n  //\n  //   var lockedFunc = lock(function (free) {\n  //     setTimeout(function { free(); }, 1000); // It will be free in 1 sec.\n  //     console.log('Hello, world');\n  //   });\n  //   lockedFunc();  // => 'Hello, world'\n  //   lockedFunc();  // none\n  //   lockedFunc();  // none\n  //   // 1 sec past then\n  //   // => 'Hello, world'\n  //   lockedFunc();  // => 'Hello, world'\n  //   lockedFunc();  // none\n  //\n  // Returns a wrapped function.\n  var lock = function (func) {\n    var locked, queuedArgsToReplay;\n\n    return function () {\n      // Convert arguments into a real array.\n      var args = Array.prototype.slice.call(arguments);\n      if (locked) {\n        // Keep a copy of this argument list to replay later.\n        // OK to overwrite a previous value because we only replay\n        // the last one.\n        queuedArgsToReplay = args;\n        return;\n      }\n      locked = true;\n      var self = this;\n      args.unshift(function replayOrFree() {\n        if (queuedArgsToReplay) {\n          // Other request(s) arrived while we were locked.\n          // Now that the lock is becoming available, replay\n          // the latest such request, then call back here to\n          // unlock (or replay another request that arrived\n          // while this one was in flight).\n          var replayArgs = queuedArgsToReplay;\n          queuedArgsToReplay = undefined;\n          replayArgs.unshift(replayOrFree);\n          func.apply(self, replayArgs);\n        } else {\n          locked = false;\n        }\n      });\n      func.apply(this, args);\n    };\n  };\n\n  var isString = function (obj) {\n    return Object.prototype.toString.call(obj) === '[object String]';\n  };\n\n  var uniqueId = 0;\n  var initializedEditors = [];\n\n  function Completer(element, option) {\n    this.$el        = $(element);\n    this.id         = 'textcomplete' + uniqueId++;\n    this.strategies = [];\n    this.views      = [];\n    this.option     = $.extend({}, Completer.defaults, option);\n\n    if (!this.$el.is('input[type=text]') && !this.$el.is('input[type=search]') && !this.$el.is('textarea') && !element.isContentEditable && element.contentEditable != 'true') {\n      throw new Error('textcomplete must be called on a Textarea or a ContentEditable.');\n    }\n\n    // use ownerDocument to fix iframe / IE issues\n    if (element === element.ownerDocument.activeElement) {\n      // element has already been focused. Initialize view objects immediately.\n      this.initialize()\n    } else {\n      // Initialize view objects lazily.\n      var self = this;\n      this.$el.one('focus.' + this.id, function () { self.initialize(); });\n\n      // Special handling for CKEditor: lazy init on instance load\n      if ((!this.option.adapter || this.option.adapter == 'CKEditor') && typeof CKEDITOR != 'undefined' && (this.$el.is('textarea'))) {\n        CKEDITOR.on(\"instanceReady\", function(event) { //For multiple ckeditors on one page: this needs to be executed each time a ckeditor-instance is ready.\n\n          if($.inArray(event.editor.id, initializedEditors) == -1) { //For multiple ckeditors on one page: focus-eventhandler should only be added once for every editor.\n            initializedEditors.push(event.editor.id);\n\t\t\t\n            event.editor.on(\"focus\", function(event2) {\n\t\t\t\t//replace the element with the Iframe element and flag it as CKEditor\n\t\t\t\tself.$el = $(event.editor.editable().$);\n\t\t\t\tif (!self.option.adapter) {\n\t\t\t\t\tself.option.adapter = $.fn.textcomplete['CKEditor'];\n\t\t\t\t}\n\t\t\t\tself.option.ckeditor_instance = event.editor; //For multiple ckeditors on one page: in the old code this was not executed when adapter was alread set. So we were ALWAYS working with the FIRST instance.\n              \tself.initialize();\n            });\n          }\n        });\n      }\n    }\n  }\n\n  Completer.defaults = {\n    appendTo: 'body',\n    className: '',  // deprecated option\n    dropdownClassName: 'dropdown-menu textcomplete-dropdown',\n    maxCount: 10,\n    zIndex: '100',\n    rightEdgeOffset: 30\n  };\n\n  $.extend(Completer.prototype, {\n    // Public properties\n    // -----------------\n\n    id:         null,\n    option:     null,\n    strategies: null,\n    adapter:    null,\n    dropdown:   null,\n    $el:        null,\n    $iframe:    null,\n\n    // Public methods\n    // --------------\n\n    initialize: function () {\n      var element = this.$el.get(0);\n      \n      // check if we are in an iframe\n      // we need to alter positioning logic if using an iframe\n      if (this.$el.prop('ownerDocument') !== document && window.frames.length) {\n        for (var iframeIndex = 0; iframeIndex < window.frames.length; iframeIndex++) {\n          if (this.$el.prop('ownerDocument') === window.frames[iframeIndex].document) {\n            this.$iframe = $(window.frames[iframeIndex].frameElement);\n            break;\n          }\n        }\n      }\n      \n      \n      // Initialize view objects.\n      this.dropdown = new $.fn.textcomplete.Dropdown(element, this, this.option);\n      var Adapter, viewName;\n      if (this.option.adapter) {\n        Adapter = this.option.adapter;\n      } else {\n        if (this.$el.is('textarea') || this.$el.is('input[type=text]') || this.$el.is('input[type=search]')) {\n          viewName = typeof element.selectionEnd === 'number' ? 'Textarea' : 'IETextarea';\n        } else {\n          viewName = 'ContentEditable';\n        }\n        Adapter = $.fn.textcomplete[viewName];\n      }\n      this.adapter = new Adapter(element, this, this.option);\n    },\n\n    destroy: function () {\n      this.$el.off('.' + this.id);\n      if (this.adapter) {\n        this.adapter.destroy();\n      }\n      if (this.dropdown) {\n        this.dropdown.destroy();\n      }\n      this.$el = this.adapter = this.dropdown = null;\n    },\n\n    deactivate: function () {\n      if (this.dropdown) {\n        this.dropdown.deactivate();\n      }\n    },\n\n    // Invoke textcomplete.\n    trigger: function (text, skipUnchangedTerm) {\n      if (!this.dropdown) { this.initialize(); }\n      text != null || (text = this.adapter.getTextFromHeadToCaret());\n      var searchQuery = this._extractSearchQuery(text);\n      if (searchQuery.length) {\n        var term = searchQuery[1];\n        // Ignore shift-key, ctrl-key and so on.\n        if (skipUnchangedTerm && this._term === term && term !== \"\") { return; }\n        this._term = term;\n        this._search.apply(this, searchQuery);\n      } else {\n        this._term = null;\n        this.dropdown.deactivate();\n      }\n    },\n\n    fire: function (eventName) {\n      var args = Array.prototype.slice.call(arguments, 1);\n      this.$el.trigger(eventName, args);\n      return this;\n    },\n\n    register: function (strategies) {\n      Array.prototype.push.apply(this.strategies, strategies);\n    },\n\n    // Insert the value into adapter view. It is called when the dropdown is clicked\n    // or selected.\n    //\n    // value    - The selected element of the array callbacked from search func.\n    // strategy - The Strategy object.\n    // e        - Click or keydown event object.\n    select: function (value, strategy, e) {\n      this._term = null;\n      this.adapter.select(value, strategy, e);\n      this.fire('change').fire('textComplete:select', value, strategy);\n      this.adapter.focus();\n    },\n\n    // Private properties\n    // ------------------\n\n    _clearAtNext: true,\n    _term:        null,\n\n    // Private methods\n    // ---------------\n\n    // Parse the given text and extract the first matching strategy.\n    //\n    // Returns an array including the strategy, the query term and the match\n    // object if the text matches an strategy; otherwise returns an empty array.\n    _extractSearchQuery: function (text) {\n      for (var i = 0; i < this.strategies.length; i++) {\n        var strategy = this.strategies[i];\n        var context = strategy.context(text);\n        if (context || context === '') {\n          var matchRegexp = $.isFunction(strategy.match) ? strategy.match(text) : strategy.match;\n          if (isString(context)) { text = context; }\n          var match = text.match(matchRegexp);\n          if (match) { return [strategy, match[strategy.index], match]; }\n        }\n      }\n      return []\n    },\n\n    // Call the search method of selected strategy..\n    _search: lock(function (free, strategy, term, match) {\n      var self = this;\n      strategy.search(term, function (data, stillSearching) {\n        if (!self.dropdown.shown) {\n          self.dropdown.activate();\n        }\n        if (self._clearAtNext) {\n          // The first callback in the current lock.\n          self.dropdown.clear();\n          self._clearAtNext = false;\n        }\n        self.dropdown.setPosition(self.adapter.getCaretPosition());\n        self.dropdown.render(self._zip(data, strategy, term));\n        if (!stillSearching) {\n          // The last callback in the current lock.\n          free();\n          self._clearAtNext = true; // Call dropdown.clear at the next time.\n        }\n      }, match);\n    }),\n\n    // Build a parameter for Dropdown#render.\n    //\n    // Examples\n    //\n    //  this._zip(['a', 'b'], 's');\n    //  //=> [{ value: 'a', strategy: 's' }, { value: 'b', strategy: 's' }]\n    _zip: function (data, strategy, term) {\n      return $.map(data, function (value) {\n        return { value: value, strategy: strategy, term: term };\n      });\n    }\n  });\n\n  $.fn.textcomplete.Completer = Completer;\n}(jQuery);\n\n+function ($) {\n  'use strict';\n\n  var $window = $(window);\n\n  var include = function (zippedData, datum) {\n    var i, elem;\n    var idProperty = datum.strategy.idProperty\n    for (i = 0; i < zippedData.length; i++) {\n      elem = zippedData[i];\n      if (elem.strategy !== datum.strategy) continue;\n      if (idProperty) {\n        if (elem.value[idProperty] === datum.value[idProperty]) return true;\n      } else {\n        if (elem.value === datum.value) return true;\n      }\n    }\n    return false;\n  };\n\n  var dropdownViews = {};\n  $(document).on('click', function (e) {\n    var id = e.originalEvent && e.originalEvent.keepTextCompleteDropdown;\n    $.each(dropdownViews, function (key, view) {\n      if (key !== id) { view.deactivate(); }\n    });\n  });\n\n  var commands = {\n    SKIP_DEFAULT: 0,\n    KEY_UP: 1,\n    KEY_DOWN: 2,\n    KEY_ENTER: 3,\n    KEY_PAGEUP: 4,\n    KEY_PAGEDOWN: 5,\n    KEY_ESCAPE: 6\n  };\n\n  // Dropdown view\n  // =============\n\n  // Construct Dropdown object.\n  //\n  // element - Textarea or contenteditable element.\n  function Dropdown(element, completer, option) {\n    this.$el       = Dropdown.createElement(option);\n    this.completer = completer;\n    this.id        = completer.id + 'dropdown';\n    this._data     = []; // zipped data.\n    this.$inputEl  = $(element);\n    this.option    = option;\n\n    // Override setPosition method.\n    if (option.listPosition) { this.setPosition = option.listPosition; }\n    if (option.height) { this.$el.height(option.height); }\n    var self = this;\n    $.each(['maxCount', 'placement', 'footer', 'header', 'noResultsMessage', 'className'], function (_i, name) {\n      if (option[name] != null) { self[name] = option[name]; }\n    });\n    this._bindEvents(element);\n    dropdownViews[this.id] = this;\n  }\n\n  $.extend(Dropdown, {\n    // Class methods\n    // -------------\n\n    createElement: function (option) {\n      var $parent = option.appendTo;\n      if (!($parent instanceof $)) { $parent = $($parent); }\n      var $el = $('<ul></ul>')\n        .addClass(option.dropdownClassName)\n        .attr('id', 'textcomplete-dropdown-' + option._oid)\n        .css({\n          display: 'none',\n          left: 0,\n          position: 'absolute',\n          zIndex: option.zIndex\n        })\n        .appendTo($parent);\n      return $el;\n    }\n  });\n\n  $.extend(Dropdown.prototype, {\n    // Public properties\n    // -----------------\n\n    $el:       null,  // jQuery object of ul.dropdown-menu element.\n    $inputEl:  null,  // jQuery object of target textarea.\n    completer: null,\n    footer:    null,\n    header:    null,\n    id:        null,\n    maxCount:  null,\n    placement: '',\n    shown:     false,\n    data:      [],     // Shown zipped data.\n    className: '',\n\n    // Public methods\n    // --------------\n\n    destroy: function () {\n      // Don't remove $el because it may be shared by several textcompletes.\n      this.deactivate();\n\n      this.$el.off('.' + this.id);\n      this.$inputEl.off('.' + this.id);\n      this.clear();\n      this.$el.remove();\n      this.$el = this.$inputEl = this.completer = null;\n      delete dropdownViews[this.id]\n    },\n\n    render: function (zippedData) {\n      var contentsHtml = this._buildContents(zippedData);\n      var unzippedData = $.map(zippedData, function (d) { return d.value; });\n      if (zippedData.length) {\n        var strategy = zippedData[0].strategy;\n        if (strategy.id) {\n          this.$el.attr('data-strategy', strategy.id);\n        } else {\n          this.$el.removeAttr('data-strategy');\n        }\n        this._renderHeader(unzippedData);\n        this._renderFooter(unzippedData);\n        if (contentsHtml) {\n          this._renderContents(contentsHtml);\n          this._fitToBottom();\n          this._fitToRight();\n          this._activateIndexedItem();\n        }\n        this._setScroll();\n      } else if (this.noResultsMessage) {\n        this._renderNoResultsMessage(unzippedData);\n      } else if (this.shown) {\n        this.deactivate();\n      }\n    },\n\n    setPosition: function (pos) {\n      // Make the dropdown fixed if the input is also fixed\n      // This can't be done during init, as textcomplete may be used on multiple elements on the same page\n      // Because the same dropdown is reused behind the scenes, we need to recheck every time the dropdown is showed\n      var position = 'absolute';\n      // Check if input or one of its parents has positioning we need to care about\n      this.$inputEl.add(this.$inputEl.parents()).each(function() {\n        if($(this).css('position') === 'absolute') // The element has absolute positioning, so it's all OK\n          return false;\n        if($(this).css('position') === 'fixed') {\n          pos.top -= $window.scrollTop();\n          pos.left -= $window.scrollLeft();\n          position = 'fixed';\n          return false;\n        }\n      });\n      this.$el.css(this._applyPlacement(pos));\n      this.$el.css({ position: position }); // Update positioning\n\n      return this;\n    },\n\n    clear: function () {\n      this.$el.html('');\n      this.data = [];\n      this._index = 0;\n      this._$header = this._$footer = this._$noResultsMessage = null;\n    },\n\n    activate: function () {\n      if (!this.shown) {\n        this.clear();\n        this.$el.show();\n        if (this.className) { this.$el.addClass(this.className); }\n        this.completer.fire('textComplete:show');\n        this.shown = true;\n      }\n      return this;\n    },\n\n    deactivate: function () {\n      if (this.shown) {\n        this.$el.hide();\n        if (this.className) { this.$el.removeClass(this.className); }\n        this.completer.fire('textComplete:hide');\n        this.shown = false;\n      }\n      return this;\n    },\n\n    isUp: function (e) {\n      return e.keyCode === 38 || (e.ctrlKey && e.keyCode === 80);  // UP, Ctrl-P\n    },\n\n    isDown: function (e) {\n      return e.keyCode === 40 || (e.ctrlKey && e.keyCode === 78);  // DOWN, Ctrl-N\n    },\n\n    isEnter: function (e) {\n      var modifiers = e.ctrlKey || e.altKey || e.metaKey || e.shiftKey;\n      return !modifiers && (e.keyCode === 13 || e.keyCode === 9 || (this.option.completeOnSpace === true && e.keyCode === 32))  // ENTER, TAB\n    },\n\n    isPageup: function (e) {\n      return e.keyCode === 33;  // PAGEUP\n    },\n\n    isPagedown: function (e) {\n      return e.keyCode === 34;  // PAGEDOWN\n    },\n\n    isEscape: function (e) {\n      return e.keyCode === 27;  // ESCAPE\n    },\n\n    // Private properties\n    // ------------------\n\n    _data:    null,  // Currently shown zipped data.\n    _index:   null,\n    _$header: null,\n    _$noResultsMessage: null,\n    _$footer: null,\n\n    // Private methods\n    // ---------------\n\n    _bindEvents: function () {\n      this.$el.on('mousedown.' + this.id, '.textcomplete-item', $.proxy(this._onClick, this));\n      this.$el.on('touchstart.' + this.id, '.textcomplete-item', $.proxy(this._onClick, this));\n      this.$el.on('mouseover.' + this.id, '.textcomplete-item', $.proxy(this._onMouseover, this));\n      this.$inputEl.on('keydown.' + this.id, $.proxy(this._onKeydown, this));\n    },\n\n    _onClick: function (e) {\n      var $el = $(e.target);\n      e.preventDefault();\n      e.originalEvent.keepTextCompleteDropdown = this.id;\n      if (!$el.hasClass('textcomplete-item')) {\n        $el = $el.closest('.textcomplete-item');\n      }\n      var datum = this.data[parseInt($el.data('index'), 10)];\n      this.completer.select(datum.value, datum.strategy, e);\n      var self = this;\n      // Deactive at next tick to allow other event handlers to know whether\n      // the dropdown has been shown or not.\n      setTimeout(function () {\n        self.deactivate();\n        if (e.type === 'touchstart') {\n          self.$inputEl.focus();\n        }\n      }, 0);\n    },\n\n    // Activate hovered item.\n    _onMouseover: function (e) {\n      var $el = $(e.target);\n      e.preventDefault();\n      if (!$el.hasClass('textcomplete-item')) {\n        $el = $el.closest('.textcomplete-item');\n      }\n      this._index = parseInt($el.data('index'), 10);\n      this._activateIndexedItem();\n    },\n\n    _onKeydown: function (e) {\n      if (!this.shown) { return; }\n\n      var command;\n\n      if ($.isFunction(this.option.onKeydown)) {\n        command = this.option.onKeydown(e, commands);\n      }\n\n      if (command == null) {\n        command = this._defaultKeydown(e);\n      }\n\n      switch (command) {\n        case commands.KEY_UP:\n          e.preventDefault();\n          this._up();\n          break;\n        case commands.KEY_DOWN:\n          e.preventDefault();\n          this._down();\n          break;\n        case commands.KEY_ENTER:\n          e.preventDefault();\n          this._enter(e);\n          break;\n        case commands.KEY_PAGEUP:\n          e.preventDefault();\n          this._pageup();\n          break;\n        case commands.KEY_PAGEDOWN:\n          e.preventDefault();\n          this._pagedown();\n          break;\n        case commands.KEY_ESCAPE:\n          e.preventDefault();\n          this.deactivate();\n          break;\n      }\n    },\n\n    _defaultKeydown: function (e) {\n      if (this.isUp(e)) {\n        return commands.KEY_UP;\n      } else if (this.isDown(e)) {\n        return commands.KEY_DOWN;\n      } else if (this.isEnter(e)) {\n        return commands.KEY_ENTER;\n      } else if (this.isPageup(e)) {\n        return commands.KEY_PAGEUP;\n      } else if (this.isPagedown(e)) {\n        return commands.KEY_PAGEDOWN;\n      } else if (this.isEscape(e)) {\n        return commands.KEY_ESCAPE;\n      }\n    },\n\n    _up: function () {\n      if (this._index === 0) {\n        this._index = this.data.length - 1;\n      } else {\n        this._index -= 1;\n      }\n      this._activateIndexedItem();\n      this._setScroll();\n    },\n\n    _down: function () {\n      if (this._index === this.data.length - 1) {\n        this._index = 0;\n      } else {\n        this._index += 1;\n      }\n      this._activateIndexedItem();\n      this._setScroll();\n    },\n\n    _enter: function (e) {\n      var datum = this.data[parseInt(this._getActiveElement().data('index'), 10)];\n      this.completer.select(datum.value, datum.strategy, e);\n      this.deactivate();\n    },\n\n    _pageup: function () {\n      var target = 0;\n      var threshold = this._getActiveElement().position().top - this.$el.innerHeight();\n      this.$el.children().each(function (i) {\n        if ($(this).position().top + $(this).outerHeight() > threshold) {\n          target = i;\n          return false;\n        }\n      });\n      this._index = target;\n      this._activateIndexedItem();\n      this._setScroll();\n    },\n\n    _pagedown: function () {\n      var target = this.data.length - 1;\n      var threshold = this._getActiveElement().position().top + this.$el.innerHeight();\n      this.$el.children().each(function (i) {\n        if ($(this).position().top > threshold) {\n          target = i;\n          return false\n        }\n      });\n      this._index = target;\n      this._activateIndexedItem();\n      this._setScroll();\n    },\n\n    _activateIndexedItem: function () {\n      this.$el.find('.textcomplete-item.active').removeClass('active');\n      this._getActiveElement().addClass('active');\n    },\n\n    _getActiveElement: function () {\n      return this.$el.children('.textcomplete-item:nth(' + this._index + ')');\n    },\n\n    _setScroll: function () {\n      var $activeEl = this._getActiveElement();\n      var itemTop = $activeEl.position().top;\n      var itemHeight = $activeEl.outerHeight();\n      var visibleHeight = this.$el.innerHeight();\n      var visibleTop = this.$el.scrollTop();\n      if (this._index === 0 || this._index == this.data.length - 1 || itemTop < 0) {\n        this.$el.scrollTop(itemTop + visibleTop);\n      } else if (itemTop + itemHeight > visibleHeight) {\n        this.$el.scrollTop(itemTop + itemHeight + visibleTop - visibleHeight);\n      }\n    },\n\n    _buildContents: function (zippedData) {\n      var datum, i, index;\n      var html = '';\n      for (i = 0; i < zippedData.length; i++) {\n        if (this.data.length === this.maxCount) break;\n        datum = zippedData[i];\n        if (include(this.data, datum)) { continue; }\n        index = this.data.length;\n        this.data.push(datum);\n        html += '<li class=\"textcomplete-item\" data-index=\"' + index + '\"><a>';\n        html +=   datum.strategy.template(datum.value, datum.term);\n        html += '</a></li>';\n      }\n      return html;\n    },\n\n    _renderHeader: function (unzippedData) {\n      if (this.header) {\n        if (!this._$header) {\n          this._$header = $('<li class=\"textcomplete-header\"></li>').prependTo(this.$el);\n        }\n        var html = $.isFunction(this.header) ? this.header(unzippedData) : this.header;\n        this._$header.html(html);\n      }\n    },\n\n    _renderFooter: function (unzippedData) {\n      if (this.footer) {\n        if (!this._$footer) {\n          this._$footer = $('<li class=\"textcomplete-footer\"></li>').appendTo(this.$el);\n        }\n        var html = $.isFunction(this.footer) ? this.footer(unzippedData) : this.footer;\n        this._$footer.html(html);\n      }\n    },\n\n    _renderNoResultsMessage: function (unzippedData) {\n      if (this.noResultsMessage) {\n        if (!this._$noResultsMessage) {\n          this._$noResultsMessage = $('<li class=\"textcomplete-no-results-message\"></li>').appendTo(this.$el);\n        }\n        var html = $.isFunction(this.noResultsMessage) ? this.noResultsMessage(unzippedData) : this.noResultsMessage;\n        this._$noResultsMessage.html(html);\n      }\n    },\n\n    _renderContents: function (html) {\n      if (this._$footer) {\n        this._$footer.before(html);\n      } else {\n        this.$el.append(html);\n      }\n    },\n\n    _fitToBottom: function() {\n      var windowScrollBottom = $window.scrollTop() + $window.height();\n      var height = this.$el.height();\n      if ((this.$el.position().top + height) > windowScrollBottom) {\n        // only do this if we are not in an iframe\n        if (!this.completer.$iframe) {\n          this.$el.offset({top: windowScrollBottom - height});\n        }\n      }\n    },\n\n    _fitToRight: function() {\n      // We don't know how wide our content is until the browser positions us, and at that point it clips us\n      // to the document width so we don't know if we would have overrun it. As a heuristic to avoid that clipping\n      // (which makes our elements wrap onto the next line and corrupt the next item), if we're close to the right\n      // edge, move left. We don't know how far to move left, so just keep nudging a bit.\n      var tolerance = this.option.rightEdgeOffset; // pixels. Make wider than vertical scrollbar because we might not be able to use that space.\n      var lastOffset = this.$el.offset().left, offset;\n      var width = this.$el.width();\n      var maxLeft = $window.width() - tolerance;\n      while (lastOffset + width > maxLeft) {\n        this.$el.offset({left: lastOffset - tolerance});\n        offset = this.$el.offset().left;\n        if (offset >= lastOffset) { break; }\n        lastOffset = offset;\n      }\n    },\n\n    _applyPlacement: function (position) {\n      // If the 'placement' option set to 'top', move the position above the element.\n      if (this.placement.indexOf('top') !== -1) {\n        // Overwrite the position object to set the 'bottom' property instead of the top.\n        position = {\n          top: 'auto',\n          bottom: this.$el.parent().height() - position.top + position.lineHeight,\n          left: position.left\n        };\n      } else {\n        position.bottom = 'auto';\n        delete position.lineHeight;\n      }\n      if (this.placement.indexOf('absleft') !== -1) {\n        position.left = 0;\n      } else if (this.placement.indexOf('absright') !== -1) {\n        position.right = 0;\n        position.left = 'auto';\n      }\n      return position;\n    }\n  });\n\n  $.fn.textcomplete.Dropdown = Dropdown;\n  $.extend($.fn.textcomplete, commands);\n}(jQuery);\n\n+function ($) {\n  'use strict';\n\n  // Memoize a search function.\n  var memoize = function (func) {\n    var memo = {};\n    return function (term, callback) {\n      if (memo[term]) {\n        callback(memo[term]);\n      } else {\n        func.call(this, term, function (data) {\n          memo[term] = (memo[term] || []).concat(data);\n          callback.apply(null, arguments);\n        });\n      }\n    };\n  };\n\n  function Strategy(options) {\n    $.extend(this, options);\n    if (this.cache) { this.search = memoize(this.search); }\n  }\n\n  Strategy.parse = function (strategiesArray, params) {\n    return $.map(strategiesArray, function (strategy) {\n      var strategyObj = new Strategy(strategy);\n      strategyObj.el = params.el;\n      strategyObj.$el = params.$el;\n      return strategyObj;\n    });\n  };\n\n  $.extend(Strategy.prototype, {\n    // Public properties\n    // -----------------\n\n    // Required\n    match:      null,\n    replace:    null,\n    search:     null,\n\n    // Optional\n    id:         null,\n    cache:      false,\n    context:    function () { return true; },\n    index:      2,\n    template:   function (obj) { return obj; },\n    idProperty: null\n  });\n\n  $.fn.textcomplete.Strategy = Strategy;\n\n}(jQuery);\n\n+function ($) {\n  'use strict';\n\n  var now = Date.now || function () { return new Date().getTime(); };\n\n  // Returns a function, that, as long as it continues to be invoked, will not\n  // be triggered. The function will be called after it stops being called for\n  // `wait` msec.\n  //\n  // This utility function was originally implemented at Underscore.js.\n  var debounce = function (func, wait) {\n    var timeout, args, context, timestamp, result;\n    var later = function () {\n      var last = now() - timestamp;\n      if (last < wait) {\n        timeout = setTimeout(later, wait - last);\n      } else {\n        timeout = null;\n        result = func.apply(context, args);\n        context = args = null;\n      }\n    };\n\n    return function () {\n      context = this;\n      args = arguments;\n      timestamp = now();\n      if (!timeout) {\n        timeout = setTimeout(later, wait);\n      }\n      return result;\n    };\n  };\n\n  function Adapter () {}\n\n  $.extend(Adapter.prototype, {\n    // Public properties\n    // -----------------\n\n    id:        null, // Identity.\n    completer: null, // Completer object which creates it.\n    el:        null, // Textarea element.\n    $el:       null, // jQuery object of the textarea.\n    option:    null,\n\n    // Public methods\n    // --------------\n\n    initialize: function (element, completer, option) {\n      this.el        = element;\n      this.$el       = $(element);\n      this.id        = completer.id + this.constructor.name;\n      this.completer = completer;\n      this.option    = option;\n\n      if (this.option.debounce) {\n        this._onKeyup = debounce(this._onKeyup, this.option.debounce);\n      }\n\n      this._bindEvents();\n    },\n\n    destroy: function () {\n      this.$el.off('.' + this.id); // Remove all event handlers.\n      this.$el = this.el = this.completer = null;\n    },\n\n    // Update the element with the given value and strategy.\n    //\n    // value    - The selected object. It is one of the item of the array\n    //            which was callbacked from the search function.\n    // strategy - The Strategy associated with the selected value.\n    select: function (/* value, strategy */) {\n      throw new Error('Not implemented');\n    },\n\n    // Returns the caret's relative coordinates from body's left top corner.\n    getCaretPosition: function () {\n      var position = this._getCaretRelativePosition();\n      var offset = this.$el.offset();\n\n      // Calculate the left top corner of `this.option.appendTo` element.\n      var $parent = this.option.appendTo;\n      if ($parent) {\n         if (!($parent instanceof $)) { $parent = $($parent); }\n         var parentOffset = $parent.offsetParent().offset();\n         offset.top -= parentOffset.top;\n         offset.left -= parentOffset.left;\n      }\n\n      position.top += offset.top;\n      position.left += offset.left;\n      return position;\n    },\n\n    // Focus on the element.\n    focus: function () {\n      this.$el.focus();\n    },\n\n    // Private methods\n    // ---------------\n\n    _bindEvents: function () {\n      this.$el.on('keyup.' + this.id, $.proxy(this._onKeyup, this));\n    },\n\n    _onKeyup: function (e) {\n      if (this._skipSearch(e)) { return; }\n      this.completer.trigger(this.getTextFromHeadToCaret(), true);\n    },\n\n    // Suppress searching if it returns true.\n    _skipSearch: function (clickEvent) {\n      switch (clickEvent.keyCode) {\n        case 9:  // TAB\n        case 13: // ENTER\n        case 16: // SHIFT\n        case 17: // CTRL\n        case 18: // ALT\n        case 33: // PAGEUP\n        case 34: // PAGEDOWN\n        case 40: // DOWN\n        case 38: // UP\n        case 27: // ESC\n          return true;\n      }\n      if (clickEvent.ctrlKey) switch (clickEvent.keyCode) {\n        case 78: // Ctrl-N\n        case 80: // Ctrl-P\n          return true;\n      }\n    }\n  });\n\n  $.fn.textcomplete.Adapter = Adapter;\n}(jQuery);\n\n+function ($) {\n  'use strict';\n\n  // Textarea adapter\n  // ================\n  //\n  // Managing a textarea. It doesn't know a Dropdown.\n  function Textarea(element, completer, option) {\n    this.initialize(element, completer, option);\n  }\n\n  $.extend(Textarea.prototype, $.fn.textcomplete.Adapter.prototype, {\n    // Public methods\n    // --------------\n\n    // Update the textarea with the given value and strategy.\n    select: function (value, strategy, e) {\n      var pre = this.getTextFromHeadToCaret();\n      var post = this.el.value.substring(this.el.selectionEnd);\n      var newSubstr = strategy.replace(value, e);\n      var regExp;\n      if (typeof newSubstr !== 'undefined') {\n        if ($.isArray(newSubstr)) {\n          post = newSubstr[1] + post;\n          newSubstr = newSubstr[0];\n        }\n        regExp = $.isFunction(strategy.match) ? strategy.match(pre) : strategy.match;\n        pre = pre.replace(regExp, newSubstr);\n        this.$el.val(pre + post);\n        this.el.selectionStart = this.el.selectionEnd = pre.length;\n      }\n    },\n\n    getTextFromHeadToCaret: function () {\n      return this.el.value.substring(0, this.el.selectionEnd);\n    },\n\n    // Private methods\n    // ---------------\n\n    _getCaretRelativePosition: function () {\n      var p = $.fn.textcomplete.getCaretCoordinates(this.el, this.el.selectionStart);\n      return {\n        top: p.top + this._calculateLineHeight() - this.$el.scrollTop(),\n        left: p.left - this.$el.scrollLeft(),\n        lineHeight: this._calculateLineHeight()\n      };\n    },\n\n    _calculateLineHeight: function () {\n      var lineHeight = parseInt(this.$el.css('line-height'), 10);\n      if (isNaN(lineHeight)) {\n        // http://stackoverflow.com/a/4515470/1297336\n        var parentNode = this.el.parentNode;\n        var temp = document.createElement(this.el.nodeName);\n        var style = this.el.style;\n        temp.setAttribute(\n          'style',\n          'margin:0px;padding:0px;font-family:' + style.fontFamily + ';font-size:' + style.fontSize\n        );\n        temp.innerHTML = 'test';\n        parentNode.appendChild(temp);\n        lineHeight = temp.clientHeight;\n        parentNode.removeChild(temp);\n      }\n      return lineHeight;\n    }\n  });\n\n  $.fn.textcomplete.Textarea = Textarea;\n}(jQuery);\n\n+function ($) {\n  'use strict';\n\n  var sentinelChar = '吶';\n\n  function IETextarea(element, completer, option) {\n    this.initialize(element, completer, option);\n    $('<span>' + sentinelChar + '</span>').css({\n      position: 'absolute',\n      top: -9999,\n      left: -9999\n    }).insertBefore(element);\n  }\n\n  $.extend(IETextarea.prototype, $.fn.textcomplete.Textarea.prototype, {\n    // Public methods\n    // --------------\n\n    select: function (value, strategy, e) {\n      var pre = this.getTextFromHeadToCaret();\n      var post = this.el.value.substring(pre.length);\n      var newSubstr = strategy.replace(value, e);\n      var regExp;\n      if (typeof newSubstr !== 'undefined') {\n        if ($.isArray(newSubstr)) {\n          post = newSubstr[1] + post;\n          newSubstr = newSubstr[0];\n        }\n        regExp = $.isFunction(strategy.match) ? strategy.match(pre) : strategy.match;\n        pre = pre.replace(regExp, newSubstr);\n        this.$el.val(pre + post);\n        this.el.focus();\n        var range = this.el.createTextRange();\n        range.collapse(true);\n        range.moveEnd('character', pre.length);\n        range.moveStart('character', pre.length);\n        range.select();\n      }\n    },\n\n    getTextFromHeadToCaret: function () {\n      this.el.focus();\n      var range = document.selection.createRange();\n      range.moveStart('character', -this.el.value.length);\n      var arr = range.text.split(sentinelChar)\n      return arr.length === 1 ? arr[0] : arr[1];\n    }\n  });\n\n  $.fn.textcomplete.IETextarea = IETextarea;\n}(jQuery);\n\n// NOTE: TextComplete plugin has contenteditable support but it does not work\n//       fine especially on old IEs.\n//       Any pull requests are REALLY welcome.\n\n+function ($) {\n  'use strict';\n\n  // ContentEditable adapter\n  // =======================\n  //\n  // Adapter for contenteditable elements.\n  function ContentEditable (element, completer, option) {\n    this.initialize(element, completer, option);\n  }\n\n  $.extend(ContentEditable.prototype, $.fn.textcomplete.Adapter.prototype, {\n    // Public methods\n    // --------------\n\n    // Update the content with the given value and strategy.\n    // When an dropdown item is selected, it is executed.\n    select: function (value, strategy, e) {\n      var pre = this.getTextFromHeadToCaret();\n      // use ownerDocument instead of window to support iframes\n      var sel = this.el.ownerDocument.getSelection();\n      \n      var range = sel.getRangeAt(0);\n      var selection = range.cloneRange();\n      selection.selectNodeContents(range.startContainer);\n      var content = selection.toString();\n      var post = content.substring(range.startOffset);\n      var newSubstr = strategy.replace(value, e);\n      var regExp;\n      if (typeof newSubstr !== 'undefined') {\n        if ($.isArray(newSubstr)) {\n          post = newSubstr[1] + post;\n          newSubstr = newSubstr[0];\n        }\n        regExp = $.isFunction(strategy.match) ? strategy.match(pre) : strategy.match;\n        pre = pre.replace(regExp, newSubstr)\n            .replace(/ $/, \"&nbsp\"); // &nbsp necessary at least for CKeditor to not eat spaces\n        range.selectNodeContents(range.startContainer);\n        range.deleteContents();\n        \n        // create temporary elements\n        var preWrapper = this.el.ownerDocument.createElement(\"div\");\n        preWrapper.innerHTML = pre;\n        var postWrapper = this.el.ownerDocument.createElement(\"div\");\n        postWrapper.innerHTML = post;\n        \n        // create the fragment thats inserted\n        var fragment = this.el.ownerDocument.createDocumentFragment();\n        var childNode;\n        var lastOfPre;\n        while (childNode = preWrapper.firstChild) {\n        \tlastOfPre = fragment.appendChild(childNode);\n        }\n        while (childNode = postWrapper.firstChild) {\n        \tfragment.appendChild(childNode);\n        }\n        \n        // insert the fragment & jump behind the last node in \"pre\"\n        range.insertNode(fragment);\n        range.setStartAfter(lastOfPre);\n        \n        range.collapse(true);\n        sel.removeAllRanges();\n        sel.addRange(range);\n      }\n    },\n\n    // Private methods\n    // ---------------\n\n    // Returns the caret's relative position from the contenteditable's\n    // left top corner.\n    //\n    // Examples\n    //\n    //   this._getCaretRelativePosition()\n    //   //=> { top: 18, left: 200, lineHeight: 16 }\n    //\n    // Dropdown's position will be decided using the result.\n    _getCaretRelativePosition: function () {\n      var range = this.el.ownerDocument.getSelection().getRangeAt(0).cloneRange();\n      var wrapperNode = range.endContainer.parentNode;\n      var node = this.el.ownerDocument.createElement('span');\n      range.insertNode(node);\n      range.selectNodeContents(node);\n      range.deleteContents();\n      setTimeout(function() { wrapperNode.normalize(); }, 0);\n      var $node = $(node);\n      var position = $node.offset();\n      position.left -= this.$el.offset().left;\n      position.top += $node.height() - this.$el.offset().top;\n      position.lineHeight = $node.height();\n      \n      // special positioning logic for iframes\n      // this is typically used for contenteditables such as tinymce or ckeditor\n      if (this.completer.$iframe) {\n        var iframePosition = this.completer.$iframe.offset();\n        position.top += iframePosition.top;\n        position.left += iframePosition.left;\n        // We need to get the scrollTop of the html-element inside the iframe and not of the body-element,\n        // because on IE the scrollTop of the body-element (this.$el) is always zero.\n        position.top -= $(this.completer.$iframe[0].contentWindow.document).scrollTop();\n      }\n      \n      $node.remove();\n      return position;\n    },\n\n    // Returns the string between the first character and the caret.\n    // Completer will be triggered with the result for start autocompleting.\n    //\n    // Example\n    //\n    //   // Suppose the html is '<b>hello</b> wor|ld' and | is the caret.\n    //   this.getTextFromHeadToCaret()\n    //   // => ' wor'  // not '<b>hello</b> wor'\n    getTextFromHeadToCaret: function () {\n      var range = this.el.ownerDocument.getSelection().getRangeAt(0);\n      var selection = range.cloneRange();\n      selection.selectNodeContents(range.startContainer);\n      return selection.toString().substring(0, range.startOffset);\n    }\n  });\n\n  $.fn.textcomplete.ContentEditable = ContentEditable;\n}(jQuery);\n\n// NOTE: TextComplete plugin has contenteditable support but it does not work\n//       fine especially on old IEs.\n//       Any pull requests are REALLY welcome.\n\n+function ($) {\n  'use strict';\n\n  // CKEditor adapter\n  // =======================\n  //\n  // Adapter for CKEditor, based on contenteditable elements.\n  function CKEditor (element, completer, option) {\n    this.initialize(element, completer, option);\n  }\n\n  $.extend(CKEditor.prototype, $.fn.textcomplete.ContentEditable.prototype, {\n    _bindEvents: function () {\n      var $this = this;\n      this.option.ckeditor_instance.on('key', function(event) {\n        var domEvent = event.data;\n        $this._onKeyup(domEvent);\n        if ($this.completer.dropdown.shown && $this._skipSearch(domEvent)) {\n          return false;\n        }\n      }, null, null, 1); // 1 = Priority = Important!\n      // we actually also need the native event, as the CKEditor one is happening to late\n      this.$el.on('keyup.' + this.id, $.proxy(this._onKeyup, this));\n    },\n});\n\n  $.fn.textcomplete.CKEditor = CKEditor;\n}(jQuery);\n\n// The MIT License (MIT)\n// \n// Copyright (c) 2015 Jonathan Ong me@jongleberry.com\n// \n// Permission is hereby granted, free of charge, to any person obtaining a copy of this software and\n// associated documentation files (the \"Software\"), to deal in the Software without restriction,\n// including without limitation the rights to use, copy, modify, merge, publish, distribute,\n// sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is\n// furnished to do so, subject to the following conditions:\n// \n// The above copyright notice and this permission notice shall be included in all copies or\n// substantial portions of the Software.\n// \n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT\n// NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\n// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n// OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n//\n// https://github.com/component/textarea-caret-position\n\n(function ($) {\n\n// The properties that we copy into a mirrored div.\n// Note that some browsers, such as Firefox,\n// do not concatenate properties, i.e. padding-top, bottom etc. -> padding,\n// so we have to do every single property specifically.\nvar properties = [\n  'direction',  // RTL support\n  'boxSizing',\n  'width',  // on Chrome and IE, exclude the scrollbar, so the mirror div wraps exactly as the textarea does\n  'height',\n  'overflowX',\n  'overflowY',  // copy the scrollbar for IE\n\n  'borderTopWidth',\n  'borderRightWidth',\n  'borderBottomWidth',\n  'borderLeftWidth',\n  'borderStyle',\n\n  'paddingTop',\n  'paddingRight',\n  'paddingBottom',\n  'paddingLeft',\n\n  // https://developer.mozilla.org/en-US/docs/Web/CSS/font\n  'fontStyle',\n  'fontVariant',\n  'fontWeight',\n  'fontStretch',\n  'fontSize',\n  'fontSizeAdjust',\n  'lineHeight',\n  'fontFamily',\n\n  'textAlign',\n  'textTransform',\n  'textIndent',\n  'textDecoration',  // might not make a difference, but better be safe\n\n  'letterSpacing',\n  'wordSpacing',\n\n  'tabSize',\n  'MozTabSize'\n\n];\n\nvar isBrowser = (typeof window !== 'undefined');\nvar isFirefox = (isBrowser && window.mozInnerScreenX != null);\n\nfunction getCaretCoordinates(element, position, options) {\n  if(!isBrowser) {\n    throw new Error('textarea-caret-position#getCaretCoordinates should only be called in a browser');\n  }\n\n  var debug = options && options.debug || false;\n  if (debug) {\n    var el = document.querySelector('#input-textarea-caret-position-mirror-div');\n    if ( el ) { el.parentNode.removeChild(el); }\n  }\n\n  // mirrored div\n  var div = document.createElement('div');\n  div.id = 'input-textarea-caret-position-mirror-div';\n  document.body.appendChild(div);\n\n  var style = div.style;\n  var computed = window.getComputedStyle? getComputedStyle(element) : element.currentStyle;  // currentStyle for IE < 9\n\n  // default textarea styles\n  style.whiteSpace = 'pre-wrap';\n  if (element.nodeName !== 'INPUT')\n    style.wordWrap = 'break-word';  // only for textarea-s\n\n  // position off-screen\n  style.position = 'absolute';  // required to return coordinates properly\n  if (!debug)\n    style.visibility = 'hidden';  // not 'display: none' because we want rendering\n\n  // transfer the element's properties to the div\n  properties.forEach(function (prop) {\n    style[prop] = computed[prop];\n  });\n\n  if (isFirefox) {\n    // Firefox lies about the overflow property for textareas: https://bugzilla.mozilla.org/show_bug.cgi?id=984275\n    if (element.scrollHeight > parseInt(computed.height))\n      style.overflowY = 'scroll';\n  } else {\n    style.overflow = 'hidden';  // for Chrome to not render a scrollbar; IE keeps overflowY = 'scroll'\n  }\n\n  div.textContent = element.value.substring(0, position);\n  // the second special handling for input type=\"text\" vs textarea: spaces need to be replaced with non-breaking spaces - http://stackoverflow.com/a/13402035/1269037\n  if (element.nodeName === 'INPUT')\n    div.textContent = div.textContent.replace(/\\s/g, '\\u00a0');\n\n  var span = document.createElement('span');\n  // Wrapping must be replicated *exactly*, including when a long word gets\n  // onto the next line, with whitespace at the end of the line before (#7).\n  // The  *only* reliable way to do that is to copy the *entire* rest of the\n  // textarea's content into the <span> created at the caret position.\n  // for inputs, just '.' would be enough, but why bother?\n  span.textContent = element.value.substring(position) || '.';  // || because a completely empty faux span doesn't render at all\n  div.appendChild(span);\n\n  var coordinates = {\n    top: span.offsetTop + parseInt(computed['borderTopWidth']),\n    left: span.offsetLeft + parseInt(computed['borderLeftWidth'])\n  };\n\n  if (debug) {\n    span.style.backgroundColor = '#aaa';\n  } else {\n    document.body.removeChild(div);\n  }\n\n  return coordinates;\n}\n\n$.fn.textcomplete.getCaretCoordinates = getCaretCoordinates;\n\n}(jQuery));\n\nreturn jQuery;\n}));\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/jquery-textcomplete/dist/jquery.textcomplete.js\n// module id = 697\n// module chunks = 0 1 5 7","module.exports={render:function (){var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;\n  return _c('div', {\n    staticClass: \"comment-temp\"\n  }, [_c('div', [_c('v-expansion-panel', {\n    staticClass: \"expansion-pl-transparent\"\n  }, [_c('v-expansion-panel-content', {\n    attrs: {\n      \"hide-actions\": \"\",\n      \"value\": true\n    }\n  }, [_c('v-card', {\n    staticClass: \"comments__container\"\n  }, [_c('v-card-text', {\n    staticClass: \"pl-4\"\n  }, [_c('div', {\n    attrs: {\n      \"id\": \"comments-container-el\"\n    }\n  })])], 1)], 1)], 1)], 1)])\n},staticRenderFns: []}\nmodule.exports.render._withStripped = true\nif (module.hot) {\n  module.hot.accept()\n  if (module.hot.data) {\n     require(\"vue-hot-reload-api\").rerender(\"data-v-c8f36406\", module.exports)\n  }\n}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/vue-loader/lib/template-compiler?{\"id\":\"data-v-c8f36406\"}!./~/vue-loader/lib/selector.js?type=template&index=0!./src/components/Comment.vue\n// module id = 701\n// module chunks = 0 1 5 7","module.exports = function(originalModule) {\r\n\tif(!originalModule.webpackPolyfill) {\r\n\t\tvar module = Object.create(originalModule);\r\n\t\t// module.parent = undefined by default\r\n\t\tif(!module.children) module.children = [];\r\n\t\tObject.defineProperty(module, \"loaded\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.l;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(module, \"id\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.i;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(module, \"exports\", {\r\n\t\t\tenumerable: true,\r\n\t\t});\r\n\t\tmodule.webpackPolyfill = 1;\r\n\t}\r\n\treturn module;\r\n};\r\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// (webpack)/buildin/harmony-module.js\n// module id = 703\n// module chunks = 0 1 5 7"],"sourceRoot":""}